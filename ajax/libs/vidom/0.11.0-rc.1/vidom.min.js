/**
 * Vidom
 * @author Filatov Dmitry <dfilatov@inbox.ru>
 * @version 0.11.0-rc.1
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.vidom={})}(this,function(t){"use strict";function e(t){t+="";for(var e=t.length,n=0;e-- >0;)switch(t.charCodeAt(e)){case 38:n|=1;break;case 34:n|=2}return 1===(1&n)&&(t=t.replace(Xt,"&amp;")),2===(2&n)&&(t=t.replace(Yt,"&quot;")),t}function n(t,e){for(var n=t.length,r=0;r<n;)if(t[r++]==e)return!0;return!1}function r(t){return t.replace(te,"$1-$2").toLowerCase()}function i(t,e,n){if("type"===e&&"INPUT"===t.tagName){var r=t.value;t.setAttribute(e,""+n),t.value=r}else t.setAttribute(_(e),""+n)}function o(t,e,n){n?i(t,e,n):a(t,e)}function u(t,e,n){t[e]=n}function s(t,e,n){var r=t[e];for(var i in n)r[i]=null==n[i]?"":n[i]}function l(t,e,n){"value"===e&&"SELECT"===t.tagName?c(t,n):t[e]!==n&&(t[e]=n)}function a(t,e){t.removeAttribute(_(e))}function h(t,e){"style"===e?t[e].cssText="":"value"===e&&"SELECT"===t.tagName?d(t):t[e]=g(t.tagName,e)}function c(t,e){var r=Array.isArray(e);if(r)for(var i=t.options,o=i.length,u=0,s=void 0;u<o;)s=i[u++],s.selected=null!=e&&n(e,s.value);else t.value=e}function d(t){for(var e=t.options,n=e.length,r=0;r<n;)e[r++].selected=!1}function f(t,n){var r=_(t);return r&&r+'="'+e(n)+'"'}function p(t,e){return e?_(t):""}function v(t,e){return"boolean"==typeof e?p(t,e):f(t,e)}function m(t,e){var n="",i=void 0;for(i in e)null!=e[i]&&(n+=r(i)+":"+e[i]+";");return n?t+'="'+n+'"':n}function g(t,e){var n=t+":"+e;if(n in ie)return ie[n];var r=t in re?re[t]:re[t]=document.createElement(t);return ie[n]=r[e]}function _(t){return t in le?le[t]:le[t]=se.test(t)?t.toLowerCase():""}function y(t,e){if(Array.isArray(t))b(e,t[1]);else if(Array.isArray(e)){for(var n=e[0],r=void 0,i=e[1];n!==i;)r=n.nextSibling,t.appendChild(n),n=r;t.appendChild(i)}else t.appendChild(e)}function C(t){if(Array.isArray(t)){for(var e=t[0],n=void 0,r=t[1],i=r.parentNode;e!==r;)n=e.nextSibling,i.removeChild(e),e=n;i.removeChild(r)}else t.parentNode.removeChild(t)}function b(t,e){if(Array.isArray(e)&&(e=e[0]),Array.isArray(t)){for(var n=t[0],r=void 0,i=t[1],o=i.parentNode;n!==i;)r=n.nextSibling,o.insertBefore(n,e),n=r;o.insertBefore(i,e)}else e.parentNode.insertBefore(t,e)}function x(t,e,n){if(n){Array.isArray(e)&&(e=e[1]);var r=e.nextSibling;r?b(t,r):y(e.parentNode,t)}else b(t,e)}function A(t,e){Array.isArray(t)?(b(e,t),C(t)):t.parentNode.replaceChild(e,t)}function D(t){if(Array.isArray(t))for(var e=t[0].nextSibling,n=void 0,r=t[1],i=r.parentNode;e!==r;)n=e.nextSibling,i.removeChild(e),e=n;else t.textContent=""}function N(t,e,n){if(Array.isArray(t)){var r=t[1],i=r.previousSibling;i===t[0]?r.parentNode.insertBefore(document.createTextNode(e),r):i.nodeValue=e}else if(n){var o=t.firstChild;o?o.nodeValue=e:t.textContent=e}else t.innerHTML=e}function w(t){if(Array.isArray(t)){var e=t[0].nextSibling;e.parentNode.removeChild(e)}else t.textContent=""}function E(t,e){return ge in t?t[ge]:e?null:t[ge]=_e++}function T(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.type;if(ke)for(var n=t.target,r=Te[e].listenersCount,i=void 0,o=void 0;r&&n&&n!==document;){if((o=E(n,!0))&&o in Ee&&(i=Ee[o][e],null!=i&&(i(t),0===--r||t.cancelBubble)))return;n=n.parentNode}}function k(t){ke&&Ee[E(t.currentTarget)][t.type](t)}function R(t,e,n){t.bubbles?++t.listenersCount:e.addEventListener(n,k,!1)}function S(t,e,n){if(e in Te){var r=Te[e];r.set||(null!==r.setup?r.setup():r.bubbles&&document.addEventListener(e,T,!1),r.set=!0);var i=E(t),o=void 0;i in Ee?(o=Ee[i],null==o[e]&&R(r,t,e)):(o=Ee[i]=Object.create(null),R(r,t,e)),o[e]=n}}function M(t,e,n){t.bubbles?--t.listenersCount:e.removeEventListener(n,k)}function O(t,e){var n=E(t,!0);if(null!==n&&n in Ee){var r=Ee[n];r[e]=null,M(Te[e],t,e)}}function j(t){var e=E(t,!0);if(null!==e&&e in Ee){var n=Ee[e];for(var r in n)null!==n[r]&&M(Te[r],t,r);delete Ee[e]}}function F(){ke=!1}function I(){ke=!0}function L(t){return Array.isArray(t)?P(t):t.namespaceURI===Re.html?null:t.namespaceURI}function P(t){return L((Array.isArray(t)?t[t.length-1]:t).parentNode)}function U(t,e){var n=t.getDomNode();me.append(n,e.renderToDom(L(n))),e.mount()}function q(t,e){var n=e.getDomNode();me.insertBefore(t.renderToDom(P(n)),n),t.mount()}function B(t){var e=t.getDomNode();t.unmount(),me.remove(e)}function H(t,e,n){var r=document.activeElement;F(),me.move(t.getDomNode(),e.getDomNode(),n),document.activeElement!==r&&r.focus(),I()}function K(t){for(var e=t.getDomNode(),n=t.children,r=n.length,i=0;i<r;)n[i++].unmount();me.removeChildren(e)}function V(t,e){var n=t.getDomNode();t.unmount(),me.replace(n,e.renderToDom(P(n))),e.mount()}function W(t,e,n){var r=t.getDomNode();e in Se?S(r,Se[e],n):ve(e).set(r,e,n)}function Z(t,e){var n=t.getDomNode();e in Se?O(n,Se[e]):ve(e).remove(n,e)}function $(t,e,n){me.updateText(t.getDomNode(),e,n)}function z(t){me.removeText(t.getDomNode())}function G(t,e){var n=t.children,r=e.children,i=n.length,o=r.length;if(1===i&&1===o)return void n[0].patch(r[0]);for(var u=0,s=i-1,l=n[u],a=l.key,h=n[s],c=h.key,d=0,f=o-1,p=r[d],v=p.key,m=r[f],g=m.key,_=0,y=null,C=void 0,b=void 0,x=Object.create(null);u<=s&&d<=f;)u in x?_=1:s in x?_=2:a===v?(l.patch(p),_=5):c===g?(h.patch(m),_=10):null!==a&&a===g?(Me.moveChild(l,h,!0),l.patch(m),_=9):null!==c&&c===v?(Me.moveChild(h,l,!1),h.patch(p),_=6):null!==a&&null===v?(Me.insertChild(p,l),_=4):null===a&&null!==v?(Me.removeChild(l),_=1):(null===y&&(y=J(n,u,s)),v in y?(C=y[v],b=n[C],x[C]=!0,Me.moveChild(b,l,!1),b.patch(p)):Me.insertChild(p,l),_=4),1===(1&_)&&++u<=s&&(l=n[u],a=l.key),2===(2&_)&&--s>=u&&(h=n[s],c=h.key),4===(4&_)&&++d<=f&&(p=r[d],v=p.key),8===(8&_)&&--f>=d&&(m=r[f],g=m.key),_=0;for(;u<=s;)u in x||Me.removeChild(n[u]),++u;for(;d<=f;)f<o-1?Me.insertChild(r[d],r[f+1]):Me.appendChild(e,r[d]),++d}function J(t,e,n){for(var r=Object.create(null),i=void 0;e<n;)i=t[e].key,null!==i&&(r[i]=e),++e;return r}function Q(t){t+="";for(var e=t.length,n=0;e-- >0;)switch(t.charCodeAt(e)){case 38:n|=1;break;case 60:n|=2;break;case 62:n|=4}return 1===(1&n)&&(t=t.replace(Oe,"&amp;")),2===(2&n)&&(t=t.replace(je,"&lt;")),4===(4&n)&&(t=t.replace(Fe,"&gt;")),t}function X(t,e,n){var r={};for(var i in t)r[i]=t[i];for(var o in e){var u=e[o];(n||"undefined"!=typeof u)&&(r[o]=u)}return r}function Y(t,e){var n=void 0;if(null===e)n=t in Le?Le[t]:Le[t]="!"===t?document.createComment(""):document.createElement(t);else{var r=e+":"+t;n=r in Le?Le[r]:Le[r]=document.createElementNS(e,t)}return n.cloneNode()}function tt(t,e,n){var r=Ue[e]||"div",i=qe[r]||(qe[r]=document.createElement(r));if(!n||!Pe[n]||Pe[n]===e)return i.innerHTML=t,i.removeChild(i.firstChild);var o=Pe[n];return i.innerHTML="<"+o+' xmlns="'+n+'">'+t+"</"+o+">",i.removeChild(i.firstChild).firstChild}function et(t){if(null==t)return null;var e=typeof t;if("object"!==e)return"string"===e?t||null:"boolean"===e?null:""+t;if(!Array.isArray(t))return t;if(0===t.length)return null;for(var n=t,r=0,i=!1,o=void 0,u=t.length,s=Object.create(null);r<u;){if(o=r in s?s[r]:et(t[r]),null===o)null!==n&&(i?n===t&&(n=t.slice(0,r)):n=null);else if("object"==typeof o)Array.isArray(o)?n=i?(n===t?n.slice(0,r):Array.isArray(n)?n:[nt(n)]).concat(o):o:n!==t?i?Array.isArray(n)?n.push(o):n=[nt(n),o]:n=o:o!==t[r]&&(i?(n=n.slice(0,r),n.push(o)):n=o),i=!0;else{for(var l=void 0,a=r;++a<u;)if(l=s[a]=et(t[a]),"string"==typeof l)o+=l;else if(null!==l)break;i?Array.isArray(n)?(n===t&&(n=n.slice(0,r)),n.push(nt(o))):n=[n,nt(o)]:n=""+o,r=a-1,i=!0}++r}return n}function nt(t){return"object"==typeof t?t:zt("plaintext",null,null,t)}function rt(t,e,n,r,i,o){this.type=Be,this.tag=t,this.key=null==e?null:e,this.attrs=n||Ie,this.children=it(r),this.ref=null==i?null:i,this._domNode=null,this._ns=t in Re?Re[t]:null,this._escapeChildren=o!==!1,this._ctx=Ie}function it(t){var e=et(t),n=null===e||"object"!=typeof e||Array.isArray(e)?e:[e];return n}function ot(){}function ut(t,e){return t.priority-e.priority}function st(){for(var t=0;t<Ge.length;){Ge.sort(ut);for(var e=Ge.length;t<e;){var n=Ge[t++],r=n.fn,i=n.ctx;r.call(i)}Ge.length>e&&(Ge=Ge.slice(e),t=0)}Ge=[]}function lt(t){1===Ge.push(t)&&ze(st)}function at(t){var e=et(t);return null===e?zt("!"):"object"==typeof e?Array.isArray(e)?zt("fragment",null,null,e):e:zt("plaintext",null,null,e)}function ht(){this._listeners=Object.create(null)}function ct(t,e,n,r,i){var o=E(t),u=Ye[o],s=void 0;if(u&&null!==u.tree){s=++u.id;var l=function(){if(u=Ye[o],u&&u.id===s){var t=u.tree,i=at(e);n&&i.setCtx(n),t.patch(i),u.tree=i,ft(r)}};i?l():lt({priority:0,fn:l})}else{if(u=Ye[o]={tree:null,id:s=++tn},t.childNodes.length>0){var a=pt(t);if(null!==a){var h=u.tree=at(e);return n&&h.setCtx(n),h.adoptDom(a,0),h.mount(),void ft(r)}t.textContent=""}var c=function(){var i=Ye[o];if(i&&i.id===s){var u=i.tree=at(e);n&&u.setCtx(n),me.append(t,u.renderToDom(L(t))),u.mount(),ft(r)}};i?c():lt({priority:0,fn:c})}}function dt(t,e,n){var r=E(t),i=Ye[r];if(i){var o=++i.id,u=function(){if(i=Ye[r],i&&i.id===o){delete Ye[r];var t=i.tree;if(null!==t){var n=t.getDomNode();t.unmount(),me.remove(n)}ft(e)}};i.tree?n?u():lt({priority:0,fn:u}):n||ft(e)}else n||ft(e)}function ft(t){t&&t()}function pt(t){for(var e=t.childNodes,n=e.length,r=0,i=null,o=void 0;r<n;)o=e[r++],i?i.push(o):o.nodeType===Node.COMMENT_NODE&&"vidom"===o.textContent&&(i=[]);return i}function vt(t,e,n,r){"function"==typeof n&&(r=n,n=this),ct(t,e,n,r,!1)}function mt(t,e,n){ct(t,e,n,null,!0)}function gt(t,e){dt(t,e,!1)}function _t(t){dt(t,null,!0)}function yt(){var t=[];for(var e in Ye){var n=Ye[e].tree;n&&t.push(n)}return t}function Ct(){this.onInit()}function bt(){this.__isMounted=!0,this.__prevState=this.state,this.getRootElement().mount(),this.onMount()}function xt(){this.__isMounted=!1,this.getRootElement().unmount(),this.onUnmount()}function At(t,e,n,r){r&&(this.__prevAttrs=this.attrs,this.__prevChildren=this.children,this.__prevContext=this.context,this.attrs=this.__buildAttrs(t),this.children=e,this.context=n),this.__isUpdating=!0,this.onChange(this.__prevAttrs,this.__prevChildren,this.__prevState,this.__prevContext),this.__isUpdating=!1;var i=this.shouldRerender(this.__prevAttrs,this.__prevChildren,this.__prevState,this.__prevContext);if(i){var o=this.getRootElement();this.__rootElement=this.render(),o.patch(this.__rootElement)}this.onUpdate(this.__prevAttrs,this.__prevChildren,this.__prevState,this.__prevContext),this.__prevAttrs=this.attrs,this.__prevChildren=this.children,this.__prevState=this.state,this.__prevContext=this.context}function Dt(){return!0}function Nt(){return null}function wt(t){return this.getRootElement().renderToDom(t)}function Et(){return this.getRootElement().renderToString()}function Tt(t,e){return this.getRootElement().adoptDom(t,e)}function kt(){return this.getRootElement().getDomNode()}function Rt(){return Ie}function St(t){this.state=this.state===Ie?t:X(this.state,t,!0),this.update()}function Mt(){var t=at(this.onRender()),e=this.onChildContextRequest(),n=e===Ie?this.context:this.context===Ie?e:X(this.context,e);return t.setCtx(n),t}function Ot(){!this.__isUpdating&&this.isMounted()&&(this.__isUpdating=!0,lt({priority:this.__id,fn:jt,ctx:this}))}function jt(){if(this.__isUpdating&&this.isMounted()){this.patch(this.attrs,this.children,this.context,!1)}}function Ft(){return null===this.__rootElement?this.__rootElement=this.render():this.__rootElement}function It(){return this.__isMounted}function Lt(){return this}function Pt(t){if(t===this.attrs)return t;var e=this.constructor.defaultAttrs,n=null!=e,r=t===Ie?n?e:t:n?X(e,t):t;return r}function Ut(t,e){var n=function(t,e,n){this.attrs=this.__buildAttrs(t),this.children=e,this.state=Ie,this.context=n,this.__id=nn++,this.__isMounted=!1,this.__isUpdating=!1,this.__rootElement=null,this.__prevAttrs=this.attrs,this.__prevChildren=this.children,this.__prevState=Ie,this.__prevContext=this.context},r={constructor:n,init:Ct,onInit:ot,mount:bt,unmount:xt,onMount:ot,onUnmount:ot,onChange:ot,shouldRerender:Dt,onRender:Nt,onUpdate:ot,isMounted:It,setState:St,renderToDom:wt,renderToString:Et,adoptDom:Tt,getDomNode:kt,getRootElement:Ft,render:Mt,update:Ot,patch:At,onChildContextRequest:Rt,onRefRequest:Lt,__buildAttrs:Pt};for(var i in t)r[i]=t[i];n.prototype=r;for(var o in e)n[o]=e[o];return n.__vidom__component__=!0,n}function qt(t,e){t in on?on[t].push(e):on[t]=[e]}function Bt(t,e){for(var n=on[t],r=n.length,i=0;i<r;){if(n[i]===e)return void(1===r?delete on[t]:n.splice(i,1));i++}}function Ht(t,e,n,r,i){if(this.type=Ve,this.key=null==e?null:e,this.attrs=n||Ie,this.children=r,this.ref=null==i?null:i,t===rn)switch(this.attrs.type){case"radio":this.component=un;break;case"checkbox":this.component=sn;break;case"file":this.component=ln;break;default:this.component=t}else this.component=t;this._instance=null,this._ctx=Ie}function Kt(t,e,n,r){this.type=We,this.component=t,this.key=null==e?null:e,this.attrs=n||Ie,this.children=r,this._rootElement=null,this._ctx=Ie}function Vt(t,e){this.type=Ke,this.key=null==t?null:t,this.children=Wt(e),this._domNode=null,this._ctx=Ie}function Wt(t){var e=et(t),n=null===e||Array.isArray(e)?e:["string"==typeof e?at(e):e];return n}function Zt(t,e){this.type=He,this.key=null==t?null:t,this.children=$t(e),this._domNode=null}function $t(t){if(null==t)return null;switch(typeof t){case"string":return t;case"boolean":return null;default:return""+t}}function zt(t,e,n,r,i,o){switch(typeof t){case"string":switch(t){case"fragment":return new Vt(e,r);case"plaintext":return new Zt(e,r);case"input":return new Ht(rn,e,n,r,i);case"textarea":return new Ht(an,e,n,r,i);case"select":return new Ht(hn,e,n,r,i);default:return new rt(t,e,n,r,i,o)}case"function":return t.__vidom__component__?new Ht(t,e,n,r,i):new Kt(t,e,n,r)}}function Gt(t,e){var n=!1,r=null,i=null,o=null,u=arguments.length>2?arguments.length>3?cn.call(arguments,2):arguments[2]:null,s=void 0;if(e)for(var l in e)switch(l){case"key":i=e[l],n=!0;break;case"ref":o=e[l],n=!0;break;case"html":u=e[l],s=!1,n=!0;break;default:null===r&&(r=Object.create(null)),r[l]=e[l]}return zt(t,i,n?r:e,u,o,s)}function Jt(t){return"<!--vidom-->"+at(t).renderToString()}function Qt(t){var e=et(t);return null===e?[]:"string"==typeof e?[zt("plaintext",null,null,e)]:Array.isArray(e)?e:[e]}var Xt=/&/g,Yt=/"/g,te=/([^A-Z]+)([A-Z])/g,ee=!1,ne=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},re=Object.create(null),ie=Object.create(null),oe=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",ue=oe+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",se=new RegExp("^["+oe+"]["+ue+"]*$"),le=Object.create(null),ae={set:i,remove:a,toString:f},he=ne({},ae,{set:o,toString:p}),ce=ne({},he,{toString:v}),de={set:u,remove:h,toString:f},fe=ne({},de,{toString:p}),pe=Object.create(null);le.acceptCharset="accept-charset",le.className="class",le.htmlFor="for",le.httpEquiv="http-equiv",pe.autoPlay=he,pe.checked=fe,pe.controls=de,pe.disabled=he,pe.download=ce,pe.id=de,pe.ismap=he,pe.loop=de,pe.multiple=fe,pe.muted=de,pe.open=he,pe.readOnly=fe,pe.selected=fe,pe.srcDoc=de,pe.style={set:s,remove:h,toString:m},pe.value={set:l,remove:h,toString:f};var ve=function(t){return t in pe?pe[t]:ae},me={append:y,remove:C,insertBefore:b,move:x,replace:A,removeChildren:D,updateText:N,removeText:w},ge="undefined"==typeof Symbol?"__vidom__id__":Symbol(),_e=1,ye="undefined"==typeof navigator?"":navigator.userAgent,Ce="undefined"==typeof navigator?"":navigator.platform,be=ye.indexOf("Trident")>-1,xe=ye.indexOf("Edge")>-1,Ae=/iPad|iPhone|iPod/.test(Ce),De=["click","mousedown","mousemove","mouseout","mouseover","mouseup"],Ne=["animationend","animationiteration","animationstart","blur","change","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragleave","dragover","dragstart","drop","focus","input","keydown","keypress","keyup","paste","pointerover","pointerdown","pointermove","pointerup","pointercancel","pointerout","submit","touchcancel","touchend","touchmove","touchstart","transitionend","wheel"],we=["canplay","canplaythrough","complete","durationchange","emptied","ended","error","gotpointercapture","load","loadeddata","loadedmetadata","loadstart","lostpointercapture","mouseenter","mouseleave","pause","play","playing","pointerenter","pointerleave","progress","ratechange","scroll","seeked","seeking","select","stalled","suspend","timeupdate","volumechange","waiting"];Ae?we=[].concat(we,De):Ne=[].concat(Ne,De);var Ee=Object.create(null),Te=Object.create(null),ke=!0;"undefined"!=typeof document&&!function(){var t={focus:"focusin",blur:"focusout"},e=0,n=!0,r=void 0,i=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/);for(null!==i&&Number(i[1])<52&&(n=!1);e<Ne.length;)r=Ne[e++],Te[r]={type:r,bubbles:!0,listenersCount:0,set:!1,setup:r in t?n?function(){var e=this.type;document.addEventListener(t[e],function(t){T(t,e)})}:function(){document.addEventListener(this.type,T,!0)}:null};for(e=0;e<we.length;)Te[we[e++]]={type:r,bubbles:!1,set:!1,setup:null}}();var Re=Object.create(null);Re.html="http://www.w3.org/1999/xhtml",Re.svg="http://www.w3.org/2000/svg",Re.math="http://www.w3.org/1998/Math/MathML";var Se=["onAnimationEnd","onAnimationIteration","onAnimationStart","onBlur","onCanPlay","onCanPlayThrough","onChange","onClick","onComplete","onContextMenu","onCopy","onCut","onDblClick","onDrag","onDragEnd","onDragEnter","onDragLeave","onDragOver","onDragStart","onDrop","onDurationChange","onEmptied","onEnded","onError","onFocus","onGotPointerCapture","onInput","onKeyDown","onKeyPress","onKeyUp","onLoad","onLoadedData","onLoadedMetadata","onLoadStart","onLostPointerCapture","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onPaste","onPause","onPlay","onPlaying","onPointerCancel","onPointerDown","onPointerEnter","onPointerLeave","onPointerMove","onPointerOut","onPointerOver","onPointerUp","onProgress","onRateChange","onScroll","onSeeked","onSeeking","onSelect","onStalled","onSubmit","onSuspend","onTimeUpdate","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onTransitionEnd","onVolumeChange","onWaiting","onWheel"].reduce(function(t,e){return t[e]=e.substr(2).toLowerCase(),t},Object.create(null)),Me={appendChild:U,insertChild:q,removeChild:B,moveChild:H,removeChildren:K,replace:V,updateAttr:W,removeAttr:Z,updateText:$,removeText:z},Oe=/&/g,je=/</g,Fe=/>/g,Ie=Object.create(null),Le=Object.create(null),Pe={"http://www.w3.org/2000/svg":"svg","http://www.w3.org/1998/Math/MathML":"math"},Ue={thead:"table",tbody:"table",tfoot:"table",tr:"tbody",td:"tr"},qe=Object.create(null),Be=1,He=2,Ke=3,Ve=4,We=5,Ze=["area","base","br","col","command","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr"].reduce(function(t,e){return t[e]=!0,t},Object.create(null)),$e=be||xe;rt.prototype={getDomNode:function(){return this._domNode},setCtx:function(t){if(t!==Ie){this._ctx=t;var e=this.children;if(null!==e&&"string"!=typeof e)for(var n=e.length,r=0;r<n;)e[r++].setCtx(t)}return this},renderToDom:function(t){var e=this.tag,n=this.children,r=this._ns||t;if($e&&n&&"string"!=typeof n){var i=tt(this.renderToString(),e,r);return this.adoptDom([i],0),i}var o=this._domNode=Y(e,r),u=this.attrs;if(null!==n)if("string"==typeof n)this._escapeChildren?o.textContent=n:o.innerHTML=n;else for(var s=0,l=n.length;s<l;)o.appendChild(n[s++].renderToDom(r));if(u!==Ie){var a=void 0,h=void 0;for(a in u)null!=(h=u[a])&&(a in Se?S(o,Se[a],h):ve(a).set(o,a,h))}return o},renderToString:function(){var t=this.tag;if("!"===t)return"<!---->";var e=this._ns,r=this.attrs,i=this.children,o="<"+t;if(null!==e&&(o+=' xmlns="'+e+'"'),r!==Ie){var u=void 0,s=void 0,l=void 0;for(u in r)if(s=r[u],null!=s){if("value"===u)switch(t){case"textarea":i=s;continue;case"select":this.setCtx({value:s,multiple:r.multiple});continue;case"option":var a=this._ctx;(a.multiple?n(a.value,s):a.value===s)&&(o+=" "+ve("selected").toString("selected",!0))}u in Se||""===(l=ve(u).toString(u,s))||(o+=" "+l)}}if(t in Ze)o+="/>";else{if(o+=">",null!==i)if("string"==typeof i)o+=this._escapeChildren?Q(i):i;else for(var h=0,c=i.length;h<c;)o+=i[h++].renderToString();o+="</"+t+">"}return o},adoptDom:function(t,e){var n=this._domNode=t[e],r=this.attrs,i=this.children;if(r!==Ie){var o=void 0,u=void 0;for(o in r)null!=(u=r[o])&&o in Se&&S(n,Se[o],u)}if(null!==i&&"string"!=typeof i){var s=0,l=i.length;if(l>0)for(var a=n.childNodes,h=0;s<l;)h=i[s++].adoptDom(a,h)}return e+1},mount:function(){var t=this.children;if(null!==t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].mount();null!==this.ref&&this.ref(this._domNode)},unmount:function(){var t=this.children;if(t&&"string"!=typeof t)for(var e=0,n=t.length;e<n;)t[e++].unmount();j(this._domNode),this._domNode=null,null!==this.ref&&this.ref(null)},clone:function(t,e,n){var r=new rt(this.tag,this.key);return r.attrs=null==t?this.attrs:X(this.attrs,t),r.children=null==e?this.children:it(e),r.ref=null==n?this.ref:n,r._escapeChildren=this._escapeChildren,r._ctx=this._ctx,r},patch:function(t){this===t?this._patchChildren(t):this.type===t.type&&this.tag===t.tag&&this._ns===t._ns?(t._domNode=this._domNode,this._patchAttrs(t),this._patchChildren(t),this._patchRef(t)):Me.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(null!==e||null!==n){var r="string"==typeof e,i="string"==typeof n;if(i)return r?void(e!==n&&Me.updateText(this,n,t._escapeChildren)):(null!==e&&e.length>0&&Me.removeChildren(this),void(""!==n&&Me.updateText(this,n,t._escapeChildren)));if(null===n||0===n.length)return void(e&&(r?Me.removeText(this):e.length>0&&Me.removeChildren(this)));if(r&&""!==e&&Me.removeText(this),r||null===e||0===e.length)for(var o=n.length,u=0;u<o;)Me.appendChild(t,n[u++]);else G(this,t)}},_patchAttrs:function(t){var e=this.attrs,n=t.attrs;if(e!==n){var r=void 0;if(n!==Ie){var i=void 0,o=void 0,u=void 0,s=void 0;for(r in n)o=n[r],e===Ie||null==(i=e[r])?null!=o&&Me.updateAttr(this,r,o):null==o?Me.removeAttr(this,r):"object"==typeof o&&"object"==typeof i?(s=Array.isArray(o),u=Array.isArray(i),s||u?s&&u?this._patchAttrArr(r,i,o):Me.updateAttr(this,r,o):this._patchAttrObj(r,i,o)):i!==o&&Me.updateAttr(this,r,o)}if(e!==Ie)for(r in e)n!==Ie&&r in n||null==e[r]||Me.removeAttr(this,r)}},_patchAttrArr:function(t,e,n){if(e!==n){var r=e.length,i=!1;if(r===n.length)for(var o=0;!i&&o<r;)e[o]!=n[o]&&(i=!0),++o;else i=!0;i&&Me.updateAttr(this,t,n)}},_patchAttrObj:function(t,e,n){if(e!==n){var r=Object.create(null),i=!1;for(var o in n)e[o]!=n[o]&&(i=!0,r[o]=n[o]);for(var u in e)null==e[u]||u in n||(i=!0,r[u]=null);i&&Me.updateAttr(this,t,r)}},_patchRef:function(t){null!==this.ref?this.ref!==t.ref&&(this.ref(null),null!==t.ref&&t.ref(t._domNode)):null!==t.ref&&t.ref(t._domNode)}};var ze="undefined"!=typeof window&&(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame)||function(t){setTimeout(t,1e3/60)},Ge=[],Je="undefined"==typeof console?null:console,Qe={},Xe={log:"",info:"",warn:"Warning!",error:"Error!"};["log","info","warn","error"].forEach(function(t){Qe[t]=Je?Je[t]?function(e,n,r,i,o){var u=Xe[t];switch(arguments.length){case 1:Je[t](u,e);break;case 2:Je[t](u,e,n);break;case 3:Je[t](u,e,n,r);break;case 4:Je[t](u,e,n,r,i);break;case 5:Je[t](u,e,n,r,i,o)}}:function(){Je.log.apply(Je,arguments)}:ot}),ht.prototype={on:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,fnCtx:n}),this},off:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this._listeners[t];if(r)for(var i=0,o=void 0;i<r.length;){if(o=r[i],o.fn===e&&o.fnCtx===n){r.splice(i,1);break}i++}return this},emit:function(t){var e=this._listeners[t];if(e){for(var n=0,r=arguments.length,i=Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(;n<e.length;){var u=e[n++],s=u.fn,l=u.fnCtx;s.call.apply(s,[l].concat(i))}}return this}};var Ye=Object.create(null),tn=0,en=new ht;en.getRootNodes=yt;var nn=1,rn=Ut({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new rt("input",null,X(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs,n=e.onChange,r=e.value,i=void 0===r?"":r,o=this.getDomNode();if(i!==o.value&&(n&&n(t),st(),this.isMounted())){var u=this.attrs.value;"undefined"!=typeof u&&o.value!==u&&(o.value=u)}},onRefRequest:function(){return this.getDomNode()}}),on=Object.create(null),un=Ut({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onInputChange(e)}}},onRender:function(){return new rt("input",null,X(this.attrs,this._addAttrs))},onMount:function(){var t=this.attrs.name;t&&qt(t,this)},onUpdate:function(t){var e=t.name,n=this.attrs.name;n!==e&&(e&&Bt(e,this),n&&qt(n,this))},onUnmount:function(){var t=this.attrs.name;t&&Bt(t,this)},onInputChange:function(t){var e=this.attrs.onChange;if(e&&e(t),st(),this.isMounted()){var n=this.getDomNode(),r=this.attrs,i=r.name,o=r.checked;if("undefined"!=typeof o&&n.checked!==o)if(i){for(var u=on[i],s=u.length,l=0,a=void 0,h=void 0;l<s;)if(a=u[l++],h=a.attrs.checked,"undefined"!=typeof h){var c=a.getDomNode();h!==c.checked&&(c.checked=h)}}else n.checked=o}},onRefRequest:function(){return this.getDomNode()}}),sn=Ut({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onInputChange(e)}}},onRender:function(){return new rt("input",null,X(this.attrs,this._addAttrs))},onInputChange:function(t){var e=this.attrs.onChange;if(e&&e(t),st(),this.isMounted()){var n=this.getDomNode(),r=this.attrs.checked;"undefined"!=typeof r&&n.checked!==r&&(n.checked=r)}},onRefRequest:function(){return this.getDomNode()}}),ln=Ut({onRender:function(){return new rt("input",null,this.attrs)},onRefRequest:function(){return this.getDomNode()}});Ht.prototype={getDomNode:function(){return null===this._instance?null:this._instance.getDomNode()},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getInstance().renderToDom(t)},renderToString:function(){return this._getInstance().renderToString()},adoptDom:function(t,e){return this._getInstance().adoptDom(t,e)},mount:function(){this._instance.mount(),null!==this.ref&&this.ref(this._instance.onRefRequest())},unmount:function(){null!==this._instance&&(this._instance.unmount(),this._instance=null),null!==this.ref&&this.ref(null)},clone:function(t,e,n){var r=new Ht(this.component,this.key);return r.attrs=null==t?this.attrs:X(this.attrs,t),r.children=null==e?this.children:e,r.ref=null==n?this.ref:n,r._ctx=this._ctx,r},patch:function(t){var e=this._getInstance();this===t?e.patch(t.attrs,t.children,t._ctx,!0):this.type===t.type&&this.component===t.component?(e.patch(t.attrs,t.children,t._ctx,!0),t._instance=e,this._patchRef(t)):(Me.replace(this,t),this._instance=null)},_patchRef:function(t){null!==this.ref?this.ref!==t.ref&&(this.ref(null),null!==t.ref&&t.ref(t._instance.onRefRequest())):null!==t.ref&&t.ref(t._instance.onRefRequest())},_getInstance:function(){return null===this._instance&&(this._instance=new this.component(this.attrs,this.children,this._ctx),this._instance.init()),this._instance}},Kt.prototype={getDomNode:function(){return null===this._rootElement?null:this._rootElement.getDomNode()},setCtx:function(t){return this._ctx=t,this},renderToDom:function(t){return this._getRootElement().renderToDom(t)},renderToString:function(){return this._getRootElement().renderToString()},adoptDom:function(t,e){return this._getRootElement().adoptDom(t,e)},mount:function(){this._getRootElement().mount()},unmount:function(){null!==this._rootElement&&(this._rootElement.unmount(),this._rootElement=null)},clone:function(t,e){var n=new Kt(this.component,this.key);return n.attrs=null==t?this.attrs:X(this.attrs,t),n.children=null==e?this.children:e,n._ctx=this._ctx,n},patch:function(t){if(this===t){var e=this._getRootElement();this._rootElement=null,e.patch(this._getRootElement())}else this.type===t.type&&this.component===t.component?(this._getRootElement().patch(t._getRootElement()),this._rootElement=null):(Me.replace(this,t),this._rootElement=null)},_getRootElement:function(){if(null!==this._rootElement)return this._rootElement;var t=this.attrs,e=this.component,n=e.defaultAttrs,r=null!=n,i=t===Ie?r?n:t:r?X(n,t):t;return this._rootElement=at(e(i,this.children,this._ctx)),this._rootElement.setCtx(this._ctx),this._rootElement}},Vt.prototype={getDomNode:function(){return this._domNode},setCtx:function(t){if(t!==Ie){this._ctx=t;var e=this.children;if(null!==e)for(var n=e.length,r=0;r<n;)e[r++].setCtx(t)}return this},renderToDom:function(t){var e=this.children,n=[Y("!",null),Y("!",null)],r=document.createDocumentFragment();if(r.appendChild(n[0]),null!==e)for(var i=e.length,o=0;o<i;)r.appendChild(e[o++].renderToDom(t));return r.appendChild(n[1]),this._domNode=n,r},renderToString:function(){var t=this.children,e="<!---->";if(null!==t)for(var n=t.length-1;n>=0;)e=t[n--].renderToString()+e;return"<!---->"+e},adoptDom:function(t,e){var n=[t[e++]],r=this.children;if(null!==r)for(var i=r.length,o=0;o<i;)e=r[o++].adoptDom(t,e);return n.push(t[e]),this._domNode=n,e+1},mount:function(){var t=this.children;if(null!==t)for(var e=0,n=t.length;e<n;)t[e++].mount()},unmount:function(){var t=this.children;if(null!==t)for(var e=t.length,n=0;n<e;)t[n++].unmount()},clone:function(t){var e=new Vt(this.key);return e.children=null==t?this.children:Wt(t),e._ctx=this._ctx,e},patch:function(t){this===t?this._patchChildren(t):this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Me.replace(this,t)},_patchChildren:function(t){var e=this.children,n=t.children;if(null!==e||null!==n){if(null===n||0===n.length)return void(null!==e&&e.length>0&&Me.removeChildren(this));if(null!==e&&0!==e.length)G(this,t);else for(var r=n.length,i=0;i<r;)Me.appendChild(t,n[i++])}}},Zt.prototype={getDomNode:function(){return this._domNode},setCtx:function(){return this},renderToDom:function(){var t=document.createDocumentFragment(),e=[Y("!",null),Y("!",null)],n=this.children;return t.appendChild(e[0]),null!==n&&t.appendChild(document.createTextNode(n)),t.appendChild(e[1]),this._domNode=e,t},renderToString:function(){return"<!---->"+(this.children?Q(this.children):"")+"<!---->"},adoptDom:function(t,e){var n=[t[e++]];return this.children&&e++,n.push(t[e++]),this._domNode=n,e},mount:ot,unmount:ot,clone:function(t){var e=new Zt(this.key);return e.children=null==t?this.children:$t(t),e},patch:function(t){this!==t&&(this.type===t.type?(t._domNode=this._domNode,this._patchChildren(t)):Me.replace(this,t))},_patchChildren:function(t){var e=this.children,n=t.children;e!==n&&(n?Me.updateText(this,n,!1):e&&Me.removeText(this))}};var an=Ut({onInit:function(){var t=this;this._addAttrs={onChange:null,onInput:function(e){t.onInput(e)}}},onRender:function(){return new rt("textarea",null,X(this.attrs,this._addAttrs))},onInput:function(t){var e=this.attrs,n=e.onChange,r=e.value,i=void 0===r?"":r,o=this.getDomNode();if(i!==o.value&&(n&&n(t),st(),this.isMounted())){var u=this.attrs.value;"undefined"!=typeof u&&o.value!==u&&(o.value=u)}},onRefRequest:function(){return this.getDomNode()}}),hn=Ut({onInit:function(){var t=this;this._addAttrs={onChange:function(e){t.onInputChange(e)}}},onRender:function(){return new rt("select",null,X(this.attrs,this._addAttrs),this.children)},onInputChange:function(t){var e=t.target,r=this.attrs,i=r.onChange,o=r.multiple;if(i)if(o){for(var u=[],s=e.options,l=s.length,a=0,h=void 0;a<l;)h=s[a++],h.selected&&u.push(h.value);i(t,u)}else i(t);if(st(),this.isMounted()){var c=this.attrs,d=c.value,f=c.multiple;if("undefined"!=typeof d)if(f)for(var p=e.options,v=p.length,m=0,g=void 0;m<v;)g=p[m++],g.selected=n(d,g.value);else e.value!=d&&(e.value=d)}},onRefRequest:function(){return this.getDomNode()}}),cn=Array.prototype.slice,dn=Ut();t.h=Gt,t.elem=zt,t.createComponent=Ut,
t.renderToString=Jt,t.toElem=at,t.toElems=Qt,t.IS_DEBUG=ee,t.console=Qe,t.Component=dn,t.mount=vt,t.mountSync=mt,t.unmount=gt,t.unmountSync=_t,t.getMountedRootNodes=yt,Object.defineProperty(t,"__esModule",{value:!0})});
