!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["pnp.graph"]=t():e["pnp.graph"]=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function i(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){var i,o=arguments.length,s=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(s=(o<3?i(s):o>3?i(t,n,s):i(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}},function(e,t,n){"use strict";function r(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(){t.apply(e,n)}}function i(e,t,n){var r=new Date(e);switch(t.toLowerCase()){case"year":r.setFullYear(r.getFullYear()+n);break;case"quarter":r.setMonth(r.getMonth()+3*n);break;case"month":r.setMonth(r.getMonth()+n);break;case"week":r.setDate(r.getDate()+7*n);break;case"day":r.setDate(r.getDate()+n);break;case"hour":r.setTime(r.getTime()+36e5*n);break;case"minute":r.setTime(r.getTime()+6e4*n);break;case"second":r.setTime(r.getTime()+1e3*n);break;default:r=void 0}return r}function o(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.filter(function(e){return!p(e)}).map(function(e){return e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")}).join("/").replace(/\\/g,"/")}function s(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function a(e){return"function"==typeof e}function u(e){return void 0!==e&&null!==e}function c(e,t,n,r){if(void 0===n&&(n=!1),void 0===r&&(r=function(){return!0}),!u(t))return e;var i=n?function(e,t){return!(t in e)}:function(){return!0};return Object.getOwnPropertyNames(t).filter(function(t){return i(e,t)&&r(t)}).reduce(function(e,n){return e[n]=t[n],e},e)}function h(e){return/^https?:\/\/|^\/\//i.test(e)}function p(e){return void 0===e||null===e||e.length<1}function l(e){return JSON.stringify(e)}function f(e,t){return Object.hasOwnProperty.call(e,t)}n.d(t,"d",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o}),n.d(t,"e",function(){return s}),n.d(t,"g",function(){return a}),n.d(t,"j",function(){return u}),n.d(t,"c",function(){return c}),n.d(t,"h",function(){return h}),n.d(t,"i",function(){return l}),n.d(t,"f",function(){return f})},function(e,t,n){"use strict";(function(e){n.d(t,"b",function(){return o}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return a});var r=n(0),i=n(1);function o(e,t){void 0!==t&&null!==t&&new Request("",{headers:t}).headers.forEach(function(t,n){e.append(n,t)})}function s(e,t){if(Object(i.j)(t)){var n=Object(i.c)(e.headers||{},t.headers);(e=Object(i.c)(e,t)).headers=n}}var a=function(e){function t(t){var n=e.call(this)||this;return n._token=t,n}return r.b(t,e),Object.defineProperty(t.prototype,"token",{get:function(){return this._token||""},set:function(e){this._token=e},enumerable:!0,configurable:!0}),t.prototype.fetch=function(t,n){void 0===n&&(n={});var r=new Headers;return o(r,n.headers),r.set("Authorization","Bearer "+this._token),n.headers=r,e.prototype.fetch.call(this,t,n)},t}(function(){function t(){}return t.prototype.fetch=function(t,n){return e.fetch(t,n)},t}())}).call(this,n(4))},function(e,t){
/*! adal-angular v1.0.17 2018-02-27 */
var n=function(){"use strict";return n=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},n.prototype._singletonInstance)return n.prototype._singletonInstance;if(n.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),n.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var n=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(n):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(n)):this.promptUser(n)}},n.prototype._openPopup=function(e,t,n,r){try{var i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,u=s/2-n/2+i,c=a/2-r/2+o,h=window.open(e,t,"width="+n+", height="+r+", top="+c+", left="+u);return h.focus&&h.focus(),h}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},n.prototype._handlePopupError=function(e,t,n,r,i){this.warn(r),this._saveItem(this.CONSTANTS.STORAGE.ERROR,n),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,r),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,i),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(r,null,n)},n.prototype._loginPopup=function(e,t,n){var r=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),i=n||this.callback;if(null!=r){if(this._openedWindows.push(r),-1!=this.config.redirectUri.indexOf("#"))var o=this.config.redirectUri.split("#")[0];else o=this.config.redirectUri;var s=this,a=window.setInterval(function(){if(!r||r.closed||void 0===r.closed){var e="Popup Window closed",n="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return s.isAngular&&s._broadcast("adal:popUpClosed",n+s.CONSTANTS.RESOURCE_DELIMETER+e),s._handlePopupError(i,t,e,n,n),void window.clearInterval(a)}try{var u=r.location;if(-1!=encodeURI(u.href).indexOf(encodeURI(o)))return s.isAngular?s._broadcast("adal:popUpHashChanged",u.hash):s.handleWindowCallback(u.hash),window.clearInterval(a),s._loginInProgress=!1,s._acquireTokenInProgress=!1,s.info("Closing popup window"),s._openedWindows=[],void r.close()}catch(e){}},1)}else{var u="Popup Window is null. This can happen if you are using IE";this._handlePopupError(i,t,"Error opening popup",u,u)}},n.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var n=new CustomEvent(e,{detail:t});window.dispatchEvent(n)},n.prototype.loginInProgress=function(){return this._loginInProgress},n.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},n.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),n=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),r=this.config.expireOffsetSeconds||300;return n&&n>this._now()+r?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},n.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},n.prototype.registerCallback=function(e,t,n){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var r=this;this._callBacksMappedToRenewStates[e].push(n),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(n,i,o,s){r._activeRenewals[t]=null;for(var a=0;a<r._callBacksMappedToRenewStates[e].length;++a)try{r._callBacksMappedToRenewStates[e][a](n,i,o,s)}catch(o){r.warn(o)}r._callBacksMappedToRenewStates[e]=null,r._callBackMappedToRenewStates[e]=null})},n.prototype._renewToken=function(e,t,n){this.info("renewToken is called for resource:"+e);var r=this._addAdalFrame("adalRenewFrame"+e),i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this.verbose("Renew token Expected state: "+i),n=n||"token";var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl(n,e),"prompt");n===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),o+="&nonce="+encodeURIComponent(this._idTokenNonce)),o+="&prompt=none",o=this._addHintParameters(o),this.registerCallback(i,e,t),this.verbosePii("Navigate to:"+o),r.src="about:blank",this._loadFrameTimeout(o,"adalRenewFrame"+e,e)},n.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var n=this._addAdalFrame("adalIdTokenFrame"),r=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=r,this._renewStates.push(r),this.verbose("Renew Idtoken Expected state: "+r);var i=null===t||void 0===t?null:this.config.clientId,o=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,i),"prompt"));o+="&prompt=none",o=this._addHintParameters(o),o+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(r,this.config.clientId,e),this.verbosePii("Navigate to:"+o),n.src="about:blank",this._loadFrameTimeout(o,"adalIdTokenFrame",this.config.clientId)},n.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},n.prototype._urlRemoveQueryStringParameter=function(e,t){var n=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+&"),e=e.replace(n,""),n=new RegExp("("+t+"=)[^&]+"),e.replace(n,"")},n.prototype._loadFrameTimeout=function(e,t,n){this.verbose("Set loading state to pending for: "+n),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+n,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var r=this;setTimeout(function(){if(r._getItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n)===r.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){r.verbose("Loading frame has timed out after: "+r.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+n);var e=r._activeRenewals[n];e&&r._callBackMappedToRenewStates[e]&&r._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),r._saveItem(r.CONSTANTS.STORAGE.RENEW_STATUS+n,r.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},r.CONSTANTS.LOADFRAME_TIMEOUT)},n.prototype._loadFrame=function(e,t){var n=this;n.info("LoadFrame: "+t);var r=t;setTimeout(function(){var t=n._addAdalFrame(r);""!==t.src&&"about:blank"!==t.src||(t.src=e,n._loadFrame(e,r))},500)},n.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var n=this.getCachedToken(e);return n?(this.info("Token is already in cache for resource:"+e),void t(null,n,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},n.prototype.acquireTokenPopup=function(e,t,n,r){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this._renewStates.push(i),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(i,e,r),this._loginPopup(o,e,r)},n.prototype.acquireTokenRedirect=function(e,t,n){if(this._isEmpty(e))return this.warn("resource is required"),void r("resource is required",null,"resource is required");var r=this.callback;if(!this._user)return this.warn("User login is required"),void r("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void r("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var i=this._guid()+"|"+e;this.config.state=i,this.verbose("Renew token Expected state: "+i);var o=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(o+="&prompt=select_account",t&&(o+=t),n&&-1===o.indexOf("&claims"))o+="&claims="+encodeURIComponent(n);else if(n&&-1!==o.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");o=this._addHintParameters(o),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,i,!0),this.promptUser(o)},n.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},n.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},n.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},n.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",n="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(n="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+n}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},n.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},n.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},n.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},n.prototype._createUser=function(e){var t=null,n=this._extractIdToken(e);return n&&n.hasOwnProperty("aud")&&(n.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:n},n.hasOwnProperty("upn")?t.userName=n.upn:n.hasOwnProperty("email")&&(t.userName=n.email)):this.warn("IdToken has invalid aud field")),t},n.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},n.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},n.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},n.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),n={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(n.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){n.valid=!0;var r;if(!t.hasOwnProperty("state"))return this.warn("No state returned"),n;if(this.verbose("State: "+t.state),r=t.state,n.stateResponse=r,this._matchState(n))return n;if(!n.stateMatch&&window.parent){n.requestType=this._requestType;for(var i=this._renewStates,o=0;o<i.length;o++)if(i[o]===n.stateResponse){n.stateMatch=!0;break}}}return n},n.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.profile.nonce)return!0}return!1},n.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var n=0;n<t.length;n++)if(t[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var r=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(r){r=r.split(this.CONSTANTS.CACHE_DELIMETER);for(n=0;n<r.length;n++)if(r[n]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},n.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},n.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var n;this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(n=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,n+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},n.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var n in this.config.endpoints)if(e.indexOf(n)>-1)return this.config.endpoints[n];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},n.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},n.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,n=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,n=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var r,i,o=t.getRequestInfo(e),s=null;i=n||window.parent!==window?t._callBackMappedToRenewStates[o.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(o),o.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),r=o.parameters[t.CONSTANTS.ACCESS_TOKEN]||o.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ACCESS_TOKEN):o.requestType===this.REQUEST_TYPE.LOGIN&&(r=o.parameters[t.CONSTANTS.ID_TOKEN],s=t.CONSTANTS.ID_TOKEN);var a=o.parameters[t.CONSTANTS.ERROR_DESCRIPTION],u=o.parameters[t.CONSTANTS.ERROR];try{i&&i(a,r,u,s)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||n||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},n.prototype._getNavigateUrl=function(e,t){var n="common";this.config.tenant&&(n=this.config.tenant);var r=this.instance+n+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+r),r},n.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var n=t.JWSPayload,r=this._base64DecodeStringUrlSafe(n);return r?JSON.parse(r):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},n.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},n.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=(e=String(e).replace(/=+$/,"")).length;if(n%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var r,i,o,s,a,u,c,h,p="",l=0;l<n;l+=4){if(r=t.indexOf(e.charAt(l)),i=t.indexOf(e.charAt(l+1)),o=t.indexOf(e.charAt(l+2)),s=t.indexOf(e.charAt(l+3)),l+2===n-1){u=(a=r<<18|i<<12|o<<6)>>16&255,c=a>>8&255,p+=String.fromCharCode(u,c);break}if(l+1===n-1){u=(a=r<<18|i<<12)>>16&255,p+=String.fromCharCode(u);break}u=(a=r<<18|i<<12|o<<6|s)>>16&255,c=a>>8&255,h=255&a,p+=String.fromCharCode(u,c,h)}return p},n.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},n.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},n.prototype._serialize=function(e,t,n){var r=[];if(null!==t){r.push("?response_type="+e),r.push("client_id="+encodeURIComponent(t.clientId)),n&&r.push("resource="+encodeURIComponent(n)),r.push("redirect_uri="+encodeURIComponent(t.redirectUri)),r.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&r.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&r.push(t.extraQueryParameter);var i=t.correlationId?t.correlationId:this._guid();r.push("client-request-id="+encodeURIComponent(i))}return r.join("&")},n.prototype._deserialize=function(e){var t,n=/\+/g,r=/([^&=]+)=([^&]*)/g,i=function(e){return decodeURIComponent(e.replace(n," "))},o={};for(t=r.exec(e);t;)o[i(t[1])]=i(t[2]),t=r.exec(e);return o},n.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},n.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",i=0,o="",s=0;s<36;s++)"-"!==n[s]&&"4"!==n[s]&&(i=16*Math.random()|0),"x"===n[s]?o+=r[i]:"y"===n[s]?(i&=3,o+=r[i|=8]):o+=n[s];return o},n.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},n.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},n.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var n=document.createElement("iframe");n.setAttribute("id",e),n.setAttribute("aria-hidden","true"),n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height=n.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(n)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},n.prototype._saveItem=function(e,t,n){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(n){var r=this._getItem(e)||"";localStorage.setItem(e,r+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},n.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},n.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},n.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},n.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},n.prototype.log=function(e,t,n,r){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&r)return;var i=(new Date).toUTCString(),o="";o=this.config.correlationId?i+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:i+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,n&&(o+="\nstack:\n"+n.stack),Logging.log(o)}},n.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},n.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},n.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},n.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},n.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},n.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},n.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},n.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},n.prototype._libVersion=function(){return"1.0.17"},void 0!==e&&e.exports&&(e.exports=n,e.exports.inject=function(e){return new n(e)}),n}()},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2),o=n(1),s=n(3),a=function(e){function t(t,n,r){var i=e.call(this,null)||this;return i.clientId=t,i.tenant=n,i.redirectUri=r,i._displayCallback=null,i._loginPromise=null,i}return r.b(t,e),t.fromSPFxContext=function(e,n){return void 0===n&&(n="c58637bb-e2e1-4312-8a00-04b5ffcd3403"),new t(n,e.pageContext.aadInfo.tenantId.toString(),Object(o.a)(window.location.origin,"/_forms/spfxsinglesignon.aspx"))},t.prototype.fetch=function(t,n){var r=this;if(!Object(o.h)(t))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(this.getResource(t)).then(function(i){return r.token=i,e.prototype.fetch.call(r,t,n)})},t.prototype.getToken=function(e){var n=this;return new Promise(function(r,i){n.ensureAuthContext().then(function(e){return n.login()}).then(function(n){t._authContext.acquireToken(e,function(e,t){if(e)return i(Error(e));r(t)})}).catch(i)})},t.prototype.ensureAuthContext=function(){var e=this;return new Promise(function(n){null===t._authContext&&(t._authContext=s.inject({clientId:e.clientId,displayCall:function(t){e._displayCallback&&e._displayCallback(t)},navigateToLoginRequestUrl:!1,redirectUri:e.redirectUri,tenant:e.tenant})),n()})},t.prototype.login=function(){var e=this;return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise(function(n,r){if(t._authContext.getCachedUser())return n();e._displayCallback=function(i){var o=window.open(i,"login","width=483, height=600");if(!o)return r(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));o&&o.focus&&o.focus();var s=window.setInterval(function(){o&&!o.closed&&void 0!==o.closed||window.clearInterval(s);try{-1!==o.document.URL.indexOf(e.redirectUri)&&(window.clearInterval(s),t._authContext.handleWindowCallback(o.location.hash),o.close(),n())}catch(e){r(e)}},30)},e.ensureAuthContext().then(function(n){t._authContext._loginInProgress=!1,t._authContext.login(),e._displayCallback=null})}),this._loginPromise)},t.prototype.getResource=function(e){var t=document.createElement("a");return t.href=e,t.protocol+"//"+t.hostname},t._authContext=null,t}(i.a),u=Object(o.g)(Object.entries)?Object.entries:function(e){return Object.keys(e).map(function(t){return[t,e[t]]})};var c,h=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"],p=new(function(){function e(e){void 0===e&&(e=new Map),this._v=e,this._v.set(h[0],"session"),this._v.set(h[1],60),this._v.set(h[2],!1),this._v.set(h[3],!1),this._v.set(h[4],750),this._v.set(h[5],null)}return e.prototype.extend=function(e){this._v=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)t[r].forEach(function(t,n){e.set(n,t)});return e}(this._v,function(e){return void 0!==e&&null!==e?new Map(u(e)):new Map}(e))},e.prototype.get=function(e){return this._v.get(e)},Object.defineProperty(e.prototype,"defaultCachingStore",{get:function(){return this.get(h[0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defaultCachingTimeoutSeconds",{get:function(){return this.get(h[1])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"globalCacheDisable",{get:function(){return this.get(h[2])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"enableCacheExpiration",{get:function(){return this.get(h[3])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"cacheExpirationIntervalMilliseconds",{get:function(){return this.get(h[4])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"spfxContext",{get:function(){return this.get(h[5])},enumerable:!0,configurable:!0}),e}()),l=function(){function e(e,t){void 0===t&&(t=-1),this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),p.enableCacheExpiration&&this.cacheExpirationHandler()}return e.prototype.get=function(e){if(!this.enabled)return null;var t=this.store.getItem(e);if(!Object(o.j)(t))return null;var n=JSON.parse(t);return new Date(n.expiration)<=new Date?(this.delete(e),null):n.value},e.prototype.put=function(e,t,n){this.enabled&&this.store.setItem(e,this.createPersistable(t,n))},e.prototype.delete=function(e){this.enabled&&this.store.removeItem(e)},e.prototype.getOrPut=function(e,t,n){var r=this;return this.enabled?new Promise(function(i){var o=r.get(e);null==o?t().then(function(t){r.put(e,t,n),i(t)}):i(o)}):t()},e.prototype.deleteExpired=function(){var e=this;return new Promise(function(t,n){e.enabled||t();try{for(var r=0;r<e.store.length;r++){var i=e.store.key(r);null!==i&&/["|']?pnp["|']? ?: ?1/i.test(e.store.getItem(i))&&e.get(i)}t()}catch(e){n(e)}})},e.prototype.test=function(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}},e.prototype.createPersistable=function(e,t){if(void 0===t){var n=p.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(n=60*this.defaultTimeoutMinutes),t=Object(o.b)(new Date,"second",n)}return Object(o.i)({pnp:1,expiration:t,value:e})},e.prototype.cacheExpirationHandler=function(){var e=this;this.deleteExpired().then(function(t){setTimeout(Object(o.d)(e,e.cacheExpirationHandler),p.cacheExpirationIntervalMilliseconds)}).catch(function(e){console.error(e)})},e}(),f=function(){function e(e){void 0===e&&(e=new Map),this._store=e}return Object.defineProperty(e.prototype,"length",{get:function(){return this._store.size},enumerable:!0,configurable:!0}),e.prototype.clear=function(){this._store.clear()},e.prototype.getItem=function(e){return this._store.get(e)},e.prototype.key=function(e){return Array.from(this._store)[e][0]},e.prototype.removeItem=function(e){this._store.delete(e)},e.prototype.setItem=function(e,t){this._store.set(e,t)},e}(),d=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._local=e,this._session=t}return Object.defineProperty(e.prototype,"local",{get:function(){return null===this._local&&(this._local=this.getStore("local")),this._local},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"session",{get:function(){return null===this._session&&(this._session=this.getStore("session")),this._session},enumerable:!0,configurable:!0}),e.prototype.getStore=function(e){return new l("local"===e?"undefined"==typeof localStorage?new f:localStorage:"undefined"==typeof sessionStorage?new f:sessionStorage)},e}(),g=function(){function e(e){this.key=e,this.expiration=Object(o.b)(new Date,"second",p.defaultCachingTimeoutSeconds),this.storeName=p.defaultCachingStore}return Object.defineProperty(e.prototype,"store",{get:function(){return"local"===this.storeName?e.storage.local:e.storage.session},enumerable:!0,configurable:!0}),e.storage=new d,e}(),T=function(){function e(e,t){this.parser=e,this.cacheOptions=t}return e.prototype.parse=function(e){var t=this;return this.parser.parse(e).then(function(e){return t.cacheData(e)})},e.prototype.cacheData=function(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e},e}(),_=function(e){function t(t,n,r,i){void 0===r&&(r=n.status),void 0===i&&(i=n.statusText);var o=e.call(this,t)||this;return o.response=n,o.status=r,o.statusText=i,o.isHttpRequestError=!0,o}return r.b(t,e),t}(Error),y=function(){function e(){}return e.prototype.parse=function(e){var t=this;return new Promise(function(n,r){t.handleError(e,r)&&t.parseImpl(e,n,r)})},e.prototype.parseImpl=function(e,t,n){var r=this;e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(function(e){return e.replace(/\s/gi,"").length>0?JSON.parse(e):{}}).then(function(e){return t(r.parseODataJSON(e))}).catch(function(e){return n(e)})},e.prototype.handleError=function(e,t){return e.ok||t(new _("Error making HttpClient request in queryable: ["+e.status+"] "+e.statusText,e.clone())),e.ok},e.prototype.parseODataJSON=function(e){var t=e;return Object(o.f)(e,"d")?t=Object(o.f)(e.d,"results")?e.d.results:e.d:Object(o.f)(e,"value")&&(t=e.value),t},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(y),S=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}r.b(t,e),t.prototype.parseImpl=function(e,t){e.text().then(t)}}(y),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.parseImpl=function(e,t){e.blob().then(t)},t}(y)),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.parseImpl=function(e,t){e.json().then(t)},t}(y),E=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.parseImpl=function(e,t){Object(o.g)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)},t}(y),m=(function(e){function t(t){var n=e.call(this)||this;return n.parser=t,n}r.b(t,e),t.prototype.parseImpl=function(e,t){this.parser(e).then(t)}}(y),function(){function e(){}return Object.defineProperty(e,"activeLogLevel",{get:function(){return e.instance.activeLogLevel},set:function(t){e.instance.activeLogLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(e,"instance",{get:function(){return void 0!==e._instance&&null!==e._instance||(e._instance=new v),e._instance},enumerable:!0,configurable:!0}),e.subscribe=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];t.map(function(t){return e.instance.subscribe(t)})},e.clearSubscribers=function(){return e.instance.clearSubscribers()},Object.defineProperty(e,"count",{get:function(){return e.instance.count},enumerable:!0,configurable:!0}),e.write=function(t,n){void 0===n&&(n=1),e.instance.log({level:n,message:t})},e.writeJSON=function(e,t){void 0===t&&(t=1),this.write(JSON.stringify(e),t)},e.log=function(t){e.instance.log(t)},e.error=function(t){e.instance.log({data:t,level:3,message:t.message})},e}()),v=function(){function e(e,t){void 0===e&&(e=2),void 0===t&&(t=[]),this.activeLogLevel=e,this.subscribers=t}return e.prototype.subscribe=function(e){this.subscribers.push(e)},e.prototype.clearSubscribers=function(){var e=this.subscribers.slice(0);return this.subscribers.length=0,e},Object.defineProperty(e.prototype,"count",{get:function(){return this.subscribers.length},enumerable:!0,configurable:!0}),e.prototype.write=function(e,t){void 0===t&&(t=1),this.log({level:t,message:e})},e.prototype.log=function(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(function(t){return t.log(e)})},e}();!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(c||(c={}));(function(){function e(){}e.prototype.log=function(e){var t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}},e.prototype.format=function(e){var t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")}})(),function(){function e(e){this.method=e}e.prototype.log=function(e){this.method(e)}}();function N(e,t){return new Promise(function(n){e.result=t,e.hasResult=!0,n(e)})}function R(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function w(e){e.pipeline.length<1&&m.write("["+e.requestId+"] ("+(new Date).getTime()+") Request pipeline contains no methods!",2);var t=R(e).then(function(e){return function(e){return m.log({data:0===m.activeLogLevel?e.result:{},level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Returning result from pipeline. Set logging to verbose to see data."}),Promise.resolve(e.result)}(e)}).catch(function(e){throw m.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function I(e){return void 0===e&&(e=!1),function(t,n,r){var i=r.value;r.value=function(){for(var r=[],s=0;s<arguments.length;s++)r[s]=arguments[s];return!e&&r.length>0&&Object(o.f)(r[0],"hasResult")&&r[0].hasResult?(m.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Skipping request pipeline method "+n+", existing result in pipeline.",0),Promise.resolve(r[0])):(m.write("["+r[0].requestId+"] ("+(new Date).getTime()+") Calling request pipeline method "+n+".",0),i.apply(t,r).then(function(e){return R(e)}))}}}var C=function(){function e(){}return e.logStart=function(e){return new Promise(function(t){m.log({data:1===m.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Beginning "+e.verb+" request ("+e.requestAbsoluteUrl+")"}),t(e)})},e.caching=function(e){return new Promise(function(t){if(e.isCached){m.write("["+e.requestId+"] ("+(new Date).getTime()+") Caching is enabled for request, checking cache...",1);var n=new g(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(n=Object(o.c)(n,e.cachingOptions)),null!==n.store){var r=n.store.get(n.key);if(null!==r)return m.log({data:1===m.activeLogLevel?{}:r,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Value returned from cache."}),Object(o.g)(e.batchDependency)&&e.batchDependency(),Object(o.f)(e.parser,"hydrate")&&(r=e.parser.hydrate(r)),N(e,r).then(function(e){return t(e)})}m.write("["+e.requestId+"] ("+(new Date).getTime()+") Value not found in cache.",1),e.parser=new T(e.parser,n)}return t(e)})},e.send=function(e){return new Promise(function(t,n){if(e.isBatched){var r=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);Object(o.g)(e.batchDependency)&&e.batchDependency(),m.write("["+e.requestId+"] ("+(new Date).getTime()+") Batching request in batch "+e.batch.batchId+".",1),t(N(e,r))}else{m.write("["+e.requestId+"] ("+(new Date).getTime()+") Sending request.",1);var i=e.clientFactory(),s=Object(o.c)(e.options||{},{method:e.verb});i.fetch(e.requestAbsoluteUrl,s).then(function(t){return e.parser.parse(t)}).then(function(t){return N(e,t)}).then(function(e){return t(e)}).catch(function(e){return n(e)})}})},e.logEnd=function(e){return new Promise(function(t){e.isBatched?m.log({data:1===m.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") "+e.verb+" request will complete in batch "+e.batch.batchId+"."}):m.log({data:1===m.activeLogLevel?{}:e,level:1,message:"["+e.requestId+"] ("+(new Date).getTime()+") Completing "+e.verb+" request."}),t(e)})},r.a([I(!0)],e,"logStart",null),r.a([I()],e,"caching",null),r.a([I()],e,"send",null),r.a([I(!0)],e,"logEnd",null),e}();function A(){return[C.logStart,C.caching,C.send,C.logEnd].slice(0)}var P=function(e){function t(){var t=e.call(this)||this;return t._batch=null,t}return r.b(t,e),t.prototype.inBatch=function(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return this._batch=e,this},t.prototype.toUrl=function(){return this._url},t.prototype.get=function(e,t){return void 0===e&&(e=new O),void 0===t&&(t={}),this.getCore(e,t)},t.prototype.getCore=function(e,t){return void 0===e&&(e=new O),void 0===t&&(t={}),this.toRequestContext("GET",t,e,A()).then(function(e){return w(e)})},t.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.toRequestContext("POST",e,t,A()).then(function(e){return w(e)})},t.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.toRequestContext("PATCH",e,t,A()).then(function(e){return w(e)})},t.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.toRequestContext("DELETE",e,t,A()).then(function(e){return w(e)})},t.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new O),this.toRequestContext("PUT",e,t,A()).then(function(e){return w(e)})},t.prototype.addBatchDependency=function(){return null!==this._batch?this._batch.addDependency():function(){return null}},Object.defineProperty(t.prototype,"hasBatch",{get:function(){return Object(o.j)(this._batch)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"batch",{get:function(){return this.hasBatch?this._batch:null},enumerable:!0,configurable:!0}),t}(function(){function e(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null}return e.prototype.toUrl=function(){return this._url},e.prototype.concat=function(e){return this._url+=e,this},Object.defineProperty(e.prototype,"query",{get:function(){return this._query},enumerable:!0,configurable:!0}),e.prototype.configure=function(e){return Object(i.c)(this._options,e),this},e.prototype.configureFrom=function(e){return Object(i.c)(this._options,e._options),this},e.prototype.usingCaching=function(e){return p.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this},e.prototype.getCore=function(e,t){return void 0===e&&(e=new b),void 0===t&&(t={}),this.toRequestContext("GET",t,e,A()).then(function(e){return w(e)})},e.prototype.postCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new b),this.toRequestContext("POST",e,t,A()).then(function(e){return w(e)})},e.prototype.patchCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new b),this.toRequestContext("PATCH",e,t,A()).then(function(e){return w(e)})},e.prototype.deleteCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new b),this.toRequestContext("DELETE",e,t,A()).then(function(e){return w(e)})},e.prototype.putCore=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=new b),this.toRequestContext("PUT",e,t,A()).then(function(e){return w(e)})},e.prototype.append=function(e){this._url=Object(o.a)(this._url,e)},Object.defineProperty(e.prototype,"parentUrl",{get:function(){return this._parentUrl},enumerable:!0,configurable:!0}),e.prototype.extend=function(e,t){this._parentUrl=e._url,this._url=Object(o.a)(this._parentUrl,t||""),this.configureFrom(e)},e}()),x=function(){function e(e){void 0===e&&(e=Object(o.e)()),this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}return Object.defineProperty(e.prototype,"batchId",{get:function(){return this._batchId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requests",{get:function(){return this._reqs},enumerable:!0,configurable:!0}),e.prototype.add=function(e,t,n,r,i){var o={id:i,method:t.toUpperCase(),options:n,parser:r,reject:null,resolve:null,url:e},s=new Promise(function(e,t){o.resolve=e,o.reject=t});return this._reqs.push(o),s},e.prototype.addDependency=function(){var e=function(){};return this._deps.push(new Promise(function(t){e=t})),e},e.prototype.addResolveBatchDependency=function(e){this._rDeps.push(e)},e.prototype.execute=function(){var e=this;return Promise.all(this._deps).then(function(){return Promise.all(e._deps)}).then(function(){return e.executeImpl()}).then(function(){return Promise.all(e._rDeps)}).then(function(){})},e}();var k,j=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=p.get("graph");return void 0!==e&&null!==e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=p.get("graph");if(void 0!==e&&null!==e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==p.spfxContext)return function(){return a.fromSPFxContext(p.spfxContext)};throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")},enumerable:!0,configurable:!0}),e}()),U=function(){function e(){this._impl=j.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;Object(i.b)(n,j.headers),Object(i.b)(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json");var r=Object(o.c)(t,{headers:n});return this.fetchRaw(e,r)},e.prototype.fetchRaw=function(e,t){var n=this;void 0===t&&(t={});var r=new Headers;Object(i.b)(r,t.headers),t=Object(o.c)(t,{headers:r});var s=function(r){n._impl.fetch(e,t).then(function(e){return r.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&r.reject(e);var t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(Object(o.d)(n,s,r),t)})};return new Promise(function(e,t){var r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};s.call(n,r)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=Object(o.c)(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=Object(o.c)(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=Object(o.c)(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=Object(o.c)(t,{method:"DELETE"});return this.fetch(e,n)},e}(),G=function(){function e(){}return e.ensure=function(t,n){var r=[e.Beta,e.V1],i=new RegExp(n,"i"),o=r.filter(function(e){return!i.test(e)}).map(function(e){return e.replace(".","\\.")});return i=new RegExp("/?("+o.join("|")+")/","ig"),t.replace(i,"/"+n+"/")},e.Beta="beta",e.V1="v1.0",e}(),L=function(e){function t(t,n){var r=e.call(this)||this;if("string"==typeof t){var i=t;r._parentUrl=i,r._url=Object(o.a)(i,n)}else r.extend(t,n);return r}return r.b(t,e),t.prototype.as=function(e){var t=new e(this._url,null);return Object(o.c)(t,this,!0)},t.prototype.toUrlAndQuery=function(){var e=this.toUrl();(Object(o.h)(e)||(e=Object(o.a)("https://graph.microsoft.com",e)),this.query.size>0)&&(e+=""+(e.indexOf("?")>-1?"&":"?")+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&"));return e},t.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},t.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=new e(this,t);return r.configure(this._options),n&&(r=r.inBatch(this._batch)),r},t.prototype.setEndpoint=function(e){return this._url=G.ensure(this._url,e),this},t.prototype.toRequestContext=function(e,t,n,r){return void 0===t&&(t={}),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new U},isBatched:this.hasBatch,isCached:/^get$/i.test(e)&&this._useCaching,options:t,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:Object(o.e)(),verb:e})},t}(P),q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skip=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),t}(L),D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.search=function(e){return this.query.set("$search",e),this},t}(q),K=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.length>0&&this.query.set("$expand",e.join(",")),this},t}(L),M=function(e){function t(t,n){return void 0===n&&(n="members"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:Object(o.i)({"@odata.id":e})})},t.prototype.getById=function(e){return new B(this,e)},t}(q),B=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(K),F=function(e){function t(t,n){return void 0===n&&(n="owners"),e.call(this,t,n)||this}return r.b(t,e),t}(M),W=(function(e){function t(t,n){return void 0===n&&(n="calendars"),e.call(this,t,n)||this}r.b(t,e)}(q),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new H(this)},enumerable:!0,configurable:!0}),t}(K)),H=function(e){function t(t,n){return void 0===n&&(n="events"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new Q(this,e)},t.prototype.add=function(e){var t=this;return this.postCore({body:Object(o.i)(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},t}(q),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.update=function(e){return this.patchCore({body:Object(o.i)(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(K),Y=function(e){function t(t,n){return void 0===n&&(n="attachments"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new V(this,e)},t.prototype.addFile=function(e,t){return this.postCore({body:Object(o.i)({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},t}(q),V=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(K),$=function(e){function t(t,n){return void 0===n&&(n="conversations"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.postCore({body:Object(o.i)(e)})},t.prototype.getById=function(e){return new X(this,e)},t}(q),J=function(e){function t(t,n){return void 0===n&&(n="threads"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new Z(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(o.i)(e)})},t}(q),z=function(e){function t(t,n){return void 0===n&&(n="posts"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new ee(this,e)},t.prototype.add=function(e){return this.postCore({body:Object(o.i)(e)})},t}(q),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new J(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:Object(o.i)(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(K),Z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new z(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:Object(o.i)({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(K),ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new Y(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:Object(o.i)(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:Object(o.i)({post:e})})},t}(K),te=function(e){function t(t,n){return e.call(this,t,n)||this}return r.b(t,e),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:Object(o.i)({"@odata.id":e})})},t.prototype.remove=function(e){var n=this.clone(t,"$ref");return n.query.set("$id",e),n.deleteCore()},t}(q),ne=function(e){function t(t,n){return void 0===n&&(n="planner/plans"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new re(this,e)},t}(q),re=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t}(K),ie=function(e){function t(t,n){return void 0===n&&(n="photo"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new S)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new E)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(K),oe=function(){function e(){}return e.prototype.create=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n={});var r=t&&t.length>0?{description:t}:{};return ve.groups.add(e,e,k.Office365,r).then(function(e){return e.group.createTeam(n).then(function(t){return{data:t,group:e.group,team:new se(e.group)}})})},e}(),se=function(e){function t(t,n){return void 0===n&&(n="team"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.update=function(e){var n=this;return this.clone(t,"").setEndpoint(G.Beta).patchCore({body:Object(o.i)(e)}).then(function(e){return{data:e,team:n}})},t.prototype.get=function(e,n){return void 0===e&&(e=new O),void 0===n&&(n={}),this.clone(t,"").setEndpoint(G.Beta).getCore(e,n)},t}(K);!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(k||(k={}));var ae=function(e){function t(t,n){return void 0===n&&(n="groups"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new ue(this,e)},t.prototype.add=function(e,t,n,r){var i=this;void 0===r&&(r={});var s=Object(o.c)({displayName:e,mailEnabled:n===k.Office365,mailNickname:t,securityEnabled:n!==k.Office365},r);return n!==k.Security&&(s=Object(o.c)(s,{groupTypes:n===k.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:Object(o.i)(s)}).then(function(e){return{data:e,group:i.getById(e.id)}})},t}(q),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"calendar",{get:function(){return new W(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"events",{get:function(){return new H(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owners",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plans",{get:function(){return new ne(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"members",{get:function(){return new M(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"conversations",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"acceptedSenders",{get:function(){return new te(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rejectedSenders",{get:function(){return new te(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"photo",{get:function(){return new ie(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"team",{get:function(){return new se(this)},enumerable:!0,configurable:!0}),t.prototype.addFavorite=function(){return this.clone(t,"addFavorite").postCore()},t.prototype.createTeam=function(e){return this.clone(t,"team").setEndpoint(G.Beta).putCore({body:Object(o.i)(e)})},t.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(t,"getMemberGroups").postCore({body:Object(o.i)({securityEnabledOnly:e})})},t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(o.i)(e)})},t.prototype.removeFavorite=function(){return this.clone(t,"removeFavorite").postCore()},t.prototype.resetUnseenCount=function(){return this.clone(t,"resetUnseenCount").postCore()},t.prototype.subscribeByMail=function(){return this.clone(t,"subscribeByMail").postCore()},t.prototype.unsubscribeByMail=function(){return this.clone(t,"unsubscribeByMail").postCore()},t.prototype.getCalendarView=function(e,n){var r=this.clone(t,"calendarView");return r.query.set("startDateTime",e.toISOString()),r.query.set("endDateTime",n.toISOString()),r.get()},t}(K),ce=function(e){function t(t,n){return void 0===n&&(n="onenote"),e.call(this,t,n)||this}return r.b(t,e),Object.defineProperty(t.prototype,"notebooks",{get:function(){return new he(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sections",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pages",{get:function(){return new de(this)},enumerable:!0,configurable:!0}),t}(K),he=function(e){function t(t,n){return void 0===n&&(n="notebooks"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new pe(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:Object(o.i)(n)}).then(function(e){return{data:e,notebook:t.getById(e.id)}})},t}(q),pe=function(e){function t(t,n){return e.call(this,t,n)||this}return r.b(t,e),Object.defineProperty(t.prototype,"sections",{get:function(){return new le(this)},enumerable:!0,configurable:!0}),t}(K),le=function(e){function t(t,n){return void 0===n&&(n="sections"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new fe(this,e)},t.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:Object(o.i)(n)}).then(function(e){return{data:e,section:t.getById(e.id)}})},t}(q),fe=function(e){function t(t,n){return e.call(this,t,n)||this}return r.b(t,e),t}(K),de=function(e){function t(t,n){return void 0===n&&(n="pages"),e.call(this,t,n)||this}return r.b(t,e),t}(q),ge=function(e){function t(t,n){return void 0===n&&(n="contacts"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new Te(this,e)},t.prototype.add=function(e,t,n,r,i){var s=this;void 0===i&&(i={});var a=Object(o.c)({businessPhones:r,emailAddresses:n,givenName:e,surName:t},i);return this.postCore({body:Object(o.i)(a)}).then(function(e){return{contact:s.getById(e.id),data:e}})},t}(q),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(o.i)(e)})},t}(K),_e=function(e){function t(t,n){return void 0===n&&(n="contactFolders"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new ye(this,e)},t.prototype.add=function(e,t){var n=this,r={displayName:e,parentFolderId:t};return this.postCore({body:Object(o.i)(r)}).then(function(e){return{contactFolder:n.getById(e.id),data:e}})},t}(q),ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"contacts",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childFolders",{get:function(){return new Oe(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.update=function(e){return this.patchCore({body:Object(o.i)(e)})},t}(K),Oe=function(e){function t(t,n){return void 0===n&&(n="childFolders"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new ye(this,e)},t.prototype.add=function(e,t){var n=this,r={displayName:e,parentFolderId:t};return this.postCore({body:Object(o.i)(r)}).then(function(e){return{contactFolder:n.getById(e.id),data:e}})},t}(K),Se=function(e){function t(t,n){return void 0===n&&(n="me"),e.call(this,t,n)||this}return r.b(t,e),Object.defineProperty(t.prototype,"onenote",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contacts",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contactFolders",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),t}(K),be=function(e){function t(t,n){return void 0===n&&(n="users"),e.call(this,t,n)||this}return r.b(t,e),t.prototype.getById=function(e){return new Ee(this,e)},t}(q),Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.b(t,e),Object.defineProperty(t.prototype,"onenote",{get:function(){return new ce(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contacts",{get:function(){return new ge(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"contactFolders",{get:function(){return new _e(this)},enumerable:!0,configurable:!0}),t}(K),me=function(e){function t(t,n){return e.call(this,t,n)||this}return r.b(t,e),Object.defineProperty(t.prototype,"groups",{get:function(){return new ae(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"teams",{get:function(){return new oe},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"me",{get:function(){return new Se(this)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"users",{get:function(){return new be(this)},enumerable:!0,configurable:!0}),t.prototype.setup=function(e){!function(e){p.extend(e)}(e)},t}(L),ve=new me("v1.0"),Ne=function(e){function t(t){void 0===t&&(t="https://graph.microsoft.com/beta/$batch");var n=e.call(this)||this;return n.batchUrl=t,n}return r.b(t,e),t.prototype.executeImpl=function(){var e=this;m.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1);var t=new U,n={requests:this.formatRequests()},r={body:Object(o.i)(n),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return m.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),t.fetch(this.batchUrl,r).then(function(e){return e.json()}).then(this._parseResponse).then(function(t){return m.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),t.responses.reduce(function(n,r,i){var s=e.requests[i];if(Object(o.j)(s))return m.write("["+e.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+s.method+" "+s.url+".",0),n.then(function(e){return s.parser.parse(r).then(s.resolve).catch(s.reject)});if(t.nextLink)throw Error("Could not properly parse responses to match requests in batch.");return n},Promise.resolve())})},t.prototype.formatRequests=function(){return this.requests.map(function(e,t){var n={id:""+ ++t,method:e.method,url:e.url},r={};return void 0!==j.headers&&null!==j.headers&&(r=Object(o.c)(r,j.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(r=Object(o.c)(r,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(n=Object(o.c)(n,{body:e.options.body}))),n=Object(o.c)(n,{headers:r})})},t.prototype._parseResponse=function(e){var t=this;return new Promise(function(n){for(var r=new Array(t.requests.length).fill(null),i=0;i<e.responses.length;++i){var o=e.responses[i],s=parseInt(o.id,10)-1;204===o.status?r[s]=new Response:r[s]=new Response(null,{headers:o.headers,status:o.status})}n({nextLink:e.nextLink,responses:r})})},t}(x);n.d(t,"graph",function(){return ve}),n.d(t,"GraphRest",function(){return me}),n.d(t,"GroupType",function(){return k}),n.d(t,"Group",function(){return ue}),n.d(t,"Groups",function(){return ae}),n.d(t,"GraphBatch",function(){return Ne}),n.d(t,"GraphQueryable",function(){return L}),n.d(t,"GraphQueryableCollection",function(){return q}),n.d(t,"GraphQueryableInstance",function(){return K}),n.d(t,"GraphQueryableSearchableCollection",function(){return D}),n.d(t,"Teams",function(){return oe}),n.d(t,"Team",function(){return se}),n.d(t,"GraphEndpoints",function(){return G}),n.d(t,"OneNote",function(){return ce}),n.d(t,"Notebooks",function(){return he}),n.d(t,"Notebook",function(){return pe}),n.d(t,"Sections",function(){return le}),n.d(t,"Section",function(){return fe}),n.d(t,"Pages",function(){return de})}])});
//# sourceMappingURL=graph.es5.umd.bundle.min.js.map