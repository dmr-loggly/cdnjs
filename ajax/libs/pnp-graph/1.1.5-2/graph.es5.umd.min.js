/**
@license
 * @pnp/graph v1.1.5-2 - pnp - provides functionality to query the Microsoft Graph
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https:github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("tslib"),require("@pnp/common"),require("@pnp/logging"),require("@pnp/odata")):"function"==typeof define&&define.amd?define(["exports","tslib","@pnp/common","@pnp/logging","@pnp/odata"],t):t((e.pnp=e.pnp||{},e.pnp.graph={}),e.tslib_1,e.pnp.common,e.pnp.logging,e.pnp.odata)}(this,function(u,i,s,p,o){"use strict";var e,t=function(n){function e(e){void 0===e&&(e="There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.");var t=n.call(this,e)||this;return t.name="NoGraphClientAvailableException",p.Logger.log({data:null,level:3,message:t.message}),t}return i.__extends(e,n),e}(Error),c=new(function(){function e(){}return Object.defineProperty(e.prototype,"headers",{get:function(){var e=s.RuntimeConfig.get("graph");return null!=e&&void 0!==e.headers?e.headers:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fetchClientFactory",{get:function(){var e=s.RuntimeConfig.get("graph");if(null!=e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==s.RuntimeConfig.spfxContext)return function(){return s.AdalClient.fromSPFxContext(s.RuntimeConfig.spfxContext)};throw new t},enumerable:!0,configurable:!0}),e}()),a=function(){function e(){this._impl=c.fetchClientFactory()}return e.prototype.fetch=function(e,t){void 0===t&&(t={});var n=new Headers;s.mergeHeaders(n,c.headers),s.mergeHeaders(n,t.headers),n.has("Content-Type")||n.append("Content-Type","application/json");var r=s.extend(t,{headers:n});return this.fetchRaw(e,r)},e.prototype.fetchRaw=function(e,t){var r=this;void 0===t&&(t={});var n=new Headers;s.mergeHeaders(n,t.headers),t=s.extend(t,{headers:n});var o=function(n){r._impl.fetch(e,t).then(function(e){return n.resolve(e)}).catch(function(e){429!==e.status&&503!==e.status&&n.reject(e);var t=n.delay;n.delay*=2,n.attempts++,n.retryCount<=n.attempts&&n.reject(e),setTimeout(s.getCtxCallback(r,o,n),t)})};return new Promise(function(e,t){var n={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};o.call(r,n)})},e.prototype.get=function(e,t){void 0===t&&(t={});var n=s.extend(t,{method:"GET"});return this.fetch(e,n)},e.prototype.post=function(e,t){void 0===t&&(t={});var n=s.extend(t,{method:"POST"});return this.fetch(e,n)},e.prototype.patch=function(e,t){void 0===t&&(t={});var n=s.extend(t,{method:"PATCH"});return this.fetch(e,n)},e.prototype.delete=function(e,t){void 0===t&&(t={});var n=s.extend(t,{method:"DELETE"});return this.fetch(e,n)},e}(),h=function(){function i(){}return i.ensure=function(e,t){var n=[i.Beta,i.V1],r=new RegExp(t,"i"),o=n.filter(function(e){return!r.test(e)}).map(function(e){return e.replace(".","\\.")});return r=new RegExp("/?("+o.join("|")+")/","ig"),e.replace(r,"/"+t+"/")},i.Beta="beta",i.V1="v1.0",i}(),n=function(o){function e(e,t){var n=o.call(this)||this;if("string"==typeof e){var r=e;n._parentUrl=r,n._url=s.combine(r,t)}else n.extend(e,t);return n}return i.__extends(e,o),e.prototype.as=function(e){var t=new e(this._url,null);return s.extend(t,this,!0)},e.prototype.toUrlAndQuery=function(){var e=this.toUrl();return s.isUrlAbsolute(e)||(e=s.combine("https://graph.microsoft.com",e)),e+"?"+Array.from(this.query).map(function(e){return e[0]+"="+e[1]}).join("&")},e.prototype.getParent=function(e,t,n){return void 0===t&&(t=this.parentUrl),new e(t,n)},e.prototype.clone=function(e,t,n){void 0===n&&(n=!0);var r=new e(this,t);return r.configure(this._options),n&&(r=r.inBatch(this._batch)),r},e.prototype.setEndpoint=function(e){return this._url=h.ensure(this._url,e),this},e.prototype.toRequestContext=function(e,t,n,r){return void 0===t&&(t={}),Promise.resolve({batch:this.batch,batchDependency:function(){},cachingOptions:this._cachingOptions,clientFactory:function(){return new a},isBatched:this.hasBatch,isCached:/^get$/i.test(e)&&this._useCaching,options:t,parser:n,pipeline:r,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:s.getGUID(),verb:e})},e}(o.ODataQueryable),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.filter=function(e){return this.query.set("$filter",e),this},t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.join(",")),this},t.prototype.orderBy=function(e,t){void 0===t&&(t=!0);var n="$orderby",r=this.query.has(n)?this.query.get(n).split(","):[];return r.push(e+" "+(t?"asc":"desc")),this.query.set(n,r.join(",")),this},t.prototype.top=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skip=function(e){return this.query.set("$top",e.toString()),this},t.prototype.skipToken=function(e){return this.query.set("$skiptoken",e),this},Object.defineProperty(t.prototype,"count",{get:function(){return this.query.set("$count","true"),this},enumerable:!0,configurable:!0}),t}(n),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.search=function(e){return this.query.set("$search",e),this},t}(r),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$select",e.join(",")),this},t.prototype.expand=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0<e.length&&this.query.set("$expand",e.join(",")),this},t}(n),d=function(n){function t(e,t){return void 0===t&&(t="members"),n.call(this,e,t)||this}return i.__extends(t,n),t.prototype.add=function(e){return this.clone(t,"$ref").postCore({body:s.jsS({"@odata.id":e})})},t.prototype.getById=function(e){return new y(this,e)},t}(r),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(l),g=function(n){function e(e,t){return void 0===t&&(t="owners"),n.call(this,e,t)||this}return i.__extends(e,n),e}(d),b=(function(n){function e(e,t){return void 0===t&&(t="calendars"),n.call(this,e,t)||this}i.__extends(e,n)}(r),function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),t}(l)),m=function(n){function e(e,t){return void 0===t&&(t="events"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new v(this,e)},e.prototype.add=function(e){var t=this;return this.postCore({body:s.jsS(e)}).then(function(e){return{data:e,event:t.getById(e.id)}})},e}(r),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t.prototype.update=function(e){return this.patchCore({body:s.jsS(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(l),_=function(n){function e(e,t){return void 0===t&&(t="attachments"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new x(this,e)},e.prototype.addFile=function(e,t){return this.postCore({body:s.jsS({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})},e}(r),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(l),w=function(n){function e(e,t){return void 0===t&&(t="conversations"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.add=function(e){return this.postCore({body:s.jsS(e)})},e.prototype.getById=function(e){return new O(this,e)},e}(r),j=function(n){function e(e,t){return void 0===t&&(t="threads"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new P(this,e)},e.prototype.add=function(e){return this.postCore({body:s.jsS(e)})},e}(r),C=function(n){function e(e,t){return void 0===t&&(t="posts"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new S(this,e)},e.prototype.add=function(e){return this.postCore({body:s.jsS(e)})},e}(r),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"threads",{get:function(){return new j(this)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return this.patchCore({body:s.jsS(e)})},t.prototype.delete=function(){return this.deleteCore()},t}(l),P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"posts",{get:function(){return new C(this)},enumerable:!0,configurable:!0}),t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:s.jsS({post:e})})},t.prototype.delete=function(){return this.deleteCore()},t}(l),S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),Object.defineProperty(t.prototype,"attachments",{get:function(){return new _(this)},enumerable:!0,configurable:!0}),t.prototype.delete=function(){return this.deleteCore()},t.prototype.forward=function(e){return this.clone(t,"forward").postCore({body:s.jsS(e)})},t.prototype.reply=function(e){return this.clone(t,"reply").postCore({body:s.jsS({post:e})})},t}(l),q=function(n){function r(e,t){return n.call(this,e,t)||this}return i.__extends(r,n),r.prototype.add=function(e){return this.clone(r,"$ref").postCore({body:s.jsS({"@odata.id":e})})},r.prototype.remove=function(e){var t=this.clone(r,"$ref");return t.query.set("$id",e),t.deleteCore()},r}(r),B=function(n){function e(e,t){return void 0===t&&(t="planner/plans"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new T(this,e)},e}(r),T=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(l),I=function(n){function t(e,t){return void 0===t&&(t="photo"),n.call(this,e,t)||this}return i.__extends(t,n),t.prototype.getBlob=function(){return this.clone(t,"$value",!1).get(new o.BlobParser)},t.prototype.getBuffer=function(){return this.clone(t,"$value",!1).get(new o.BufferParser)},t.prototype.setContent=function(e){return this.clone(t,"$value",!1).patchCore({body:e})},t}(l),G=function(){function e(){}return e.prototype.create=function(e,t,n){void 0===t&&(t=""),void 0===n&&(n={});var r=t&&0<t.length?{description:t}:{};return V.groups.add(e,e,u.GroupType.Office365,r).then(function(t){return t.group.createTeam(n).then(function(e){return{data:e,group:t.group,team:new $(t.group)}})})},e}(),$=function(n){function r(e,t){return void 0===t&&(t="team"),n.call(this,e,t)||this}return i.__extends(r,n),r.prototype.update=function(e){var t=this;return this.clone(r,"").setEndpoint(h.Beta).patchCore({body:s.jsS(e)}).then(function(e){return{data:e,team:t}})},r.prototype.get=function(e,t){return void 0===e&&(e=new o.ODataDefaultParser),void 0===t&&(t={}),this.clone(r,"").setEndpoint(h.Beta).getCore(e,t)},r}(l);(e=u.GroupType||(u.GroupType={}))[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security";var E=function(n){function e(e,t){return void 0===t&&(t="groups"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new R(this,e)},e.prototype.add=function(e,t,n,r){var o=this;void 0===r&&(r={});var i=s.extend({displayName:e,mailEnabled:n===u.GroupType.Office365,mailNickname:t,securityEnabled:n!==u.GroupType.Office365},r);return n!==u.GroupType.Security&&(i=s.extend(i,{groupTypes:n===u.GroupType.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:s.jsS(i)}).then(function(e){return{data:e,group:o.getById(e.id)}})},e}(r),R=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(r,e),Object.defineProperty(r.prototype,"calendar",{get:function(){return new b(this,"calendar")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"events",{get:function(){return new m(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"owners",{get:function(){return new g(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"plans",{get:function(){return new B(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"members",{get:function(){return new d(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"conversations",{get:function(){return new w(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"acceptedSenders",{get:function(){return new q(this,"acceptedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"rejectedSenders",{get:function(){return new q(this,"rejectedsenders")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"photo",{get:function(){return new I(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"team",{get:function(){return new $(this)},enumerable:!0,configurable:!0}),r.prototype.addFavorite=function(){return this.clone(r,"addFavorite").postCore()},r.prototype.createTeam=function(e){return this.clone(r,"team").setEndpoint(h.Beta).putCore({body:s.jsS(e)})},r.prototype.getMemberGroups=function(e){return void 0===e&&(e=!1),this.clone(r,"getMemberGroups").postCore({body:s.jsS({securityEnabledOnly:e})})},r.prototype.delete=function(){return this.deleteCore()},r.prototype.update=function(e){return this.patchCore({body:s.jsS(e)})},r.prototype.removeFavorite=function(){return this.clone(r,"removeFavorite").postCore()},r.prototype.resetUnseenCount=function(){return this.clone(r,"resetUnseenCount").postCore()},r.prototype.subscribeByMail=function(){return this.clone(r,"subscribeByMail").postCore()},r.prototype.unsubscribeByMail=function(){return this.clone(r,"unsubscribeByMail").postCore()},r.prototype.getCalendarView=function(e,t){var n=this.clone(r,"calendarView");return n.query.set("startDateTime",e.toISOString()),n.query.set("endDateTime",t.toISOString()),n.get()},r}(l),D=function(n){function e(e,t){return void 0===t&&(t="onenote"),n.call(this,e,t)||this}return i.__extends(e,n),Object.defineProperty(e.prototype,"notebooks",{get:function(){return new k(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sections",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pages",{get:function(){return new L(this)},enumerable:!0,configurable:!0}),e}(l),k=function(n){function e(e,t){return void 0===t&&(t="notebooks"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new U(this,e)},e.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:s.jsS(n)}).then(function(e){return{data:e,notebook:t.getById(e.id)}})},e}(r),U=function(n){function e(e,t){return n.call(this,e,t)||this}return i.__extends(e,n),Object.defineProperty(e.prototype,"sections",{get:function(){return new F(this)},enumerable:!0,configurable:!0}),e}(l),F=function(n){function e(e,t){return void 0===t&&(t="sections"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new A(this,e)},e.prototype.add=function(e){var t=this,n={displayName:e};return this.postCore({body:s.jsS(n)}).then(function(e){return{data:e,section:t.getById(e.id)}})},e}(r),A=function(n){function e(e,t){return n.call(this,e,t)||this}return i.__extends(e,n),e}(l),L=function(n){function e(e,t){return void 0===t&&(t="pages"),n.call(this,e,t)||this}return i.__extends(e,n),e}(r),N=function(n){function e(e,t){return void 0===t&&(t="me"),n.call(this,e,t)||this}return i.__extends(e,n),Object.defineProperty(e.prototype,"onenote",{get:function(){return new D(this)},enumerable:!0,configurable:!0}),e}(l),M=function(n){function e(e,t){return void 0===t&&(t="users"),n.call(this,e,t)||this}return i.__extends(e,n),e.prototype.getById=function(e){return new Q(this,e)},e}(r),Q=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.__extends(t,e),t}(l),H=function(n){function e(e,t){return n.call(this,e,t)||this}return i.__extends(e,n),Object.defineProperty(e.prototype,"groups",{get:function(){return new E(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"teams",{get:function(){return new G},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"me",{get:function(){return new N(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"users",{get:function(){return new M(this)},enumerable:!0,configurable:!0}),e.prototype.setup=function(e){var t;t=e,s.RuntimeConfig.extend(t)},e}(n),V=new H("v1.0"),z=function(n){function e(e){var t=n.call(this,e)||this;return t.name="GraphBatchParseException",p.Logger.log({data:{},level:3,message:"["+t.name+"]::"+t.message}),t}return i.__extends(e,n),e}(Error),J=function(n){function e(e){void 0===e&&(e="https://graph.microsoft.com/beta/$batch");var t=n.call(this)||this;return t.batchUrl=e,t}return i.__extends(e,n),e.prototype.executeImpl=function(){var i=this;p.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Executing batch with "+this.requests.length+" requests.",1);var e=new a,t={requests:this.formatRequests()},n={body:s.jsS(t),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return p.Logger.write("["+this.batchId+"] ("+(new Date).getTime()+") Sending batch request.",1),e.fetch(this.batchUrl,n).then(function(e){return e.json()}).then(this._parseResponse).then(function(o){return p.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched requests.",1),o.responses.reduce(function(e,t,n){var r=i.requests[n];if(s.objectDefinedNotNull(r))return p.Logger.write("["+i.batchId+"] ("+(new Date).getTime()+") Resolving batched request "+r.method+" "+r.url+".",0),e.then(function(e){return r.parser.parse(t).then(r.resolve).catch(r.reject)});if(o.nextLink)throw new z("Could not properly parse responses to match requests in batch.");return e},Promise.resolve())})},e.prototype.formatRequests=function(){return this.requests.map(function(e,t){var n={id:""+ ++t,method:e.method,url:e.url},r={};return void 0!==c.headers&&null!==c.headers&&(r=s.extend(r,c.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(r=s.extend(r,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(n=s.extend(n,{body:e.options.body}))),n=s.extend(n,{headers:r})})},e.prototype._parseResponse=function(i){var u=this;return new Promise(function(e){for(var t=new Array(u.requests.length).fill(null),n=0;n<i.responses.length;++n){var r=i.responses[n],o=parseInt(r.id,10)-1;204===r.status?t[o]=new Response:t[o]=new Response(null,{headers:r.headers,status:r.status})}e({nextLink:i.nextLink,responses:t})})},e}(o.ODataBatch);u.graph=V,u.GraphRest=H,u.Group=R,u.Groups=E,u.GraphBatch=J,u.GraphQueryable=n,u.GraphQueryableCollection=r,u.GraphQueryableInstance=l,u.GraphQueryableSearchableCollection=f,u.Teams=G,u.Team=$,u.GraphEndpoints=h,u.OneNote=D,u.Notebooks=k,u.Notebook=U,u.Sections=F,u.Section=A,u.Pages=L,Object.defineProperty(u,"__esModule",{value:!0})});