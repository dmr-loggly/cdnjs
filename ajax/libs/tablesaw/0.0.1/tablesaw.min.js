/*! Tablesaw - v0.1.0 - 2013-12-13
* https://github.com/filamentgroup/tablesaw
* Copyright (c) 2013 Zach Leatherman; Licensed MIT */
!function(a){var b={regex:{dir:/tablesaw(\.min)?\.js/i}};b.dir=function(){var c;return a("script").each(function(){var d=a(this).attr("data-dist-dir");return d?(c=d,!1):this.src&&this.src.match(b.regex.dir)?(c=this.src.replace(b.regex.dir,""),!1):void 0}),c}(),window.TableSaw=b,!("querySelector"in document)||window.blackberry&&window.WebKitPoint||window.operamini||(a(document.documentElement).addClass("enhanced"),a(function(){a(document).trigger("enhance.tablesaw")}))}(jQuery),function(a){function b(a){if(a&&3===a.length){var b=window,c=!!b.document.createElementNS&&!!b.document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&!!document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1"),d=function(d){var e=b.document.createElement("link"),f=b.document.getElementsByTagName("script")[0];e.rel="stylesheet",e.href=a[d&&c?0:d?1:2],f.parentNode.insertBefore(e,f)},e=new b.Image;e.onerror=function(){d(!1)},e.onload=function(){d(1===e.width&&1===e.height)},e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw=="}}a(function(){b([TableSaw.dir+"icons/icons.data.svg.css",TableSaw.dir+"icons/icons.data.png.css",TableSaw.dir+"icons/icons.fallback.css"])})}(jQuery),function(a){var b={pluginName:"table",classes:{reflowTable:"ui-table-reflow",cellLabels:"ui-table-cell-label",popup:"ui-table-columntoggle-popup",columnBtnContain:"ui-table-columntoggle-btnwrap table-advance",columnBtn:"ui-table-columntoggle-btn ui-table-nav-btn",priorityPrefix:"ui-table-priority-",columnToggleTable:"ui-table-columntoggle",collapsibleCell:"ui-table-cell-collapsible",collapsibleRow:"ui-table-row-collapsible",dialogClass:"",toolbar:"ui-table-bar"},events:{create:"tablecreate",destroy:"tabledestroy"},columnBtnText:"Columns",mode:"reflow",initSelector:"table",columnBtnSide:"right"},c={_create:function(){var c=this,e=a(this);if(!a(this).is("[data-exclude]")){a(this).is("[data-mode]")&&(b.mode=a(this).attr("data-mode")),e.is("[data-column-btn-side]")&&(b.columnBtnSide=e.attr("data-column-btn-side")),e.is("[data-dialog-class]")&&(b.classes.dialogClass=e.attr("data-dialog-class"));var f=this.querySelectorAll("thead tr"),g=this.querySelectorAll("tbody tr"),h=e.prev("."+b.classes.toolbar);h.length||(h=a("<div>").addClass(b.classes.toolbar).insertBefore(e)),b.mode&&h.addClass("mode-"+b.mode),this.headers=e.find("tr:first > th"),this.allHeaders=this.querySelectorAll("th"),a(f).each(function(){var b=0;a(this).children().each(function(){var d=parseInt(this.getAttribute("colspan"),10),e=":nth-child("+(b+1)+")";if(c.colstart=b+1,d)for(var g=0;d-1>g;g++)b++,e+=", :nth-child("+(b+1)+")";this.cells=a(c).find("tr").not(a(f).eq(0)).not(this).children(e),b++})}),a(g).each(function(){var c=a(this);c.is("[data-collapsible-row]")&&(c.addClass(b.classes.collapsibleRow),c.on("click",d),c.children().each(function(){var c=a(this);c.is("[data-collapsible-cell]")&&c.addClass(b.classes.collapsibleCell)}))}),"reflow"===b.mode?e[b.pluginName]("reflow",c):"columntoggle"===b.mode&&e[b.pluginName]("columntoggle",c),e.trigger(b.events.create,[b.mode])}},destroy:function(){var c=a(this);c.removeAttr("data-mode"),c.removeClass(b.classes.reflowTable),c.find("."+b.classes.cellLabels).remove(),c.removeClass(b.classes.columnToggleTable),c.find("th, td").each(function(){var b=a(this);b.removeClass("ui-table-cell-hidden").removeClass("ui-table-cell-visible"),this.className=this.className.replace(/\bui\-table\-priority\-\d\b/g,"")}),c.prev("."+b.classes.toolbar).each(function(){this.className=this.className.replace(/\bmode\-\w*\b/gi,"")}),a(window).off("resize."+c.attr("id")),c.trigger(b.events.destroy),c.removeData(b.pluginName+"active")},reflow:function(c){var d=this,e=this.getAttribute("class")+" "+b.classes.reflowTable;if("reflow"===b.mode){d.setAttribute("class",e);var f=a(this.allHeaders);f.each(function(){var d=a(this.cells),e=c.colstart,f=d.not(this).filter("thead th").length&&" ui-table-cell-label-top",g=a(this).text();if(""!==g)if(f){var h=parseInt(a(this).attr("colspan"),10),i="";h&&(i="td:nth-child("+h+"n + "+e+")"),d.filter(i).prepend("<b class='"+b.classes.cellLabels+f+"'>"+g+"</b>")}else d.prepend("<b class='"+b.classes.cellLabels+"'>"+g+"</b>")})}},columntoggle:function(){var c,d,e,f,g,h,i=a(this),j=this,k=function(b){var c=b.target.checked;a(b.target).data("cells").toggleClass("ui-table-cell-hidden",!c).toggleClass("ui-table-cell-visible",c),i.trigger("tablecolumns")};i.attr("id")||i.attr("id",b.pluginName+"-"+Math.round(1e4*Math.random())),i.addClass(b.classes.columnToggleTable),c=i.attr("id"),d=c+"-popup",h=a("<div class='"+b.classes.columnBtnContain+" "+b.columnBtnSide+" "+b.classes.dialogClass+"'></div>"),e=a("<a href='#"+d+"' class='btn btn-micro "+b.classes.columnBtn+"' data-popup-link>"+"<span>"+b.columnBtnText+"</span></a>"),f=a("<div class='dialog-table-coltoggle "+b.classes.popup+"' id='"+d+"'></div>"),g=a("<div class='btn-group'></div>"),a(this.headers).not("td").each(function(){var c=a(this),d=c.attr("data-priority"),e=c.add(this.cells);d&&"persist"!==d&&(e.addClass(b.classes.priorityPrefix+d),a("<label class='btn btn-check btn-checkbox btn-selected theme-simple'><input type='checkbox' checked>"+c.text()+"</label>").appendTo(g).trigger("enhance").children(0).data("cells",e))}),g.find(".btn").btn(),g.appendTo(f),g.on("change",k),e.appendTo(h),h.appendTo(i.prev("."+b.classes.toolbar)),f.appendTo(h).dialog(!0),a(window).on("resize."+c,function(){i[b.pluginName]("refreshToggle",j)}),a.extend(this,{_menu:g,_menuInputChange:k}),a(this)[b.pluginName]("refreshToggle",j)},refreshPriority:function(){a(this.headers).not("td").each(function(){var c=a(this),d=c.attr("data-priority"),e=c.add(this.cells);d&&"persist"!==d?e.addClass(b.classes.priorityPrefix+d):e.each(function(){this.className=this.className.replace(/\bui\-table\-priority\-\d\b/g,"")})})},refreshToggle:function(){this._menu.find("input").each(function(){var b=a(this);this.checked="table-cell"===b.data("cells").eq(0).css("display"),b.parent()[this.checked?"addClass":"removeClass"]("btn-selected")})}},d=function(){var b=a(this);b.toggleClass("open")};a.fn[b.pluginName]=function(c,d,e,f){return this.each(function(){return c&&"string"==typeof c?a.fn[b.pluginName].prototype[c].call(this,d,e,f):a(this).data(b.pluginName+"active")?a(this):(a(this).data(b.pluginName+"active",!0),a.fn[b.pluginName].prototype._create.call(this),void 0)})},a.extend(a.fn[b.pluginName].prototype,c),a(document).on("enhance.tablesaw",function(c){a(c.target).find(b.initSelector)[b.pluginName]()})}(jQuery),function(a){var b="btn",c="."+b,d="btn-selected",e={_create:function(){return a(this).each(function(){a(this).trigger("beforecreate."+b)[b]("_init").trigger("create."+b)})},_init:function(){var c=a(this),d=void 0!==this.disabled&&this.disabled!==!1,e=this.getElementsByTagName("input")[0],f=this.getElementsByTagName("select")[0];return e&&a(this).addClass("btn-"+e.type)[b]("_formbtn",e),f&&a(this).addClass("btn-select")[b]("_select",f),d&&c.addClass("ui-disabled"),c},_formbtn:function(b){var c=function(b,c){if("radio"===c.type&&c.checked){var e=c.getAttribute("name");a("[name='"+e+"']").each(function(){a(this).parent().removeClass(d)}),b[c.checked?"addClass":"removeClass"](d)}else"checkbox"===c.type&&b[c.checked?"addClass":"removeClass"](d)};c(a(this),b),a(this).bind("click",function(){c(a(this),b)})},_select:function(b){var c=function(b,c){var d,e,f,g=a(c).find("option");if(g.each(function(){var a=this;a.selected&&(d=document.createTextNode(a.text))}),f=b.childNodes,g.length>0)for(var h=0,i=f.length;i>h;h++)e=f[h],e&&3===e.nodeType&&b.replaceChild(d,e)};c(this,b),console.log(this),a(this).bind("change refresh",function(a){console.log(a.type),c(this,b)})}};a.fn[b]=function(c,d,e,f){return this.each(function(){return c&&"string"==typeof c?a.fn[b].prototype[c].call(this,d,e,f):a(this).data(b+"active")?a(this):(a(this).data(b+"active",!0),a.fn[b].prototype._create.call(this),void 0)})},a.extend(a.fn[b].prototype,e),a(document).on("enhance",function(d){a(c,d.target)[b]()})}(jQuery),function(a,b){function c(c){function d(a){return b(a.cells).add(a)}function e(a){d(a).removeClass("ui-table-cell-hidden")}function f(a){d(a).addClass("ui-table-cell-hidden")}function g(a){d(a).addClass("ui-table-cell-persist")}function h(a){return b(a).is('[data-priority="persist"]')}function i(){c.removeClass(u),b("#"+z+"-persist").remove()}function j(){var a="#"+z+" ",d=[],e=c.width();v.each(function(c){var f;h(this)&&(f=b(this).width(),.75*e>f&&d.push(a+" .ui-table-cell-persist:nth-child("+(c+1)+") { width: "+f+"px; }"))}),i(),c.addClass(u),y.append(b("<style>").attr("id",z+"-persist").html(d.join("\n")))}function k(){var a,c=[];return w.each(function(d){var e=b(this),f="none"===e.css("display");f||a?f&&a&&!c[1]&&(c[1]=d):(a=!0,c[0]=d)}),c}function l(){var a=k();return[a[1]-1,a[0]-1]}function m(a){return a?k():l()}function n(a){return a[1]>-1&&a[1]<w.length}function o(){var a=20,d=c.parent().width(),h=0;v.each(function(c){var i=b(this),j=i.is('[data-priority="persist"]');return h+=x[c]+(j?0:a),j?(g(this),void 0):(h>d?f(this):e(this),void 0)}),i(),c.trigger("tablecolumns")}function p(a){var b=m(a);n(b)&&(isNaN(b[0])&&(b[0]=a?0:w.length-1),j(),f(w.get(b[0])),e(w.get(b[1])),c.trigger("tablecolumns"))}var q=b("<div class='table-advance'></div>"),r=b("<a href='#' class='ui-table-nav-btn btn btn-micro left' title='Previous Column'></a>").appendTo(q),s=b("<a href='#' class='ui-table-nav-btn btn btn-micro right' title='Next Column'></a>").appendTo(q),t="disabled",u="table-fix-persist",v=c.find("thead th"),w=v.not('[data-priority="persist"]'),x=[],y=b(document.head||"head"),z=c.attr("id");c.css("width","auto"),v.each(function(){x.push(b(this).outerWidth())}),c.css("width",""),q.appendTo(c.prev(".ui-table-bar")),c.addClass("table-coltoggle-swipe"),z||(z="tableswipe-"+Math.round(1e4*Math.random()),c.attr("id",z)),r.add(s).click(function(a){p(!!b(a.target).closest(s).length),a.preventDefault()}),c.bind("touchstart.swipetoggle",function(a){var d,e,f=(a.touches||a.originalEvent.touches)[0].pageX;c.addClass("table-noanimate"),b(this).bind("touchmove",function(a){d=(a.touches||a.originalEvent.touches)[0].pageX,e=d-f,-30>e&&(e=-30),e>30&&(e=30)}).bind("touchend.swipetoggle",function(){15>d-f&&p(!0),d-f>-15&&p(!1),b(this).unbind("touchmove touchend"),c.removeClass("table-noanimate")})}).bind("tablecolumns.swipetoggle",function(){r[n(l())?"removeClass":"addClass"](t),s[n(k())?"removeClass":"addClass"](t)}).bind("tablenext.swipetoggle",function(){p(!0)}).bind("tableprev.swipetoggle",function(){p(!1)}).bind("tabledestroy.swipetoggle",function(){var c=b(this);c.removeClass("table-coltoggle-swipe"),c.prev(".ui-table-bar").find(".table-advance").remove(),b(a).off("resize",o),c.unbind(".swipetoggle")}),o(),b(a).on("resize",o)}b(document).on("tablecreate","table",function(a,d){var e=b(this);"swipe"===d&&c(e)})}(this,jQuery),function(a){function b(b){return a.map(b.childNodes,function(b){var c=a(b);if(c.is("input, select"))return c.val();if(!c.hasClass("ui-table-cell-label"))return a.trim(c.text())}).join("")}var c="sortable",d="table[data-"+c+"]",e="[data-"+c+"-switch]",f={head:c+"-head",ascend:c+"-ascending",descend:c+"-descending",enhanced:c+"-enhanced",switcher:c+"-switch",tableToolbar:"ui-table-toolbar"},g={sort:"Sort"},h={_create:function(b){return a(this).each(function(){var d=a(this).data("init"+c);return d?!1:(a(this).data("init"+c,!0).trigger("beforecreate."+c).addClass(f.enhanced)[c]("_init",b).trigger("create."+c),void 0)})},_init:function(){var d,h,i=a(this),j=function(){i.addClass(c)},k=function(b){a.each(b,function(b,c){a(c).addClass(f.head)})},l=function(b,c){a.each(b,function(b,d){var e=a("<button />");e.bind("click",{col:d},c),a(d).wrapInner(e)})},m=function(b){a.each(b,function(b,c){var d=a(c);d.removeAttr("data-sortable-default-col"),d.removeClass(f.ascend),d.removeClass(f.descend)})},n=function(b){if(!a(b.target).is("a[href]")){b.stopPropagation();var e=a(this).parent(),g=b.data.col;m(e.siblings()),e.hasClass(f.descend)?i[c]("sortBy",g,!0):i[c]("sortBy",g),h&&h.find("select").val(d.index(e)).trigger("refresh"),b.preventDefault()}},o=function(b){a.each(b,function(b,c){var d=a(c);d.is("[data-sortable-default-col]")&&(d.hasClass(f.descend)||d.addClass(f.ascend))})},p=function(c){h=a("<div>").addClass(f.switcher).addClass(f.tableToolbar).html(function(){var d=["<label>"+g.sort+":"];return d.push('<span class="btn btn-small">&#160;<select>'),c.each(function(c){var e=a(this),g=e.is("[data-sortable-default-col]"),h=e.hasClass(f.descend),i=!1;a(this.cells).slice(0,3).each(function(){return isNaN(parseInt(b(this),10))?void 0:(i=!0,!1)}),d.push("<option"+(g&&!h?" selected":"")+' value="'+c+'_asc">'+e.text()+" "+(i?"↑":"(A-Z)")+"</option>"),d.push("<option"+(g&&h?" selected":"")+' value="'+c+'_desc">'+e.text()+" "+(i?"↓":"(Z-A)")+"</option>")}),d.push("</select></span></label>"),d.join("")});var d=i.prev(".ui-table-bar"),e=d.children().eq(0);e.length?h.insertBefore(e):h.appendTo(d),h.find(".btn").btn(),h.find("select").on("change",function(){var b=a(this).val().split("_"),d=c.eq(b[0]);m(d.siblings()),i.sortable("sortBy",d.get(0),"asc"===b[1])})};j(),d=i.find("thead th[data-"+c+"-col]"),k(d),l(d,n),o(d),i.is(e)&&p(d,i.find("tbody tr:nth-child(-n+3)"))},getColumnNumber:function(b){return a(b).prevAll().length},getTableRows:function(){return a(this).find("tbody tr")},sortRows:function(c,d,e){var f,g,h,i=function(c){var e=[];return a.each(c,function(a,c){e.push({cell:b(c.childNodes[2*d+1]),rowNum:a})}),e},j=function(a){var b;return b=a?function(a,b){return parseInt(a.cell,10)?parseInt(a.cell,10)-parseInt(b.cell,10):a.cell>b.cell?1:-1}:function(a,b){return parseInt(a.cell,10)?parseInt(b.cell,10)-parseInt(a.cell,10):a.cell<b.cell?1:-1}},k=function(a,b){var c,d,e,f=[];for(c=0,d=a.length;d>c;c++)e=a[c].rowNum,f.push(b[e]);return f};return f=i(c),g=j(e),h=f.sort(g),c=k(h,c)},replaceTableRows:function(b){var c=a(this),d=c.find("tbody");d.html(b)},makeColDefault:function(b,c){var d=a(b);d.attr("data-sortable-default-col","true"),c?(d.removeClass(f.descend),d.addClass(f.ascend)):(d.removeClass(f.ascend),d.addClass(f.descend))},notify:function(){},sortBy:function(b,d){var e,f,g=a(this);e=g[c]("getColumnNumber",b),f=g[c]("getTableRows"),f=g[c]("sortRows",f,e,d),g[c]("replaceTableRows",f),g[c]("makeColDefault",b,d),g[c]("notify")}};a.fn[c]=function(b){var d,e=Array.prototype.slice.call(arguments,1);return b&&"string"==typeof b?(d=a.fn[c].prototype[b].apply(this[0],e),"undefined"!=typeof d?d:a(this)):(a(this).data(c+"data")||(a(this).data(c+"active",!0),a.fn[c].prototype._create.call(this,b)),a(this))},a.extend(a.fn[c].prototype,h),a(document).on("tablecreate","table",function(){a(this).is(d)&&a(this)[c]()})}(jQuery),function(a,b){function c(c){function e(b){var c=b.attr(d.attr.init);return!c||a.matchMedia&&a.matchMedia(c).matches}function f(){if(!e(c))return g.hide(),void 0;g.show();var a=h.find("li").removeClass(i);c.find("thead th").each(function(c){"none"===b(this).css("display")&&a.eq(c).addClass(i)})}var g=b('<div class="table-advance minimap">'),h=b('<ul class="table-advance-dots">').appendTo(g),i="table-advance-dots-hide",j=c.find("thead th");j.each(function(){h.append("<li><i></i></li>")}),g.appendTo(c.prev(".ui-table-bar")),f(),b(a).on("resize",f),c.bind("tablecolumns.minimap",function(){f()}).bind("tabledestroy.minimap",function(){var c=b(this);c.prev(".ui-table-bar").find(".table-advance").remove(),b(a).off("resize",f),c.unbind(".minimap")})}var d={attr:{init:"data-minimap"}};b(document).on("tablecreate","table",function(a,e){var f=b(this);"swipe"!==e&&"columntoggle"!==e||!f.is("[ "+d.attr.init+"]")||c(f)})}(this,jQuery),function(a,b){var c={selectors:{init:"table[data-mode-switch]"},attributes:{excludeMode:"data-mode-exclude"},classes:{main:"ui-table-modeswitch",toolbar:"ui-table-toolbar"},modes:["reflow","swipe","columntoggle"],i18n:{modes:["Stack","Swipe","Toggle"],columns:'Col<span class="a11y-sm">umn</span>s'},init:function(a){var d=b(a),e=d.attr(c.attributes.excludeMode),f=d.prev(".ui-table-bar"),g="",h=b("<div>").addClass(c.classes.main+" "+c.classes.toolbar).html(function(){var a,b=["<label>"+c.i18n.columns+":"],f=d.attr("data-mode");b.push('<span class="btn btn-small">&#160;<select>');for(var h=0,i=c.modes.length;i>h;h++)e&&e.toLowerCase()===c.modes[h]||(a=f===c.modes[h],a&&(g=c.modes[h]),b.push("<option"+(a?" selected":"")+' value="'+c.modes[h]+'">'+c.i18n.modes[h]+"</option>"));return b.push("</select></span></label>"),b.join("")}),i=f.find(".table-advance").eq(0);i.length?h.insertBefore(i):h.appendTo(f),h.find(".btn").btn(),h.find("select").bind("change",c.onModeChange)},onModeChange:function(){var a=b(this),d=a.closest("."+c.classes.main),e=a.closest(".ui-table-bar").nextUntil(e).eq(0),f=a.val();d.remove(),e.table("destroy"),e.attr("data-mode",f),e.table()}};b(a.document).on("tablecreate","table",function(){b(this).is(c.selectors.init)&&c.init(this)})}(this,jQuery);