!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof module&&module.exports?module.exports=function(t,e){return void 0===e&&(e="undefined"!=typeof window?require("jquery"):require("jquery")(t)),a(e),e}:a(jQuery)}(function(o){"use strict";"undefined"!=typeof window&&window;var a,e,t,i,s,n,r,l,h,d,c,b,f,u="head"in document&&(!window.blackberry||window.WebKitPoint)&&!window.operamini;u&&o(document.documentElement).addClass("tablesaw-enhanced"),a="tablesaw",e="tablesaw-bar",t="tablesawcreate",i="tablesawdestroy",s="tablesawrefresh",(n=function(t){if(!t)throw new Error("Tablesaw requires an element.");this.table=t,this.$table=o(t),this.mode=this.$table.attr("data-tablesaw-mode")||"stack",this.init()}).prototype.init=function(){this.$table.attr("id")||this.$table.attr("id",a+"-"+Math.round(1e4*Math.random())),this.createToolbar(),this._initCells(),this.$table.trigger(t,[this])},n.prototype._getPrimaryHeaders=function(){return this.$table.find("thead").children().filter("tr").eq(0).find("th")},n.prototype._findHeadersForCell=function(t){for(var e=this._getPrimaryHeaders(),a=[],i=1;i<this.headerMapping.length;i++)for(var s=0;s<this.headerMapping[i].length;s++)this.headerMapping[i][s]===t&&a.push(e[s]);return a},n.prototype._initCells=function(){var t=this.$table.find("tr"),r=[];t.each(function(t){r[t]=[]}),t.each(function(s){var n=0;o(this).children().each(function(){for(var t=parseInt(this.getAttribute("colspan"),10),e=parseInt(this.getAttribute("rowspan"),10);r[s][n];)n++;if(r[s][n]=this,t)for(var a=0;a<t-1;a++)n++,r[s][n]=this;if(e)for(var i=1;i<e;i++)r[s+i][n]=this;n++})});for(var e=0;e<r[0].length;e++){var a,i=r[0][e],s=0;for(i.cells||(i.cells=[]);s<r.length;)i!==(a=r[s][e])&&i.cells.push(a),s++}this.headerMapping=r},n.prototype.refresh=function(){this._initCells(),this.$table.trigger(s)},n.prototype.createToolbar=function(){var t=this.$table.prev().filter("."+e);t.length||(t=o("<div>").addClass(e).insertBefore(this.$table)),this.$toolbar=t,this.mode&&this.$toolbar.addClass("tablesaw-mode-"+this.mode)},n.prototype.destroy=function(){this.$table.prev().filter("."+e).each(function(){this.className=this.className.replace(/\btablesaw-mode\-\w*\b/gi,"")});var t=this.$table.attr("id");o(document).off("."+t),o(window).off("."+t),this.$table.trigger(i,[this]),this.$table.removeData(a)},o.fn[a]=function(){return this.each(function(){var t=o(this);if(!t.data(a)){var e=new n(this);t.data(a,e)}})},o(document).on("enhance.tablesaw",function(t){u&&o(t.target).find("table[data-tablesaw-mode],table[data-tablesaw-sortable]")[a]()}),l="tablesaw-cell-label",h="tablesaw-cell-content",d=r="tablesaw-stack",c="data-tablesaw-no-labels",b="data-tablesaw-hide-empty",(f=function(t,e){this.tablesaw=e,this.$table=o(t),this.labelless=this.$table.is("["+c+"]"),this.hideempty=this.$table.is("["+b+"]"),this.$table.data(d,this)}).prototype.init=function(){if(this.$table.addClass(r),!this.labelless){var e=this;this.$table.find("th, td").filter(function(){return!o(this).closest("thead").length}).filter(function(){return!(o(this).closest("tr").is("["+c+"]")||e.hideempty&&!o(this).html())}).each(function(){var a=[],t=o(this);o(e.tablesaw._findHeadersForCell(this)).each(function(){var t=o(this),e=t.find(".tablesaw-sortable-btn");a.push(e.length?e.html():t.html())}),t.wrapInner("<span class='"+h+"'></span>"),t.prepend("<b class='"+l+"'>"+a.join(", ")+"</b>")})}},f.prototype.destroy=function(){this.$table.removeClass(r),this.$table.find("."+l).remove(),this.$table.find("."+h).each(function(){o(this).replaceWith(this.childNodes)})},o(document).on("tablesawcreate",function(t,e){"stack"===e.mode&&new f(e.table,e).init()}),o(document).on("tablesawdestroy",function(t,e){"stack"===e.mode&&o(e.table).data(d).destroy()})});