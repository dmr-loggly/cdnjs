(function(u,k){"object"===typeof exports&&"object"===typeof module?module.exports=k():"function"===typeof define&&define.amd?define(k):"object"===typeof exports?exports.RxPlayer=k():u.RxPlayer=k()})(this,function(){return function(u){function k(f){if(c[f])return c[f].exports;var m=c[f]={exports:{},id:f,loaded:!1};u[f].call(m.exports,m,m.exports,k);m.loaded=!0;return m.exports}var c={};k.m=u;k.c=c;k.p="";return k(0)}([function(u,k,c){u.exports=c(33)},function(u,k){function c(z,d){for(var a=-1,b=z?
z.length:0;++a<b;)if(z[a]===d)return a;return-1}function f(z){return!!z&&"object"==typeof z&&"[object Date]"==h.call(z)||!1}function m(z){return!!z&&"function"==typeof z||!1}function n(z){return"number"==typeof z}function a(z){return!!z&&"object"==typeof z||!1}function b(z){return"string"==typeof z}function p(z){for(var b=arguments,q=1;q<b.length;q++){var v=b[q];if(a(v))for(var c=d(v),h=0,g=c.length;h<g;h++)z[c[h]]=v[c[h]]}return z}function t(z,d){for(var a=z?z.length:0,b=-1,q=Array(a);++b<a;)q[b]=
d(z[b],b);return q}function l(d,a,b){for(var q=d?d.length:0,v=-1;++v<q;)b=a(b,d[v],v);return b}function x(d,a){for(var b=d?d.length:0,q=-1,v=[];++q<b;)a(d[q],q)&&v.push(d[q]);return v}function g(d,a){for(var c in d)if(a.hasOwnProperty(c)){var h=d[c],e=a[c];b(h)||n(h)||f(h)?d[c]=e:v(h)?(h.length=0,q.apply(h,e)):d[c]=g(h,e)}return d}var e=Object.prototype,h=e.toString,B=e.hasOwnProperty,v=Array.isArray,q=Array.prototype.push,d=Object.keys||function(d){var a=[],b;for(b in d)d.hasOwnProperty(b)&&a.push(d[b]);
return a},e=function(){var d=0;return function(a){a||(a="");return""+a+d++}}();u.exports={chunk:function(d,a){for(var b=[],q=0,v=-1,h=d?d.length:0;++v<h;)b[q]?b[q].length===a?b[++q]=[d[v]]:b[q].push(d[v]):b[q]=[d[v]];return b},compact:function(d){return x(d,function(d){return null!=d})},contains:function(d,a){return-1<c(d,a)},cloneArray:function(d){for(var a=d?d.length:0,b=-1,q=Array(a);++b<a;)q[b]=d[b];return q},cloneObject:function(d){return p({},d)},defaults:function(d,a){for(var b in a)"undefined"==
typeof d[b]&&(d[b]=a[b]);return d},each:function(d,a){for(var b=d?d.length:0,q=-1;++q<b;)a(d[q],q)},extend:p,values:function(a){for(var b=d(a),q=-1,v=b.length,h=Array(v);++q<v;)h[q]=a[b[q]];return h},filter:x,find:function(d,a){for(var b=-1,q=d?d.length:0;++b<q;)if(a(d[b],b))return d[b]},between:function(d,a,b){for(var q=-1,v=d?d.length:0;++q<v;)if(d[q][a]<=b&&d[q+1]&&b<d[q+1][a])return d[q]},findLast:function(d,a){for(var b=d?d.length:0;0<=--b;)if(a(d[b],b))return d[b]},flatten:function(d,b){for(var a=
b?t(d,b):d,q=-1,v=a?a.length:0,h=[];++q<v;){var c=a[q];if(c&&"object"==typeof c&&"number"==typeof c.length){var g=-1,e=c.length,p=h.length;for(h.length+=e;++g<e;)h[p++]=c[g]}else h.push(c)}return h},groupBy:function(d,a){var b;b=m(a)?a:function(d){return d[a]};return l(d,function(d,a){var q=b(a);(v(d[q])?d[q]:d[q]=[]).push(a);return d},{})},identity:function(d){return d},indexOf:c,isArray:v,isDate:f,isFunction:m,isNumber:n,isObject:a,isString:b,isPromise:function(d){return!!d&&"function"==typeof d.then},
isObservable:function(d){return!!d&&"function"==typeof d.subscribe},keys:d,last:function(d){return d[d.length-1]},map:t,memoize:function(d,a){var b=function N(){var b=N.cache,q=a?a.apply(this,arguments):arguments[0];return B.call(b,q)?b[q]:b[q]=d.apply(this,arguments)};b.cache={};return b},noop:function(){},pad:function(d,a){d=d.toString();return d.length>=a?d:(Array(a+1).join("0")+d).slice(-a)},pick:function(d,a){return l(a,function(a,b){b in d&&(a[b]=d[b]);return a},{})},pluck:function(d,a){return t(d,
function(d){return d[a]})},reduce:l,simpleMerge:g,sortedIndex:function(d,a,b){var q=0,v=d?d.length:q;for(a=b(a);q<v;){var h=q+v>>>1;b(d[h])<a?q=h+1:v=h}return q},tryCatch:function(d){try{return d()}catch(a){return a}},uniqueId:e}},function(u,k){function c(f){this.name="AssertionError";this.message=f;Error.captureStackTrace&&Error.captureStackTrace(this,c)}function f(f,n){if(!f)throw new c(n);}c.prototype=Error();f.equal=function(c,n,a){return f(c===n,a)};f.iface=function(c,n,a){f(c,n+" should be an object");
for(var b in a)f.equal(typeof c[b],a[b],n+" should have property "+b+" as a "+a[b])};u.exports=f},function(u,k,c){c(5);u.exports=c(21)},function(u,k){function c(){}var f={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},m=function(){};c.error=m;c.warn=m;c.info=m;c.debug=m;c.setLevel=function(n){"string"==typeof n&&(n=f[n]);c.error=n>=f.ERROR?console.error.bind(console):m;c.warn=n>=f.WARNING?console.warn.bind(console):m;c.info=n>=f.INFO?console.info.bind(console):m;c.debug=n>=f.DEBUG?console.log.bind(console):
m};u.exports=c},function(u,k,c){k=c(20).Promise;var f=c(21),m=f.Observable,n=f.SingleAssignmentDisposable,f=f.config,a=m.fromEvent,b=m.merge,p=m.timer,t=c(22).getBackedoffDelay,l=c(1),x=l.identity,g=l.isArray,e=l.map,h=l.noop,B=c(23);f.useNativeEvents=!0;f.Promise=k;c=m.prototype;c.log=function(a,d){a||(a="");return this["do"](function(b){return console.log(a,"next",(d||x)(b))},function(d){return console.log(a,"error",d)},function(){return console.log(a,"completed")})};c.each=function(a){return this.subscribe(a,
h)};var v=function(a,d){return a===d};c.changes=function(a){return this.distinctUntilChanged(a,v)};c.customDebounce=function(a,d){var b=this;return m.create(function(v){var h=B(function(d){return v.onNext(d)},a,d),c=b.subscribe(h,function(d){return v.onError(d)},function(){return v.onCompleted()});return function(){h.dispose();c.dispose()}})};c.simpleTimeout=function(a){var d=1>=arguments.length||void 0===arguments[1]?"timeout":arguments[1],b=this;return m.create(function(v){var h=new n,c=setTimeout(function(){return v.onError(Error(d))},
a);h.setDisposable(b.subscribe(function(d){clearTimeout(c);v.onNext(d)},function(d){return v.onError(d)},function(d){return v.onCompleted()}));return function(){clearTimeout(c);h.dispose()}})};c.flatMapMaxConcurrent=function(a,d){var b=this;return m.create(function(v){function h(d){var a=e.length;if(a<d)for(d=p.splice(0,d-a),a=0;a<d.length;a++)c(d[a])}function c(d){var a=new n;e.push(a);a.setDisposable(d.subscribe(function(d){return v.onNext(d)},function(d){return v.onError(d)},function(){var d=e.indexOf(a);
0<=d&&e.splice(d,1);h(g)}))}var g=0,e=[],p=[],B=d.subscribe(function(d){var a=g;g=d;d>a&&h(d)},function(d){return v.onError(d)}),l=b.subscribe(function(d){try{d=a(d)}catch(b){return v.onError(b)}p.push(d);h(g)},function(d){return v.onError(d)},function(){return v.onCompleted()});return function(){B.dispose();l.dispose();for(var d=p.length=0;d<e.length;d++)e[d].dispose();e.length=0}})};u.exports={on:function(q,d){return g(d)?b(e(d,function(d){return a(q,d)})):a(q,d)},first:function(a){return a.take(1)},
only:function(a){return m.never().startWith(a)},retryWithBackoff:function(a,d){var b=d.retryDelay,v=d.totalRetry,c=d.shouldRetry,e=d.resetDelay,g=0,l;l=0<e?B(function(){return g=0},e):h;return function E(){for(var d=0,h=arguments.length,e=Array(h);d<h;d++)e[d]=arguments[d];return a.apply(null,e)["catch"](function(d){if(c&&!c(d,g)||g++>=v)throw d;d=t(b,g);return p(d).flatMap(function(){l();return E.apply(null,e)})})}}}},function(u,k,c){function f(a){for(var b=a.length,c=new Uint8Array(b),f=0;f<b;f++)c[f]=
a.charCodeAt(f)&255;return c}function m(a,b){b||(b="");for(var c="",f=0;f<a.byteLength;f++)c+=(a[f]>>>4).toString(16),c+=(a[f]&15).toString(16),b.length&&(c+=b);return c}var n=c(2);u.exports={totalBytes:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].byteLength;return b},strToBytes:f,bytesToStr:function(a){return String.fromCharCode.apply(null,a)},bytesToUTF16Str:function(a){for(var b="",c=a.length,f=0;f<c;f+=2)b+=String.fromCharCode(a[f]);return b},hexToBytes:function(a){for(var b=a.length,c=
new Uint8Array(b/2),f=0,l=0;f<b;f+=2,l++)c[l]=parseInt(a.substr(f,2),16)&255;return c},bytesToHex:m,concat:function(){for(var a=arguments.length,b=-1,c=0,f;++b<a;)f=arguments[b],c+="number"===typeof f?f:f.length;for(var c=new Uint8Array(c),l=0,b=-1;++b<a;)f=arguments[b],"number"===typeof f?l+=f:0<f.length&&(c.set(f,l),l+=f.length);return c},be2toi:function(a,b){return(a[0+b]<<8)+(a[1+b]<<0)},be4toi:function(a,b){return 16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b]},be8toi:function(a,b){return 4294967296*
(16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b])+16777216*a[4+b]+65536*a[5+b]+256*a[6+b]+a[7+b]},le2toi:function(a,b){return(a[0+b]<<0)+(a[1+b]<<8)},le4toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]},le8toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]+(a[4+b]+256*a[5+b]+65536*a[6+b]+16777216*a[7+b]*4294967296)},itobe2:function(a){return new Uint8Array([a>>>8&255,a&255])},itobe4:function(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])},
itobe8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255])},itole2:function(a){return new Uint8Array([a&255,a>>>8&255])},itole4:function(a){return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255])},itole8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255,b&255,b>>>8&255,b>>>16&255,b>>>24&255])},guidToUuid:function(a){n.equal(a.length,
16,"UUID length should be 16");var b=f(a);a=b[0];var c=b[1],t=b[2],l=b[3],x=b[4],g=b[5],e=b[6],h=b[7],B=b.subarray(8,10),b=b.subarray(10,16),v=new Uint8Array(16);v[0]=l;v[1]=t;v[2]=c;v[3]=a;v[4]=g;v[5]=x;v[6]=h;v[7]=e;v.set(B,8);v.set(b,10);return m(v)},toBase64URL:function(a){return btoa(a).replace(/\=+$/,"")}}},function(u,k,c){function f(a,b){var d,c,h=b.length;d=Infinity;for(c=-Infinity;0<=--h&&a<d;)d=b.start(h),c=b.end(h);return a>=d?{start:d,end:c}:null}function m(a){return!!a&&"number"===typeof a.length}
function n(a){if(e.isArray(a))return a;for(var b=-1,d=a.length,c=Array(d);++b<d;)c[b]={start:a.start(b),end:a.end(b)};return c}function a(a,b){return a.start<=b&&b<a.end}function b(a,b){for(var d=0;d<b.length;d++)if(p(a,b[d]))return b[d];return null}function p(b,c){return a(b,c.start)||a(b,c.end)||a(c,b.start)}function t(b,c){return a(b,c.start)&&a(b,c.end)}function l(a,b){return Math.abs(b.start-a.end)<B||Math.abs(b.end-a.start)<B}function x(a,b,d){var c=Math.min(a.start,b.start);a=Math.max(a.end,
b.end);return{start:c,end:a,bitrate:d}}function g(){this.ranges=[];this.length=0}var e=c(1),h=c(2),B=1/60;g.prototype={start:function(a){return this.ranges[a].start},end:function(a){return this.ranges[a].end},hasRange:function(a,b){for(var d=a+b,c=0;c<this.ranges.length;c++){var h=this.ranges[c],e=h.start,h=h.end;if(e-a<=B&&a-h<=B&&e-d<=B&&d-h<=B)return this.ranges[c]}return null},getRange:function(b){for(var c=0;c<this.ranges.length;c++)if(a(this.ranges[c],b))return this.ranges[c];return null},insert:function(a,
b,d){h(0<=b);h(0<d-b);var c=this.ranges;h(b<=d);if(b!=d){a={start:b,end:d,bitrate:a};for(b=0;b<c.length;b++){d=c[b];var e=p(a,d),g=l(a,d);if(e||g)if(a.bitrate===d.bitrate)a=x(a,d,d.bitrate),c.splice(b--,1);else if(e)if(t(d,a))c.splice(++b,0,a),e=d.end,d.end=a.start,a={start:a.end,end:e,bitrate:d.bitrate};else if(t(a,d))c.splice(b--,1);else if(d.start<a.start)d.end=a.start;else{d.start=a.end;break}else break;else if(0===b){if(a.end<=c[0].start)break}else if(c[b-1].end<=a.start&&a.end<=d.start)break}c.splice(b,
0,a);for(a=0;a<c.length;a++)b=c[a],b.start===b.end&&c.splice(a++,1);for(a=1;a<c.length;a++)b=c[a-1],d=c[a],b.bitrate===d.bitrate&&l(b,d)&&(b=x(b,d,d.bitrate),c.splice(--a,2,b))}this.length=this.ranges.length;return this.ranges},equals:function(a){var c;a:{c=this.ranges;a=n(a);for(var d=0;d<c.length;d++){var h=c[d],e=b(h,a);if(!e||e.start>h.start||e.end<h.end){c=!1;break a}}c=!0}return c},intersect:function(a){var c=this.ranges;a=n(a);for(var d=0;d<c.length;d++){var h=c[d],e=b(h,a);e?(e.start>h.start&&
(h.start=e.start),e.end<h.end&&(h.end=e.end)):c.splice(d--,1)}this.length=this.ranges.length;return this.ranges}};u.exports={getRange:f,getGap:function(a,b){var d=m(b)?f(a,b):b;return d?d.end-a:Infinity},getNextRangeGap:function(a,b){for(var d=-1,c;++d<b.length;){var h=b.start(d);if(h>a){c=h;break}}return null!=c?c-a:Infinity},getLoaded:function(a,b){var d=m(b)?f(a,b):b;return d?a-d.start:0},getSize:function(a,b){var d=m(b)?f(a,b):b;return d?d.end-d.start:0},bufferedToArray:n,BufferedRanges:g}},function(u,
k,c){function f(a){return a&&"function"==typeof a.then?a:h.resolve(a)}function m(a){return function(){var d;try{d=a.apply(this,arguments)}catch(b){return h.reject(b)}return f(d)}}function n(a,d){function b(){var a=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];a.errorCode&&(a={systemCode:a.systemCode,code:a.errorCode.code});this.name="KeySessionError";this.mediaKeyError=a;this.message="MediaKeyError code:"+a.code+" and systemCode:"+a.systemCode}b.prototype=Error();return function(c,e){var f=
g.isFunction(d)?d.call(this):this,B=W(f),q=ha(f).map(function(a){throw new b(f.error||a);});try{return a.call(this,c,e),z(B,q).take(1).toPromise()}catch(l){return h.reject(l)}}}function a(a,d){var b=document.createElement(a.tagName),c="on"+d;if(c in b)return!0;b.setAttribute(c,"return;");return g.isFunction(b[c])}function b(a,d){return g.flatten(a,function(a){return g.map(d||E,function(d){return d+a})})}function p(d,b){return g.find(b,function(b){return a(d,b)})}function t(a,d){var c;a=b(a,d);return function(d){if(d instanceof
L){"undefined"==typeof c&&(c=p(d,a)||null);if(c)return X(d,c);e.warn("compat: element <"+d.tagName+"> does not support any of these events: "+a.join(", "));return D()}return N(d,a)}}function l(a,d){if(d instanceof U)return d._setVideo(a);if(a.setMediaKeys)return a.setMediaKeys(d);if(null!==d){if(a.WebkitSetMediaKeys)return a.WebkitSetMediaKeys(d);if(a.mozSetMediaKeys)return a.mozSetMediaKeys(d);if(a.msSetMediaKeys)return a.msSetMediaKeys(d);throw Error("compat: cannot find setMediaKeys method");}}
function x(){return!!(y.fullscreenElement||y.mozFullScreenElement||y.webkitFullscreenElement||y.msFullscreenElement)}var g=c(1),e=c(4),h=c(9),B=c(10);k=c(6);var v=k.bytesToStr,q=k.strToBytes,d=c(2);k=c(3).Observable;var z=k.merge,D=k.never,X=k.fromEvent,M=k.just,N=c(5).on,y=document,F=window,E=["","webkit","moz","ms"],L=F.HTMLElement;c=F.HTMLVideoElement;var Y=F.MediaSource||F.MozMediaSource||F.WebKitMediaSource||F.MSMediaSource,I=F.MediaKeys||F.MozMediaKeys||F.WebKitMediaKeys||F.MSMediaKeys;k="Microsoft Internet Explorer"==
navigator.appName||"Netscape"==navigator.appName&&/Trident\//.test(navigator.userAgent);var U=g.noop,J;navigator.requestMediaKeySystemAccess&&(J=function(a,d){return navigator.requestMediaKeySystemAccess(a,d)});k=t(k?["progress"]:["loadedmetadata"]);var da=t(["sourceopen","webkitsourceopen"]),S=t(["encrypted","needkey"]),ea=t(["keymessage","message"]),W=t(["keyadded","ready"]),ha=t(["keyerror","error"]),ja=t(["keystatuseschange"]),S={onEncrypted:S,onKeyMessage:ea,onKeyStatusesChange:ja,onKeyError:ha};
if(!J&&c.prototype.webkitGenerateKeyRequest){var fa=function(a,d){var b=this;B.call(this);this._vid=a;this._key=d;this._con=z(ea(a),W(a),ha(a)).subscribe(function(a){return b.trigger(a.type,a)})};fa.prototype=g.extend({},B.prototype,{generateRequest:m(function(a,d){this._vid.webkitGenerateKeyRequest(this._key,d)}),update:n(function(a,d){if(0<=this._key.indexOf("clearkey")){var b=JSON.parse(v(a)),c=q(atob(b.keys[0].k)),b=q(atob(b.keys[0].kid));this._vid.webkitAddKey(this._key,c,b,d)}else this._vid.webkitAddKey(this._key,
a,null,d)}),close:m(function(){this._con&&this._con.dispose();this._vid=this._con=null})});U=function(a){this.ks_=a};U.prototype={_setVideo:function(a){this._vid=a},createSession:function(a){return new fa(this._vid,this.ks_)}};var sa=function(a){var d=y.querySelector("video")||y.createElement("video");return d&&d.canPlayType?!!d.canPlayType("video/mp4",a):!1};J=function(a){return sa(a)?h.resolve({createMediaKeys:function(){return h.resolve(new U(a))}}):h.reject()}}else if(I&&!J){var va=function(a){B.call(this);
this._mk=a};va.prototype=g.extend(B.prototype,{generateRequest:m(function(a,d){var b=this;this._ss=this._mk.memCreateSession("video/mp4",d);this._con=z(ea(this._ss),W(this._ss),ha(this._ss)).subscribe(function(a){return b.trigger(a.type,a)})}),update:n(function(a,b){d(this._ss);this._ss.update(a,b)},function(){return this._ss}),close:m(function(){this._ss&&(this._ss.close(),this._ss=null,this._con.dispose(),this._con=null)})});I.prototype.alwaysRenew=!0;I.prototype.memCreateSession=I.prototype.createSession;
I.prototype.createSession=function(){return new va(this)};J=function(a){return I.isTypeSupported(a)?h.resolve({createMediaKeys:function(){return h.resolve(new I(a))}}):h.reject()}}I||(ja=function(){throw Error("eme: MediaKeys is not available");},I={create:ja,isTypeSupported:ja});F.WebKitSourceBuffer&&!F.WebKitSourceBuffer.prototype.addEventListener&&(F=F.WebKitSourceBuffer.prototype,g.extend(F,B.prototype),F.__listeners=[],F.appendBuffer=function(a){if(this.updating)throw Error("SourceBuffer updating");
this.trigger("updatestart");this.updating=!0;try{this.append(a)}catch(d){this.__emitUpdate("error",d);return}this.__emitUpdate("update")},F.__emitUpdate=function(a,d){var b=this;setTimeout(function(){b.trigger(a,d);b.updating=!1;b.trigger("updateend")},0)});F=t(["fullscreenchange","FullscreenChange"],E.concat("MS"));u.exports={isEventSupported:a,HTMLVideoElement_:c,MediaSource_:Y,requestMediaKeySystemAccess:J,sourceOpen:function(a){return"open"==a.readyState?M():da(a).take(1)},loadedMetadataEvent:k,
isCodecSupported:function(a){return!!Y&&Y.isTypeSupported(a)},setMediaKeys:function(a,d){return f(l(a,d))},emeEvents:S,isFullscreen:x,onFullscreenChange:F,requestFullscreen:function(a){if(!x()){if(a.requestFullscreen)return a.requestFullscreen();if(a.msRequestFullscreen)return a.msRequestFullscreen();if(a.mozRequestFullScreen)return a.mozRequestFullScreen();if(a.webkitRequestFullscreen)return a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(x()){if(y.exitFullscreen)return y.exitFullscreen();
if(y.msExitFullscreen)return y.msExitFullscreen();if(y.mozCancelFullScreen)return y.mozCancelFullScreen();if(y.webkitExitFullscreen)return y.webkitExitFullscreen()}},visibilityEvents:function(){var a;null!=y.hidden?a="":null!=y.mozHidden?a="moz":null!=y.msHidden?a="ms":null!=y.webkitHidden&&(a="webkit");return{hidden:a?a+"Hidden":"hidden",visibilityChange:a+"visibilitychange"}}}},function(u,k,c){u.exports=c(20).Promise},function(u,k,c){function f(){this.__listeners={}}var m=c(1),n=c(2);f.prototype.addEventListener=
function(a,b){n("function"==typeof b,"eventemitter: second argument should be a function");this.__listeners[a]||(this.__listeners[a]=[]);this.__listeners[a].push(b)};f.prototype.removeEventListener=function(a,b){if(0===arguments.length)this.__listeners={};else if(this.__listeners.hasOwnProperty(a))if(1===arguments.length)delete this.__listeners[a];else{var c=this.__listeners[a],f=c.indexOf(b);~f&&c.splice(f,1);c.length||delete this.__listeners[a]}};f.prototype.trigger=function(a,b){if(this.__listeners.hasOwnProperty(a)){var c=
this.__listeners[a].slice();m.each(c,function(a){try{a(b)}catch(c){console.error(c,c.stack)}})}};f.prototype.on=f.prototype.addEventListener;f.prototype.off=f.prototype.removeEventListener;u.exports=f},function(u,k,c){function f(a,b){return 0===b.length?a:n.test(b)?b:a+"/"+b}var m=c(1),n=/:\/\//,a=/:\//,b=/\/\.\//g,p=/\/\.\.\//,t=/[^\/]*\/+\.\.\//,l=/\/+/g;u.exports={resolveURL:function(){var c=m.compact(arguments);if(0===c.length)return"";c=m.reduce(c,f,"");for(b.test(c)&&(c=c.replace(b,"/"));p.test(c);)c=
c.replace(t,"/");return c.replace(l,"/").replace(a,"://")},parseBaseURL:function(a){var b=a.lastIndexOf("/");return 0<=b?a.substring(0,b+1):a}}},function(u,k,c){function f(a,b,c){var e=3>=arguments.length||void 0===arguments[3]?null:arguments[3];this.name="RequestError";this.url=a;this.xhr=b;this.code=b.status;this.reason=e;this.message="request: "+c+" ("+a+")";Error.captureStackTrace&&Error.captureStackTrace(this,f)}function m(a,b){var c=b.code,e=b.method,d=b.message;this.name="RestCallMethodError";
this.url=a;this.code=c;this.message="restmethodcall: webservice error status "+c+" ("+a+")"+(e?" ("+e+")":"")+(d?"\n"+d:"");Error.captureStackTrace&&Error.captureStackTrace(this,m)}function n(a,b,c){a=a.querySelector("RestCallResult");var e=+a.querySelector("Status").textContent;if(0>e)throw new m(b,{code:e,method:c});return{output:a.querySelector("Output"),status:e}}function a(a){return"rest-call-method"==a.format?t(a):l.create(function(b){function c(a){var h=a.target,e=h.status;if(200>e||300<=e)return b.onError(new f(d,
h,h.statusText));var e=Date.now()-E,g;g="document"==p?(new DOMParser).parseFromString(h.responseText,"text/xml"):h.response;if("json"==p&&"string"==typeof g)try{g=JSON.parse(g)}catch(l){g=null}if(null==g)return b.onError(new f(d,h,'null response with format "'+p+'" (error while parsing or wrong content-type)'));if(x){var q;if(n){q=n;for(var v={},m,k=0;k<q.length;k++)m=q[k],v[m]=h.getResponseHeader(m);q=v}b.onNext({blob:g,size:a.total,duration:e,headers:q,url:h.responseURL||d,xhr:h})}else b.onNext(g);
b.onCompleted()}function e(a){b.onError(new f(d,a,"error event"))}var d=a.url,g=a.data,l=a.headers,p=a.format,x=a.withMetadata,n=a.responseHeaders,m=new XMLHttpRequest;m.open(a.method||"GET",d,!0);m.responseType="document"==p?"text":p||"text";if(l)for(var k in l)m.setRequestHeader(k,l[k]);m.addEventListener("load",c,!1);m.addEventListener("error",e,!1);var E=Date.now();m.send(g);return function(){var a=m.readyState;0<a&&4>a&&(m.removeEventListener("load",c),m.removeEventListener("error",e),m.abort());
m=null}})}function b(a){return(a||"").toString().replace(x,function(a){return g[a]})}function p(a){var c="",e;for(e in a)var g=a[e],g="object"==typeof g?p(g):b(g),c=c+("<"+e+">"+g+"</"+e+">");return c}function t(b){b.method="POST";b.headers={"Content-Type":"application/xml"};b.data=e.replace("{payload}",p(b.data));b.format="document";return a(b).map(function(a){return n(a,b.url,b.ScriptInfo)})}var l=c(3).Observable;f.prototype=Error();m.prototype=Error();var x=/[&<>]/g,g={"&":"&amp;","<":"&lt;",">":"&gt;"},
e='<RestCallMethod xmlns:i="http://www.w3.org/2001/XMLSchema-instance">{payload}</RestCallMethod>';a.escapeXml=b;a.RequestError=f;a.RestCallMethodError=m;a.RestCallResult=n;a.getNodeTextContent=function(a,b){var c=a.querySelector(b);return c&&c.textContent};u.exports=a},function(u,k){u.exports=function(c){c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],c.children=[],c.webpackPolyfill=1);return c}},function(u,k){function c(){p=!1;t.length?b=t.concat(b):l=-1;b.length&&f()}function f(){if(!p){var a=
setTimeout(c);p=!0;for(var g=b.length;g;){t=b;for(b=[];++l<g;)t[l].run();l=-1;g=b.length}t=null;p=!1;clearTimeout(a)}}function m(a,b){this.fun=a;this.array=b}function n(){}var a=u.exports={},b=[],p=!1,t,l=-1;a.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var e=1;e<arguments.length;e++)c[e-1]=arguments[e];b.push(new m(a,c));1!==b.length||p||setTimeout(f,0)};m.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];
a.version="";a.versions={};a.on=n;a.addListener=n;a.once=n;a.off=n;a.removeListener=n;a.removeAllListeners=n;a.emit=n;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(u,k,c){function f(a){function b(a,h,g){if(a>=e.length)return g(E());var f=e[a],l=f.keySystem;d(f.keyType,c).then(function(a){return h({keySystem:l,keySystemAccess:a})},function(){return b(a+
1,h,g)})}if(Y&&L&&!L.alwaysRenew){if(a=p.find(a,function(a){return a.type==Y}))return l.resolve({keySystem:a,keySystemAccess:U});throw E();}var c=[{initDataTypes:["cenc"]}],e=p.flatten(a,function(a){return p.map(y[a.type],function(d){return{keyType:d,keySystem:a}})});return new l(function(a,d){return b(0,a,d)})}function m(a,d,b){return b.createMediaKeys().then(function(b){L=b;Y=d.type;t.debug("eme: set mediakeys");return z(a,b).then(function(){return b})})}function n(a,d,b){var c=3>=arguments.length||
void 0===arguments[3]?!1:arguments[3];t.debug("eme: generate request",d,b,c);return a.generateRequest(d,b).then(function(){c&&a.keyStatuses&&(t.info("eme: store session",a),I.set(b,a));return a})}function a(a){return p.isPromise(a)?B(a):p.isObservable(a)?a:q(a)}function b(d,b){function c(a){var e=new Uint8Array(a.initData),h=a.initDataType;t.info("eme: encrypted event",a);return B(f(b)).flatMap(function(a){var b=a.keySystem;a=a.keySystemAccess;t.info("eme: compatible keysystem",b.type);a=m(d,b,a);
return B(a).flatMap(function(a){var d=I.get(e);if(d){if(0<d.keyStatuses.size)return t.debug("eme: reuse session"),q(d);I["delete"](e)}t.debug("eme: create session");d=a.createSession("temporary");return n(d,h,e,E)}).flatMap(function(a){return g(a,b,e)})})}function g(d,b,c){var f,l=M(d).map(function(a){a="eme: keyerror event "+a.errorCode+" / "+a.systemCode;t.error(a);throw Error(a);}),q=N(d).flatMap(function(c){f=c.sessionId;for(var g=d.keyStatuses.values(),l=g.next();!l.done;l=g.next())if(l=F[l.value])throw t.error(l),
Error(l);if(!b.onKeyStatusesChange)return t.warn("eme: keystatuseschange event not handled"),h();var q;try{q=b.onKeyStatusesChange(c,d)}catch(p){q=e["throw"](p)}return a(q)["catch"](function(a){var d="eme: onKeyStatusesChange has failed (reason: "+(a&&a.message||"unknown")+")",b=Error(d);b.reason=a;t.error(d);throw b;})}),p=X(d).flatMap(function(d){f=d.sessionId;var c=d.message;d=d.messageType;var h;try{h=b.getLicense(new Uint8Array(c),d||"licenserequest")}catch(g){h=e["throw"](g)}return a(h)["catch"](function(a){var d=
"eme: getLicense has failed (reason: "+(a&&a.message||"unknown")+")",b=Error(d);b.reason=a;t.error(d);throw b;})}),q=v(p,q).concatMap(function(a){return d.update(a,f)["catch"](function(a){t.error("eme: error on session update",f,a);throw a;})}).map(function(a){return{type:"eme",value:{session:d,name:"session-updated"}}});return v(q,l).tapOnError(function(a){t.debug("eme: delete session from store",f);I["delete"](c)})}var l=2>=arguments.length||void 0===arguments[2]?{}:arguments[2];p.each(b,function(a){return x.iface(a,
"keySystem",{getLicense:"function",type:"string"})});var E=l.persistedSessions;return e.create(function(a){var b=D(d).take(1).flatMap(c).subscribe(a);return function(){b&&b.dispose();z(d,null)["catch"](function(a){return t.warn(a)})}})}var p=c(1),t=c(4),l=c(9),x=c(2),g=c(6).bytesToHex,e=c(3).Observable,h=e.empty,B=e.fromPromise,v=e.merge,q=e.just;k=c(8);var d=k.requestMediaKeySystemAccess,z=k.setMediaKeys;k=k.emeEvents;var D=k.onEncrypted,X=k.onKeyMessage,M=k.onKeyError,N=k.onKeyStatusesChange,y=
{clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.youtube.playready","com.microsoft.playready"]},F={"output-not-allowed":"eme: the required output protection is not available.",expired:"eme: a required key has expired and the content cannot be decrypted.","internal-error":"eme: an unknown error has occurred in the CDM."},E=function(){return Error("eme: could not find a compatible key system")},L,Y,I=function(){var a={};return{get:function(d){return a[g(d)]},
set:function(d,b){a[g(d)]=b},"delete":function(d){delete a[g(d)]},dispose:function(){a={}}}}(),U={createMediaKeys:function(){return l.resolve(L)}};b.onEncrypted=function(a){return D(a)};b.getCurrentKeySystem=function(){return Y};b.dispose=function(){Y=L=null;I.dispose()};u.exports=b},function(u,k,c){function f(a){this.name="OutOfIndexError";this.type=a;this.message="out of range in index "+a}function m(a){switch(a.indexType){case "template":return b;case "timeline":return p;case "list":return t;case "base":return l;
default:throw Error("index-handler: unrecognized indexType "+a.indexType);}}function n(a,b){this.adaptation=a;this.representation=b;this.index=b.index;this.handler=new (m(this.index))(this.index)}c(1);var a=c(2),b=c(31),p=c(17),t=c(30),l=c(29);f.prototype=Error();n.prototype.getInitSegment=function(){var a=this.index.initialization||{};return{id:"init_"+this.adaptation.id+"_"+this.representation.id,init:!0,media:a.media,range:a.range,indexRange:this.index.indexRange}};n.prototype.normalizeRange=function(a,
b,c){var h=this.index.presentationTimeOffset||0,f=this.index.timescale||1;b||(b=0);c||(c=0);b=Math.min(b,c);return{time:a*f-h,up:(a+b)*f-h,to:(a+c)*f-h}};n.prototype.getSegments=function(a,b,c){a=this.normalizeRange(a,b,c);b=a.up;c=a.to;if(!this.handler.checkRange(a.time))throw new f(this.index.indexType);return this.handler.getSegments(b,c)};n.prototype.insertNewSegments=function(a,b){for(var c=[],h=0;h<a.length;h++)this.handler.addSegment(a[h],b)&&c.push(a[h]);return c};n.prototype.setTimescale=
function(b){var c=this.index;a("number"==typeof b);a(0<b);return c.timescale!==b?(c.timescale=b,!0):!1};n.prototype.scale=function(b){a(0<this.index.timescale);return b/this.index.timescale};u.exports={OutOfIndexError:f,IndexHandler:n,getLiveEdge:function(a){var b=a.adaptations.video[0].representations[0].index;return m(b).getLiveEdge(b,a)}}},function(u,k,c){function f(a){var b=a.ts,c=a.d;a=a.r;return-1===c?b:b+(a+1)*c}function m(a){this.index=a;this.timeline=a.timeline}var n=c(1);m.getLiveEdge=function(a,
b){var c=f(n.last(a.timeline))/a.timescale-b.suggestedPresentationDelay;return Math.max(a.timeline[0].ts/a.timescale+1,c)};m.prototype.createSegment=function(a,b,c){return{id:a,media:this.index.media,time:a,number:void 0,range:b,duration:c}};m.prototype.calculateRepeat=function(a,b){var c=a.r||0;0>c&&(c=Math.ceil(((b?b.t:Infinity)-a.ts)/a.d)-1);return c};m.prototype.checkRange=function(a){var b=n.last(this.timeline);if(!b)return!0;0>b.d&&(b={ts:b.ts,d:0,r:b.r});return a<=f(b)};m.prototype.getSegmentIndex=
function(a){for(var b=this.timeline,c=0,f=b.length;c<f;){var l=c+f>>>1;b[l].ts<a?c=l+1:f=l}return 0<c?c-1:c};m.prototype.getSegmentNumber=function(a,b,c){a=b-a;return 0<a?Math.floor(a/c):0};m.prototype.getSegments=function(a,b){var c=this.index.timeline,f=[],l=c.length,m=this.getSegmentIndex(a)-1,g=c.length&&c[0].d||0;a:for(;!(++m>=l);){var e=c[m],h=e.d,B=e.ts,v=e.range,g=Math.max(g,h);if(0>h){B+g<b&&f.push(this.createSegment(B,v,void 0));break}for(var e=this.calculateRepeat(e,c[m+1]),q=this.getSegmentNumber(B,
a,h),d;(d=B+q*h)<b;)if(q++<=e)f.push(this.createSegment(d,v,h));else continue a;break}return f};m.prototype.addSegment=function(a,b){var c=this.timeline,m=c.length,l=c[m-1];if(b&&a.ts===b.ts){var n=a.ts+a.d,g=n-(l.ts+l.d*l.r);if(0>=g)return!1;-1===l.d&&((m=c[m-2])&&m.d===g?(m.r++,c.pop()):l.d=g);c.push({d:-1,ts:n,r:0});return!0}return a.ts>=f(l)?(l.d===a.d?l.r++:c.push({d:a.d,ts:a.ts,r:0}),!0):!1};u.exports=m},function(u,k,c){function f(a,c,f){a.id=a.id||b.uniqueId();var g=a.adaptations,g=g.concat(f||
[]),g=b.map(g,function(a){return m(a,c)}),g=b.filter(g,function(a){return 0>e.indexOf(a.type)?(p.warn("not supported adaptation type",a.type),!1):!0});t(0<g.length);a.adaptations=b.groupBy(g,"type");return a}function m(c,e){c.id=c.id||b.uniqueId();b.defaults(c,e);var f=b.pick(c,g),l=b.map(c.representations,function(a){a.id=a.id||b.uniqueId();b.defaults(a,f);var d=a.index;t(d);d.timescale||(d.timescale=1);a.bitrate||(a.bitrate=1);"mp4a.40.02"==a.codecs&&(a.codecs="mp4a.40.2");return a}).sort(function(a,
b){return a.bitrate-b.bitrate}),d=c.type,m=c.mimeType;m||(m=l[0].mimeType);t(m);c.mimeType=m;d||(d=c.type=m.split("/")[0]);if("video"==d||"audio"==d)l=b.filter(l,function(b){return x(a(b))});t(0<l.length,"manifest: no compatible representation for this adaptation");c.representations=l;c.bitrates=b.pluck(l,"bitrate");return c}function n(a){b.isArray(a)||(a=[a]);return b.flatten(a,function(a){var c=a.mimeType,e=a.url,d=a.language;a=a.languages;d&&(a=[d]);return b.map(a,function(a){return{id:b.uniqueId(),
type:"text",lang:a,mimeType:c,rootURL:e,baseURL:"",representations:[{id:b.uniqueId(),mimeType:c,index:{indexType:"template",duration:Number.MAX_VALUE,timescale:1,startNumber:0}}]}})})}function a(a){return a.mimeType+';codecs="'+a.codecs+'"'}var b=c(1),p=c(4),t=c(2),l=c(11).parseBaseURL,x=c(8).isCodecSupported,g="profiles width height frameRate audioSamplingRate mimeType segmentProfiles codecs maximumSAPPeriod maxPlayoutRate codingDependency index".split(" "),e=["audio","video","text"];u.exports={normalizeManifest:function(a,
c,e){t(c.transportType);c.id=c.id||b.uniqueId();c.type=c.type||"static";var g=c.locations;g&&g.length||(c.locations=[a]);c.isLive="dynamic"==c.type;var d={rootURL:l(c.locations[0]),baseURL:c.baseURL,isLive:c.isLive};e&&(e=n(e));a=b.map(c.periods,function(a){return f(a,d,e)});b.extend(c,a[0]);c.periods=null;c.duration||(c.duration=Infinity);c.isLive&&(c.suggestedPresentationDelay=c.suggestedPresentationDelay||15,c.availabilityStartTime=c.availabilityStartTime||0);return c},mergeManifestsIndex:function(a,
c){var e=a.adaptations,f=c.adaptations,d;for(d in e){var g=f[d];b.each(e[d],function(a,d){b.simpleMerge(a.index,g[d].index)})}return a},mutateManifestLiveGap:function(a){var b=1>=arguments.length||void 0===arguments[1]?1:arguments[1];a.isLive&&(a.presentationLiveGap+=b)},getCodec:a,getAdaptations:function(c){var e=c.adaptations,f=[];b.each(b.keys(e),function(b){var d=e[b];f.push({type:b,adaptations:d,codec:a(d[0].representations[0])})});return f},getAvailableSubtitles:function(a){return b.pluck(a.adaptations.text,
"lang")},getAvailableLanguages:function(a){return b.pluck(a.adaptations.audio,"lang")}}},function(u,k,c){function f(b,c){var f=b.playbackRate,l=b.duration,m=b.currentTime,g=b.readyState,e=b.buffered,h=a(m,e),k=n(m,h);return{name:c,ts:m,range:h,gap:k,duration:l,playback:f,readyState:g,stalled:null,buffered:e}}var m=c(3).Observable;k=c(7);var n=k.getGap,a=k.getRange;u.exports={timingsSampler:function(a){return m.create(function(c){function m(g){var h=e;g=f(a,g);var h=h.stalled,l=g.gap,d;(d=h||!(.5>=
l||Infinity===l))||(d=(d=g.range)?.5>=g.duration-(l+d.end):!1);d?h&&Infinity>l&&l>("seeking"==h.name?.5:5)&&(h=null):h={name:g.name,playback:g.playback};g.stalled=h;e=g;c.onNext(e)}function l(){m("play")}function n(){m("seeking")}function g(){m("seeked")}var e=f(a,"init"),h=setInterval(function(){return m("timeupdate")},1E3);a.addEventListener("play",l);a.addEventListener("seeking",n);a.addEventListener("seeked",g);c.onNext(e);return function(){a.removeEventListener("play",l);a.removeEventListener("seeking",
n);a.removeEventListener("seeked",g);clearInterval(h)}}).shareValue({name:"init",stalled:null})},seekingsSampler:function(a){return a.filter(function(a){return"seeking"==a.name&&(Infinity===a.gap||-2>a.gap)}).skip(1).startWith(!0)},getLiveGap:function(a,c){if(!c.isLive)return Infinity;var f=c.availabilityStartTime,l=c.presentationLiveGap;return Date.now()/1E3-a-(f+l+10)},toWallClockTime:function(a,c){return new Date(1E3*(a+c.availabilityStartTime))},fromWallClockTime:function(a,c){var f=a,l=c.suggestedPresentationDelay,
m=c.presentationLiveGap,g=c.timeShiftBufferDepth;"number"!=typeof f&&(f=f.getTime());var e=Date.now(),g=e-1E3*g;return Math.max(Math.min(f,e-1E3*(m+l)),g)/1E3-c.availabilityStartTime}}},function(u,k,c){var f;(function(m,n,a){(function(){function b(a){return"function"===typeof a}function p(){return function(){m.nextTick(g)}}function t(){var a=0,d=new da(g),b=document.createTextNode("");d.observe(b,{characterData:!0});return function(){b.data=a=++a%2}}function l(){var a=new MessageChannel;a.port1.onmessage=
g;return function(){a.port2.postMessage(0)}}function x(){return function(){setTimeout(g,1)}}function g(){for(var a=0;a<I;a+=2)(0,S[a])(S[a+1]),S[a]=void 0,S[a+1]=void 0;I=0}function e(){}function h(a,d,b,c){try{a.call(d,b,c)}catch(e){return e}}function B(a,d,b){U(function(a){var c=!1,e=h(b,d,function(b){c||(c=!0,d!==b?q(a,b):z(a,b))},function(b){c||(c=!0,D(a,b))},"Settle: "+(a._label||" unknown promise"));!c&&e&&(c=!0,D(a,e))},a)}function v(a,b){1===b._state?z(a,b._result):2===a._state?D(a,b._result):
u(b,void 0,function(b){q(a,b)},function(b){D(a,b)})}function q(a,d){if(a===d)D(a,new TypeError("You cannot resolve a promise with itself"));else if("function"===typeof d||"object"===typeof d&&null!==d)if(d.constructor===a.constructor)v(a,d);else{var c;try{c=d.then}catch(e){W.error=e,c=W}c===W?D(a,W.error):void 0===c?z(a,d):b(c)?B(a,d,c):z(a,d)}else z(a,d)}function d(a){a._onerror&&a._onerror(a._result);M(a)}function z(a,b){void 0===a._state&&(a._result=b,a._state=1,0!==a._subscribers.length&&U(M,
a))}function D(a,b){void 0===a._state&&(a._state=2,a._result=b,U(d,a))}function u(a,b,d,c){var e=a._subscribers,f=e.length;a._onerror=null;e[f]=b;e[f+1]=d;e[f+2]=c;0===f&&a._state&&U(M,a)}function M(a){var b=a._subscribers,d=a._state;if(0!==b.length){for(var c,e,f=a._result,g=0;g<b.length;g+=3)c=b[g],e=b[g+d],c?y(d,c,e,f):e(f);a._subscribers.length=0}}function N(){this.error=null}function y(a,d,c,e){var f=b(c),g,h,l,m;if(f){try{g=c(e)}catch(n){ha.error=n,g=ha}g===ha?(m=!0,h=g.error,g=null):l=!0;if(d===
g){D(d,new TypeError("A promises callback cannot return that same promise."));return}}else g=e,l=!0;void 0===d._state&&(f&&l?q(d,g):m?D(d,h):1===a?z(d,g):2===a&&D(d,g))}function F(a,d){try{d(function(d){q(a,d)},function(d){D(a,d)})}catch(b){D(a,b)}}function E(a,d,b,c){this._instanceConstructor=a;this.promise=new a(e,c);this._abortOnReject=b;this._validateInput(d)?(this._input=d,this._remaining=this.length=d.length,this._init(),0===this.length?z(this.promise,this._result):(this.length=this.length||
0,this._enumerate(),0===this._remaining&&z(this.promise,this._result))):D(this.promise,this._validationError())}function L(a){this._id=ja++;this._result=this._state=void 0;this._subscribers=[];if(e!==a){if(!b(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof L))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");F(this,a)}}var Y=Array.isArray?
Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},I=0,U=function(a,d){S[I]=a;S[I+1]=d;I+=2;2===I&&ea()},J="undefined"!==typeof window?window:{},da=J.MutationObserver||J.WebKitMutationObserver,J="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,S=Array(1E3),ea;ea="undefined"!==typeof m&&"[object process]"==={}.toString.call(m)?p():da?t():J?l():x();var W=new N,ha=new N;E.prototype._validateInput=function(a){return Y(a)};
E.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};E.prototype._init=function(){this._result=Array(this.length)};E.prototype._enumerate=function(){for(var a=this.length,d=this.promise,b=this._input,c=0;void 0===d._state&&c<a;c++)this._eachEntry(b[c],c)};E.prototype._eachEntry=function(a,d){var b=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===b&&void 0!==a._state?(a._onerror=null,this._settledAt(a._state,d,a._result)):this._willSettleAt(b.resolve(a),
d):(this._remaining--,this._result[d]=this._makeResult(1,d,a))};E.prototype._settledAt=function(a,d,b){var c=this.promise;void 0===c._state&&(this._remaining--,this._abortOnReject&&2===a?D(c,b):this._result[d]=this._makeResult(a,d,b));0===this._remaining&&z(c,this._result)};E.prototype._makeResult=function(a,d,b){return b};E.prototype._willSettleAt=function(a,d){var b=this;u(a,void 0,function(a){b._settledAt(1,d,a)},function(a){b._settledAt(2,d,a)})};var ja=0;L.all=function(a,d){return(new E(this,
a,!0,d)).promise};L.race=function(a,d){function b(a){q(f,a)}function c(a){D(f,a)}var f=new this(e,d);if(!Y(a))return D(f,new TypeError("You must pass an array to race.")),f;for(var g=a.length,h=0;void 0===f._state&&h<g;h++)u(this.resolve(a[h]),void 0,b,c);return f};L.resolve=function(a,d){if(a&&"object"===typeof a&&a.constructor===this)return a;var b=new this(e,d);q(b,a);return b};L.reject=function(a,d){var b=new this(e,d);D(b,a);return b};L.prototype={constructor:L,then:function(a,d){var b=this._state;
if(1===b&&!a||2===b&&!d)return this;var c=new this.constructor(e),f=this._result;if(b){var g=arguments[b-1];U(function(){y(b,c,g,f)})}else u(this,c,a,d);return c},"catch":function(a){return this.then(null,a)}};var fa={Promise:L,polyfill:function(){var a;a="undefined"!==typeof n?n:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var d;new a.Promise(function(a){d=a});return b(d)}()||
(a.Promise=L)}};c(48).amd?!(f=function(){return fa}.call(k,c,k,a),void 0!==f&&(a.exports=f)):"undefined"!==typeof a&&a.exports?a.exports=fa:"undefined"!==typeof this&&(this.ES6Promise=fa)}).call(this)}).call(k,c(14),function(){return this}(),c(13)(u))},function(u,k,c){var f;(function(m,n,a){(function(b){function p(a){for(var r=a.length,d=Array(r),b=0;b<r;b++)d[b]=a[b];return d}function t(){if(pa)try{throw Error();}catch(a){var r=a.stack.split("\n"),r=0<r[0].indexOf("@")?r[1]:r[2];if(r=l(r))return Ab=
r[0],r[1]}}function l(a){var r=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(a);if(r||(r=/at ([^ ]+):(\d+):(?:\d+)$/.exec(a)))return[r[1],Number(r[2])];if(a=/.*@(.+):(\d+)$/.exec(a))return[a[1],Number(a[2])]}function x(a,r){var d=-1;var b=a,c=[];if(Qb(b)){xa.nonEnumArgs&&b.length&&ab(b)&&(b=Rb.call(b));var Z=xa.enumPrototypes&&"function"==typeof b,e=xa.enumErrorProps&&(b===bb||b instanceof Error),f;for(f in b)Z&&"prototype"==f||e&&("message"==f||"name"==f)||c.push(f);if(xa.nonEnumShadows&&b!==Bb){f=b.constructor;
Z=-1;e=Sb;if(b===(f&&f.prototype))var g=b===Tb?"[object String]":b===bb?"[object Error]":Da.call(b),g=za[g];for(;++Z<e;)f=Cb[Z],g&&g[f]||!Ma.call(b,f)||c.push(f)}}for(b=c.length;++d<b&&(g=c[d],!1!==r(a[g],g,a)););return a}function g(a){return"function"!=typeof a.toString&&"string"==typeof(a+"")}function e(a,r,b,d){if(a===r)return 0!==a||1/a==1/r;var c=typeof a,Z=typeof r;if(a===a&&(null==a||null==r||"function"!=c&&"object"!=c&&"function"!=Z&&"object"!=Z))return!1;Z=Da.call(a);c=Da.call(r);"[object Arguments]"==
Z&&(Z="[object Object]");"[object Arguments]"==c&&(c="[object Object]");if(Z!=c)return!1;switch(Z){case "[object Boolean]":case "[object Date]":return+a==+r;case "[object Number]":return a!=+a?r!=+r:0==a?1/a==1/r:a==+r;case "[object RegExp]":case "[object String]":return a==String(r)}c="[object Array]"==Z;if(!c){if("[object Object]"!=Z||!xa.nodeClass&&(g(a)||g(r)))return!1;var Z=!xa.argsObject&&ab(a)?Object:a.constructor,f=!xa.argsObject&&ab(r)?Object:r.constructor;if(!(Z==f||Ma.call(a,"constructor")&&
Ma.call(r,"constructor")||V(Z)&&Z instanceof Z&&V(f)&&f instanceof f)&&"constructor"in a&&"constructor"in r)return!1}b||(b=[]);d||(d=[]);for(Z=b.length;Z--;)if(b[Z]==a)return d[Z]==r;var h=0,l=!0;b.push(a);d.push(r);if(c){if(Z=a.length,h=r.length,l=h==Z)for(;h--&&(l=e(a[h],r[h],b,d)););}else x(r,function(r,c,ua){if(Ma.call(ua,c))return h++,l=Ma.call(a,c)&&e(a[c],r,b,d)}),l&&x(a,function(a,C,r){if(Ma.call(r,C))return l=-1<--h});b.pop();d.pop();return l}function h(){try{return Db.apply(this,arguments)}catch(a){return ka.e=
a,ka}}function B(a){if(!V(a))throw new TypeError("fn must be a function");Db=a;return h}function v(a,r){for(var b=Array(a),d=0;d<a;d++)b[d]=r();return b}function q(a,r){this.id=a;this.value=r}function d(a){this.observer=a;this.a=[];this.isStopped=!1}function z(a){this._s=s}function D(a){this._s=s;this._l=s.length;this._i=0}function u(a){this._a=a}function M(a){this._a=a;a=+a.length;if(isNaN(a))a=0;else if(0!==a&&"number"===typeof a&&K.isFinite(a)){var r;r=+a;r=0===r?r:isNaN(r)?r:0>r?-1:1;a=r*Math.floor(Math.abs(a));
a=0>=a?0:a>Eb?Eb:a}this._l=a;this._i=0}function N(a){var r=a[ia];if(!r&&"string"===typeof a)return a=new z(a),a[ia]();if(!r&&a.length!==b)return a=new u(a),a[ia]();if(!r)throw new TypeError("Object is not iterable");return a[ia]()}function y(a,r){this.observer=a;this.parent=r}function F(a,r){ba(a)||(a=qa);return new cb(r,a)}function E(a,r){this.observer=a;this.parent=r}function L(a,r){this.observer=a;this.parent=r}function Y(a,r){return new G(function(b){var d=new P,c=new ra;c.setDisposable(d);d.setDisposable(a.subscribe(function(a){b.onNext(a)},
function(a){try{var C=r(a)}catch(d){return b.onError(d)}aa(C)&&(C=ca(C));a=new P;c.setDisposable(a);a.setDisposable(C.subscribe(b))},function(a){b.onCompleted(a)}));return c},a)}function I(a,r){var b=this;return new G(function(d){var c=0,e=a.length;return b.subscribe(function(b){if(c<e){var T=a[c++],f;try{f=r(b,T)}catch(g){return d.onError(g)}d.onNext(f)}else d.onCompleted()},function(a){d.onError(a)},function(){d.onCompleted()})},b)}function U(){return!1}function J(){return[]}function da(a,r,b){var d=
Ea(r,b,3);return a.map(function(r,b){var c=d(r,b,a);aa(c)&&(c=ca(c));(db(c)||eb(c))&&(c=fb(c));return c}).concatAll()}function S(a,r,b){this.observer=a;this.selector=r;this.source=b;this.i=0;this.isStopped=!1}function ea(a,r,b){var d=Ea(r,b,3);return a.map(function(r,b){var c=d(r,b,a);aa(c)&&(c=ca(c));(db(c)||eb(c))&&(c=fb(c));return c}).mergeAll()}function W(a,r,b){this.observer=a;this.predicate=r;this.source=b;this.i=0;this.isStopped=!1}function ha(a,r,b){if(a.addEventListener)return a.addEventListener(r,
b,!1),ma(function(){a.removeEventListener(r,b,!1)});throw Error("No listener found");}function ja(a,r,b){var d=new Q;if("[object NodeList]"===Object.prototype.toString.call(a))for(var c=0,e=a.length;c<e;c++)d.add(ja(a.item(c),r,b));else a&&d.add(ha(a,r,b));return d}function fa(a,r){return new G(function(b){return r.scheduleWithAbsolute(a,function(){b.onNext(0);b.onCompleted()})})}function sa(a,r,b){return new G(function(d){var c=a,e=ob(r);return b.scheduleRecursiveWithAbsoluteAndState(0,c,function(a,
r){if(0<e){var C=b.now();c+=e;c<=C&&(c=C+e)}d.onNext(a);r(a+1,c)})})}function va(a,r){return new G(function(b){return r.scheduleWithRelative(ob(a),function(){b.onNext(0);b.onCompleted()})})}function Na(a,r,b){return a===r?new G(function(a){return b.schedulePeriodicWithState(0,r,function(b){a.onNext(b);return b+1})}):pb(function(){return sa(b.now()+a,r,b)})}function Ya(a,b,d){return new G(function(c){var ua=!1,e=new ra,f=null,g=[],h=!1,l;l=a.materialize().timestamp(d).subscribe(function(a){"E"===a.value.kind?
(g=[],g.push(a),f=a.value.exception,a=!h):(g.push({value:a.value,timestamp:a.timestamp+b}),a=!ua,ua=!0);if(a)if(null!==f)c.onError(f);else a=new P,e.setDisposable(a),a.setDisposable(d.scheduleRecursiveWithRelative(b,function(a){var b,r,C;if(null===f){h=!0;do b=null,0<g.length&&0>=g[0].timestamp-d.now()&&(b=g.shift().value),null!==b&&b.accept(c);while(null!==b);C=!1;r=0;0<g.length?(C=!0,r=Math.max(0,g[0].timestamp-d.now())):ua=!1;b=f;h=!1;if(null!==b)c.onError(b);else C&&a(r)}}))});return new Q(l,
e)},a)}function mb(a,b,d){return pb(function(){return Ya(a,b-d.now(),d)})}function Za(a,b){return new G(function(d){function c(){f&&(f=!1,d.onNext(e));ua&&d.onCompleted()}var ua,e,f;return new Q(a.subscribe(function(a){f=!0;e=a},d.onError.bind(d),function(){ua=!0}),b.subscribe(c,d.onError.bind(d),c))},a)}function nb(a,b,d){return new G(function(c){function ua(a,b){h[b]=a;var r;e[b]=!0;if(f||(f=e.every(ya))){if(l){c.onError(l);return}try{r=d.apply(null,h)}catch(C){c.onError(C);return}c.onNext(r)}if(g&&
h[1])c.onCompleted()}var e=[!1,!1],f=!1,g=!1,h=Array(2),l;return new Q(a.subscribe(function(a){ua(a,0)},function(a){if(h[1])c.onError(a);else l=a},function(){g=!0;h[1]&&c.onCompleted()}),b.subscribe(function(a){ua(a,1)},function(a){c.onError(a)},function(){g=!0;ua(!0,1)}))},a)}var La={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},K=La[typeof window]&&window||this,Sa=La[typeof k]&&k&&!k.nodeType&&k,Ta=La[typeof m]&&m&&!m.nodeType&&m,$a=Ta&&Ta.exports===Sa&&Sa,wa=La[typeof n]&&
n;!wa||wa.global!==wa&&wa.window!==wa||(K=wa);var A={internals:{},config:{Promise:K.Promise},helpers:{}},R=A.helpers.noop=function(){};A.helpers.notDefined=function(a){return"undefined"===typeof a};var ya=A.helpers.identity=function(a){return a};A.helpers.pluck=function(a){return function(b){return b[a]}};A.helpers.just=function(a){return function(){return a}};var Ba=A.helpers.defaultNow=Date.now,qb=A.helpers.defaultComparer=function(a,b){return Ub(a,b)},Fa=A.helpers.defaultSubComparer=function(a,
b){return a>b?1:a<b?-1:0};A.helpers.defaultKeySerializer=function(a){return a.toString()};var rb=A.helpers.defaultError=function(a){throw a;},aa=A.helpers.isPromise=function(a){return!!a&&"function"===typeof a.then};A.helpers.asArray=function(){return Array.prototype.slice.call(arguments)};A.helpers.not=function(a){return!a};var V=A.helpers.isFunction=function(){var a=function(a){return"function"==typeof a||!1};a(/x/)&&(a=function(a){return"function"==typeof a&&"[object Function]"==Da.call(a)});return a}(),
pa=A.config.longStackSupport=!1;try{throw Error();}catch(Oa){pa=!!Oa.stack}var Vb=t(),Ab;(A.EmptyError=function(){this.message="Sequence contains no elements.";Error.call(this)}).prototype=Error.prototype;var Fb=A.ObjectDisposedError=function(){this.message="Object has been disposed";Error.call(this)};Fb.prototype=Error.prototype;var Ua=A.ArgumentOutOfRangeError=function(){this.message="Argument out of range";Error.call(this)};Ua.prototype=Error.prototype;var Va=A.NotSupportedError=function(a){this.message=
a||"This operation is not supported";Error.call(this)};Va.prototype=Error.prototype;var Gb=A.NotImplementedError=function(a){this.message=a||"This operation is not implemented";Error.call(this)};Gb.prototype=Error.prototype;var gb=A.helpers.notImplemented=function(){throw new Gb;},hb=A.helpers.notSupported=function(){throw new Va;},ia="function"===typeof Symbol&&Symbol.iterator||"_es6shim_iterator_";K.Set&&"function"===typeof(new K.Set)["@@iterator"]&&(ia="@@iterator");var ib=A.doneEnumerator={done:!0,
value:b},eb=A.helpers.isIterable=function(a){return a[ia]!==b},db=A.helpers.isArrayLike=function(a){return a&&a.length!==b};A.helpers.iterator=ia;var Ea=A.internals.bindCallback=function(a,b,d){if("undefined"===typeof b)return a;switch(d){case 0:return function(){return a.call(b)};case 1:return function(d){return a.call(b,d)};case 2:return function(d,c){return a.call(b,d,c)};case 3:return function(d,c,T){return a.call(b,d,c,T)}}return function(){return a.apply(b,arguments)}},Cb="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),
Sb=Cb.length,Da=Object.prototype.toString,Ma=Object.prototype.hasOwnProperty,Wb="[object Arguments]"==Da.call(arguments),bb=Error.prototype,Bb=Object.prototype,Tb=String.prototype,sb=Bb.propertyIsEnumerable;try{Da.call(document)}catch(Gc){}var za={};za["[object Array]"]=za["[object Date]"]=za["[object Number]"]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0};za["[object Boolean]"]=za["[object String]"]={constructor:!0,toString:!0,valueOf:!0};za["[object Error]"]=za["[object Function]"]=
za["[object RegExp]"]={constructor:!0,toString:!0};za["[object Object]"]={constructor:!0};var xa={};(function(){var a=function(){this.x=1},b=[];a.prototype={valueOf:1,y:1};for(var d in new a)b.push(d);for(d in arguments);xa.enumErrorProps=sb.call(bb,"message")||sb.call(bb,"name");xa.enumPrototypes=sb.call(a,"prototype");xa.nonEnumArgs=0!=d;xa.nonEnumShadows=!/valueOf/.test(b)})(1);var Qb=A.internals.isObject=function(a){var b=typeof a;return a&&("function"==b||"object"==b)||!1},ab=function(a){return a&&
"object"==typeof a?"[object Arguments]"==Da.call(a):!1};Wb||(ab=function(a){return a&&"object"==typeof a?Ma.call(a,"callee"):!1});var Ub=A.internals.isEqual=function(a,b){return e(a,b,[],[])},ka={e:{}},Db,Rb=Array.prototype.slice,O=this.inherits=A.internals.inherits=function(a,b){function d(){this.constructor=a}d.prototype=b.prototype;a.prototype=new d},Pa=A.internals.addProperties=function(a){for(var b=[],d=1,c=arguments.length;d<c;d++)b.push(arguments[d]);d=0;for(c=b.length;d<c;d++){var e=b[d],
f;for(f in e)a[f]=e[f]}};A.internals.addRef=function(a,b){return new G(function(d){return new Q(b.getDisposable(),a.subscribe(d))})};q.prototype.compareTo=function(a){var b=this.value.compareTo(a.value);0===b&&(b=this.id-a.id);return b};var jb=A.internals.PriorityQueue=function(a){this.items=Array(a);this.length=0},Ga=jb.prototype;Ga.isHigherPriority=function(a,b){return 0>this.items[a].compareTo(this.items[b])};Ga.percolate=function(a){if(!(a>=this.length||0>a)){var b=a-1>>1;if(!(0>b||b===a)&&this.isHigherPriority(a,
b)){var d=this.items[a];this.items[a]=this.items[b];this.items[b]=d;this.percolate(b)}}};Ga.heapify=function(a){+a||(a=0);if(!(a>=this.length||0>a)){var b=2*a+1,d=2*a+2,c=a;b<this.length&&this.isHigherPriority(b,c)&&(c=b);d<this.length&&this.isHigherPriority(d,c)&&(c=d);c!==a&&(b=this.items[a],this.items[a]=this.items[c],this.items[c]=b,this.heapify(c))}};Ga.peek=function(){return this.items[0].value};Ga.removeAt=function(a){this.items[a]=this.items[--this.length];this.items[this.length]=b;this.heapify()};
Ga.dequeue=function(){var a=this.peek();this.removeAt(0);return a};Ga.enqueue=function(a){var b=this.length++;this.items[b]=new q(jb.count++,a);this.percolate(b)};Ga.remove=function(a){for(var b=0;b<this.length;b++)if(this.items[b].value===a)return this.removeAt(b),!0;return!1};jb.count=0;var Q=A.CompositeDisposable=function(){var a=[],b,d;if(Array.isArray(arguments[0]))a=arguments[0],d=a.length;else for(d=arguments.length,a=Array(d),b=0;b<d;b++)a[b]=arguments[b];for(b=0;b<d;b++)if(!Xb(a[b]))throw new TypeError("Not a disposable");
this.disposables=a;this.isDisposed=!1;this.length=a.length},tb=Q.prototype;tb.add=function(a){this.isDisposed?a.dispose():(this.disposables.push(a),this.length++)};tb.remove=function(a){var b=!1;if(!this.isDisposed){var d=this.disposables.indexOf(a);-1!==d&&(b=!0,this.disposables.splice(d,1),this.length--,a.dispose())}return b};tb.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var a=this.disposables.length,b=Array(a),d=0;d<a;d++)b[d]=this.disposables[d];this.disposables=[];for(d=this.length=
0;d<a;d++)b[d].dispose()}};var Qa=A.Disposable=function(a){this.isDisposed=!1;this.action=a||R};Qa.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var ma=Qa.create=function(a){return new Qa(a)},la=Qa.empty={dispose:R},Xb=Qa.isDisposable=function(a){return a&&V(a.dispose)},ga=Qa.checkDisposed=function(a){if(a.isDisposed)throw new Fb;},P=A.SingleAssignmentDisposable=function(){this.isDisposed=!1;this.current=null};P.prototype.getDisposable=function(){return this.current};
P.prototype.setDisposable=function(a){if(this.current)throw Error("Disposable has already been assigned");var b=this.isDisposed;!b&&(this.current=a);b&&a&&a.dispose()};P.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};var ra=A.SerialDisposable=function(){this.isDisposed=!1;this.current=null};ra.prototype.getDisposable=function(){return this.current};ra.prototype.setDisposable=function(a){var b=this.isDisposed;if(!b){var d=this.current;
this.current=a}d&&d.dispose();b&&a&&a.dispose()};ra.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};A.RefCountDisposable=function(){function a(b){this.disposable=b;this.disposable.count++;this.isInnerDisposed=!1}function b(a){this.underlyingDisposable=a;this.isPrimaryDisposed=this.isDisposed=!1;this.count=0}a.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,
0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))};b.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))};b.prototype.getDisposable=function(){return this.isDisposed?la:new a(this)};return b}();var Wa=A.internals.ScheduledItem=function(a,b,d,c,e){this.scheduler=a;this.state=b;this.action=d;
this.dueTime=c;this.comparer=e||Fa;this.disposable=new P};Wa.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())};Wa.prototype.compareTo=function(a){return this.comparer(this.dueTime,a.dueTime)};Wa.prototype.isCancelled=function(){return this.disposable.isDisposed};Wa.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var na=A.Scheduler=function(){function a(b,d,c,r){this.now=b;this._schedule=d;this._scheduleRelative=c;this._scheduleAbsolute=r}
function b(a,d){d();return la}a.isScheduler=function(b){return b instanceof a};var d=a.prototype;d.schedule=function(a){return this._schedule(a,b)};d.scheduleWithState=function(a,b){return this._schedule(a,b)};d.scheduleWithRelative=function(a,d){return this._scheduleRelative(d,a,b)};d.scheduleWithRelativeAndState=function(a,b,d){return this._scheduleRelative(a,b,d)};d.scheduleWithAbsolute=function(a,d){return this._scheduleAbsolute(d,a,b)};d.scheduleWithAbsoluteAndState=function(a,b,d){return this._scheduleAbsolute(a,
b,d)};a.now=Ba;a.normalize=function(a){0>a&&(a=0);return a};return a}(),ob=na.normalize,ba=na.isScheduler;(function(a){function b(a,d){function c(b){C(b,function(b){var d=!1,r=!1,C=a.scheduleWithState(b,function(a,b){d?T.remove(C):r=!0;c(b);return la});r||(T.add(C),d=!0)})}var r=d[0],C=d[1],T=new Q;c(r);return T}function d(a,b,c){function r(b){T(b,function(b,d){var C=!1,T=!1,e=a[c](b,d,function(a,b){C?ta.remove(e):T=!0;r(b);return la});T||(ta.add(e),C=!0)})}var C=b[0],T=b[1],ta=new Q;r(C);return ta}
function c(a,b){a(function(d){b(a,d)})}a.scheduleRecursive=function(a){return this.scheduleRecursiveWithState(a,function(a,b){a(function(){b(a)})})};a.scheduleRecursiveWithState=function(a,d){return this.scheduleWithState([a,d],b)};a.scheduleRecursiveWithRelative=function(a,b){return this.scheduleRecursiveWithRelativeAndState(b,a,c)};a.scheduleRecursiveWithRelativeAndState=function(a,b,c){return this._scheduleRelative([a,c],b,function(a,b){return d(a,b,"scheduleWithRelativeAndState")})};a.scheduleRecursiveWithAbsolute=
function(a,b){return this.scheduleRecursiveWithAbsoluteAndState(b,a,c)};a.scheduleRecursiveWithAbsoluteAndState=function(a,b,c){return this._scheduleAbsolute([a,c],b,function(a,b){return d(a,b,"scheduleWithAbsoluteAndState")})}})(na.prototype);(function(a){na.prototype.schedulePeriodic=function(a,b){return this.schedulePeriodicWithState(null,a,b)};na.prototype.schedulePeriodicWithState=function(a,b,d){if("undefined"===typeof K.setInterval)throw new Va;b=ob(b);var c=a,C=K.setInterval(function(){c=
d(c)},b);return ma(function(){K.clearInterval(C)})}})(na.prototype);var Aa=na.immediate=function(){return new na(Ba,function(a,b){return b(this,a)},hb,hb)}(),qa=na.currentThread=function(){function a(){for(;0<b.length;){var d=b.dequeue();!d.isCancelled()&&d.invoke()}}var b,d=new na(Ba,function(d,c){var T=new Wa(this,d,c,this.now());if(b)b.enqueue(T);else{b=new jb(4);b.enqueue(T);var e=B(a)();b=null;if(e===ka)throw e.e;}return T.disposable},hb,hb);d.scheduleRequired=function(){return!b};return d}();
A.internals.SchedulePeriodicRecursive=function(){function a(b,d){d(0,this._period);try{this._state=this._action(this._state)}catch(c){throw this._cancel.dispose(),c;}}function b(a,d,c,r){this._scheduler=a;this._state=d;this._period=c;this._action=r}b.prototype.start=function(){var b=new P;this._cancel=b;b.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this)));return b};return b}();var Ra,ub,Hb=function(){var a,b=R;if(K.setTimeout)a=K.setTimeout,b=K.clearTimeout;
else if(K.WScript)a=function(a,b){K.WScript.Sleep(b);a()};else throw new Va;return{setTimeout:a,clearTimeout:b}}(),vb=Hb.setTimeout,Yb=Hb.clearTimeout;(function(){function b(a){if(e)vb(function(){b(a)},0);else{var d=ta[a];if(d&&(e=!0,d=B(d)(),ub(a),e=!1,d===ka))throw d.e;}}function d(){if(!K.postMessage||K.importScripts)return!1;var a=!1,b=K.onmessage;K.onmessage=function(){a=!0};K.postMessage("","*");K.onmessage=b;return a}var c=1,ta={},e=!1;ub=function(a){delete ta[a]};var f=RegExp("^"+String(Da).replace(/[.*+?^${}()|[\]\\]/g,
"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),g="function"==typeof(g=wa&&$a&&wa.setImmediate)&&!f.test(g)&&g;if(V(g))Ra=function(a){var d=c++;ta[d]=a;g(function(){b(d)});return d};else if("undefined"!==typeof a&&"[object process]"==={}.toString.call(a))Ra=function(d){var r=c++;ta[r]=d;a.nextTick(function(){b(r)});return r};else if(d()){var f=function(a){"string"===typeof a.data&&a.data.substring(0,h.length)===h&&b(a.data.substring(h.length))},h="ms.rx.schedule"+Math.random();K.addEventListener?
K.addEventListener("message",f,!1):K.attachEvent?K.attachEvent("onmessage",f):K.onmessage=f;Ra=function(a){var b=c++;ta[b]=a;K.postMessage(h+currentId,"*");return b}}else if(K.MessageChannel){var l=new K.MessageChannel;l.port1.onmessage=function(a){b(a.data)};Ra=function(a){var b=c++;ta[b]=a;l.port2.postMessage(b);return b}}else Ra="document"in K&&"onreadystatechange"in K.document.createElement("script")?function(a){var d=K.document.createElement("script"),r=c++;ta[r]=a;d.onreadystatechange=function(){b(r);
d.onreadystatechange=null;d.parentNode.removeChild(d);d=null};K.document.documentElement.appendChild(d);return r}:function(a){var d=c++;ta[d]=a;vb(function(){b(d)},0);return d}})();var Ha=na.timeout=na["default"]=function(){return new na(Ba,function(a,b){var d=this,c=new P,e=Ra(function(){!c.isDisposed&&c.setDisposable(b(d,a))});return new Q(c,ma(function(){ub(e)}))},function(a,b,d){var c=this;b=na.normalize(b);var e=new P;if(0===b)return c.scheduleWithState(a,d);var f=vb(function(){!e.isDisposed&&
e.setDisposable(d(c,a))},b);return new Q(e,ma(function(){Yb(f)}))},function(a,b,d){return this.scheduleWithRelativeAndState(a,b-this.now(),d)})}(),Ca=A.Notification=function(){function a(b,d,c,C,e,f){this.kind=b;this.value=d;this.exception=c;this._accept=C;this._acceptObservable=e;this.toString=f}a.prototype.accept=function(a,b,d){return a&&"object"===typeof a?this._acceptObservable(a):this._accept(a,b,d)};a.prototype.toObservable=function(a){var b=this;ba(a)||(a=Aa);return new G(function(d){return a.scheduleWithState(b,
function(a,b){b._acceptObservable(d);"N"===b.kind&&d.onCompleted()})})};return a}(),Zb=Ca.createOnNext=function(){function a(b){return b(this.value)}function b(a){return a.onNext(this.value)}function d(){return"OnNext("+this.value+")"}return function(c){return new Ca("N",c,null,a,b,d)}}(),$b=Ca.createOnError=function(){function a(b,d){return d(this.exception)}function b(a){return a.onError(this.exception)}function d(){return"OnError("+this.exception+")"}return function(c){return new Ca("E",null,c,
a,b,d)}}(),ac=Ca.createOnCompleted=function(){function a(b,d,c){return c()}function b(a){return a.onCompleted()}function d(){return"OnCompleted()"}return function(){return new Ca("C",null,null,a,b,d)}}(),kb=A.internals.Enumerator=function(a){this._next=a};kb.prototype.next=function(){return this._next()};kb.prototype[ia]=function(){return this};var Ia=A.internals.Enumerable=function(a){this._iterator=a};Ia.prototype[ia]=function(){return this._iterator()};Ia.prototype.concat=function(){var a=this;
return new G(function(b){var d=a[ia](),c,e=new ra,f=Aa.scheduleRecursive(function(a){if(!c){try{var C=d.next()}catch(f){return b.onError(f)}if(C.done)return b.onCompleted();C=C.value;aa(C)&&(C=ca(C));var g=new P;e.setDisposable(g);g.setDisposable(C.subscribe(function(a){b.onNext(a)},function(a){b.onError(a)},a))}});return new Q(e,f,ma(function(){c=!0}))})};Ia.prototype.catchError=function(){var a=this;return new G(function(b){var d=a[ia](),c,e=new ra,f=Aa.scheduleRecursiveWithState(null,function(a,
C){if(!c){try{var f=d.next()}catch(g){return observer.onError(g)}if(f.done)if(null!==a)b.onError(a);else b.onCompleted();else{f=f.value;aa(f)&&(f=ca(f));var h=new P;e.setDisposable(h);h.setDisposable(f.subscribe(function(a){b.onNext(a)},C,function(){b.onCompleted()}))}}});return new Q(e,f,ma(function(){c=!0}))})};Ia.prototype.catchErrorWhen=function(a){var b=this;return new G(function(d){var c=new Ja,e=new Ja,f=a(c).subscribe(e),g=b[ia](),h,l=new ra,m=Aa.scheduleRecursive(function(a){if(!h){try{var b=
g.next()}catch(r){return d.onError(r)}if(b.done)d.onCompleted();else{b=b.value;aa(b)&&(b=ca(b));var C=new P,f=new P;l.setDisposable(new Q(f,C));C.setDisposable(b.subscribe(function(a){d.onNext(a)},function(b){f.setDisposable(e.subscribe(a,function(a){d.onError(a)},function(){d.onCompleted()}));c.onNext(b)},function(){d.onCompleted()}))}}});return new Q(f,l,m,ma(function(){h=!0}))})};var wb=Ia.repeat=function(a,b){null==b&&(b=-1);return new Ia(function(){var d=b;return new kb(function(){if(0===d)return ib;
0<d&&d--;return{done:!1,value:a}})})},xb=Ia.of=function(a,b,d){if(b)var c=Ea(b,d,3);return new Ia(function(){var d=-1;return new kb(function(){return++d<a.length?{done:!1,value:b?c(a[d],d,a):a[d]}:ib})})},Ka=A.Observer=function(){},Xa=Ka.create=function(a,b,d){a||(a=R);b||(b=rb);d||(d=R);return new bc(a,b,d)},yb=A.internals.AbstractObserver=function(a){function b(){this.isStopped=!1;a.call(this)}O(b,a);b.prototype.next=gb;b.prototype.error=gb;b.prototype.completed=gb;b.prototype.onNext=function(a){this.isStopped||
this.next(a)};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.error(a))};b.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.error(a),!0)};return b}(Ka),bc=A.AnonymousObserver=function(a){function b(d,c,r){a.call(this);this._onNext=d;this._onError=c;this._onCompleted=r}O(b,a);b.prototype.next=function(a){this._onNext(a)};
b.prototype.error=function(a){this._onError(a)};b.prototype.completed=function(){this._onCompleted()};return b}(yb),w,H=A.Observable=function(){function a(b){if(A.config.longStackSupport&&pa){try{throw Error();}catch(d){this.stack=d.stack.substring(d.stack.indexOf("\n")+1)}var c=this;this._subscribe=function(a){var d=a.onError.bind(a);a.onError=function(a){if(pa&&c.stack&&"object"===typeof a&&null!==a&&a.stack&&-1===a.stack.indexOf("From previous event:")){for(var b=[],r=c;r;r=r.source)r.stack&&b.unshift(r.stack);
b.unshift(a.stack);for(var b=b.join("\nFrom previous event:\n").split("\n"),r=[],C=0,T=b.length;C<T;C++){var e=b[C],f;if(f=l(e)){var g=f[1];f=f[0]===Ab&&g>=Vb&&g<=cc}else f=!1;if(f=!f)f=e,f=!(-1!==f.indexOf("(module.js:")||-1!==f.indexOf("(node.js:"));f&&e&&r.push(e)}b=r.join("\n");a.stack=b}d(a)};return b.call(c,a)}}else this._subscribe=b}w=a.prototype;w.subscribe=w.forEach=function(a,b,d){return this._subscribe("object"===typeof a?a:Xa(a,b,d))};w.subscribeOnNext=function(a,b){return this._subscribe(Xa("undefined"!==
typeof b?function(d){a.call(b,d)}:a))};w.subscribeOnError=function(a,b){return this._subscribe(Xa(null,"undefined"!==typeof b?function(d){a.call(b,d)}:a))};w.subscribeOnCompleted=function(a,b){return this._subscribe(Xa(null,null,"undefined"!==typeof b?function(){a.call(b)}:a))};return a}(),dc=A.internals.ScheduledObserver=function(a){function b(d,c){a.call(this);this.scheduler=d;this.observer=c;this.hasFaulted=this.isAcquired=!1;this.queue=[];this.disposable=new ra}O(b,a);b.prototype.next=function(a){var b=
this;this.queue.push(function(){b.observer.onNext(a)})};b.prototype.error=function(a){var b=this;this.queue.push(function(){b.observer.onError(a)})};b.prototype.completed=function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})};b.prototype.ensureActive=function(){var a=!1,b=this;!this.hasFaulted&&0<this.queue.length&&(a=!this.isAcquired,this.isAcquired=!0);a&&this.disposable.setDisposable(this.scheduler.scheduleRecursive(function(a){var d;if(0<b.queue.length){d=b.queue.shift();
try{d()}catch(c){throw b.queue=[],b.hasFaulted=!0,c;}a()}else b.isAcquired=!1}))};b.prototype.dispose=function(){a.prototype.dispose.call(this);this.disposable.dispose()};return b}(yb),oa=A.ObservableBase=function(a){function b(a){return a&&V(a.dispose)?a:V(a)?ma(a):la}function d(a,c){var C=c[0],T=c[1],T=B(T.subscribeCore).call(T,C);if(T===ka&&!C.fail(ka.e))throw ka.e;C.setDisposable(b(T))}function c(a){a=new Ib(a);var b=[a,this];qa.scheduleRequired()?qa.scheduleWithState(b,d):d(null,b);return a}
function e(){a.call(this,c)}O(e,a);e.prototype.subscribeCore=gb;return e}(H),ec=function(a){function b(d){this.source=d;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new d(a))};return b}(oa);d.prototype.onNext=function(a){this.isStopped||this.a.push(a)};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.observer.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.observer.onNext(this.a),this.observer.onCompleted())};
d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(a),!0)};w.toArray=function(){return new ec(this)};H.create=H.createWithDisposable=function(a,b){return new G(a,b)};var pb=H.defer=function(a){return new G(function(b){var d;try{d=a()}catch(c){return zb(c).subscribe(b)}aa(d)&&(d=ca(d));return d.subscribe(b)})},fc=function(a){function b(d){this.scheduler=d;a.call(this)}function d(a,b){this.observer=a;this.parent=
b}function c(a,b){b.onCompleted()}O(b,a);b.prototype.subscribeCore=function(a){return(new d(a,this)).run()};d.prototype.run=function(){return this.parent.scheduler.scheduleWithState(this.observer,c)};return b}(oa),gc=H.empty=function(a){ba(a)||(a=Aa);return new fc(a)},ic=function(a){function b(d,c,r){this.iterable=d;this.mapper=c;this.scheduler=r;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return(new hc(a,this)).run()};return b}(oa),hc=function(){function a(b,d){this.observer=b;this.parent=
d}a.prototype.run=function(){var a=N(Object(this.parent.iterable)),b=this.observer,d=this.parent.mapper;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,C){try{var e=a.next()}catch(f){return b.onError(f)}if(e.done)return b.onCompleted();e=e.value;if(d)try{e=d(e,c)}catch(g){return b.onError(g)}b.onNext(e);C(c+1)})};return a}(),Eb=Math.pow(2,53)-1;z.prototype[ia]=function(){return new D(this._s)};D.prototype[ia]=function(){return this};D.prototype.next=function(){return this._i<
this._l?{done:!1,value:this._s.charAt(this._i++)}:ib};u.prototype[ia]=function(){return new M(this._a)};M.prototype[ia]=function(){return this};M.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:ib};var fb=H.from=function(a,b,d,c){if(null==a)throw Error("iterable cannot be null.");if(b&&!V(b))throw Error("mapFn when provided must be a function");if(b)var e=Ea(b,d,2);ba(c)||(c=qa);return new ic(a,e,c)},cb=function(a){function b(d,c){this.args=d;this.scheduler=c;a.call(this)}
O(b,a);b.prototype.subscribeCore=function(a){return(new y(a,this)).run()};return b}(oa);y.prototype.run=function(){var a=this.observer,b=this.parent.args,d=b.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,e){if(c<d)a.onNext(b[c]),e(c+1);else a.onCompleted()})};var jc=H.fromArray=function(a,b){ba(b)||(b=qa);return new cb(a,b)},kc=function(a){function b(){a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return la};return b}(oa);H.never=function(){return new kc};
H.of=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];return new cb(b,qa)};H.ofWithScheduler=function(a){for(var b=arguments.length,d=Array(b-1),c=1;c<b;c++)d[c-1]=arguments[c];return new cb(d,a)};var lc=function(a){function b(d,c){this.obj=d;this.keys=Object.keys(d);this.scheduler=c;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return(new E(a,this)).run()};return b}(oa);E.prototype.run=function(){var a=this.observer,b=this.parent.obj,d=this.parent.keys,c=
d.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(e,f){if(e<c){var g=d[e];a.onNext([g,b[g]]);f(e+1)}else a.onCompleted()})};H.pairs=function(a,b){b||(b=qa);return new lc(a,b)};var nc=function(a){function b(d,c,r){this.start=d;this.count=c;this.scheduler=r;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return(new mc(a,this)).run()};return b}(oa),mc=function(){function a(b,d){this.observer=b;this.parent=d}a.prototype.run=function(){var a=this.parent.start,b=this.parent.count,
d=this.observer;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,e){if(c<b)d.onNext(a+c),e(c+1);else d.onCompleted()})};return a}();H.range=function(a,b,d){ba(d)||(d=qa);return new nc(a,b,d)};var oc=function(a){function b(d,c,r){this.value=d;this.repeatCount=null==c?-1:c;this.scheduler=r;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return(new L(a,this)).run()};return b}(oa);L.prototype.run=function(){var a=this.observer,b=this.parent.value;return this.parent.scheduler.scheduleRecursiveWithState(this.parent.repeatCount,
function(d,c){if(-1===d||0<d)a.onNext(b),0<d&&d--;if(0===d)return a.onCompleted();c(d)})};H.repeat=function(a,b,d){ba(d)||(d=qa);return new oc(a,b,d)};var pc=function(a){function b(d,c){this.value=d;this.scheduler=c;a.call(this)}function d(a,b){this.observer=a;this.parent=b}function c(a,b){var d=b[1];d.onNext(b[0]);d.onCompleted()}O(b,a);b.prototype.subscribeCore=function(a){return(new d(a,this)).run()};d.prototype.run=function(){return this.parent.scheduler.scheduleWithState([this.parent.value,this.observer],
c)};return b}(oa);H["return"]=H.just=H.returnValue=function(a,b){ba(b)||(b=Aa);return new pc(a,b)};var qc=function(a){function b(d,c){this.error=d;this.scheduler=c;a.call(this)}function d(a,b){this.observer=a;this.parent=b}function c(a,b){b[1].onError(b[0])}O(b,a);b.prototype.subscribeCore=function(a){return(new d(a,this)).run()};d.prototype.run=function(){return this.parent.scheduler.scheduleWithState([this.parent.error,this.observer],c)};return b}(oa),zb=H["throw"]=H.throwError=H.throwException=
function(a,b){ba(b)||(b=Aa);return new qc(a,b)};w["catch"]=w.catchError=w.catchException=function(a){return"function"===typeof a?Y(this,a):rc([this,a])};var rc=H.catchError=H["catch"]=H.catchException=function(){var a=[];if(Array.isArray(arguments[0]))a=arguments[0];else for(var b=0,d=arguments.length;b<d;b++)a.push(arguments[b]);return xb(a).catchError()};w.combineLatest=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];Array.isArray(b[0])?b[0].unshift(this):b.unshift(this);
return sc.apply(this,b)};var sc=H.combineLatest=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];var c=b.pop();Array.isArray(b[0])&&(b=b[0]);return new G(function(a){function d(b){C[b]=!0;if(g||(g=C.every(ya))){try{var r=c.apply(null,h)}catch(e){return a.onError(e)}a.onNext(r)}else if(T.filter(function(a,d){return d!==b}).every(ya))a.onCompleted()}for(var e=b.length,f=function(){return!1},C=v(e,f),g=!1,T=v(e,f),h=Array(e),l=Array(e),f=0;f<e;f++)(function(c){var e=b[c],
f=new P;aa(e)&&(e=ca(e));f.setDisposable(e.subscribe(function(a){h[c]=a;d(c)},function(b){a.onError(b)},function(){T[c]=!0;T.every(ya)&&a.onCompleted()}));l[c]=f})(f);return new Q(l)},this)};w.concat=function(){for(var a=[],b=0,d=arguments.length;b<d;b++)a.push(arguments[b]);a.unshift(this);return tc.apply(null,a)};var tc=H.concat=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{a=Array(arguments.length);for(var b=0,d=arguments.length;b<d;b++)a[b]=arguments[b]}return xb(a).concat()};
w.concatAll=w.concatObservable=function(){return this.merge(1)};var vc=function(a){function b(d,c){this.source=d;this.maxConcurrent=c;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){var b=new Q;b.add(this.source.subscribe(new uc(a,this.maxConcurrent,b)));return b};return b}(oa),uc=function(){function a(b,d,c){this.o=b;this.max=d;this.g=c;this.done=!1;this.q=[];this.activeCount=0;this.isStopped=!1}function b(a,d){this.parent=a;this.sad=d;this.isStopped=!1}a.prototype.handleSubscribe=function(a){var d=
new P;this.g.add(d);aa(a)&&(a=ca(a));d.setDisposable(a.subscribe(new b(this,d)))};a.prototype.onNext=function(a){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(a)):this.q.push(a))};a.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};a.prototype.onCompleted=function(){this.isStopped||(this.done=this.isStopped=!0,0===this.activeCount&&this.o.onCompleted())};a.prototype.dispose=function(){this.isStopped=!0};a.prototype.fail=function(a){return this.isStopped?
!1:(this.isStopped=!0,this.o.onError(a),!0)};b.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};b.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=this.parent;a.g.remove(this.sad);0<a.q.length?a.handleSubscribe(a.q.shift()):(a.activeCount--,a.done&&0===a.activeCount&&a.o.onCompleted())}};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=
function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return a}();w.merge=function(a){return"number"!==typeof a?wc(this,a):new vc(this,a)};var wc=H.merge=function(){var a,b=[],d,c=arguments.length;arguments[0]?ba(arguments[0])?(a=arguments[0],d=1):(a=Aa,d=0):(a=Aa,d=1);for(;d<c;d++)b.push(arguments[d]);Array.isArray(b[0])&&(b=b[0]);return F(a,b).mergeAll()},Jb=A.CompositeError=function(a){this.name="NotImplementedError";this.innerErrors=a;this.message="This contains multiple errors. Check the innerErrors";
Error.call(this)};Jb.prototype=Error.prototype;H.mergeDelayError=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var b=arguments.length;a=Array(b);for(var d=0;d<b;d++)a[d]=arguments[d]}var c=F(null,a);return new G(function(a){function b(){if(0===r.length)a.onCompleted();else if(1===r.length)a.onError(r[0]);else a.onError(new Jb(r))}var d=new Q,e=new P,f=!1,r=[];d.add(e);e.setDisposable(c.subscribe(function(c){var e=new P;d.add(e);aa(c)&&(c=ca(c));e.setDisposable(c.subscribe(function(b){a.onNext(b)},
function(a){r.push(a);d.remove(e);f&&1===d.length&&b()},function(){d.remove(e);f&&1===d.length&&b()}))},function(a){r.push(a);f=!0;1===d.length&&b()},function(){f=!0;1===d.length&&b()}));return d})};var yc=function(a){function b(d){this.source=d;a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){var b=new Q,d=new P;b.add(d);d.setDisposable(this.source.subscribe(new xc(a,b)));return b};return b}(oa),xc=function(){function a(b,d){this.o=b;this.g=d;this.done=this.isStopped=!1}function b(a,d,c){this.parent=
a;this.g=d;this.sad=c;this.isStopped=!1}a.prototype.onNext=function(a){if(!this.isStopped){var d=new P;this.g.add(d);aa(a)&&(a=ca(a));d.setDisposable(a.subscribe(new b(this,this.g,d)))}};a.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};a.prototype.onCompleted=function(){this.isStopped||(this.done=this.isStopped=!0,1===this.g.length&&this.o.onCompleted())};a.prototype.dispose=function(){this.isStopped=!0};a.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=
!0,this.o.onError(a),!0)};b.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};b.prototype.onCompleted=function(){if(!this.isStopped){var a=this.parent;this.isStopped=!0;a.g.remove(this.sad);a.done&&1===a.g.length&&a.o.onCompleted()}};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};
return a}();w.mergeAll=w.mergeObservable=function(){return new yc(this)};w.skipUntil=function(a){var b=this;return new G(function(d){var c=!1,e=new Q(b.subscribe(function(a){c&&d.onNext(a)},function(a){d.onError(a)},function(){c&&d.onCompleted()}));aa(a)&&(a=ca(a));var f=new P;e.add(f);f.setDisposable(a.subscribe(function(){c=!0;f.dispose()},function(a){d.onError(a)},function(){f.dispose()}));return e},b)};w["switch"]=w.switchLatest=function(){var a=this;return new G(function(b){var d=!1,c=new ra,
e=!1,f=0,g=a.subscribe(function(a){var g=new P,C=++f;d=!0;c.setDisposable(g);aa(a)&&(a=ca(a));g.setDisposable(a.subscribe(function(a){f===C&&b.onNext(a)},function(a){f===C&&b.onError(a)},function(){f===C&&(d=!1,e&&b.onCompleted())}))},function(a){b.onError(a)},function(){e=!0;!d&&b.onCompleted()});return new Q(g,c)},a)};w.takeUntil=function(a){var b=this;return new G(function(d){aa(a)&&(a=ca(a));return new Q(b.subscribe(d),a.subscribe(function(){d.onCompleted()},function(a){d.onError(a)},R))},b)};
w.withLatestFrom=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];var c=b.pop(),e=this;if("undefined"===typeof e)throw Error("Source observable not found for withLatestFrom().");if("function"!==typeof c)throw Error("withLatestFrom() expects a resultSelector function.");Array.isArray(b[0])&&(b=b[0]);return new G(function(a){for(var d=b.length,f=v(d,function(){return!1}),g=!1,C=Array(d),h=Array(d+1),l=0;l<d;l++)(function(d){var c=b[d],e=new P;aa(c)&&(c=ca(c));e.setDisposable(c.subscribe(function(a){C[d]=
a;f[d]=!0;g=f.every(ya)},a.onError.bind(a),function(){}));h[d]=e})(l);l=new P;l.setDisposable(e.subscribe(function(b){var d;b=[b].concat(C);if(g){try{d=c.apply(null,b)}catch(e){a.onError(e);return}a.onNext(d)}},a.onError.bind(a),function(){a.onCompleted()}));h[d]=l;return new Q(h)},this)};w.zip=function(){if(Array.isArray(arguments[0]))return I.apply(this,arguments);for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];var c=this,e=b.pop();b.unshift(c);return new G(function(a){function d(b){var f,
r;if(C.every(function(a){return 0<a.length})){try{r=C.map(function(a){return a.shift()}),f=e.apply(c,r)}catch(g){a.onError(g);return}a.onNext(f)}else if(h.filter(function(a,d){return d!==b}).every(ya))a.onCompleted()}function f(b){h[b]=!0;if(h.every(function(a){return a}))a.onCompleted()}for(var g=b.length,C=v(g,J),h=v(g,U),l=Array(g),m=0;m<g;m++)(function(c){var e=b[c],g=new P;aa(e)&&(e=ca(e));g.setDisposable(e.subscribe(function(a){C[c].push(a);d(c)},function(b){a.onError(b)},function(){f(c)}));
l[c]=g})(m);return new Q(l)},c)};H.zip=function(){for(var a=arguments.length,b=Array(a),d=0;d<a;d++)b[d]=arguments[d];a=b.shift();return a.zip.apply(a,b)};H.zipArray=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var b=arguments.length;a=Array(b);for(var d=0;d<b;d++)a[d]=arguments[d]}return new G(function(b){function d(a){if(e.every(function(a){return 0<a.length})){var c=e.map(function(a){return a.shift()});b.onNext(c)}else if(f.filter(function(b,d){return d!==a}).every(ya))b.onCompleted()}
for(var c=a.length,e=v(c,function(){return[]}),f=v(c,function(){return!1}),r=Array(c),g=0;g<c;g++)(function(c){r[c]=new P;r[c].setDisposable(a[c].subscribe(function(a){e[c].push(a);d(c)},function(a){b.onError(a)},function(){f[c]=!0;if(f.every(ya))b.onCompleted()}))})(g);return new Q(r)})};w.asObservable=function(){var a=this;return new G(function(b){return a.subscribe(b)},this)};w.dematerialize=function(){var a=this;return new G(function(b){return a.subscribe(function(a){return a.accept(b)},function(a){b.onError(a)},
function(){b.onCompleted()})},this)};w.distinctUntilChanged=function(a,b){var d=this;b||(b=qb);return new G(function(c){var e=!1,f;return d.subscribe(function(d){var g=d;if(a)try{g=a(d)}catch(h){c.onError(h);return}if(e)try{var l=b(f,g)}catch(m){c.onError(m);return}e&&l||(e=!0,f=g,c.onNext(d))},function(a){c.onError(a)},function(){c.onCompleted()})},this)};w["do"]=w.tap=w.doAction=function(a,b,d){var c=this;return new G(function(e){var f=!a||V(a)?Xa(a||R,b||R,d||R):a;return c.subscribe(function(a){try{f.onNext(a)}catch(b){e.onError(b)}e.onNext(a)},
function(a){try{f.onError(a)}catch(b){e.onError(b)}e.onError(a)},function(){try{f.onCompleted()}catch(a){e.onError(a)}e.onCompleted()})},this)};w.doOnNext=w.tapOnNext=function(a,b){return this.tap("undefined"!==typeof b?function(d){a.call(b,d)}:a)};w.doOnError=w.tapOnError=function(a,b){return this.tap(R,"undefined"!==typeof b?function(d){a.call(b,d)}:a)};w.doOnCompleted=w.tapOnCompleted=function(a,b){return this.tap(R,null,"undefined"!==typeof b?function(){a.call(b)}:a)};w["finally"]=w.ensure=function(a){var b=
this;return new G(function(d){var c;try{c=b.subscribe(d)}catch(e){throw a(),e;}return ma(function(){try{c.dispose()}catch(b){throw b;}finally{a()}})},this)};w.finallyAction=function(a){return this.ensure(a)};w.ignoreElements=function(){var a=this;return new G(function(b){return a.subscribe(R,function(a){b.onError(a)},function(){b.onCompleted()})},a)};w.materialize=function(){var a=this;return new G(function(b){return a.subscribe(function(a){b.onNext(Zb(a))},function(a){b.onNext($b(a));b.onCompleted()},
function(){b.onNext(ac());b.onCompleted()})},a)};w.repeat=function(a){return wb(this,a).concat()};w.retry=function(a){return wb(this,a).catchError()};w.retryWhen=function(a){return wb(this).catchErrorWhen(a)};w.scan=function(){var a=!1,b,d,c=this;2===arguments.length?(a=!0,b=arguments[0],d=arguments[1]):d=arguments[0];return new G(function(e){var f,g,h;return c.subscribe(function(c){!h&&(h=!0);try{f?g=d(g,c):(g=a?d(b,c):c,f=!0)}catch(l){e.onError(l);return}e.onNext(g)},function(a){e.onError(a)},function(){!h&&
a&&e.onNext(b);e.onCompleted()})},c)};w.skipLast=function(a){if(0>a)throw new Ua;var b=this;return new G(function(d){var c=[];return b.subscribe(function(b){c.push(b);c.length>a&&d.onNext(c.shift())},function(a){d.onError(a)},function(){d.onCompleted()})},b)};w.startWith=function(){var a,b=0;arguments.length&&ba(arguments[0])?(a=arguments[0],b=1):a=Aa;for(var d=[],c=arguments.length;b<c;b++)d.push(arguments[b]);return xb([jc(d,a),this]).concat()};w.takeLast=function(a){if(0>a)throw new Ua;var b=this;
return new G(function(d){var c=[];return b.subscribe(function(b){c.push(b);c.length>a&&c.shift()},function(a){d.onError(a)},function(){for(;0<c.length;)d.onNext(c.shift());d.onCompleted()})},b)};w.selectConcat=w.concatMap=function(a,b,d){return V(a)&&V(b)?this.concatMap(function(d,c){var e=a(d,c);aa(e)&&(e=ca(e));(db(e)||eb(e))&&(e=fb(e));return e.map(function(a,e){return b(d,a,c,e)})}):V(a)?da(this,a,d):da(this,function(){return a})};var Kb=function(a){function b(d,c,e){this.source=d;this.selector=
Ea(c,e,3);a.call(this)}O(b,a);b.prototype.internalMap=function(a,d){var c=this;return new b(this.source,function(b,d,e){return a.call(this,c.selector(b,d,e),d,e)},d)};b.prototype.subscribeCore=function(a){return this.source.subscribe(new S(a,this.selector,this))};return b}(oa);S.prototype.onNext=function(a){if(!this.isStopped){a=B(this.selector).call(this,a,this.i++,this.source);if(a===ka)return this.observer.onError(a.e);this.observer.onNext(a)}};S.prototype.onError=function(a){this.isStopped||(this.isStopped=
!0,this.observer.onError(a))};S.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.observer.onCompleted())};S.prototype.dispose=function(){this.isStopped=!0};S.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(a),!0)};w.map=w.select=function(a,b){var d="function"===typeof a?a:function(){return a};return this instanceof Kb?this.internalMap(d,b):new Kb(this,d,b)};w.pluck=function(){var a=arguments,d=arguments.length;if(0===d)throw Error("List of properties cannot be empty.");
return this.map(function(c){var e=c;for(c=0;c<d;c++)if(e=e[a[c]],"undefined"===typeof e)return b;return e})};w.selectMany=w.flatMap=function(a,b,d){return V(a)&&V(b)?this.flatMap(function(d,c){var e=a(d,c);aa(e)&&(e=ca(e));(db(e)||eb(e))&&(e=fb(e));return e.map(function(a,e){return b(d,a,c,e)})},d):V(a)?ea(this,a,d):ea(this,function(){return a})};w.selectSwitch=w.flatMapLatest=w.switchMap=function(a,b){return this.select(a,b).switchLatest()};w.skip=function(a){if(0>a)throw new Ua;var b=this;return new G(function(d){var c=
a;return b.subscribe(function(a){if(0>=c)d.onNext(a);else c--},function(a){d.onError(a)},function(){d.onCompleted()})},b)};w.skipWhile=function(a,b){var d=this,c=Ea(a,b,3);return new G(function(a){var b=0,e=!1;return d.subscribe(function(f){if(!e)try{e=!c(f,b++,d)}catch(g){a.onError(g);return}e&&a.onNext(f)},function(b){a.onError(b)},function(){a.onCompleted()})},d)};w.take=function(a,b){if(0>a)throw new Ua;if(0===a)return gc(b);var d=this;return new G(function(b){var c=a;return d.subscribe(function(a){0<
c--&&(b.onNext(a),0===c&&b.onCompleted())},function(a){b.onError(a)},function(){b.onCompleted()})},d)};w.takeWhile=function(a,b){var d=this,c=Ea(a,b,3);return new G(function(a){var b=0,e=!0;return d.subscribe(function(f){if(e){try{e=c(f,b++,d)}catch(g){a.onError(g);return}if(e)a.onNext(f);else a.onCompleted()}},function(b){a.onError(b)},function(){a.onCompleted()})},d)};var Lb=function(a){function b(d,c,e){this.source=d;this.predicate=Ea(c,e,3);a.call(this)}O(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new W(a,
this.predicate,this))};b.prototype.internalFilter=function(a,d){var c=this;return new b(this.source,function(b,d,e){return c.predicate(b,d,e)&&a.call(this,b,d,e)},d)};return b}(oa);W.prototype.onNext=function(a){if(!this.isStopped){var b=B(this.predicate).call(this,a,this.i++,this.source);if(b===ka)return this.observer.onError(b.e);b&&this.observer.onNext(a)}};W.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.observer.onError(a))};W.prototype.onCompleted=function(){this.isStopped||
(this.isStopped=!0,this.observer.onCompleted())};W.prototype.dispose=function(){this.isStopped=!0};W.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.observer.onError(a),!0)};w.filter=w.where=function(a,b){return this instanceof Lb?this.internalFilter(a,b):new Lb(this,a,b)};H.fromCallback=function(a,b,d){return function(){for(var c=arguments.length,e=Array(c),f=0;f<c;f++)e[f]=arguments[f];return(new G(function(c){e.push(function(){for(var a=arguments.length,e=Array(a),f=
0;f<a;f++)e[f]=arguments[f];if(d){try{e=d.apply(b,e)}catch(g){return c.onError(g)}c.onNext(e)}else if(1>=e.length)c.onNext.apply(c,e);else c.onNext(e);c.onCompleted()});a.apply(b,e)})).publishLast().refCount()}};H.fromNodeCallback=function(a,b,d){return function(){for(var c=arguments.length,e=Array(c),f=0;f<c;f++)e[f]=arguments[f];return(new G(function(c){e.push(function(a){if(a)c.onError(a);else{for(var e=arguments.length,f=[],g=1;g<e;g++)f[g-1]=arguments[g];if(d){try{f=d.apply(b,f)}catch(h){return c.onError(h)}c.onNext(f)}else if(1>=
f.length)c.onNext.apply(c,f);else c.onNext(f);c.onCompleted()}});a.apply(b,e)})).publishLast().refCount()}};A.config.useNativeEvents=!1;H.fromEvent=function(a,b,d){return a.addListener?Mb(function(d){a.addListener(b,d)},function(d){a.removeListener(b,d)},d):A.config.useNativeEvents||"function"!==typeof a.on||"function"!==typeof a.off?(new G(function(c){return ja(a,b,function(a){var b=a;if(d)try{b=d(arguments)}catch(e){return c.onError(e)}c.onNext(b)})})).publish().refCount():Mb(function(d){a.on(b,
d)},function(d){a.off(b,d)},d)};var Mb=H.fromEventPattern=function(a,b,d){return(new G(function(c){function e(a){var b=a;if(d)try{b=d(arguments)}catch(f){return c.onError(f)}c.onNext(b)}var f=a(e);return ma(function(){b&&b(e,f)})})).publish().refCount()},ca=H.fromPromise=function(a){return pb(function(){var b=new A.AsyncSubject;a.then(function(a){b.onNext(a);b.onCompleted()},b.onError.bind(b));return b})};w.toPromise=function(a){a||(a=A.config.Promise);if(!a)throw new Va("Promise type not provided nor in Rx.config.Promise");
var b=this;return new a(function(a,d){var c,e=!1;b.subscribe(function(a){c=a;e=!0},d,function(){e&&a(c)})})};H.startAsync=function(a){var b;try{b=a()}catch(d){return zb(d)}return ca(b)};w.multicast=function(a,b){var d=this;return"function"===typeof a?new G(function(c){var e=d.multicast(a());return new Q(b(e).subscribe(c),e.connect())},d):new zc(d,a)};w.publish=function(a){return a&&V(a)?this.multicast(function(){return new Ja},a):this.multicast(new Ja)};w.share=function(){return this.publish().refCount()};
w.publishLast=function(a){return a&&V(a)?this.multicast(function(){return new Nb},a):this.multicast(new Nb)};w.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new Ob(b)},a):this.multicast(new Ob(a))};w.shareValue=function(a){return this.publishValue(a).refCount()};w.replay=function(a,b,d,c){return a&&V(a)?this.multicast(function(){return new Pb(b,d,c)},a):this.multicast(new Pb(b,d,c))};w.shareReplay=function(a,b,d){return this.replay(null,a,b,d).refCount()};
var zc=A.ConnectableObservable=function(a){function b(d,c){var e=!1,f,g=d.asObservable();this.connect=function(){e||(e=!0,f=new Q(g.subscribe(c),ma(function(){e=!1})));return f};a.call(this,function(a){return c.subscribe(a)})}O(b,a);b.prototype.refCount=function(){var a,b=0,d=this;return new G(function(c){var e=1===++b,f=d.subscribe(c);e&&(a=d.connect());return function(){f.dispose();0===--b&&a.dispose()}})};return b}(H),Ac=H.interval=function(a,b){return Na(a,a,ba(b)?b:Ha)};H.timer=function(a,d,
c){var e;ba(c)||(c=Ha);d!==b&&"number"===typeof d?e=d:ba(d)&&(c=d);return a instanceof Date&&e===b?fa(a.getTime(),c):a instanceof Date&&e!==b?(e=d,sa(a.getTime(),e,c)):e===b?va(a,c):Na(a,e,c)};w.delay=function(a,b){ba(b)||(b=Ha);return a instanceof Date?mb(this,a.getTime(),b):Ya(this,a,b)};w.debounce=w.throttleWithTimeout=function(a,b){ba(b)||(b=Ha);var d=this;return new G(function(c){var e=new ra,f=!1,g,h=0,l=d.subscribe(function(d){f=!0;g=d;h++;var l=h;d=new P;e.setDisposable(d);d.setDisposable(b.scheduleWithRelative(a,
function(){f&&h===l&&c.onNext(g);f=!1}))},function(a){e.dispose();c.onError(a);f=!1;h++},function(){e.dispose();f&&c.onNext(g);c.onCompleted();f=!1;h++});return new Q(l,e)},this)};w.throttle=function(a,b){return this.debounce(a,b)};w.timestamp=function(a){ba(a)||(a=Ha);return this.map(function(b){return{value:b,timestamp:a.now()}})};w.sample=w.throttleLatest=function(a,b){ba(b)||(b=Ha);return"number"===typeof a?Za(this,Ac(a,b)):Za(this,a)};w.timeout=function(a,b,d){null!=b&&"string"!==typeof b||(b=
zb(Error(b||"Timeout")));ba(d)||(d=Ha);var c=this,e=a instanceof Date?"scheduleWithAbsolute":"scheduleWithRelative";return new G(function(f){function g(){var c=h;q.setDisposable(d[e](a,function(){h===c&&(aa(b)&&(b=ca(b)),m.setDisposable(b.subscribe(f)))}))}var h=0,l=new P,m=new ra,q=new ra;m.setDisposable(l);g();l.setDisposable(c.subscribe(function(a){h++;f.onNext(a);g()},function(a){h++;f.onError(a)},function(){h++;f.onCompleted()}));return new Q(m,q)},c)};w.throttleFirst=function(a,b){ba(b)||(b=
Ha);var d=+a||0;if(0>=d)throw new RangeError("windowDuration cannot be less or equal zero.");var c=this;return new G(function(a){var e=0;return c.subscribe(function(c){var f=b.now();if(0===e||f-e>=d)e=f,a.onNext(c)},function(b){a.onError(b)},function(){a.onCompleted()})},c)};var Bc=function(a){function b(a){var d=this.source.publish();a=d.subscribe(a);var c=la,e=this.pauser.distinctUntilChanged().subscribe(function(a){a?c=d.connect():(c.dispose(),c=la)});return new Q(a,c,e)}function d(c,e){this.source=
c;this.controller=new Ja;this.pauser=e&&e.subscribe?this.controller.merge(e):this.controller;a.call(this,b,c)}O(d,a);d.prototype.pause=function(){this.controller.onNext(!1)};d.prototype.resume=function(){this.controller.onNext(!0)};return d}(H);w.pausable=function(a){return new Bc(this,a)};var Cc=function(a){function d(a){var c=[],e;return nb(this.source,this.pauser.distinctUntilChanged().startWith(!1),function(a,b){return{data:a,shouldFire:b}}).subscribe(function(d){if(e!==b&&d.shouldFire!=e){if(e=
d.shouldFire)for(;0<c.length;)a.onNext(c.shift())}else if(e=d.shouldFire)a.onNext(d.data);else c.push(d.data)},function(b){for(;0<c.length;)a.onNext(c.shift());a.onError(b)},function(){for(;0<c.length;)a.onNext(c.shift());a.onCompleted()})}function c(b,e){this.source=b;this.controller=new Ja;this.pauser=e&&e.subscribe?this.controller.merge(e):this.controller;a.call(this,d,b)}O(c,a);c.prototype.pause=function(){this.controller.onNext(!1)};c.prototype.resume=function(){this.controller.onNext(!0)};return c}(H);
w.pausableBuffered=function(a){return new Cc(this,a)};var Ec=function(a){function b(a){return this.source.subscribe(a)}function d(c,e,f){a.call(this,b,c);this.subject=new Dc(e,f);this.source=c.multicast(this.subject).refCount()}O(d,a);d.prototype.request=function(a){return this.subject.request(null==a?-1:a)};return d}(H),Dc=function(a){function b(a){return this.subject.subscribe(a)}function d(c,e){null==c&&(c=!0);a.call(this,b);this.subject=new Ja;this.queue=(this.enableQueue=c)?[]:null;this.requestedCount=
0;this.requestedDisposable=la;this.error=null;this.hasCompleted=this.hasFailed=!1;this.scheduler=e||qa}O(d,a);Pa(d.prototype,Ka,{onCompleted:function(){this.hasCompleted=!0;if(this.enableQueue&&0!==this.queue.length)this.queue.push(Ca.createOnCompleted());else this.subject.onCompleted()},onError:function(a){this.hasFailed=!0;this.error=a;if(this.enableQueue&&0!==this.queue.length)this.queue.push(Ca.createOnError(a));else this.subject.onError(a)},onNext:function(a){var b=!1;0===this.requestedCount?
this.enableQueue&&this.queue.push(Ca.createOnNext(a)):(-1!==this.requestedCount&&0===this.requestedCount--&&this.disposeCurrentRequest(),b=!0);b&&this.subject.onNext(a)},_processRequest:function(a){if(this.enableQueue){for(;this.queue.length>=a&&0<a||0<this.queue.length&&"N"!==this.queue[0].kind;){var b=this.queue.shift();b.accept(this.subject);"N"===b.kind?a--:(this.disposeCurrentRequest(),this.queue=[])}return{numberOfItems:a,returnValue:0!==this.queue.length}}return{numberOfItems:a,returnValue:!1}},
request:function(a){this.disposeCurrentRequest();var b=this;return this.requestedDisposable=this.scheduler.scheduleWithState(a,function(a,d){var c=b._processRequest(d),e=c.numberOfItems;c.returnValue||(b.requestedCount=e,b.requestedDisposable=ma(function(){b.requestedCount=0}))})},disposeCurrentRequest:function(){this.requestedDisposable.dispose();this.requestedDisposable=la}});return d}(H);w.controlled=function(a,b){a&&ba(a)&&(b=a,a=!0);null==a&&(a=!0);return new Ec(this,a,b)};w.pipe=function(a){function b(){d.resume()}
var d=this.pausableBuffered();a.addListener("drain",b);d.subscribe(function(b){!a.write(String(b))&&d.pause()},function(b){a.emit("error",b)},function(){!a._isStdio&&a.end();a.removeListener("drain",b)});d.resume();return a};w.transduce=function(a){function b(a){return{"@@transducer/init":function(){return a},"@@transducer/step":function(a,b){return a.onNext(b)},"@@transducer/result":function(a){return a.onCompleted()}}}var d=this;return new G(function(c){var e=a(b(c));return d.subscribe(function(a){try{e["@@transducer/step"](c,
a)}catch(b){c.onError(b)}},function(a){c.onError(a)},function(){e["@@transducer/result"](c)})},d)};var G=A.AnonymousObservable=function(a){function b(a){return a&&V(a.dispose)?a:V(a)?ma(a):la}function d(a,c){var e=c[0],f=B(c[1])(e);if(f===ka&&!e.fail(ka.e))throw ka.e;e.setDisposable(b(f))}function c(b,e){this.source=e;a.call(this,function(a){a=new Ib(a);var c=[a,b];qa.scheduleRequired()?qa.scheduleWithState(c,d):d(null,c);return a})}O(c,a);return c}(H),Ib=function(a){function b(d){a.call(this);this.observer=
d;this.m=new P}O(b,a);var d=b.prototype;d.next=function(a){a=B(this.observer.onNext).call(this.observer,a);if(a===ka)throw this.dispose(),a.e;};d.error=function(a){a=B(this.observer.onError).call(this.observer,a);this.dispose();if(a===ka)throw a.e;};d.completed=function(){var a=B(this.observer.onCompleted).call(this.observer);this.dispose();if(a===ka)throw a.e;};d.setDisposable=function(a){this.m.setDisposable(a)};d.getDisposable=function(){return this.m.getDisposable()};d.dispose=function(){a.prototype.dispose.call(this);
this.m.dispose()};return b}(yb),lb=function(a,b){this.subject=a;this.observer=b};lb.prototype.dispose=function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1);this.observer=null}};var Ja=A.Subject=function(a){function b(a){ga(this);if(!this.isStopped)return this.observers.push(a),new lb(this,a);if(this.hasError)return a.onError(this.error),la;a.onCompleted();return la}function d(){a.call(this,b);this.isStopped=
this.isDisposed=!1;this.observers=[];this.hasError=!1}O(d,a);Pa(d.prototype,Ka.prototype,{hasObservers:function(){return 0<this.observers.length},onCompleted:function(){ga(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,b=p(this.observers),d=b.length;a<d;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ga(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;for(var b=0,d=p(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},
onNext:function(a){ga(this);if(!this.isStopped)for(var b=0,d=p(this.observers),c=d.length;b<c;b++)d[b].onNext(a)},dispose:function(){this.isDisposed=!0;this.observers=null}});d.create=function(a,b){return new Fc(a,b)};return d}(H),Nb=A.AsyncSubject=function(a){function b(a){ga(this);if(!this.isStopped)return this.observers.push(a),new lb(this,a);if(this.hasError)a.onError(this.error);else{if(this.hasValue)a.onNext(this.value);a.onCompleted()}return la}function d(){a.call(this,b);this.hasValue=this.isStopped=
this.isDisposed=!1;this.observers=[];this.hasError=!1}O(d,a);Pa(d.prototype,Ka,{hasObservers:function(){ga(this);return 0<this.observers.length},onCompleted:function(){var a,b;ga(this);if(!this.isStopped){this.isStopped=!0;var d=p(this.observers);b=d.length;if(this.hasValue)for(a=0;a<b;a++){var c=d[a];c.onNext(this.value);c.onCompleted()}else for(a=0;a<b;a++)d[a].onCompleted();this.observers.length=0}},onError:function(a){ga(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=
0,d=p(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},onNext:function(a){ga(this);this.isStopped||(this.value=a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0;this.value=this.exception=this.observers=null}});return d}(H),Fc=A.AnonymousSubject=function(a){function b(a){return this.observable.subscribe(a)}function d(c,e){this.observer=c;this.observable=e;a.call(this,b)}O(d,a);Pa(d.prototype,Ka.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},
onNext:function(a){this.observer.onNext(a)}});return d}(H),Ob=A.BehaviorSubject=function(a){function b(a){ga(this);if(!this.isStopped)return this.observers.push(a),a.onNext(this.value),new lb(this,a);if(this.hasError)a.onError(this.error);else a.onCompleted();return la}function d(c){a.call(this,b);this.value=c;this.observers=[];this.hasError=this.isStopped=this.isDisposed=!1}O(d,a);Pa(d.prototype,Ka,{getValue:function(){ga(this);if(this.hasError)throw this.error;return this.value},hasObservers:function(){return 0<
this.observers.length},onCompleted:function(){ga(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,b=p(this.observers),d=b.length;a<d;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ga(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=0,d=p(this.observers),c=d.length;b<c;b++)d[b].onError(a);this.observers.length=0}},onNext:function(a){ga(this);if(!this.isStopped){this.value=a;for(var b=0,d=p(this.observers),c=d.length;b<c;b++)d[b].onNext(a)}},
dispose:function(){this.isDisposed=!0;this.exception=this.value=this.observers=null}});return d}(H),Pb=A.ReplaySubject=function(a){function b(a,d){return ma(function(){d.dispose();!a.isDisposed&&a.observers.splice(a.observers.indexOf(d),1)})}function d(a){a=new dc(this.scheduler,a);var c=b(this,a);ga(this);this._trim(this.scheduler.now());this.observers.push(a);for(var e=0,f=this.q.length;e<f;e++)a.onNext(this.q[e].value);if(this.hasError)a.onError(this.error);else if(this.isStopped)a.onCompleted();
a.ensureActive();return c}function c(b,f,g){this.bufferSize=null==b?e:b;this.windowSize=null==f?e:f;this.scheduler=g||qa;this.q=[];this.observers=[];this.hasError=this.isDisposed=this.isStopped=!1;this.error=null;a.call(this,d)}var e=Math.pow(2,53)-1;O(c,a);Pa(c.prototype,Ka.prototype,{hasObservers:function(){return 0<this.observers.length},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;0<this.q.length&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){ga(this);
if(!this.isStopped){var b=this.scheduler.now();this.q.push({interval:b,value:a});this._trim(b);for(var b=0,d=p(this.observers),c=d.length;b<c;b++){var e=d[b];e.onNext(a);e.ensureActive()}}},onError:function(a){ga(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;var b=this.scheduler.now();this._trim(b);for(var b=0,d=p(this.observers),c=d.length;b<c;b++){var e=d[b];e.onError(a);e.ensureActive()}this.observers.length=0}},onCompleted:function(){ga(this);if(!this.isStopped){this.isStopped=
!0;var a=this.scheduler.now();this._trim(a);for(var a=0,b=p(this.observers),d=b.length;a<d;a++){var c=b[a];c.onCompleted();c.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0;this.observers=null}});return c}(H);A.Pauser=function(a){function b(){a.call(this)}O(b,a);b.prototype.pause=function(){this.onNext(!1)};b.prototype.resume=function(){this.onNext(!0)};return b}(Ja);K.Rx=A;!(f=function(){return A}.call(k,c,k,m),f!==b&&(m.exports=f));var cc=t()}).call(this)}).call(k,
c(13)(u),function(){return this}(),c(14))},function(u,k,c){function f(c){var f=.3*(2*Math.random()-1);return c*(1+f)}c(3);u.exports={getFuzzedDelay:f,getBackedoffDelay:function(c){return f(c*Math.pow(2,(1>=arguments.length||void 0===arguments[1]?1:arguments[1])-1))}}},function(u,k,c){c(1);u.exports=function(c,m,n){function a(){var b=t-Date.now();if(0<b)k=setTimeout(a,b);else switch(k=null,l.length){case 0:return c();case 1:return c(l[0]);case 2:return c(l[0],l[1]);case 3:return c(l[0],l[1],l[2]);
default:return c.apply(null,l)}}function b(){var c=arguments.length,f=0;for(l=Array(c);f<c;f++)l[f]=arguments[f];if(x&&!g)return g=!0,t=Date.now(),a();c=t;t=Date.now()+m;if(!k||t<c)k&&clearTimeout(k),k=setTimeout(a,m);return b}var k=null,t=0,l=[],x=!(!n||!n.leading),g=!1;b.isWaiting=function(){return!!k};b.dispose=function(){k&&(clearTimeout(k),k=null)};return b}},function(u,k){function c(c){return function(m,n){return null==m?n:c*n+(1-c)*m}}u.exports=function(f,m){return f.map(function(c){return c.value.response}).filter(function(c){return 2E3<
c.size}).map(function(c){return c.size/c.duration*8E3}).scan(c(m.alpha))}},function(u,k,c){function f(a,b){return"number"==typeof a&&0<a?a:b}function m(a,b){var d=2>=arguments.length||void 0===arguments[2]?0:arguments[2];return p.findLast(a,function(a){return a/b<=1-d})||a[0]}function n(a,b){var d=p.find(a,function(a){return a.width>=b});return d?d.bitrate:Infinity}function a(a,b){return b?p.find(a,function(a){return a.lang===b}):null}function b(a,b){return a.filter(function(a){return a.type===b})}
var p=c(1),t=c(4);k=c(3);var l=k.BehaviorSubject,x=k.CompositeDisposable,g=k.Observable.combineLatest,e=c(5).only,h=c(24),B={defLanguage:"fra",defSubtitle:"",defBufSize:30,defBufThreshold:.3};u.exports=function(c,q,d){function k(b){return I.changes().map(function(d){return a(b,d)||b[0]})}function D(b){return U.changes().map(function(d){return a(b,d)})}var u=p.defaults(3>=arguments.length||void 0===arguments[3]?{}:arguments[3],B),M=u.defSubtitle,N=u.defBufSize,y=u.defBufThreshold,F=u.initVideoBitrate,
E=u.initAudioBitrate,L=d.videoWidth,Y=d.inBackground,I=new l(u.defLanguage),U=new l(M),J={audio:h(b(c,"audio"),{alpha:.6}).publishValue(E||0),video:h(b(c,"video"),{alpha:.6}).publishValue(F||0)},da=new x(p.map(p.values(J),function(a){return a.connect()})),S={audio:new l(Infinity),video:new l(Infinity)},ea={audio:new l(Infinity),video:new l(Infinity)},W={audio:new l(N),video:new l(N),text:new l(N)};return{setLanguage:function(a){I.onNext(a)},setSubtitle:function(a){U.onNext(a)},getLanguage:function(){return I.value},
getSubtitle:function(){return U.value},getAverageBitrates:function(){return J},getAudioMaxBitrate:function(){return ea.audio.value},getVideoMaxBitrate:function(){return ea.video.value},getAudioBufferSize:function(){return W.audio.value},getVideoBufferSize:function(){return W.video.value},setAudioBitrate:function(a){S.audio.onNext(f(a,Infinity))},setVideoBitrate:function(a){S.video.onNext(f(a,Infinity))},setAudioMaxBitrate:function(a){ea.audio.onNext(f(a,Infinity))},setVideoMaxBitrate:function(a){ea.video.onNext(f(a,
Infinity))},setAudioBufferSize:function(a){W.audio.onNext(f(a,N))},setVideoBufferSize:function(a){W.video.onNext(f(a,N))},getBufferAdapters:function(a){var b=a.type,d=a.bitrates,c=a.representations;a=c[0];if(1<c.length){a=S[b];var f=ea[b],h=J[b].map(function(a,b){return m(d,a,0===b?0:y)}).changes().customDebounce(2E3,{leading:!0});"video"==b&&(f=g(f,L,Y,function(a,b,e){if(e)return d[0];b=n(c,b);return b<a?b:a}));a=g(a,f,h,function(a,b,d){return Infinity>a?a:Infinity>b?Math.min(b,d):d}).map(function(a){return p.find(c,
function(b){return b.bitrate===m(d,a)})}).changes(function(a){return a.id}).tap(function(a){return t.info("bitrate",b,a.bitrate)})}else a=e(a);return{representations:a,bufferSizes:W[b]||new l(N)}},getAdaptationsChoice:function(a,b){if("audio"==a)return k(b);if("text"==a)return D(b);if(1==b.length)return e(b[0]);throw Error("adaptive: unknown type "+a+" for adaptation chooser");},dispose:function(){da&&(da.dispose(),da=null)}}}},function(u,k,c){var f=c(1),m=c(4);c(2);k=c(7);var n=k.BufferedRanges,
a=k.bufferedToArray,b=k.getGap;k=c(3);var p=k.Observable,t=k.Subject,l=p.combineLatest,x=p.defer,g=p.empty,e=p.from,h=p.just,B=p.merge,v=p.timer;k=c(5);var q=k.first,d=k.on,z=c(46).ArraySet;c=c(16);var D=c.IndexHandler,X=c.OutOfIndexError;u.exports=function(c){function k(a){E.appendBuffer(a);return q(sa)}function p(a){return x(function(){return E.updating?q(sa).flatMap(function(){return k(a)}):k(a)})}function u(d){function c(a){if(n.test(a.id))return!1;if(a.init||null==a.time)return!0;var b=k.scale(a.time);
a=k.scale(a.duration);return(b=fa.hasRange(b,a))?1.5*b.bitrate<d.bitrate:!0}function q(a,c,e){var f=[];e&&(m.debug("add init segment",J),f.push(k.getInitSegment()));if(0===a.readyState)return f;e=a.ts;a=Math.max(0,Math.min(c,a.liveGap,(a.duration||Infinity)-e));c=b(e,E.buffered);c=c>ea&&Infinity>c?Math.min(c,W):0;var g=fa.getRange(e);g&&g.bitrate===d.bitrate&&(g=Math.floor(g.end-e),g>c&&(c=g));e=k.getSegments(e,c,a);return f.concat(e)}var k=new D(L,d),n=new z,I=l(U,ja,va,function(a,b){return{timing:a,
bufferSize:b}}).flatMap(function(b,h){var l=b.timing,k=b.bufferSize;if(da){var I=a(E.buffered);fa.equals(I)||(m.debug("intersect new buffer",J),fa.intersect(I))}var v;try{v=q(l,k,0===h),v=f.filter(v,c)}catch(p){if(p instanceof X)return S.onNext({type:"out-of-index",value:p}),g();throw p;}return e(f.map(v,function(a){n.add(a.id);return{adaptation:L,representation:d,segment:a}}))}).concatMap(Y).concatMap(function(a){return p(a.parsed.blob).map(a)}).map(function(a){var b=a.parsed;n.remove(a.segment.id);
var c=b.timescale;c&&k.setTimescale(c);c=b.nextSegments;b=b.currentSegment;c=c?k.insertNewSegments(c,b):[];b&&fa.insert(d.bitrate,k.scale(b.ts),k.scale(b.ts+b.d));return{type:"segment",value:f.extend({addedSegments:c},a)}});return B(I,S)["catch"](function(a){if(412!==a.code)throw a;return h({type:"precondition-failed",value:a}).concat(v(2E3)).concat(u(d))})}var E=c.sourceBuffer,L=c.adaptation,Y=c.pipeline,I=c.adapters,U=c.timings;c=c.seekings;var J=L.type,da="audio"==J||"video"==J,S=new t,ea="video"==
J?4:1,W="video"==J?6:1,ha=I.representations,ja=I.bufferSizes,fa=new n,sa=B(d(E,"update"),d(E,"error").map(function(a){m.error("buffer: error event",a);throw Error("buffer: error event");})).share(),va=sa.ignoreElements().startWith(!0);return l(ha,c,f.identity).flatMapLatest(u)}},function(u,k){u.exports={InitializationSegmentCache:function(){var c={};return{add:function(f,m){var k=f.segment;k.init&&(c[k.id]=m)},get:function(f){f=f.segment;return f.init&&(f=c[f.id],null!=f)?f:null}}}}},function(u,k,
c){c(4);k=c(3).Observable;var f=k.merge,m=k.interval,n=c(5).on;c=c(8).visibilityEvents();var a=c.hidden,b=c.visibilityChange,p=document,t=window,l=t.devicePixelRatio||1;u.exports=function(c){var g=n(p,b).map(function(){return p[a]}),e=g.filter(function(a){return!1===a}),g=g.customDebounce(6E4).filter(function(a){return!0===a}),e=f(e,g).startWith(!1);return{videoWidth:f(m(2E4),n(t,"resize").customDebounce(500)).startWith("init").map(function(){return c.clientWidth*l}).changes(),inBackground:e}}},function(u,
k,c){function f(c){m.call(this,c)}k=c(1);var m=c(17);f.getLiveEdge=function(){throw Error("not implemented");};k.extend(f.prototype,m.prototype);f.prototype.addSegment=function(c){this.index.timeline.push(c);return!0};u.exports=f},function(u,k,c){function f(c){this.index=c}c(1);f.getLiveEdge=function(){throw Error("not implemented");};f.prototype.checkRange=function(c){var f=this.index,a=f.list;c=Math.floor(c/f.duration);return 0<=c&&c<a.length};f.prototype.createSegment=function(c,f){var a=this.index.list[c];
return{id:c,media:a.media,time:f,number:void 0,range:a.range,duration:this.index.duration}};f.prototype.getSegments=function(c,f){for(var a=this.index.duration,b=Math.floor(c/a),k=Math.floor(f/a),t=[];b<k;)t.push(this.createSegment(b,b*a)),b++;return t};f.prototype.addSegment=function(){return!1};u.exports=f},function(u,k,c){function f(c){this.index=c}c(1);f.getLiveEdge=function(c,f){return Date.now()/1E3-f.availabilityStartTime-f.suggestedPresentationDelay};f.prototype.checkRange=function(){return!0};
f.prototype.createSegment=function(c){var f=this.index,a=f.startNumber,f=f.duration;null==a&&(a=1);c=Math.floor(c/f)+a;return{id:c,media:this.index.media,time:c*f,number:c,range:void 0,duration:this.index.duration}};f.prototype.getSegments=function(c,f){for(var a=this.index.duration,b=[],k=c;k<=f;k+=a)b.push(this.createSegment(k));return b};f.prototype.addSegment=function(){return!1};u.exports=f},function(u,k,c){function f(c,f,g){function e(a){return k(a).simpleTimeout(d,"timeout").map(function(b){b=
m.extend({response:b},a);n.add(a,b);g.onNext({type:c,value:b});return b})}var h=f.resolver,k=f.loader,v=f.parser,q=3>=arguments.length||void 0===arguments[3]?{}:arguments[3];v||(v=p);k||(k=p);h||(h=p);var q=m.defaults(q,{totalRetry:3,timeout:1E4,cache:t}),d=q.timeout,n=q.cache,D={retryDelay:500,totalRetry:q.totalRetry,shouldRetry:function(a){return 500<=a.code||200>a.code||/timeout/.test(a.message)||/request: error event/.test(a.message)}};return function(d){return h(d).flatMap(function(d){var c=
a(function(){return e(d)},D),f=n.get(d);return m.isPromise(f)?b(f)["catch"](c):null===f?c():p(f)}).flatMap(function(a){return v(a).map(function(b){return m.extend({parsed:b},a)})})}}var m=c(1);c(4);k=c(3);var n=k.Subject;k=k.Observable;var a=c(5).retryWithBackoff,b=k.fromPromise,p=k.just,t={add:function(){},get:function(){return null}};u.exports=function(){var a=new n;return{createPipelines:function(b,c){c=c||{};var e=[],h;for(h in b)e[h]=f(h,b[h],a,c[h]);return e},metrics:a}}},function(u,k,c){function f(a,
b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function m(a){D(a.man,"player: no manifest loaded")}function n(a,b){return a.filter(function(a){return a.type==b}).pluck("value")}var a=function(){function a(b,d){for(var c=0;c<d.length;c++){var e=d[c];
e.enumerable=e.enumerable||!1;e.configurable=!0;"value"in e&&(e.writable=!0);Object.defineProperty(b,e.key,e)}}return function(b,d,c){d&&a(b.prototype,d);c&&a(b,c);return b}}(),b=function(a,b,d){var c=!0;for(;c;)if(null===a&&(a=Function.prototype),c=Object.getOwnPropertyDescriptor(a,b),void 0===c){a=Object.getPrototypeOf(a);if(null===a)break;c=!0}else{if("value"in c)return c.value;b=c.get;return void 0===b?void 0:b.call(d)}},p=c(9),t=c(1),l=c(4);k=c(3);var x=k.CompositeDisposable,g=k.BehaviorSubject,
e=k.Observable,h=k.Subject,B=e.combineLatest,v=e.defer,q=e.zip,d=c(5).on;k=c(10);var z=c(47),D=c(2),e=c(8),X=e.HTMLVideoElement_,M=e.exitFullscreen,N=e.requestFullscreen,y=e.isFullscreen,F=e.onFullscreenChange,e=c(19),E=e.timingsSampler,L=e.toWallClockTime,Y=e.fromWallClockTime,I=e.getLiveGap,U=c(27).InitializationSegmentCache,e=c(7),J=e.getSize,da=e.getLoaded,S=c(36).parseTimeFragment,ea=c(28),W=c(18),ha=c(40),ja=c(32),fa=c(25),sa=c(34),va=c(15);c=function(c){function e(a){var d=this;if(!(this instanceof
e))throw new TypeError("Cannot call a class as a function");var c=a.videoElement,f=a.transport,k=a.transportOptions,m=a.initVideoBitrate;a=a.initAudioBitrate;b(Object.getPrototypeOf(e.prototype),"constructor",this).call(this);this.defaultTransport=f;this.defaultTransportOptions=k||{};c||(c=document.createElement("video"));D(c instanceof X,"requires an actual HTMLVideoElement");this.version="1.1.0";this.video=c;this.fullscreen=F(c).subscribe(function(){return d.trigger("fullscreenChange",d.isFullscreen())});
this.playing=new g;this.stream=new h;var k=ja(),f=k.createPipelines,k=k.metrics,q=E(c),c=ea(c);this.createPipelines=f;this.metrics=k;this.timings=q;this.adaptive=fa(k,q,c,{initVideoBitrate:m,initAudioBitrate:a});this.muted=.1;this._setState("STOPPED");this.resetStates();this.log=l}f(e,c);a(e,[{key:"resetStates",value:function(){this.man=null;this.reps={video:null,audio:null,text:null};this.adas={video:null,audio:null,text:null};this.evts={};this.frag={start:null,end:null}}},{key:"_clear",value:function(){this.subscriptions&&
(this.subscriptions.dispose(),this.subscriptions=null)}},{key:"stop",value:function(){"STOPPED"!==this.state&&(this.resetStates(),this._clear(),this._setState("STOPPED"))}},{key:"dispose",value:function(){this.stop();this.metrics.dispose();this.adaptive.dispose();this.fullscreen.dispose();this.stream.dispose();this.video=this.createPipelines=this.timings=this.stream=this.fullscreen=this.adaptive=this.metrics=null}},{key:"__recordState",value:function(a,b){this.evts[a]!==b&&(this.evts[a]=b,this.trigger(a+
"Change",b))}},{key:"_parseOptions",value:function(a){var b=t.defaults(t.cloneObject(a),{transport:this.defaultTransport,transportOptions:{},keySystems:[],timeFragment:{},subtitles:[],autoPlay:!1,directFile:!1}),d=b.transport,c=b.transportOptions,e=b.url,f=b.keySystems,g=b.timeFragment,h=b.subtitles,l=b.autoPlay,b=b.directFile,g=S(g);t.isString(d)&&(d=ha[d]);t.isFunction(d)&&(d=d(t.defaults(c,this.defaultTransportOptions)));D(d,"player: transport "+a.transport+" is not supported");b&&(b={isLive:!1,
duration:Infinity});return{url:e,keySystems:f,subtitles:h,timeFragment:g,autoPlay:l,transport:d,directFile:b}}},{key:"loadVideo",value:function(){var a=this,b=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],b=this._parseOptions(b);l.info("loadvideo",b);var c=b,e=c.url,f=c.keySystems,g=c.subtitles,h=c.timeFragment,k=c.autoPlay,b=c.transport,m=c.directFile;this.stop();this.frag=h;this.playing.onNext(k);var E=this.createPipelines(b,{segment:{cache:U()}}),da=this.adaptive,b=this.timings,c=
this.video,J;try{J=sa({url:e,keySystems:f,subtitles:g,timings:b,timeFragment:h,adaptive:da,pipelines:E,videoElement:c,autoPlay:k,directFile:m})}catch(S){J=v(function(){throw S;})}J=J.publish();e=n(J,"segment");f=n(J,"manifest");g=n(J,"stalled").startWith(null);h=n(J,"loaded").filter(function(a){return!0===a});m=m?h:q(h,n(e.pluck("adaptation"),"audio"),n(e.pluck("adaptation"),"video"),t.noop);m=m.take(1);g=m.map("LOADED").concat(B(this.playing,g,function(a,b){return b?"seeking"==b.name?"SEEKING":"BUFFERING":
a?"PLAYING":"PAUSED"})).changes().startWith("LOADING");this.subscriptions=new x;J=[d(c,["play","pause"]).each(function(b){return a.playing.onNext("play"==b.type)}),e.each(function(b){var d=b.adaptation.type,c=b.representation,e=b.adaptation;a.reps[d]=c;a.adas[d]=e;"text"==d&&a.__recordState("subtitle",e.lang);"video"==d&&a.__recordState("videoBitrate",c.bitrate);"audio"==d&&(a.__recordState("language",e.lang),a.__recordState("audioBitrate",c.bitrate));a.trigger("progress",b)}),f.each(function(b){a.man=
b;a.trigger("manifestChange",b)}),g.each(function(b){return a._setState(b)}),b.each(function(b){a.man&&(a.man.isLive&&0<b.ts&&(b.wallClockTime=L(b.ts,a.man),b.liveGap=I(b.ts,a.man)),a.trigger("currentTimeChange",b))}),J.subscribe(function(){},function(b){a.resetStates();a.trigger("error",b);a._setState("STOPPED");a._clear()},function(){a.resetStates();a._setState("ENDED");a._clear()}),J.subscribe(function(b){return a.stream.onNext(b)},function(b){return a.stream.onNext({type:"error",value:b})}),J.connect()];
t.each(J,function(b){return a.subscriptions.add(b)});return m.toPromise()}},{key:"_setState",value:function(a){this.state!==a&&(this.state=a,this.trigger("playerStateChange",a))}},{key:"getManifest",value:function(){return this.man}},{key:"getVideoElement",value:function(){return this.video}},{key:"getNativeTextTrack",value:function(){return this.video.textTracks[0]}},{key:"getPlayerState",value:function(){return this.state}},{key:"isLive",value:function(){m(this);return this.man.isLive}},{key:"getUrl",
value:function(){m(this);return this.man.baseURL}},{key:"getVideoDuration",value:function(){return this.video.duration}},{key:"getVideoLoadedTime",value:function(){return J(this.video.currentTime,this.video.buffered)}},{key:"getVideoPlayedTime",value:function(){return da(this.video.currentTime,this.video.buffered)}},{key:"getCurrentTime",value:function(){if(!this.man)return NaN;var a=this.video.currentTime;return this.man.isLive?L(a,this.man):a}},{key:"getStartTime",value:function(){return this.frag.start}},
{key:"getEndTime",value:function(){return this.frag.end}},{key:"getPlaybackRate",value:function(){return this.video.playbackRate}},{key:"getVolume",value:function(){return this.video.volume}},{key:"isFullscreen",value:function(){return y()}},{key:"getAvailableLanguages",value:function(){return this.man&&W.getAvailableLanguages(this.man)||[]}},{key:"getAvailableSubtitles",value:function(){return this.man&&W.getAvailableSubtitles(this.man)||[]}},{key:"getLanguage",value:function(){return this.adaptive.getLanguage()}},
{key:"getSubtitle",value:function(){return this.adaptive.getSubtitle()}},{key:"getAvailableVideoBitrates",value:function(){var a=this.man&&this.man.adaptations.video[0];return a&&a.bitrates||[]}},{key:"getAvailableAudioBitrates",value:function(){var a=this.adas.audio;return a&&a.bitrates||[]}},{key:"getVideoBitrate",value:function(){return this.evts.videoBitrate}},{key:"getAudioBitrate",value:function(){return this.evts.audioBitrate}},{key:"getVideoMaxBitrate",value:function(){return this.adaptive.getVideoMaxBitrate()}},
{key:"getAudioMaxBitrate",value:function(){return this.adaptive.getAudioMaxBitrate()}},{key:"getVideoBufferSize",value:function(){return this.adaptive.getVideoBufferSize()}},{key:"getAudioBufferSize",value:function(){return this.adaptive.getAudioBufferSize()}},{key:"getAverageBitrates",value:function(){return this.adaptive.getAverageBitrates()}},{key:"getMetrics",value:function(){return this.metrics}},{key:"getTimings",value:function(){return this.timings}},{key:"play",value:function(){this.video.play()}},
{key:"pause",value:function(){this.video.pause()}},{key:"setPlaybackRate",value:function(a){var b=this;return new p(function(d){return d(b.video.playbackRate=a)})}},{key:"goToStart",value:function(){return this.seekTo(this.getStartTime())}},{key:"seekTo",value:function(a){var b=this;return new p(function(d){D(b.man);var c=b.video.currentTime;b.man.isLive&&(a=Y(a,b.man));a!==c?(l.info("seek to",a),d(b.video.currentTime=a)):d(c)})}},{key:"setFullscreen",value:function(){!1===(0>=arguments.length||void 0===
arguments[0]?!0:arguments[0])?M():N(this.video)}},{key:"setVolume",value:function(a){a!==this.video.volume&&(this.video.volume=a,this.trigger("volumeChange",a))}},{key:"mute",value:function(){this.muted=this.getVolume()||.1;this.setVolume(0)}},{key:"unMute",value:function(){0===this.getVolume()&&this.setVolume(this.muted)}},{key:"setLanguage",value:function(a){var b=this;return new p(function(d){D(t.contains(b.getAvailableLanguages(),a),"player: unknown language");d(b.adaptive.setLanguage(a))})}},
{key:"setSubtitle",value:function(a){var b=this;return(new p(function(d){D(!a||t.contains(b.getAvailableSubtitles(),a),"player: unknown subtitle");d(b.adaptive.setSubtitle(a||""))})).then(function(){a||b.__recordState("subtitle",null)})}},{key:"setVideoBitrate",value:function(a){var b=this;return new p(function(d){D(0===a||t.contains(b.getAvailableVideoBitrates(),a),"player: video bitrate unavailable");d(b.adaptive.setVideoBitrate(a))})}},{key:"setAudioBitrate",value:function(a){var b=this;return new p(function(d){D(0===
a||t.contains(b.getAvailableAudioBitrates(),a),"player: audio bitrate unavailable");d(b.adaptive.setAudioBitrate(a))})}},{key:"setVideoMaxBitrate",value:function(a){var b=this;return new p(function(d){d(b.adaptive.setVideoMaxBitrate(a))})}},{key:"setAudioMaxBitrate",value:function(a){var b=this;return new p(function(d){d(b.adaptive.setAudioMaxBitrate(a))})}},{key:"setVideoBufferSize",value:function(a){var b=this;return new p(function(d){return d(b.adaptive.setVideoBufferSize(a))})}},{key:"setAudioBufferSize",
value:function(a){var b=this;return new p(function(d){return d(b.adaptive.setAudioBufferSize(a))})}},{key:"getStreamObservable",value:function(){return this.stream}},{key:"getDebug",value:function(){return z.getDebug(this)}},{key:"showDebug",value:function(){z.showDebug(this,this.video)}},{key:"hideDebug",value:function(){z.hideDebug()}},{key:"toggleDebug",value:function(){z.toggleDebug(this,this.video)}},{key:"getCurrentKeySystem",value:function(){return va.getCurrentKeySystem()}}]);return e}(k);
u.exports=c},function(u,k,c){function f(a,b){return p.create(function(d){b.src=a;d.onNext({url:a});return function(){b.src=""}})}function m(a){return"audio"==a||"video"==a}var n=c(1),a=c(4),b=c(2),p=c(3).Observable;k=c(5);var t=k.first,l=k.on;k=c(19);var x=k.getLiveGap,g=k.seekingsSampler,e=k.fromWallClockTime,h=c(5).retryWithBackoff,B=p.empty,v=p.never,q=p.just,d=p.merge,z=p.zip,D=Math.min;k=c(8);var X=k.MediaSource_,M=k.sourceOpen,N=k.loadedMetadataEvent,y=c(35),F=c(7).getNextRangeGap,E=c(16).getLiveEdge,
L=c(26),Y=c(15);c=c(18);var I=c.normalizeManifest,U=c.mergeManifestsIndex,J=c.mutateManifestLiveGap,da=c.getAdaptations;u.exports=function(c){function k(b,d,c){var e=c.type;c=c.codec;if(m(e))V[e]?b=V[e]:(a.info("add sourcebuffer",c),b=d.addSourceBuffer(c),V[e]=b);else{if(d=pa[e])try{d.abort()}catch(f){a.warn(f)}finally{delete pa[e]}if("text"==e)a.info("add text sourcebuffer",c),b=new y(b,c);else throw e="stream: unknown buffer type "+e,a.error(e),Error(e);pa[e]=b}return b}function u(b,d,c){b=c.type;
var e=m(b);e?(c=V[b],delete V[b]):(c=pa[b],delete pa[b]);if(c)try{c.abort(),e&&d.removeSourceBuffer(c)}catch(f){a.warn(f)}}function ha(a){var b=Ta.map(function(b){var d;rb?(d=n.cloneObject(b),d.ts=D(b.ts,Fa),d.duration=D(b.duration,Fa)):d=b;d.liveGap=x(b.ts,a);return d}),d=g(b);return{timings:b,seekings:d}}function ja(d,c,e,f){var g=c.type,h=wa.getAdaptationsChoice(g,c.adaptations);b(A[g],"stream: no pipeline found for type "+g);return h.flatMapLatest(function(b){if(!b)return u(R,d,c),v();var h=wa.getBufferAdapters(b);
b=L({sourceBuffer:k(R,d,c),pipeline:A[g],adaptation:b,timings:e,seekings:f,adapters:h});return m(g)?b:b["catch"](function(b){a.error("buffer",g,"has crashed",b);return B()})})}function fa(d){var c=N(R).tap(function(){var c=d.duration,f=qb,g=Fa,h=/^\d*(\.\d+)? ?%$/;n.isString(f)&&h.test(f)&&(f=parseFloat(f)/100*c);n.isString(g)&&h.test(g)&&(Fa=parseFloat(g)/100*c);if(Infinity===g||"100%"===g)g=c;d.isLive?f=f?e(f,d):E(d):b(f<c&&g<=c,"stream: bad startTime and endTime");a.info("set initial time",f);
R.currentTime=f}),f=l(R,"canplay").tap(function(){a.info("canplay event");ya&&R.play();ya=!0}).tap(function(){R.currentTime=R.buffered.start(0)});return t(z(c,f,n.noop)).map({type:"loaded",value:!0}).startWith({type:"loaded",value:!1})}function sa(b){return K&&K.length?Y(R,K,{persistedSessions:b.isLive}):Y.onEncrypted(R).map(function(){a.error("eme: ciphered media and no keySystem passed");throw Error("eme: ciphered media and no keySystem passed");})}function va(b){var d=1>=arguments.length||void 0===
arguments[1]?!0:arguments[1];return b.distinctUntilChanged(null,function(a,b){var c=b.stalled,e=a.stalled,c=e||c?e&&c?e.name==c.name:!1:!0;!c&&d&&(R.playbackRate=e?e.playback:0);return c}).map(function(b){if(b.stalled){var d=F(b.ts,b.buffered);if(1>d){var c=b.ts+d+.01;R.currentTime=c;a.warn("discontinuity seek",b.ts,d,c)}}return{type:"stalled",value:b.stalled}})}function Na(a){return a&&"out-of-index"==a.type}function Ya(b,d){if(Na(d))return a.warn("out of index"),aa({url:b.locations[0]}).map(function(a){a=
a.parsed;return{type:"manifest",value:U(b,I(a.url,a.manifest,Sa))}});d&&"precondition-failed"==d.type&&(J(b,1),a.warn("precondition failed",b.presentationLiveGap));return q(d)}function mb(a,b,c,e){var f=n.map(da(b),function(b){return ja(a,b,c,e)}),f=d(f);return b.isLive?f.distinctUntilChanged(null,function(a,b){return Na(b)&&Na(a)}).concatMap(function(a){return Ya(b,a)}):f}function Za(b,c){var e=ha(c),f=e.timings,g=e.seekings,e=q({type:"manifest",value:c}),h=fa(c),g=mb(b,c,f,g),k=sa(c),f=va(f,!0),
m=l(R,"error").flatMap(function(){var b="stream: video element MEDIA_ERR code "+R.error.code;a.error(b);throw Error(b);});return d(e,h,k,g,f,m).takeUntil(Oa)}function nb(){var a=ha(Ba,{timeInterval:1E3}).timings,b=q({type:"manifest",value:Ba}),c=fa(Ba),a=va(a,!1);return d(b,c,a).takeUntil(Oa)}var La=c.url,K=c.keySystems,Sa=c.subtitles,Ta=c.timings,$a=c.timeFragment,wa=c.adaptive,A=c.pipelines,R=c.videoElement,ya=c.autoPlay,Ba=c.directFile;b(X,"player: browser is required to support MediaSource");
var qb=$a.start,Fa=$a.end,rb=Infinity>Fa,aa=A.manifest,V={},pa={},Oa=Ta.filter(function(a){var b=a.ts;a=a.duration;return 0<a&&.2>D(a,Fa)-b}).take(1).share();if(Ba)return f(La,R).flatMap(nb).takeUntil(Oa);c=h(function(b){var d=b.url,c=b.mediaSource;b=M(c);return aa({url:d}).zip(b,n.identity).flatMap(function(b){b=b.parsed;b=I(b.url,b.manifest,Sa);c.duration=Infinity===b.duration?Number.MAX_VALUE:b.duration;a.info("set duration",c.duration);return Za(c,b)})},{retryDelay:500,totalRetry:3,resetDelay:6E4,
shouldRetry:function(b,d){if(/MEDIA_ERR/.test(b.message))return!1;a.warn("stream retry",b,d);return!0}});return function(b,d){return p.create(function(c){var e=new X,f=d.src=URL.createObjectURL(e);c.onNext({url:b,mediaSource:e});a.info("create mediasource object",f);return function(){d.src="";if(e&&"closed"!==e.readyState){var b=e.readyState;n.each(n.cloneArray(e.sourceBuffers),function(d){try{"open"==b&&d.abort(),"closed"!=b&&e.removeSourceBuffer(d)}catch(c){a.warn("error while disposing souceBuffer",
c)}})}n.each(n.keys(pa),function(b){b=pa[b];try{b.abort()}catch(d){a.warn("error while disposing souceBuffer",d)}});f&&URL.revokeObjectURL(f);f=e=pa=V=null}})}(La,R).flatMap(c).takeUntil(Oa)}},function(u,k,c){function f(){p.call(this);this.updating=!1;this.readyState="opened";this.buffered=new t}function m(a,b){f.call(this);this.video=a;this.codec=b;this.isVTT=/^text\/vtt/.test(b);var c=document.createElement("track"),h=c.track;this.trackElement=c;this.track=h;c.kind="subtitles";h.mode="showing";
a.appendChild(c)}var n=c(9),a=c(1),b=c(2),p=c(10),t=c(7).BufferedRanges;f.prototype=a.extend({},p.prototype,{appendBuffer:function(a){var b=this;return this._lock(function(){return b._append(a)})},remove:function(a,b){var c=this;return this._lock(function(){return c._remove(a,b)})},abort:function(){this.remove(0,Infinity);this.updating=!1;this.readyState="closed";this._abort()},_append:function(a){},_remove:function(a,b){},_lock:function(a){var c=this;b(!this.updating,"text-buffer: cannot remove while updating");
this.updating=!0;this.trigger("updatestart");return(new n(function(b){return b(a())})).then(function(){return c._unlock("update")},function(a){return c._unlock("error",a)})},_unlock:function(a,b){this.trigger(a,b);this.updating=!1;this.trigger("updateend")}});var l=window.VTTCue||window.TextTrackCue;m.prototype=a.extend({},f.prototype,{createCuesFromArray:function(b){if(!b.length)return[];a.last(b);return a.compact(a.map(b,function(a){var b=a.start,c=a.end;if(a=a.text)return new l(b,c,a)}))},_append:function(b){var c=
this;if(this.isVTT)b=new Blob([b],{type:"text/vtt"}),b=URL.createObjectURL(b),this.trackElement.src=b,this.buffered.insert(0,Infinity);else{var e=this.createCuesFromArray(b);e.length&&(a.each(e,function(a){return c.track.addCue(a)}),b=e[0],e=a.last(e),this.buffered.insert(0,b.startTime,e.endTime))}return n.resolve()},_remove:function(b,c){var e=this.track;a.each(a.cloneArray(e.cues),function(a){var f=a.startTime,l=a.endTime;f>=b&&f<=c&&l<=c&&e.removeCue(a)})},_abort:function(){var a=this.trackElement,
b=this.video;a&&b&&b.hasChildNodes(a)&&b.removeChild(a);this.track.mode="disabled";this.size=0;this.video=this.track=this.trackElement=null}});u.exports=m},function(u,k,c){function f(a){if(!a)return!1;a=a.replace(/^npt\:/,"").replace(/\.$/,"");var b,c;a=a.split(":");var e=a.length;switch(e){case 3:b=parseInt(a[0],10);c=parseInt(a[1],10);a=parseFloat(a[2]);break;case 2:b=0;c=parseInt(a[0],10);a=parseFloat(a[1]);break;case 1:c=b=0;a=parseFloat(a[0]);break;default:return!1}p(23>=b,t);p(59>=c,t);p(1>=
e||60>a,t);return 3600*b+60*c+a}function m(a){if(!a)return!1;var b,c,e,f;a=a.split(":");switch(a.length){case 3:b=parseInt(a[0],10);c=parseInt(a[1],10);e=parseInt(a[2],10);f=a=0;break;case 4:b=parseInt(a[0],10);c=parseInt(a[1],10);e=parseInt(a[2],10);-1===a[3].indexOf(".")?(a=parseInt(a[3],10),f=0):(f=a[3].split("."),a=parseInt(f[0],10),f=parseInt(f[1],10));break;default:return!1}p(23>=b,t);p(59>=c,t);p(59>=e,t);return 3600*b+60*c+e+.001*a+1E-6*f}function n(a){return new Date(Date.parse(a))}function a(a){return a?
a:!1}var b=c(1),p=c(2),t="Invalid MediaFragment",t="Invalid MediaFragment";u.exports={parseTimeFragment:function(c){if(b.isString(c)){var k=c,g=k.split(",");p(2>=g.length,t);c=g[0]?g[0]:"";g=g[1]?g[1]:"";p((c||g)&&(!c||g||-1===k.indexOf(",")),t);c=c.replace(/^smpte(-25|-30|-30-drop)?\:/,"").replace("clock:","");var k=/^((npt\:)?((\d+\:(\d\d)\:(\d\d))|((\d\d)\:(\d\d))|(\d+))(\.\d*)?)?$/,e=/^(\d+\:\d\d\:\d\d(\:\d\d(\.\d\d)?)?)?$/,h=/^((\d{4})(-(\d{2})(-(\d{2})(T(\d{2})\:(\d{2})(\:(\d{2})(\.(\d+))?)?(Z|(([-\+])(\d{2})\:(\d{2})))?)?)?)?)?$/,
B=/^(\d*(\.\d+)? ?%)?$/;if(k.test(c)&&k.test(g))k=f;else if(e.test(c)&&e.test(g))k=m;else if(h.test(c)&&h.test(g))k=n;else if(B.test(c)&&B.test(g))k=a;else throw Error(t);c=k(c);g=k(g);p(!1!==c||!1!==g,t);c={start:!1===c?"":c,end:!1===g?"":g}}else c=b.pick(c,["start","end"]);b.isString(c.start)&&b.isString(c.end)?(c.start||(c.start="0%"),c.end||(c.end="100%")):(c.start||(c.start=0),c.end||(c.end=Infinity));b.isString(c.start)&&b.isString(c.end)?(p(0<=parseFloat(c.start)&&100>=parseFloat(c.start),
"player: startTime should be between 0% and 100%"),p(0<=parseFloat(c.end)&&100>=parseFloat(c.end),"player: endTime should be between 0% and 100%")):(p((b.isNumber(c.start)||b.isDate(c.start))&&(b.isNumber(c.end)||b.isDate(c.end)),"player: timeFragment should have interface { start, end } where start and end are numbers or dates"),p(c.start<c.end,"player: startTime should be lower than endTime"),p(0<=c.start,"player: startTime should be greater than 0"));return c}}},function(u,k,c){function f(a){var b=
m(a,2);a=b[0];return(b=b[1])&&Infinity!==b?"bytes="+ +a+"-"+ +b:"bytes="+ +a+"-"}var m=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var d=[],c=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(c=(h=g.next()).done)&&(d.push(h.value),!b||d.length!==b);c=!0);}catch(k){e=!0,f=k}finally{try{if(!c&&g["return"])g["return"]()}finally{if(e)throw f;}}return d}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),n=c(1);k=c(3).Observable;
var a=k.empty,b=k.merge,p=k.just,t=c(2),l=c(12),x=c(11).resolveURL;k=c(38);var g=k.parseSidx,e=k.patchPssh,h=c(39),B=function(a){a.withMetadata=!0;return l(a)};u.exports=function(){var c=(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]).contentProtectionParser;c||(c=n.noop);var k={loader:function(d){var c=d.adaptation,e=d.representation,g=d.segment,h=g.media,k=g.range;d=g.indexRange;if(g.init&&!(h||k||d))return a();k=n.isArray(k)?{Range:f(k)}:null;if(h)var l=g.time,g=g.number,h=-1===h.indexOf("$")?
h:h.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,e.id).replace(/\$Bandwidth\$/g,e.bitrate).replace(/\$Number\$/g,g).replace(/\$Time\$/g,l);else h="";c=x(c.rootURL,c.baseURL,e.baseURL,h);e=B({url:c,format:"arraybuffer",headers:k});return n.isArray(d)?(d=B({url:c,format:"arraybuffer",headers:{Range:f(d)}}),b(e,d)):e},parser:function(a){var b=a.adaptation,c=a.segment;a=new Uint8Array(a.response.blob);var f=c.init,h=c.indexRange,k,l,m;if(h=g(a,h?h[0]:0))k=h.segments,l=h.timescale;f||(0<=c.time&&
0<=c.duration?m={ts:c.time,d:c.duration}:h&&1===h.segments.length&&(m={ts:h.segments[0].ts,d:h.segments[0].d}),t(m));f&&b.contentProtection&&(a=e(a,b.contentProtection));return p({blob:a,currentSegment:m,nextSegments:k,timescale:l})}};return{manifest:{loader:function(a){return B({url:a.url,format:"document"})},parser:function(a){a=a.response;return p({manifest:h(a.blob,c),url:a.url})}},audio:k,video:k,text:{loader:function(a){}}}}},function(u,k,c){function f(a,b){for(var c=0,f=a.length,g,d;c+8<f&&
(d=p(a,c),g=p(a,c+4),n(0<d,"dash: out of range size"),g!==b);)c+=d;if(c>=f)return-1;n(c+d<=f,"dash: atom out of range");return c}function m(b){var c=b.systemId;b=b.privateData;c=c.replace(/-/g,"");n(32===c.length);c=g(4,l(c),a(b.length),b);return g(a(c.length+8),x("pssh"),c)}var n=c(2);k=c(6);var a=k.itobe4,b=k.be8toi,p=k.be4toi,t=k.be2toi,l=k.hexToBytes,x=k.strToBytes,g=k.concat;u.exports={parseSidx:function(a,c){var g=f(a,1936286840);if(-1==g)return null;var k=p(a,g),g=g+4+4,l=a[g],g=g+8,d=p(a,
g),g=g+4;if(0===l)l=p(a,g),g+=4,c+=p(a,g)+k,g+=4;else if(1===l)l=b(a,g),g+=8,c+=b(a,g)+k,g+=8;else return null;for(var k=[],g=g+2,m=t(a,g),g=g+2;0<=--m;){var n=p(a,g),g=g+4,u=n&2147483647;if(1==(n&2147483648)>>>31)throw Error("not implemented");n=p(a,g);g+=4;g+=4;k.push({ts:l,d:n,r:0,range:[c,c+u-1]});l+=n;c+=u}return{segments:k,timescale:d}},patchPssh:function(b,c){if(!c||!c.length)return b;var k=f(b,1836019574);if(-1==k)return b;for(var l=p(b,k),q=[b.subarray(k,k+l)],d=0;d<c.length;d++)q.push(m(c[d]));
q=g.apply(null,q);q.set(a(q.length),0);return g(b.subarray(0,k),q,b.subarray(k+l))}}},function(u,k,c){function f(a){var b=F.last(a.timeline);return(b.ts+(b.r+1)*b.d)/a.timescale}function m(a,b){var d=J[a.nodeName];E(d,"parser: no attributes for "+a.nodeName);return F.reduce(d,function(b,d){var c=d.k,e=d.fn,f=d.n,g=d.def;a.hasAttribute(c)?b[f||c]=e(a.getAttribute(c)):null!=g&&(b[f||c]=g);return b},b||{})}function n(a){return a}function a(a){return"true"==a}function b(a){return"true"==a?!0:"false"==
a?!1:parseInt(a)}function p(a){return new Date(Date.parse(a))}function t(a){if(!a)return 0;var b=L.exec(a);E(b,"parser: "+a+" is not a valid ISO8601 duration");return 31536E3*parseFloat(b[2]||0)+2592E3*parseFloat(b[4]||0)+86400*parseFloat(b[6]||0)+3600*parseFloat(b[8]||0)+60*parseFloat(b[10]||0)+parseFloat(b[12]||0)}function l(a){var b=I.exec(a);if(!b)return-1;a=parseInt(b[1])||0;b=parseInt(b[2])||0;return 0<b?a/b:a}function x(a){return a}function g(a){return(a=Y.exec(a))?[+a[1],+a[2]]:null}function e(a,
b,d){for(a=a.firstElementChild;a;)d=b(d,a.nodeName,a),a=a.nextElementSibling;return d}function h(a){var b=e(a,function(a,b,d){if("Initialization"==b){var c,e;d.hasAttribute("range")&&(c=g(d.getAttribute("range")));d.hasAttribute("sourceURL")&&(e=d.getAttribute("sourceURL"));a.initialization={range:c,media:e}}return a},m(a));"SegmentBase"==a.nodeName&&(b.indexType="base",b.timeline=[]);return b}function B(a){return e(a,function(a,b,d){"SegmentTimeline"==b&&(a.indexType="timeline",a.timeline=v(d));
return a},h(a))}function v(a){return e(a,function(a,b,d){b=a.length;d=m(d);null==d.ts&&(b=0<b&&a[b-1],d.ts=b?b.ts+b.d*(b.r+1):0);null==d.r&&(d.r=0);a.push(d);return a},[])}function q(a){a=B(a);a.indexType||(a.indexType="template");return a}function d(a){var b=B(a);b.list=[];b.indexType="list";return e(a,function(a,b,d){"SegmentURL"==b&&a.list.push(m(d));return a},b)}function z(a){var b=e(a,function(a,b,c){switch(b){case "BaseURL":a.baseURL=c.textContent;break;case "SegmentBase":a.index=h(c);break;
case "SegmentList":a.index=d(c);break;case "SegmentTemplate":a.index=q(c)}return a},{});return m(a,b)}function D(a,b){var c=e(a,function(a,c,e){switch(c){case "ContentProtection":c=b(m(e),e);a.contentProtection=c;break;case "ContentComponent":a.contentComponent=m(e);break;case "BaseURL":a.baseURL=e.textContent;break;case "SegmentBase":a.index=h(e);break;case "SegmentList":a.index=d(e);break;case "SegmentTemplate":a.index=q(e);break;case "Representation":a.representations.push(z(e))}return a},{representations:[]});
return m(a,c)}function X(a,b){var d=m(a,e(a,function(a,d,c){switch(d){case "BaseURL":a.baseURL=c.textContent;break;case "AdaptationSet":a.adaptations.push(D(c,b))}return a},{adaptations:[]}));d.baseURL&&F.each(d.adaptations,function(a){return F.defaults(a,{baseURL:d.baseURL})});return d}function M(a,b){var d=a.documentElement;E.equal(d.nodeName,"MPD","parser: document root should be MPD");var c=e(d,function(a,d,c){switch(d){case "BaseURL":a.baseURL=c.textContent;break;case "Location":a.locations.push(c.textContent);
break;case "Period":a.periods.push(X(c,b))}return a},{transportType:"dash",periods:[],locations:[]}),c=m(d,c);/isoff-live/.test(c.profiles)&&(d=(d=F.find(c.periods[0].adaptations,function(a){return"video/mp4"==a.mimeType}))&&d.index,E(d&&("timeline"==d.indexType||"template"==d.indexType)),E(c.availabilityStartTime),d=d.timeline?f(d):Date.now()/1E3-60,c.availabilityStartTime=c.availabilityStartTime.getTime()/1E3,c.presentationLiveGap=Date.now()/1E3-(d+c.availabilityStartTime));return c}function N(a,
b){return M((new DOMParser).parseFromString(a,"application/xml"),b)}function y(a,b){if(F.isString(a))return N(a,b);if(a instanceof window.Document)return M(a,b);throw Error("parser: unsupported type to parse");}var F=c(1),E=c(2),L=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,Y=/([0-9]+)-([0-9]+)/,I=/([0-9]+)(\/([0-9]+))?/;k=[{k:"profiles",fn:n},{k:"width",fn:parseInt},{k:"height",fn:parseInt},{k:"frameRate",fn:l},{k:"audioSamplingRate",fn:n},{k:"mimeType",fn:n},{k:"segmentProfiles",
fn:n},{k:"codecs",fn:n},{k:"maximumSAPPeriod",fn:parseFloat},{k:"maxPlayoutRate",fn:parseFloat},{k:"codingDependency",fn:a}];c=[{k:"timescale",fn:parseInt},{k:"presentationTimeOffset",fn:parseFloat,def:0},{k:"indexRange",fn:g},{k:"indexRangeExact",fn:a},{k:"availabilityTimeOffset",fn:parseFloat},{k:"availabilityTimeComplete",fn:a}];var U=c.concat([{k:"duration",fn:parseInt},{k:"startNumber",fn:parseInt}]),J={ContentProtection:[{k:"schemeIdUri",fn:n},{k:"value",fn:n}],SegmentURL:[{k:"media",fn:n},
{k:"mediaRange",fn:g},{k:"index",fn:n},{k:"indexRange",fn:g}],S:[{k:"t",fn:parseInt,n:"ts"},{k:"d",fn:parseInt},{k:"r",fn:parseInt}],SegmentTimeline:[],SegmentBase:c,SegmentTemplate:U.concat([{k:"initialization",fn:function(a){return{media:a,range:void 0}}},{k:"index",fn:n},{k:"media",fn:n},{k:"bitstreamSwitching",fn:n}]),SegmentList:U,ContentComponent:[{k:"id",fn:n},{k:"lang",fn:n},{k:"contentType",fn:n},{k:"par",fn:x}],Representation:k.concat([{k:"id",fn:n},{k:"bandwidth",fn:parseInt,n:"bitrate"},
{k:"qualityRanking",fn:parseInt}]),AdaptationSet:k.concat([{k:"id",fn:n},{k:"group",fn:parseInt},{k:"lang",fn:n},{k:"contentType",fn:n},{k:"par",fn:x},{k:"minBandwidth",fn:parseInt,n:"minBitrate"},{k:"maxBandwidth",fn:parseInt,n:"maxBitrate"},{k:"minWidth",fn:parseInt},{k:"maxWidth",fn:parseInt},{k:"minHeight",fn:parseInt},{k:"maxHeight",fn:parseInt},{k:"minFrameRate",fn:l},{k:"maxFrameRate",fn:l},{k:"segmentAlignment",fn:b},{k:"subsegmentAlignment",fn:b},{k:"bitstreamSwitching",fn:a}]),Period:[{k:"id",
fn:n},{k:"start",fn:t},{k:"duration",fn:t},{k:"bitstreamSwitching",fn:a}],MPD:[{k:"id",fn:n},{k:"profiles",fn:n},{k:"type",fn:n},{k:"availabilityStartTime",fn:p},{k:"availabilityEndTime",fn:p},{k:"publishTime",fn:p},{k:"mediaPresentationDuration",fn:t,n:"duration"},{k:"minimumUpdatePeriod",fn:t},{k:"minBufferTime",fn:t},{k:"timeShiftBufferDepth",fn:t},{k:"suggestedPresentationDelay",fn:t},{k:"maxSegmentDuration",fn:t},{k:"maxSubsegmentDuration",fn:t}]};y.parseFromString=N;y.parseFromDocument=M;u.exports=
y},function(u,k,c){u.exports={smooth:c(41),dash:c(37)}},function(u,k,c){function f(a){return(a=a.match(F))&&a[1]||""}function m(a,b){return b?a.replace(F,"?token="+b):a.replace(F,"")}function n(a,b,d){return x(a.rootURL,a.baseURL,b.baseURL).replace(/\{bitrate\}/g,b.bitrate).replace(/\{start time\}/g,d.time)}var a=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var d=[],c=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(c=(h=g.next()).done)&&(d.push(h.value),
!b||d.length!==b);c=!0);}catch(k){e=!0,f=k}finally{try{if(!c&&g["return"])g["return"]()}finally{if(e)throw f;}}return d}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}();k=c(1);var b=c(3).Observable,p=b.empty,t=b.just;c(2);var l=c(12),x=c(11).resolveURL,g=c(6).bytesToStr,e=c(4),h=c(43),b=c(42),B=b.patchSegment,v=b.createVideoInitSegment,q=b.createAudioInitSegment,d=b.getMdat,z=b.getTraf,D=b.parseTfrf,X=b.parseTfxd,b=c(44).parseSami;c=c(45).parseTTML;var M={"application/x-sami":b,
"application/ttml+xml":c,"application/ttml+xml+mp4":c,"text/vtt":k.identity},N=/\.(isml?)(\?token=\S+)?$/,y=/\.wsx?(\?token=\S+)?/,F=/\?token=(\S+)/,E=function(a){a.withMetadata=!0;return l(a)};u.exports=function(){function b(a,d,c){var f,g;d.isLive?(a=z(a))?(f=D(a),g=X(a)):e.warn("smooth: could not find traf atom"):f=null;g||(g={d:c.duration,ts:c.time});return{nextSegments:f,currentSegment:g}}var c={loader:function(b){var d=b.adaptation,c=b.representation;b=b.segment;if(b.init){var e;b=d.smoothProtection||
{};switch(d.type){case "video":e=v(c.index.timescale,c.width,c.height,72,72,4,c.codecPrivateData,b.keyId,b.keySystems);break;case "audio":e=q(c.index.timescale,c.channels,c.bitsPerSample,c.packetSize,c.samplingRate,c.codecPrivateData,b.keyId,b.keySystems)}return t({blob:e,size:e.length,duration:100})}var f;if(e=b.range)e=a(e,2),f=e[0],f=(e=e[1])&&Infinity!==e?"bytes="+ +f+"-"+ +e:"bytes="+ +f+"-",f={Range:f};d=n(d,c,b);return E({url:d,format:"arraybuffer",headers:f})},parser:function(a){var d=a.adaptation,
c=a.response;a=a.segment;if(a.init)return t({blob:c.blob,timings:null});c=new Uint8Array(c.blob);a=b(c,d,a);d=a.nextSegments;a=a.currentSegment;return t({blob:B(c,a.ts),nextSegments:d,currentSegment:a})}};return{manifest:{resolver:function(a){a=a.url;var b=f(a);return(y.test(a)?E({url:m(a,""),format:"document"}).map(function(a){return a.blob.getElementsByTagName("media")[0].getAttribute("src")}):t(a)).map(function(a){var d=a.match(N);a=d?a.replace(d[1],d[1]+"/manifest"):a;return{url:m(a,b)}})},loader:function(a){return E({url:a.url,
format:"document"})},parser:function(a){a=a.response;return t({manifest:h(a.blob),url:a.url})}},audio:c,video:c,text:{loader:function(a){var b=a.adaptation,d=a.representation,c=a.segment;if(c.init)return p();a=d.mimeType;b=n(b,d,c);return 0<=a.indexOf("mp4")?E({url:b,format:"arraybuffer"}):E({url:b,format:"text"})},parser:function(a){var c=a.response,e=a.adaptation,f=a.representation;a=a.segment;var h=e.lang,k=f.mimeType,l=M[k];if(!l)throw Error("smooth: could not find a text-track parser for the type "+
k);var m=c.blob;0<=k.indexOf("mp4")?(m=new Uint8Array(m),c=g(d(m))):c=m;k=b(m,e,a);e=k.nextSegments;k=k.currentSegment;return t({blob:l(c,h,a.time/f.index.timescale),currentSegment:k,nextSegments:e})}}}}},function(u,k,c){function f(a,b){l(4===a.length);return x(z(b.length+8),N(a),b)}function m(a,b,c,e,f){for(var g=0,h=a.length,k;g<h;){k=d(a,g);if(1970628964===d(a,g+4)&&d(a,g+8)===b&&d(a,g+12)===c&&d(a,g+16)===e&&d(a,g+20)===f)return a.subarray(g+24,g+k);g+=k}}function n(a,b){for(var c=0,e=a.length,
f,g;c+8<e&&(g=d(a,c),f=d(a,c+4),l(0<g,"dash: out of range size"),f!==b);)c+=g;if(!(c>=e))return a.subarray(c+8,c+g)}function a(a,b,d,c){var e=[a,b,d];t.each(c,function(a){a=y.pssh(a.systemId,a.privateData,a.keyIds);e.push(a)});return e}function b(b,d,c,e,g,h,k){c=y.mult("stbl",[c,f("stts",new Uint8Array(8)),f("stsc",new Uint8Array(8)),f("stsz",new Uint8Array(12)),f("stco",new Uint8Array(8))]);var l=f("url ",new Uint8Array([0,0,0,1])),l=y.dref(l),l=y.mult("dinf",[l]);e=y.mult("minf",[e,l,c]);d=y.hdlr(d);
c=y.mdhd(b);d=y.mult("mdia",[c,d,e]);g=y.tkhd(g,h,1);g=y.mult("trak",[g,d]);h=y.trex(1);h=y.mult("mvex",[h]);b=y.mvhd(b,1);k=y.mult("moov",a(b,h,g,k));b=y.ftyp("isom",["isom","iso2","iso6","avc1","dash"]);return x(b,k)}var p=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var d=[],c=!0,e=!1,f=void 0;try{for(var g=a[Symbol.iterator](),h;!(c=(h=g.next()).done)&&(d.push(h.value),!b||d.length!==b);c=!0);}catch(k){e=!0,f=k}finally{try{if(!c&&g["return"])g["return"]()}finally{if(e)throw f;
}}return d}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),t=c(1),l=c(2);k=c(6);var x=k.concat,g=k.strToBytes,e=k.bytesToStr,h=k.hexToBytes,B=k.bytesToHex,v=k.be2toi,q=k.itobe2,d=k.be4toi,z=k.itobe4,D=k.be8toi,X=k.itobe8,M=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350],N=t.memoize(g),y={mult:function(a,b){return f(a,x.apply(null,b))},avc1encv:function(a,b,d,c,e,h,k,m,n,p){l("avc1"===a||"encv"===a,"should be avc1 or encv atom");return f(a,x(6,
q(b),16,q(d),q(c),q(e),2,q(h),6,[0,1,k.length],g(k),31-k.length,q(m),[255,255],n,"encv"===a?p:[]))},avcc:function(a,b,d,c,e,g){c=2===c?1:4===c?3:0;e=h(e);g=h(g);return f("avcC",x([1,a,b,d,252|c,225],q(e.length),e,[1],q(g.length),g))},dref:function(a){return f("dref",x(7,[1],a))},esds:function(a,b){return f("esds",x(4,[3,25],q(a),[0,4,17,64,21],11,[5,2],h(b),[6,1,2]))},frma:function(a){l.equal(a.length,4,"wrong data format length");return f("frma",g(a))},free:function(a){return f("free",new Uint8Array(a-
8))},ftyp:function(a,b){return f("ftyp",x.apply(null,[g(a),[0,0,0,1]].concat(b.map(g))))},hdlr:function(a){return f("hdlr",x(8,g("audio"===a?"soun":"vide"),12,g("Media Handler")))},mdhd:function(a){return f("mdhd",x(12,z(a),8))},moof:function(a,b){return y.mult("moof",[a,b])},mp4aenca:function(a,b,d,c,e,g,h,k){return f(a,x(6,q(b),8,q(d),q(c),2,q(e),q(g),2,h,"enca"===a?k:[]))},mvhd:function(a,b){return f("mvhd",x(12,z(a),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,q(b+1)))},pssh:function(a){var b=
1>=arguments.length||void 0===arguments[1]?[]:arguments[1],d=2>=arguments.length||void 0===arguments[2]?[]:arguments[2];a=a.replace(/-/g,"");l(32===a.length,"wrong system id length");var c,e=d.length;0<e?(c=1,d=x.apply(null,[z(e)].concat(d))):(c=0,d=[]);return f("pssh",x([c,0,0,0],h(a),d,z(b.length),b))},saio:function(a,b,d,c){return f("saio",x(4,[0,0,0,1],z(a.length+b.length+d.length+c.length+8+8+8+8)))},saiz:function(a){if(0===a.length)return f("saiz",new Uint8Array);var b=d(a,0),c=d(a,4),e=new Uint8Array(9+
c);e.set(z(c),5);for(var c=9,g=8,h,k;g<a.length;)g+=8,2===(b&2)?(k=2,h=v(a,g),g+=2+6*h):k=h=0,e[c]=6*h+8+k,c++;return f("saiz",e)},schm:function(a,b){l.equal(a.length,4,"wrong scheme type length");return f("schm",x(4,g(a),z(b)))},senc:function(a){return f("senc",a)},smhd:function(){return f("smhd",new Uint8Array(8))},stsd:function(a){return f("stsd",x.apply(null,[7,[a.length]].concat(a)))},tkhd:function(a,b,d){return f("tkhd",x(z(7),8,z(d),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],q(a),2,
q(b),2))},trex:function(a){return f("trex",x(4,z(a),[0,0,0,1],12))},tfdt:function(a){return f("tfdt",x([1,0,0,0],X(a)))},tenc:function(a,b,d){l.equal(d.length,32,"wrong default KID length");return f("tenc",x(6,[a,b],h(d)))},traf:function(a,b,d,c,e){var f=[a,b,d];c&&f.push(y.senc(c),y.saiz(c),y.saio(e,a,b,d));return y.mult("traf",f)},vmhd:function(){var a=new Uint8Array(12);a[3]=1;return f("vmhd",a)}},F={traf:function(a){return(a=n(a,1836019558))?n(a,1953653094):null},senc:function(a){return m(a,2721664850,
1520127764,2722393154,2086964724)},tfxd:function(a){return m(a,1830656773,1121273062,2162299933,2952222642)},tfrf:function(a){return m(a,3565190898,3392751253,2387879627,2655430559)},mdat:function(a){return n(a,1835295092)}};u.exports={getMdat:F.mdat,getTraf:F.traf,parseTfrf:function(a){a=F.tfrf(a);if(!a)return[];for(var b=[],c=a[0],e=a[4],f=0;f<e;f++){var g,h;1==c?(h=D(a,16*f+5),g=D(a,16*f+13)):(h=d(a,8*f+5),g=d(a,8*f+9));b.push({ts:h,d:g})}return b},parseTfxd:function(a){if(a=F.tfxd(a))return{d:D(a,
12),ts:D(a,4)}},createVideoInitSegment:function(a,d,c,e,f,g,h,k,l){l||(l=[]);h=h.split("00000001");var m=p(h,3);h=m[1];var m=m[2],q=parseInt(h.substr(2,2),16),n=parseInt(h.substr(4,2),16),v=parseInt(h.substr(6,2),16);g=y.avcc(q,n,v,g,h,m);l.length?(k=y.tenc(1,8,k),k=y.mult("schi",[k]),h=y.schm("cenc",65536),m=y.frma("avc1"),k=y.mult("sinf",[m,h,k]),e=y.avc1encv("encv",1,d,c,e,f,"AVC Coding",24,g,k)):e=y.avc1encv("avc1",1,d,c,e,f,"AVC Coding",24,g);e=y.stsd([e]);return b(a,"video",e,y.vmhd(),d,c,l)},
createAudioInitSegment:function(a,d,c,e,f,g,h,k){k||(k=[]);g||(g=M.indexOf(f),l(0<=g,"non supported frequency"),g=((32|g&31)<<4|d&31)<<3,g=B(q(g)));g=y.esds(1,g);if(k.length){h=y.tenc(1,8,h);h=y.mult("schi",[h]);var m=y.schm("cenc",65536),n=y.frma("mp4a");h=y.mult("sinf",[n,m,h]);d=y.mp4aenca("enca",1,d,c,e,f,g,h)}else d=y.mp4aenca("mp4a",1,d,c,e,f,g);d=y.stsd([d]);return b(a,"audio",d,y.smhd(),0,0,k)},patchSegment:function(a,b){var c=e(a.subarray(4,8));l("moof"===c);var c=a.subarray(0,d(a,0)),f=
y.tfdt(b),g=f.length,h=d(c,8),k=d(c,8+h),m=d(c,8+h+8),n=d(c,8+h+8+m),q=c.subarray(8,8+h),p=c.subarray(8+h+8,8+h+8+k-8),k=p.subarray(0,m),n=p.subarray(m,m+n);k.set([0,0,0,1],12);p=F.senc(p);f=y.traf(k,f,n,p,q);q=y.moof(q,f);g=8+h+8+m+g;m=a.length;h=q.length;f=c.length;c=a.subarray(f,m);m=new Uint8Array(h+(m-f));m.set(q,0);m.set(c,h);m.set(z(q.length+8),g+16);return m}}},function(u,k,c){function f(a){var b=x.last(a.timeline);return(b.ts+(b.r+1)*b.d)/a.timescale}function m(a,b,c){for(a=a.firstElementChild;a;)c=
b(c,a.nodeName,a),a=a.nextElementSibling;return c}function n(a,b){return x.reduce(b,function(b,c){var e=l(c,3),f=e[0],g=e[2];b[e[1]]=x.isFunction(g)?g(a.getAttribute(f)):g[a.getAttribute(f)];return b},{})}function a(a,b){a.hasAttribute("Timescale")&&(b=+a.getAttribute("Timescale"));var c=a.getAttribute("Type"),e=a.getAttribute("Subtype"),f=q[c];g(f,"parser: unrecognized QualityLevel type "+c);var h=m(a,function(a,b,d){switch(b){case "QualityLevel":d=n(d,f);if("video"!=c||19E4<d.bitrate)d.id=x.uniqueId(),
a.representations.push(d);break;case "c":b=a.index;var e=a.index.timeline,g=e.length,h=0<g?e[g-1]:{d:0,ts:0,r:0},k=+d.getAttribute("d"),l=d.getAttribute("t");(d=+d.getAttribute("r"))&&d--;0<g&&k==h.d&&null==l?h.r+=(d||0)+1:e.push({d:k,ts:null==l?h.ts+h.d*(h.r+1):+l,r:d});b.timeline=e}return a},{representations:[],index:{timeline:[],indexType:"timeline",timescale:b,initialization:{}}}),k=h.representations,h=h.index;g(k.length,"parser: adaptation should have at least one representation");var l=k[0].codecs;
l||(l=v[c],x.each(k,function(a){return a.codecs=l}));var p=k[0].mimeType;p||(p=B[c],x.each(k,function(a){return a.mimeType=p}));"ADVT"==e&&(c="ad-insert");return{id:x.uniqueId(),type:c,index:h,representations:k,name:a.getAttribute("Name"),lang:a.getAttribute("Language"),baseURL:a.getAttribute("Url")}}function b(a){return p((new DOMParser).parseFromString(a,"application/xml"))}function p(b){b=b.documentElement;g.equal(b.nodeName,"SmoothStreamingMedia","parser: document root should be SmoothStreamingMedia");
g(/^[2]-[0-2]$/.test(b.getAttribute("MajorVersion")+"-"+b.getAttribute("MinorVersion")),"Version should be 2.0, 2.1 or 2.2");var c=+b.getAttribute("Timescale")||1E7,k=m(b,function(b,d,f){switch(d){case "Protection":f=f.firstElementChild;g.equal(f.nodeName,"ProtectionHeader","parser: Protection should have ProtectionHeader child");d=e.strToBytes(atob(f.textContent));var h;h=e.le2toi(d,8);h=e.bytesToUTF16Str(d.subarray(10,10+h));h=(new DOMParser).parseFromString(h,"application/xml").querySelector("KID").textContent;
h=e.guidToUuid(atob(h)).toLowerCase();var k=e.hexToBytes(h);f=f.getAttribute("SystemID").toLowerCase().replace(/\{|\}/g,"");d={keyId:h,keySystems:[{systemId:f,privateData:d}].concat([{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:e.concat([8,1,18,16],k)}])};b.protection=d;break;case "StreamIndex":b.adaptations.push(a(f,c))}return b},{protection:null,adaptations:[]}),l=k.protection,k=k.adaptations;x.each(k,function(a){return a.smoothProtection=l});var q,n,p,v,t="TRUE"===b.getAttribute("IsLive");
if(t){q=20;p=+b.getAttribute("DVRWindowLength")/c;v=h;n=x.find(k,function(a){return"video"==a.type});var u=x.find(k,function(a){return"audio"==a.type});n=Math.min(f(n.index),f(u.index));n=Date.now()/1E3-(n+v)}return{transportType:"smoothstreaming",profiles:"",type:t?"dynamic":"static",suggestedPresentationDelay:q,timeShiftBufferDepth:p,presentationLiveGap:n,availabilityStartTime:v,periods:[{duration:(+b.getAttribute("Duration")||Infinity)/c,adaptations:k,laFragCount:+b.getAttribute("LookAheadFragmentCount")}]}}
function t(a){if(x.isString(a))return b(a);if(a instanceof window.Document)return p(a);throw Error("parser: unsupported type to parse");}var l=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var c=[],e=!0,f=!1,g=void 0;try{for(var h=a[Symbol.iterator](),k;!(e=(k=h.next()).done)&&(c.push(k.value),!b||c.length!==b);e=!0);}catch(l){f=!0,g=l}finally{try{if(!e&&h["return"])h["return"]()}finally{if(f)throw g;}}return c}throw new TypeError("Invalid attempt to destructure non-iterable instance");
}}(),x=c(1),g=c(2),e=c(6),h=Date.UTC(1970,0,1,0,0,0,0)/1E3,B={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},v={audio:"mp4a.40.2",video:"avc1.4D401E"};k={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4"};c={AACL:"mp4a.40.5",AACH:"mp4a.40.5",AVC1:"avc1.4D401E",H264:"avc1.4D401E"};var q={audio:[["Bitrate","bitrate",parseInt],["AudioTag","audiotag",parseInt],["FourCC","mimeType",k],["FourCC","codecs",c],["Channels","channels",parseInt],["SamplingRate",
"samplingRate",parseInt],["BitsPerSample","bitsPerSample",parseInt],["PacketSize","packetSize",parseInt],["CodecPrivateData","codecPrivateData",String]],video:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",k],["FourCC","codecs",c],["MaxWidth","width",parseInt],["MaxHeight","height",parseInt],["CodecPrivateData","codecPrivateData",String]],text:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",k]]};t.parseFromString=b;t.parseFromDocument=p;u.exports=t},function(u,k,c){function f(a){return a.replace(p,
"\n").replace(b,function(a,b){return String.fromCharCode(b)})}var m=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var c=[],f=!0,k=!1,l=void 0;try{for(var d=a[Symbol.iterator](),m;!(f=(m=d.next()).done)&&(c.push(m.value),!b||c.length!==b);f=!0);}catch(n){k=!0,l=n}finally{try{if(!f&&d["return"])d["return"]()}finally{if(k)throw l;}}return c}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),n=c(1),a=c(2),b=/&#([0-9]+);/g,p=
/<br>/gi,t=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,l=/\s*<p class=([^>]+)>(.*)/i,x=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;u.exports={parseSami:function(b,c){var h=/<sync[ >]/ig,k=/<sync[ >]|<\/body>/ig,p=[],q=b.match(t),q=m(q,2)[1],d,u=k.exec(b),u=/\.(\S+)\s*{([^}]*)}/gi,D;for(d={};D=u.exec(q);){var X=D[1];D=D[2].match(/\s*lang:\s*(\S+);/i)[1];X&&D&&(d[D]=X)}q=d[c];for(a(q,"sami: could not find lang "+c+" in CSS");;){d=h.exec(b);u=k.exec(b);if(!d&&!u)break;if(!d||!u||d.index>=u.index)throw Error("parse error");
d=b.slice(d.index,u.index);u=d.match(x);if(!u)throw Error("parse error: sync time attribute");X=+u[1];if(isNaN(X))throw Error("parse error: sync time attribute NaN");u=p;d=d.split("\n");X/=1E3;D=d.length;for(var M=void 0;0<=--D;)if(M=d[D].match(l)){var M=m(M,3),N=M[2];q===M[1]&&("&nbsp;"===N?n.last(u).end=X:u.push({text:f(N),start:X}))}}return p}}},function(u,k,c){function f(c,e){var h=0;c=c.firstChild;for(var k=[],n;c;){if(1===c.nodeType)switch(c.tagName.toUpperCase()){case "P":n=c;var q=e,d=m(n.getAttribute("begin"),
q),p=m(n.getAttribute("end"),q),t=m(n.getAttribute("dur"),0);if(!a.isNumber(d)&&!a.isNumber(p)&&!a.isNumber(t))throw Error("ttml: unsupported timestamp format");0<t?(null==d&&(d=h||q),null==p&&(p=d+t)):null==p&&(p=m(n.getAttribute("duration"),0),p=0<=p?p+d:Number.MAX_VALUE);n={id:n.getAttribute("xml:id")||n.getAttribute("id"),text:decodeURIComponent(l(n.innerHTML.replace(b,"\n"))),start:d,end:p};h=n.end;k.push(n);break;case "DIV":n=m(c.getAttribute("begin"),0),null==n&&(n=e),k.push.apply(k,f(c,n))}c=
c.nextSibling}return k}function m(a,b){if(a){var c;if(c=a.match(p)){c=n(c,7);var f=c[3],k=c[4],l=c[6];return 3600*parseInt(c[2]||0,10)+60*parseInt(f,10)+parseInt(k,10)+parseFloat("0."+l)}if(c=a.match(t))return c=n(c,5),f=c[4],parseFloat(c[1])*x[f]+b}}var n=function(){return function(a,b){if(Array.isArray(a))return a;if(Symbol.iterator in Object(a)){var c=[],f=!0,k=!1,l=void 0;try{for(var d=a[Symbol.iterator](),m;!(f=(m=d.next()).done)&&(c.push(m.value),!b||c.length!==b);f=!0);}catch(n){k=!0,l=n}finally{try{if(!f&&
d["return"])d["return"]()}finally{if(k)throw l;}}return c}throw new TypeError("Invalid attempt to destructure non-iterable instance");}}(),a=c(1),b=/<br[^>]+>/gm,p=/^(([0-9]+):)?([0-9]+):([0-9]+)(\.([0-9]+))?$/,t=/(([0-9]+)(\.[0-9]+)?)(ms|h|m|s)/,l=window.escape,x={h:3600,m:60,s:1,ms:.001};u.exports={parseTTML:function(b,c,h){b=a.isString(b)?(new DOMParser).parseFromString(b,"text/xml"):b;if(!(b instanceof window.Document||b instanceof window.HTMLElement))throw Error("ttml: needs a Document to parse");
b=b.querySelector("tt");if(!b)throw Error("ttml: could not find <tt> tag");b=f(b.querySelector("body"),0);a.each(b,function(a){a.start+=h;a.end+=h});return b}}},function(u,k){function c(){this.arr=[]}c.prototype.add=function(c){this.arr.push(c)};c.prototype.remove=function(c){c=this.arr.indexOf(c);0<=c&&this.arr.splice(c,1)};c.prototype.test=function(c){return 0<=this.arr.indexOf(c)};c.prototype.size=function(){return this.arr.length};u.exports={ArraySet:c}},function(u,k,c){function f(a){return null==
a?"":String(a).replace(x,function(a){return g[a]})}function m(a){var b=a.getAverageBitrates(),c,f;b.video.subscribe(function(a){return f=a|0}).dispose();b.audio.subscribe(function(a){return c=a|0}).dispose();return{manifest:a.man,version:a.version,timeFragment:a.frag,currentTime:a.getCurrentTime(),state:a.getPlayerState(),buffer:p(a.video.buffered),volume:a.getVolume(),video:{adaptation:a.adas.video,representation:a.reps.video,maxBitrate:a.getVideoMaxBitrate(),bufferSize:a.getVideoBufferSize(),avrBitrate:f},
audio:{adaptation:a.adas.audio,representation:a.reps.audio,maxBitrate:a.getAudioMaxBitrate(),bufferSize:a.getAudioBufferSize(),avrBitrate:c}}}function n(a,b){var c=b.parentNode.querySelector("#cp--debug-infos-content");if(c){var g;try{g=m(a)}catch(k){return}var d=g,l=d.video,n=d.audio,d=d.manifest;g="<b>Player v"+g.version+"</b> ("+g.state+")<br>";d&&l&&n&&(g+=["Container: "+f(d.transportType),"Live: "+f(""+d.isLive),"Downloading bitrate (Kbit/s): "+(l.representation.bitrate/1E3).toFixed(3)+"/"+(n.representation.bitrate/
1E3).toFixed(3),"Estimated bandwidth (Kbit/s): "+(l.avrBitrate/1E3).toFixed(3)+"/"+(n.avrBitrate/1E3).toFixed(3),"Location: "+d.locations[0]].join("<br>"));c.innerHTML=g}}function a(a,c){var g="<style>\n#cp--debug-infos {\n  position: absolute;\n  top: "+f(c.offsetTop+10)+"px;\n  left: "+f(c.offsetLeft+10)+'px;\n  width: 500px;\n  height: 300px;\n  background-color: rgba(10, 10, 10, 0.83);\n  overflow: hidden;\n  color: white;\n  text-align: left;\n  padding: 2em;\n  box-sizing: border-box;\n}\n#cp--debug-hide-infos {\n  float: right;\n  cursor: pointer;\n}\n</style>\n<div id="cp--debug-infos">\n  <a id="cp--debug-hide-infos">[x]</a>\n  <p id="cp--debug-infos-content"></p>\n</div>',
k=c.parentNode,m=k.querySelector("#cp--debug-infos-container");m||(m=document.createElement("div"),m.setAttribute("id","cp--debug-infos-container"),k.appendChild(m));m.innerHTML=g;l||(l=k.querySelector("#cp--debug-hide-infos"),l.addEventListener("click",function(){return b(c)}));t&&clearInterval(t);t=setInterval(function(){return n(a,c)},1E3);n(a,c)}function b(a){(a=a.parentNode.querySelector("#cp--debug-infos-container"))&&a.parentNode.removeChild(a);t&&(clearInterval(t),t=null);l&&(l.removeEventListener("click",
b),l=null)}var p=c(7).bufferedToArray,t,l,x=/[&<>"']/g,g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};u.exports={getDebug:m,showDebug:a,hideDebug:b,toggleDebug:function(c,f){f.parentNode.querySelector("#cp--debug-infos-container")?b(f):a(c,f)}}},function(u,k){u.exports=function(){throw Error("define cannot be used indirect");}}])});
