(function(r,h){"object"===typeof exports&&"object"===typeof module?module.exports=h():"function"===typeof define&&define.amd?define([],h):"object"===typeof exports?exports.RxPlayer=h():r.RxPlayer=h()})(this,function(){return function(r){function h(p){if(c[p])return c[p].exports;var q=c[p]={exports:{},id:p,loaded:!1};r[p].call(q.exports,q,q.exports,h);q.loaded=!0;return q.exports}var c={};h.m=r;h.c=c;h.p="";return h(0)}([function(r,h,c){r.exports=c(32)},function(r,h){function c(a,b){for(var e=-1,d=
a?a.length:0;++e<d;)if(a[e]===b)return e;return-1}function p(a){return!!a&&"object"==typeof a&&"[object Date]"==C.call(a)||!1}function q(a){return!!a&&"function"==typeof a||!1}function l(a){return"number"==typeof a}function a(a){return!!a&&"object"==typeof a||!1}function b(a){return"string"==typeof a}function f(b){for(var e=arguments,d=1;d<e.length;d++){var m=e[d];if(a(m))for(var f=J(m),k=0,c=f.length;k<c;k++)b[f[k]]=m[f[k]]}return b}function v(a,b){for(var e=a?a.length:0,d=-1,m=Array(e);++d<e;)m[d]=
b(a[d],d);return m}function k(a,b,e){for(var d=a?a.length:0,m=-1;++m<d;)e=b(e,a[m],m);return e}function u(a,b){for(var e=a?a.length:0,d=-1,m=[];++d<e;)b(a[d],d)&&m.push(a[d]);return m}function w(a,d){for(var m in a)if(d.hasOwnProperty(m)){var f=a[m],k=d[m];b(f)||l(f)||p(f)?a[m]=k:e(f)?(f.length=0,x.apply(f,k)):a[m]=w(f,k)}return a}var m=Object.prototype,C=m.toString,d=m.hasOwnProperty,e=Array.isArray,x=Array.prototype.push,J=Object.keys||function(a){var b=[],d;for(d in a)a.hasOwnProperty(d)&&b.push(a[d]);
return b},m=function(){var a=0;return function(b){b||(b="");return""+b+a++}}();r.exports={chunk:function(a,b){for(var d=[],e=0,m=-1,f=a?a.length:0;++m<f;)d[e]?d[e].length===b?d[++e]=[a[m]]:d[e].push(a[m]):d[e]=[a[m]];return d},compact:function(a){return u(a,function(a){return null!=a})},contains:function(a,b){return-1<c(a,b)},cloneArray:function(a){for(var b=a?a.length:0,d=-1,e=Array(b);++d<b;)e[d]=a[d];return e},cloneObject:function(a){return f({},a)},defaults:function(a,b){for(var d in b)"undefined"==
typeof a[d]&&(a[d]=b[d]);return a},each:function(a,b){for(var d=a?a.length:0,e=-1;++e<d;)b(a[e],e)},extend:f,values:function(a){for(var b=J(a),d=-1,e=b.length,m=Array(e);++d<e;)m[d]=a[b[d]];return m},filter:u,find:function(a,b){for(var d=-1,e=a?a.length:0;++d<e;)if(b(a[d],d))return a[d]},between:function(a,b,d){for(var e=-1,m=a?a.length:0;++e<m;)if(a[e][b]<=d&&a[e+1]&&d<a[e+1][b])return a[e]},findLast:function(a,b){for(var d=a?a.length:0;0<=--d;)if(b(a[d],d))return a[d]},flatten:function(a,b){for(var d=
b?v(a,b):a,e=-1,m=d?d.length:0,f=[];++e<m;){var k=d[e];if(k&&"object"==typeof k&&"number"==typeof k.length){var c=-1,l=k.length,w=f.length;for(f.length+=l;++c<l;)f[w++]=k[c]}else f.push(k)}return f},groupBy:function(a,b){var d;d=q(b)?b:function(a){return a[b]};return k(a,function(a,b){var m=d(b);(e(a[m])?a[m]:a[m]=[]).push(b);return a},{})},identity:function(a){return a},indexOf:c,isArray:e,isDate:p,isFunction:q,isNumber:l,isObject:a,isString:b,isPromise:function(a){return!!a&&"function"==typeof a.then},
isObservable:function(a){return!!a&&"function"==typeof a.subscribe},keys:J,last:function(a){return a[a.length-1]},map:v,memoize:function(a,b){var e=function I(){var e=I.cache,m=b?b.apply(this,arguments):arguments[0];return d.call(e,m)?e[m]:e[m]=a.apply(this,arguments)};e.cache={};return e},noop:function(){},pad:function(a,b){a=a.toString();return a.length>=b?a:(Array(b+1).join("0")+a).slice(-b)},pick:function(a,b){return k(b,function(b,d){d in a&&(b[d]=a[d]);return b},{})},pluck:function(a,b){return v(a,
function(a){return a[b]})},reduce:k,simpleMerge:w,sortedIndex:function(a,b,d){var e=0,m=a?a.length:e;for(b=d(b);e<m;){var f=e+m>>>1;d(a[f])<b?e=f+1:m=f}return e},sortedMerge:function(a,b,d){for(var e=0,m=0,f=0,k=a.length,c=b.length,l=[];e<k&&m<c;)a[e][d]<=b[m][d]?(l[f]=a[e],e++,f++):0<f&&b[m][d]<=l[f-1][d]?m++:(l[f]=b[m],m++,f++);if(e<k)for(d=e;d<k;d++)l[f]=a[d],f++;else for(d=m;d<c;d++)l[f]=b[d],f++;return l},tryCatch:function(a){try{return a()}catch(b){return b}},uniqueId:m}},function(r,h){function c(q){this.name=
"AssertionError";this.message=q;Error.captureStackTrace&&Error.captureStackTrace(this,c)}function p(q,l){if(!q)throw new c(l);}c.prototype=Error();p.equal=function(c,l,a){return p(c===l,a)};p.iface=function(c,l,a){p(c,l+" should be an object");for(var b in a)p.equal(typeof c[b],a[b],l+" should have property "+b+" as a "+a[b])};r.exports=p},function(r,h,c){c(5);r.exports=c(13)},function(r,h){function c(){}var p={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},q=function(){};c.error=q;c.warn=q;c.info=q;c.debug=
q;c.setLevel=function(l){"string"==typeof l&&(l=p[l]);c.error=l>=p.ERROR?console.error.bind(console):q;c.warn=l>=p.WARNING?console.warn.bind(console):q;c.info=l>=p.INFO?console.info.bind(console):q;c.debug=l>=p.DEBUG?console.log.bind(console):q};r.exports=c},function(r,h,c){h=c(13);var p=h.Observable,q=h.SingleAssignmentDisposable;h=h.config;var l=p.fromEvent,a=p.merge,b=p.timer,f=c(20).getBackedoffDelay,v=c(1),k=v.isArray,u=v.map,w=v.noop,m=c(21);h.useNativeEvents=!0;c=p.prototype;c.log=function(){return this};
c.each=function(a){return this.subscribe(a,w)};var C=function(a,b){return a===b};c.changes=function(a){return this.distinctUntilChanged(a,C)};c.customDebounce=function(a,b){var f=this;return p.create(function(k){var c=m(function(a){return k.onNext(a)},a,b),l=f.subscribe(c,function(a){return k.onError(a)},function(){return k.onCompleted()});return function(){c.dispose();l.dispose()}})};c.simpleTimeout=function(a){var b=1>=arguments.length||void 0===arguments[1]?"timeout":arguments[1],m=this;return p.create(function(f){var k=
new q,c=setTimeout(function(){return f.onError(Error(b))},a);k.setDisposable(m.subscribe(function(a){clearTimeout(c);f.onNext(a)},function(a){return f.onError(a)},function(a){return f.onCompleted()}));return function(){clearTimeout(c);k.dispose()}})};r.exports={on:function(b,e){return k(e)?a(u(e,function(a){return l(b,a)})):l(b,e)},first:function(a){return a.take(1)},only:function(a){return p.never().startWith(a)},retryWithBackoff:function(a,e){var k=e.retryDelay,c=e.totalRetry,l=e.shouldRetry,u=
e.resetDelay,C=0,v;v=0<u?m(function(){return C=0},u):w;return function E(){for(var e=0,m=arguments.length,w=Array(m);e<m;e++)w[e]=arguments[e];return a.apply(null,w)["catch"](function(a){if(l&&!l(a,C)||C++>=c)throw a;a=f(k,C);return b(a).flatMap(function(){v();return E.apply(null,w)})})}}}},function(r,h,c){r.exports=c(48).Promise},function(r,h,c){function p(a){for(var b=a.length,f=new Uint8Array(b),c=0;c<b;c++)f[c]=a.charCodeAt(c)&255;return f}function q(a,b){b||(b="");for(var f="",c=0;c<a.byteLength;c++)f+=
(a[c]>>>4).toString(16),f+=(a[c]&15).toString(16),b.length&&(f+=b);return f}var l=c(2);r.exports={totalBytes:function(a){for(var b=0,f=0;f<a.length;f++)b+=a[f].byteLength;return b},strToBytes:p,bytesToStr:function(a){return String.fromCharCode.apply(null,a)},bytesToUTF16Str:function(a){for(var b="",f=a.length,c=0;c<f;c+=2)b+=String.fromCharCode(a[c]);return b},hexToBytes:function(a){for(var b=a.length,f=new Uint8Array(b/2),c=0,k=0;c<b;c+=2,k++)f[k]=parseInt(a.substr(c,2),16)&255;return f},bytesToHex:q,
concat:function(){for(var a=arguments.length,b=-1,f=0,c;++b<a;)c=arguments[b],f+="number"===typeof c?c:c.length;for(var f=new Uint8Array(f),k=0,b=-1;++b<a;)c=arguments[b],"number"===typeof c?k+=c:0<c.length&&(f.set(c,k),k+=c.length);return f},be2toi:function(a,b){return(a[0+b]<<8)+(a[1+b]<<0)},be4toi:function(a,b){return 16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b]},be8toi:function(a,b){return 4294967296*(16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b])+16777216*a[4+b]+65536*a[5+b]+256*a[6+b]+a[7+
b]},le2toi:function(a,b){return(a[0+b]<<0)+(a[1+b]<<8)},le4toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]},le8toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]+(a[4+b]+256*a[5+b]+65536*a[6+b]+16777216*a[7+b]*4294967296)},itobe2:function(a){return new Uint8Array([a>>>8&255,a&255])},itobe4:function(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])},itobe8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a>>>24&255,
a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255])},itole2:function(a){return new Uint8Array([a&255,a>>>8&255])},itole4:function(a){return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255])},itole8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255,b&255,b>>>8&255,b>>>16&255,b>>>24&255])},guidToUuid:function(a){l.equal(a.length,16,"UUID length should be 16");var b=p(a);a=b[0];var f=b[1],c=b[2],k=b[3],u=b[4],w=b[5],m=
b[6],C=b[7],d=b.subarray(8,10),b=b.subarray(10,16),e=new Uint8Array(16);e[0]=k;e[1]=c;e[2]=f;e[3]=a;e[4]=w;e[5]=u;e[6]=C;e[7]=m;e.set(d,8);e.set(b,10);return q(e)},toBase64URL:function(a){return btoa(a).replace(/\=+$/,"")}}},function(r,h,c){function p(a){return a&&"function"==typeof a.then?a:m.resolve(a)}function q(a){return function(){var b;try{b=a.apply(this,arguments)}catch(d){return m.reject(d)}return p(b)}}function l(a,b){return w.flatten(a,function(a){return w.map(b||O,function(b){return b+
a})})}function a(a,b){return w.find(b,function(b){var d;d=document.createElement(a.tagName);b="on"+b;b in d?d=!0:(d.setAttribute(b,"return;"),d=w.isFunction(d[b]));return d})}function b(b,d){var e;b=l(b,d);return function(d){return d instanceof X?("undefined"==typeof e&&(e=a(d,b)||null),e?H(d,e):F()):y(d,b)}}function f(a,b){function d(){var a=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];a.errorCode&&(a={systemCode:a.systemCode,code:a.errorCode.code});this.name="KeySessionError";this.mediaKeyError=
a;this.message="MediaKeyError code:"+a.code+" and systemCode:"+a.systemCode}d.prototype=Error();return function(e,f){var c=w.isFunction(b)?b.call(this):this,t=V(c),k=da(c).map(function(a){throw new d(c.error||a);});try{return a.call(this,e,f),J(t,k).take(1).toPromise()}catch(l){return m.reject(l)}}}function v(a,b){if(b instanceof Q)return b._setVideo(a);if(a.setMediaKeys)return a.setMediaKeys(b);if(null!==b){if(a.WebkitSetMediaKeys)return a.WebkitSetMediaKeys(b);if(a.mozSetMediaKeys)return a.mozSetMediaKeys(b);
if(a.msSetMediaKeys)return new m(function(d,e){1<=a.readyState?(a.msSetMediaKeys(b),d()):a.addEventListener("loadedmetatdata",function(){try{a.msSetMediaKeys(b)}catch(m){return e(m)}finally{a.removeEventListener("loadedmetatdata")}d()})});throw Error("compat: cannot find setMediaKeys method");}}function k(){return!!(I.fullscreenElement||I.mozFullScreenElement||I.webkitFullscreenElement||I.msFullscreenElement)}var u=function(){function a(b,d){for(var e=0;e<d.length;e++){var m=d[e];m.enumerable=m.enumerable||
!1;m.configurable=!0;"value"in m&&(m.writable=!0);Object.defineProperty(b,m.key,m)}}return function(b,d,e){d&&a(b.prototype,d);e&&a(b,e);return b}}(),w=c(1);c(4);var m=c(6),C=c(10);h=c(7);var d=h.bytesToStr,e=h.strToBytes,x=c(2);h=c(3).Observable;var J=h.merge,F=h.never,H=h.fromEvent,N=h.just,y=c(5).on,I=document,E=window,O=["","webkit","moz","ms"],X=E.HTMLElement;c=E.HTMLVideoElement;var Y=E.MediaSource||E.MozMediaSource||E.WebKitMediaSource||E.MSMediaSource,U=E.MediaKeys||E.MozMediaKeys||E.WebKitMediaKeys||
E.MSMediaKeys;h="Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&/Trident\//.test(navigator.userAgent);var Q=w.noop,R;navigator.requestMediaKeySystemAccess&&(R=function(a,b){return navigator.requestMediaKeySystemAccess(a,b)});var ea=function(){function a(b,d,e){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this._keyType=b;this._mediaKeys=d;this._configuration=e}a.prototype.createMediaKeys=function(){return m.resolve(this._mediaKeys)};
a.prototype.getConfiguration=function(){return this._configuration};u(a,[{key:"keySystem",get:function(){return this._keyType}}]);return a}(),P=b(h?["progress"]:["loadedmetadata"]),ga=b(["sourceopen","webkitsourceopen"]);h=b(["encrypted","needkey"]);var ba=b(["keymessage","message"]),V=b(["keyadded","ready"]),da=b(["keyerror","error"]),W=b(["keystatuseschange"]);h={onEncrypted:h,onKeyMessage:ba,onKeyStatusesChange:W,onKeyError:da};if(!R&&c.prototype.webkitGenerateKeyRequest){var fa=function(a,b){var d=
this;C.call(this);this._vid=a;this._key=b;this._con=J(ba(a),V(a),da(a)).subscribe(function(a){return d.trigger(a.type,a)})};fa.prototype=w.extend({},C.prototype,{generateRequest:q(function(a,b){this._vid.webkitGenerateKeyRequest(this._key,b)}),update:f(function(a,b){if(0<=this._key.indexOf("clearkey")){var m=JSON.parse(d(a)),f=e(atob(m.keys[0].k)),m=e(atob(m.keys[0].kid));this._vid.webkitAddKey(this._key,f,m,b)}else this._vid.webkitAddKey(this._key,a,null,b)}),close:q(function(){this._con&&this._con.dispose();
this._vid=this._con=null})});Q=function(a){this.ks_=a};Q.prototype={_setVideo:function(a){this._vid=a},createSession:function(){return new fa(this._vid,this.ks_)}};var A=function(a){var b=I.querySelector("video")||I.createElement("video");return b&&b.canPlayType?!!b.canPlayType("video/mp4",a):!1};R=function(a,b){if(!A(a))return m.reject();for(var d=0;d<b.length;d++){var e=b[d],f=e.videoCapabilities,c=e.audioCapabilities,t=e.initDataTypes,k=e.sessionTypes,l=e.distinctiveIdentifier,e=e.persistentState,
u=!0;if(u=(u=(u=(u=u&&(!t||!!w.find(t,function(a){return"cenc"===a})))&&(!k||w.filter(k,function(a){return"temporary"===a}).length===k.length))&&"required"!==l)&&"required"!==e)return d={videoCapabilities:f,audioCapabilities:c,initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"not-allowed",sessionTypes:["temporary"]},m.resolve(new ea(a,new Q(a),d))}return m.reject()}}else if(U&&!R){var t=function(a){C.call(this);this._mk=a};t.prototype=w.extend(C.prototype,{generateRequest:q(function(a,
b){var d=this;this._ss=this._mk.memCreateSession("video/mp4",b);this._con=J(ba(this._ss),V(this._ss),da(this._ss)).subscribe(function(a){return d.trigger(a.type,a)})}),update:f(function(a,b){x(this._ss);this._ss.update(a,b)},function(){return this._ss}),close:q(function(){this._ss&&(this._ss.close(),this._ss=null,this._con.dispose(),this._con=null)})});U.prototype.alwaysRenew=!0;U.prototype.memCreateSession=U.prototype.createSession;U.prototype.createSession=function(){return new t(this)};R=function(a,
b){if(!U.isTypeSupported(a))return m.reject();for(var d=0;d<b.length;d++){var e=b[d],f=e.videoCapabilities,c=e.audioCapabilities,t=e.initDataTypes,e=e.distinctiveIdentifier,k=!0;if(k=(k=k&&(!t||w.find(t,function(a){return"cenc"===a})))&&"required"!==e)return d={videoCapabilities:f,audioCapabilities:c,initDataTypes:["cenc"],distinctiveIdentifier:"not-allowed",persistentState:"required",sessionTypes:["temporary","persistent-license"]},m.resolve(new ea(a,new Q(a),d))}return m.reject()}}U||(W=function(){throw Error("eme: MediaKeys is not available");
},U={create:W,isTypeSupported:W});E.WebKitSourceBuffer&&!E.WebKitSourceBuffer.prototype.addEventListener&&(W=E.WebKitSourceBuffer.prototype,w.extend(W,C.prototype),W.__listeners=[],W.appendBuffer=function(a){if(this.updating)throw Error("SourceBuffer updating");this.trigger("updatestart");this.updating=!0;try{this.append(a)}catch(b){this.__emitUpdate("error",b);return}this.__emitUpdate("update")},W.__emitUpdate=function(a,b){var d=this;setTimeout(function(){d.trigger(a,b);d.updating=!1;d.trigger("updateend")},
0)});W=b(["fullscreenchange","FullscreenChange"],O.concat("MS"));r.exports={HTMLVideoElement_:c,MediaSource_:Y,isCodecSupported:function(a){return!!Y&&Y.isTypeSupported(a)},sourceOpen:function(a){return"open"==a.readyState?N():ga(a).take(1)},loadedMetadata:function(a){return a.readyState>=HTMLVideoElement.HAVE_METADATA?N():P(a).take(1)},canPlay:function(a){return a.readyState>=HTMLVideoElement.HAVE_ENOUGH_DATA?N():y(a,"canplay").take(1)},KeySystemAccess:ea,requestMediaKeySystemAccess:R,setMediaKeys:function(a,
b){return p(v(a,b))},emeEvents:h,isFullscreen:k,onFullscreenChange:W,requestFullscreen:function(a){if(!k()){if(a.requestFullscreen)return a.requestFullscreen();if(a.msRequestFullscreen)return a.msRequestFullscreen();if(a.mozRequestFullScreen)return a.mozRequestFullScreen();if(a.webkitRequestFullscreen)return a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(k()){if(I.exitFullscreen)return I.exitFullscreen();if(I.msExitFullscreen)return I.msExitFullscreen();if(I.mozCancelFullScreen)return I.mozCancelFullScreen();
if(I.webkitExitFullscreen)return I.webkitExitFullscreen()}},videoSizeChange:function(){return y(E,"resize")},visibilityChange:function(){var a;null!=I.hidden?a="":null!=I.mozHidden?a="moz":null!=I.msHidden?a="ms":null!=I.webkitHidden&&(a="webkit");var b=a?a+"Hidden":"hidden";return y(I,a+"visibilitychange").map(function(){return I[b]})}}},function(r,h,c){function p(a){if(v.isArray(a))return a;for(var b=-1,f=a.length,d=Array(f);++b<f;)d[b]={start:a.start(b),end:a.end(b),bitrate:0};return d}function q(a,
b){return a.start<=b&&b<a.end}function l(b,m){for(var f=0;f<m.length;f++)if(a(b,m[f]))return m[f];return null}function a(a,b){return q(a,b.start)||q(a,b.end)||q(b,a.start)}function b(a,b){return q(a,b.start)&&q(a,b.end)}function f(a,b,f){return{start:Math.min(a.start,b.start),end:Math.max(a.end,b.end),bitrate:f}}var v=c(1),k=c(2),u=1/60;h=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.ranges=a?p(a):[];this.length=this.ranges.length}c.prototype.start=
function(a){return this.ranges[a].start};c.prototype.end=function(a){return this.ranges[a].end};c.prototype.hasRange=function(a,b){for(var d=a+b,e=0;e<this.ranges.length;e++){var c=this.ranges[e],f=c.start,c=c.end;if(f-a<=u&&a-c<=u&&f-d<=u&&d-c<=u)return this.ranges[e]}return null};c.prototype.getRange=function(a){for(var b=0;b<this.ranges.length;b++)if(q(this.ranges[b],a))return this.ranges[b];return null};c.prototype.getGap=function(a){var b=this.getRange(a);return b?b.end-a:Infinity};c.prototype.getLoaded=
function(a){var b=this.getRange(a);return b?a-b.start:0};c.prototype.getSize=function(a){return(a=this.getRange(a))?a.end-a.start:0};c.prototype.getNextRangeGap=function(a){for(var b=this.ranges,d=-1,e;++d<b.length;){var c=b[d].start;if(c>a){e=c;break}}return null!=e?e-a:Infinity};c.prototype.insert=function(c,l,d){var e=this.ranges;k(l<=d);if(l!=d){c={start:l,end:d,bitrate:c};for(l=0;l<e.length;l++){d=e[l];var q=a(c,d),p=Math.abs(d.start-c.end)<u||Math.abs(d.end-c.start)<u;if(q||p)if(c.bitrate===
d.bitrate)c=f(c,d,d.bitrate),e.splice(l--,1);else if(q)if(b(d,c))e.splice(++l,0,c),q=d.end,d.end=c.start,c={start:c.end,end:q,bitrate:d.bitrate};else if(b(c,d))e.splice(l--,1);else if(d.start<c.start)d.end=c.start;else{d.start=c.end;break}else break;else if(0===l){if(c.end<=e[0].start)break}else if(e[l-1].end<=c.start&&c.end<=d.start)break}e.splice(l,0,c);for(c=0;c<e.length;c++)l=e[c],l.start===l.end&&e.splice(c++,1);for(c=1;c<e.length;c++)l=e[c-1],d=e[c],l.bitrate===d.bitrate&&(Math.abs(d.start-
l.end)<u||Math.abs(d.end-l.start)<u)&&(l=f(l,d,d.bitrate),e.splice(--c,2,l))}this.length=this.ranges.length;return this.ranges};c.prototype.remove=function(a,b){this.intersect(new c([{start:0,end:a},{start:b,end:Infinity}]))};c.prototype.equals=function(a){var b;a:{b=this.ranges;a=a.ranges;for(var d=0;d<b.length;d++){var e=b[d],c=l(e,a);if(!c||c.start>e.start||c.end<e.end){b=!1;break a}}b=!0}return b};c.prototype.intersect=function(a){var b=this.ranges;a=a.ranges;for(var d=0;d<b.length;d++){var e=
b[d],c=l(e,a);c?(c.start>e.start&&(e.start=c.start),c.end<e.end&&(e.end=c.end)):b.splice(d--,1)}this.length=this.ranges.length;return this.ranges};return c}();r.exports={bufferedToArray:p,BufferedRanges:h}},function(r,h,c){function p(){this.__listeners={}}var q=c(1),l=c(2);p.prototype.addEventListener=function(a,b){l("function"==typeof b,"eventemitter: second argument should be a function");this.__listeners[a]||(this.__listeners[a]=[]);this.__listeners[a].push(b)};p.prototype.removeEventListener=
function(a,b){if(0===arguments.length)this.__listeners={};else if(this.__listeners.hasOwnProperty(a))if(1===arguments.length)delete this.__listeners[a];else{var c=this.__listeners[a],l=c.indexOf(b);~l&&c.splice(l,1);c.length||delete this.__listeners[a]}};p.prototype.trigger=function(a,b){if(this.__listeners.hasOwnProperty(a)){var c=this.__listeners[a].slice();q.each(c,function(a){try{a(b)}catch(c){console.error(c,c.stack)}})}};p.prototype.on=p.prototype.addEventListener;p.prototype.off=p.prototype.removeEventListener;
r.exports=p},function(r,h){var c=/^(?:[a-z]+:)?\/\//i,p=/\/[\.]{1,2}\//;r.exports={resolveURL:function(){var q=arguments.length;if(0===q)return"";for(var l="",a=0;a<q;a++){var b=arguments[a];"string"===typeof b&&""!==b&&(c.test(b)?l=b:("/"===b[0]&&(b=b.substr(1)),"/"===l[l.length-1]&&(l=l.substr(0,l.length-1)),l=l+"/"+b))}if(p.test(l)){q=[];l=l.split("/");a=0;for(b=l.length;a<b;a++)".."==l[a]?q.pop():"."!=l[a]&&q.push(l[a]);q=q.join("/")}else q=l;return q},parseBaseURL:function(c){var l=c.lastIndexOf("/");
return 0<=l?c.substring(0,l+1):c}}},function(r,h,c){function p(a,b,c){a.id=a.id||f.uniqueId();var m=a.adaptations,m=m.concat(c||[]),m=f.map(m,function(a){return q(a,b)}),m=f.filter(m,function(a){return 0>C.indexOf(a.type)?(v.info("not supported adaptation type",a.type),!1):!0});k(0<m.length);a.adaptations=f.groupBy(m,"type");return a}function q(b,c){k("undefined"!=typeof b.id);f.defaults(b,c);var l=f.pick(b,m),u=f.map(b.representations,function(a){k("undefined"!=typeof a.id);f.defaults(a,l);var b=
a.index;k(b);b.timescale||(b.timescale=1);a.bitrate||(a.bitrate=1);"mp4a.40.02"==a.codecs&&(a.codecs="mp4a.40.2");return a}).sort(function(a,b){return a.bitrate-b.bitrate}),q=b.type,p=b.mimeType;p||(p=u[0].mimeType);k(p);b.mimeType=p;q||(q=b.type=p.split("/")[0]);if("video"==q||"audio"==q)u=f.filter(u,function(b){return w(a(b))});k(0<u.length,"manifest: no compatible representation for this adaptation");b.representations=u;b.bitrates=f.pluck(u,"bitrate");return b}function l(a){f.isArray(a)||(a=[a]);
return f.flatten(a,function(a){var b=a.mimeType,c=a.url,d=a.language;a=a.languages;d&&(a=[d]);return f.map(a,function(a){return{id:f.uniqueId(),type:"text",lang:a,mimeType:b,rootURL:c,baseURL:"",representations:[{id:f.uniqueId(),mimeType:b,index:{indexType:"template",duration:Number.MAX_VALUE,timescale:1,startNumber:0}}]}})})}function a(a){return a.mimeType+';codecs="'+a.codecs+'"'}function b(a,b){var c=a.adaptations;return(c=c&&c[b])?c:[]}var f=c(1),v=c(4),k=c(2),u=c(11).parseBaseURL,w=c(8).isCodecSupported,
m="profiles width height frameRate audioSamplingRate mimeType segmentProfiles codecs maximumSAPPeriod maxPlayoutRate codingDependency index".split(" "),C=["audio","video","text"];r.exports={normalizeManifest:function(a,b,c){k(b.transportType);b.id=b.id||f.uniqueId();b.type=b.type||"static";var m=b.locations;m&&m.length||(b.locations=[a]);b.isLive="dynamic"==b.type;var q={rootURL:u(b.locations[0]),baseURL:b.baseURL,isLive:b.isLive};c&&(c=l(c));a=f.map(b.periods,function(a){return p(a,q,c)});f.extend(b,
a[0]);b.periods=null;b.duration||(b.duration=Infinity);b.isLive&&(b.suggestedPresentationDelay=b.suggestedPresentationDelay||15,b.availabilityStartTime=b.availabilityStartTime||0);return b},mergeManifestsIndex:function(a,b){var c=a.adaptations,k=b.adaptations,m;for(m in c){var l=k[m];f.each(c[m],function(a,b){f.simpleMerge(a.index,l[b].index)})}return a},mutateManifestLiveGap:function(a){var b=1>=arguments.length||void 0===arguments[1]?1:arguments[1];a.isLive&&(a.presentationLiveGap+=b)},getCodec:a,
getAdaptations:function(b){var c=b.adaptations;if(!c)return[];var k=[];f.each(f.keys(c),function(b){var d=c[b];k.push({type:b,adaptations:d,codec:a(d[0].representations[0])})});return k},getAdaptationsByType:b,getAvailableSubtitles:function(a){return b(a,"text").map(function(a){return a.lang})},getAvailableLanguages:function(a){return b(a,"audio").map(function(a){return a.lang})},createDirectFileManifest:function(){return{isLive:!1,duration:Infinity,adaptations:null}}}},function(r,h,c){(function(p,
q){function l(a){for(var g=a.length,n=Array(g),b=0;b<g;b++)n[b]=a[b];return n}function a(){try{return Da.apply(this,arguments)}catch(a){return L.e=a,L}}function b(B){if(!aa(B))throw new TypeError("fn must be a function");Da=B;return a}function f(a){throw a;}function h(a,g){for(var n=Array(a),b=0;b<a;b++)n[b]=g();return n}function k(a){this._s=a}function u(a){this._s=a;this._l=a.length;this._i=0}function w(a){this._a=a}function m(a){this._a=a;a=+a.length;if(isNaN(a))a=0;else if(0!==a&&"number"===typeof a&&
A.isFinite(a)){var g;g=+a;g=0===g?g:isNaN(g)?g:0>g?-1:1;a=g*Math.floor(Math.abs(a));a=0>=a?0:a>cb?cb:a}this._l=a;this._i=0}function C(a){var g=a._es6shim_iterator_;if(!g&&"string"===typeof a)return a=new k(a),a._es6shim_iterator_();if(!g&&void 0!==a.length)return a=new w(a),a._es6shim_iterator_();if(!g)throw new TypeError("Object is not iterable");return a._es6shim_iterator_()}function d(a,g){this.observer=a;this.parent=g}function e(a,g){ha(a)||(a=sa);return new Qa(g,a)}function x(a,g){this.observer=
a;this.parent=g}function J(a,g){this.observer=a;this.parent=g}function F(a,g){return new S(function(n){var b=new T,K=new pa;K.setDisposable(b);b.setDisposable(a.subscribe(new nb(n,K,g)));return K},a)}function H(){return!1}function N(){return[]}function y(){for(var a=arguments.length,g=Array(a),n=0;n<a;n++)g[n]=arguments[n];return g}function I(a){return function(g){return a.subscribe(g)}}function E(a,g){this.o=a;this.accumulator=g.accumulator;this.hasSeed=g.hasSeed;this.seed=g.seed;this.hasAccumulation=
!1;this.accumulation=null;this.isStopped=this.hasValue=!1}function O(a,g){return function(n){var b=n;for(n=0;n<g;n++)if(b=b[a[n]],"undefined"===typeof b)return;return b}}function X(a,g,n){return function(){for(var D=arguments.length,K=Array(D),c=0;c<D;c++)K[c]=arguments[c];if(aa(n)){K=b(n).apply(g,K);if(K===L)return a.onError(K.e);a.onNext(K)}else if(1>=K.length)a.onNext(K[0]);else a.onNext(K);a.onCompleted()}}function Y(a,g,n){return function(){var D=arguments[0];if(D)return a.onError(D);for(var D=
arguments.length,K=[],c=1;c<D;c++)K[c-1]=arguments[c];if(aa(n)){K=b(n).apply(g,K);if(K===L)return a.onError(K.e);a.onNext(K)}else if(1>=K.length)a.onNext(K[0]);else a.onNext(K);a.onCompleted()}}function U(a,g,n){this._e=a;this._n=g;this._fn=n;this._e.addEventListener(this._n,this._fn,!1);this.isDisposed=!1}function Q(a,g,n){var b=Object.prototype.toString.call(a);if("[object NodeList]"===b||"[object HTMLCollection]"===b){for(var b=new Z,K=0,c=a.length;K<c;K++)b.add(Q(a.item(K),g,n));return b}return new U(a,
g,n)}function R(a,g){return function(){var n=arguments[0];aa(g)&&(n=g.apply(null,arguments));a.onNext(n)}}function ea(a,g){return new S(function(n){return g.scheduleWithAbsolute(a,function(){n.onNext(0);n.onCompleted()})})}function P(a,g,n){return new S(function(b){var K=a,c=Wa(g);return n.scheduleRecursiveWithAbsoluteAndState(0,K,function(a,g){if(0<c){var B=n.now();K+=c;K<=B&&(K=B+c)}b.onNext(a);g(a+1,K)})})}function ga(a,g){return new S(function(n){return g.scheduleWithRelative(Wa(a),function(){n.onNext(0);
n.onCompleted()})})}function ba(a,g,n){return a===g?new S(function(a){return n.schedulePeriodicWithState(0,g,function(g){a.onNext(g);return g+1})}):db(function(){return P(n.now()+a,g,n)})}function V(a,g,n){return new S(function(b){var K=!1,c=new pa,d=null,e=[],f=!1,t;t=a.materialize().timestamp(n).subscribe(function(a){"E"===a.value.kind?(e=[],e.push(a),d=a.value.exception,a=!f):(e.push({value:a.value,timestamp:a.timestamp+g}),a=!K,K=!0);if(a)if(null!==d)b.onError(d);else a=new T,c.setDisposable(a),
a.setDisposable(n.scheduleRecursiveWithRelative(g,function(a){var g,B,c;if(null===d){f=!0;do g=null,0<e.length&&0>=e[0].timestamp-n.now()&&(g=e.shift().value),null!==g&&g.accept(b);while(null!==g);c=!1;B=0;0<e.length?(c=!0,B=Math.max(0,e[0].timestamp-n.now())):K=!1;g=d;f=!1;if(null!==g)b.onError(g);else c&&a(B)}}))});return new Z(t,c)},a)}function da(a,g,n){return db(function(){return V(a,g-n.now(),n)})}function W(a,g){return new S(function(n){function b(){d&&(d=!1,n.onNext(c));K&&n.onCompleted()}
var K=!1,c,d=!1,e=new T;e.setDisposable(a.subscribe(function(a){d=!0;c=a},function(a){n.onError(a)},function(){K=!0;e.dispose()}));return new Z(e,g.subscribe(b,function(a){n.onError(a)},b))},a)}function fa(a,g,n){return new S(function(D){function c(a,g){t[g]=a;d[g]=!0;if(e||(e=d.every(ta))){if(k)return D.onError(k);var B=b(n).apply(null,t);if(B===L)return D.onError(B.e);D.onNext(B)}f&&t[1]&&D.onCompleted()}var d=[!1,!1],e=!1,f=!1,t=Array(2),k;return new Z(a.subscribe(function(a){c(a,0)},function(a){if(t[1])D.onError(a);
else k=a},function(){f=!0;t[1]&&D.onCompleted()}),g.subscribe(function(a){c(a,1)},function(a){D.onError(a)},function(){f=!0;c(!0,1)}))},a)}var A=p,t={internals:{},config:{Promise:c(6)},helpers:{}},ka=t.helpers.noop=function(){},ta=t.helpers.identity=function(a){return a},Fa=t.helpers.defaultNow=Date.now,Ua=t.helpers.defaultComparer=function(a,g){return ya(a,g)},Va=t.helpers.defaultSubComparer=function(a,g){return a>g?1:a<g?-1:0},Pa=t.helpers.defaultError=function(a){throw a;},ja=t.helpers.isPromise=
function(a){return!!a&&"function"!==typeof a.subscribe&&"function"===typeof a.then},aa=t.helpers.isFunction=function(a){return"function"==typeof a||!1},L={e:{}},Da;(t.EmptyError=function(){this.message="Sequence contains no elements.";this.name="EmptyError";Error.call(this)}).prototype=Error.prototype;var Ka=t.ObjectDisposedError=function(){this.message="Object has been disposed";this.name="ObjectDisposedError";Error.call(this)};Ka.prototype=Error.prototype;var za=t.ArgumentOutOfRangeError=function(){this.message=
"Argument out of range";this.name="ArgumentOutOfRangeError";Error.call(this)};za.prototype=Error.prototype;var ia=t.NotSupportedError=function(a){this.message=a||"This operation is not supported";this.name="NotSupportedError";Error.call(this)};ia.prototype=Error.prototype;var La=t.NotImplementedError=function(a){this.message=a||"This operation is not implemented";this.name="NotImplementedError";Error.call(this)};La.prototype=Error.prototype;var va=t.helpers.notImplemented=function(){throw new La;
},Ga=t.helpers.notSupported=function(){throw new ia;},ua=t.doneEnumerator={done:!0,value:void 0},Xa=t.helpers.isArrayLike=function(a){return a&&void 0!==a.length},wa=t.internals.bindCallback=function(a,g,n){return g?function(){return a.apply(g,arguments)}:a};t.internals.isObject=function(a){var g=typeof a;return a&&("function"==g||"object"==g)||!1};var ya=t.internals.isEqual=function(a,g){if(a===g)return!0;if(!a||!g||"object"!==typeof a||"object"!==typeof g)return!1;for(var n in a)if(a.hasOwnProperty(n)&&
(!g.hasOwnProperty(n)||a[n]!==g[n]))return!1;for(n in g)if(g.hasOwnProperty(n)&&!a.hasOwnProperty(n))return!1;return!0},G=t.internals.inherits=function(a,g){function n(){this.constructor=a}n.prototype=g.prototype;a.prototype=new n},Ha=t.internals.addProperties=function(a){for(var g=1,n=arguments.length;g<n;g++){var b=arguments[g],c;for(c in b)a[c]=b[c]}},Z=t.CompositeDisposable=function(){var a=[],g,n;if(Array.isArray(arguments[0]))a=arguments[0],n=a.length;else for(n=arguments.length,a=Array(n),
g=0;g<n;g++)a[g]=arguments[g];for(g=0;g<n;g++)if(!ob(a[g]))throw new TypeError("Not a disposable");this.disposables=a;this.isDisposed=!1;this.length=a.length},Ya=Z.prototype;Ya.add=function(a){this.isDisposed?a.dispose():(this.disposables.push(a),this.length++)};Ya.remove=function(a){var g=!1;if(!this.isDisposed){var n=this.disposables.indexOf(a);-1!==n&&(g=!0,this.disposables.splice(n,1),this.length--,a.dispose())}return g};Ya.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var a=
this.disposables.length,g=Array(a),n=0;n<a;n++)g[n]=this.disposables[n];this.disposables=[];for(n=this.length=0;n<a;n++)g[n].dispose()}};var Ia=t.Disposable=function(a){this.isDisposed=!1;this.action=a||ka};Ia.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var qa=Ia.create=function(a){return new Ia(a)},na=Ia.empty={dispose:ka},ob=Ia.isDisposable=function(a){return a&&aa(a.dispose)},la=Ia.checkDisposed=function(a){if(a.isDisposed)throw new Ka;},T=t.SingleAssignmentDisposable=
function(){this.isDisposed=!1;this.current=null};T.prototype.getDisposable=function(){return this.current};T.prototype.setDisposable=function(a){if(this.current)throw Error("Disposable has already been assigned");var g=this.isDisposed;!g&&(this.current=a);g&&a&&a.dispose()};T.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};var pa=t.SerialDisposable=function(){this.isDisposed=!1;this.current=null};pa.prototype.getDisposable=
function(){return this.current};pa.prototype.setDisposable=function(a){var g=this.isDisposed;if(!g){var n=this.current;this.current=a}n&&n.dispose();g&&a&&a.dispose()};pa.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};t.RefCountDisposable=function(){function a(g){this.disposable=g;this.disposable.count++;this.isInnerDisposed=!1}function g(a){this.underlyingDisposable=a;this.isPrimaryDisposed=this.isDisposed=!1;this.count=0}
a.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))};g.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))};g.prototype.getDisposable=function(){return this.isDisposed?
na:new a(this)};return g}();var Ma=t.internals.ScheduledItem=function(a,g,n,b,c){this.scheduler=a;this.state=g;this.action=n;this.dueTime=b;this.comparer=c||Va;this.disposable=new T};Ma.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())};Ma.prototype.compareTo=function(a){return this.comparer(this.dueTime,a.dueTime)};Ma.prototype.isCancelled=function(){return this.disposable.isDisposed};Ma.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var ra=
t.Scheduler=function(){function a(g,b,n,B){this.now=g;this._schedule=b;this._scheduleRelative=n;this._scheduleAbsolute=B}function g(a,g){g();return na}a.isScheduler=function(g){return g instanceof a};var b=a.prototype;b.schedule=function(a){return this._schedule(a,g)};b.scheduleWithState=function(a,g){return this._schedule(a,g)};b.scheduleWithRelative=function(a,b){return this._scheduleRelative(b,a,g)};b.scheduleWithRelativeAndState=function(a,g,b){return this._scheduleRelative(a,g,b)};b.scheduleWithAbsolute=
function(a,b){return this._scheduleAbsolute(b,a,g)};b.scheduleWithAbsoluteAndState=function(a,g,b){return this._scheduleAbsolute(a,g,b)};a.now=Fa;a.normalize=function(a){0>a&&(a=0);return a};return a}(),Wa=ra.normalize,ha=ra.isScheduler;(function(a){function g(a,g){function b(g){var n=!1,c=!1,K=a.scheduleWithState(g,function(a,g){n?B.remove(K):c=!0;D(g,b);return na});c||(B.add(K),n=!0)}var n=g[0],D=g[1],B=new Z;D(n,b);return B}function b(a,g,n){function D(g,b){var B=!1,d=!1,e=a[n](g,b,function(a,
g){B?K.remove(e):d=!0;c(g,D);return na});d||(K.add(e),B=!0)}var B=g[0],c=g[1],K=new Z;c(B,D);return K}function D(a,g){return b(a,g,"scheduleWithRelativeAndState")}function c(a,g){return b(a,g,"scheduleWithAbsoluteAndState")}function d(a,g){a(function(b){g(a,b)})}a.scheduleRecursive=function(a){return this.scheduleRecursiveWithState(a,d)};a.scheduleRecursiveWithState=function(a,b){return this.scheduleWithState([a,b],g)};a.scheduleRecursiveWithRelative=function(a,g){return this.scheduleRecursiveWithRelativeAndState(g,
a,d)};a.scheduleRecursiveWithRelativeAndState=function(a,g,b){return this._scheduleRelative([a,b],g,D)};a.scheduleRecursiveWithAbsolute=function(a,g){return this.scheduleRecursiveWithAbsoluteAndState(g,a,d)};a.scheduleRecursiveWithAbsoluteAndState=function(a,g,b){return this._scheduleAbsolute([a,b],g,c)}})(ra.prototype);(function(a){ra.prototype.schedulePeriodic=function(a,b){return this.schedulePeriodicWithState(null,a,b)};ra.prototype.schedulePeriodicWithState=function(a,b,D){if("undefined"===typeof A.setInterval)throw new ia;
b=Wa(b);var B=a,c=A.setInterval(function(){B=D(B)},b);return qa(function(){A.clearInterval(c)})}})(ra.prototype);var oa=ra.immediate=function(){return new ra(Fa,function(a,g){return g(this,a)},Ga,Ga)}(),sa=ra.currentThread=function(){function a(){for(;0<g.length;){var b=g.shift();!b.isCancelled()&&b.invoke()}}var g,n=new ra(Fa,function(n,c){var d=new Ma(this,n,c,this.now());if(g)g.push(d);else{g=[d];var e=b(a)();g=null;if(e===L)return f(e.e)}return d.disposable},Ga,Ga);n.scheduleRequired=function(){return!g};
return n}();t.internals.SchedulePeriodicRecursive=function(){function a(g,b){b(0,this._period);try{this._state=this._action(this._state)}catch(B){throw this._cancel.dispose(),B;}}function g(a,g,b,B){this._scheduler=a;this._state=g;this._period=b;this._action=B}g.prototype.start=function(){var g=new T;this._cancel=g;g.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this)));return g};return g}();var Ja,Za,eb=function(){var a,g=ka;if(A.setTimeout)a=A.setTimeout,
g=A.clearTimeout;else if(A.WScript)a=function(a,g){A.WScript.Sleep(g);a()};else throw new ia;return{setTimeout:a,clearTimeout:g}}(),$a=eb.setTimeout,pb=eb.clearTimeout;(function(){function a(g){if(c)$a(function(){a(g)},0);else{var n=D[g];if(n&&(c=!0,n=b(n)(),Za(g),c=!1,n===L))return f(n.e)}}function g(){if(!A.postMessage||A.importScripts)return!1;var a=!1,g=A.onmessage;A.onmessage=function(){a=!0};A.postMessage("","*");A.onmessage=g;return a}var n=1,D={},c=!1;Za=function(a){delete D[a]};String(toString).replace(/[.*+?^${}()|[\]\\]/g,
"\\$&").replace(/toString| for [^\]]+/g,".*?");var d=p.setImmediate;if(aa(d))Ja=function(g){var b=n++;D[b]=g;d(function(){a(b)});return b};else if("undefined"!==typeof q&&"[object process]"==={}.toString.call(q))Ja=function(g){var b=n++;D[b]=g;q.nextTick(function(){a(b)});return b};else if(g()){var e=function(g){"string"===typeof g.data&&g.data.substring(0,t.length)===t&&a(g.data.substring(t.length))},t="ms.rx.schedule"+Math.random();A.addEventListener?A.addEventListener("message",e,!1):A.attachEvent?
A.attachEvent("onmessage",e):A.onmessage=e;Ja=function(a){var g=n++;D[g]=a;A.postMessage(t+currentId,"*");return g}}else if(A.MessageChannel){var k=new A.MessageChannel;k.port1.onmessage=function(g){a(g.data)};Ja=function(a){var g=n++;D[g]=a;k.port2.postMessage(g);return g}}else Ja="document"in A&&"onreadystatechange"in A.document.createElement("script")?function(g){var b=A.document.createElement("script"),c=n++;D[c]=g;b.onreadystatechange=function(){a(c);b.onreadystatechange=null;b.parentNode.removeChild(b);
b=null};A.document.documentElement.appendChild(b);return c}:function(g){var b=n++;D[b]=g;$a(function(){a(b)},0);return b}})();var Aa=ra.timeout=ra["default"]=function(){return new ra(Fa,function(a,g){var b=this,D=new T,c=Ja(function(){!D.isDisposed&&D.setDisposable(g(b,a))});return new Z(D,qa(function(){Za(c)}))},function(a,g,b){var D=this;g=ra.normalize(g);var c=new T;if(0===g)return D.scheduleWithState(a,b);var d=$a(function(){!c.isDisposed&&c.setDisposable(b(D,a))},g);return new Z(c,qa(function(){pb(d)}))},
function(a,g,b){return this.scheduleWithRelativeAndState(a,g-this.now(),b)})}(),xa=t.Notification=function(){function a(g,b,D,c,B,d){this.kind=g;this.value=b;this.exception=D;this._accept=c;this._acceptObservable=B;this.toString=d}a.prototype.accept=function(a,b,D){return a&&"object"===typeof a?this._acceptObservable(a):this._accept(a,b,D)};a.prototype.toObservable=function(a){var b=this;ha(a)||(a=oa);return new S(function(D){return a.scheduleWithState(b,function(a,g){g._acceptObservable(D);"N"===
g.kind&&D.onCompleted()})})};return a}(),qb=xa.createOnNext=function(){function a(g){return g(this.value)}function g(a){return a.onNext(this.value)}function b(){return"OnNext("+this.value+")"}return function(D){return new xa("N",D,null,a,g,b)}}(),rb=xa.createOnError=function(){function a(g,b){return b(this.exception)}function g(a){return a.onError(this.exception)}function b(){return"OnError("+this.exception+")"}return function(D){return new xa("E",null,D,a,g,b)}}(),sb=xa.createOnCompleted=function(){function a(g,
b,n){return n()}function g(a){return a.onCompleted()}function b(){return"OnCompleted()"}return function(){return new xa("C",null,null,a,g,b)}}(),Ba=t.Observer=function(){},Na=Ba.create=function(a,g,b){a||(a=ka);g||(g=Pa);b||(b=ka);return new tb(a,g,b)},Oa=t.internals.AbstractObserver=function(a){function g(){this.isStopped=!1}G(g,a);g.prototype.next=va;g.prototype.error=va;g.prototype.completed=va;g.prototype.onNext=function(a){!this.isStopped&&this.next(a)};g.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.error(a))};g.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())};g.prototype.dispose=function(){this.isStopped=!0};g.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.error(a),!0)};return g}(Ba),tb=t.AnonymousObserver=function(a){function g(g,b,c){a.call(this);this._onNext=g;this._onError=b;this._onCompleted=c}G(g,a);g.prototype.next=function(a){this._onNext(a)};g.prototype.error=function(a){this._onError(a)};g.prototype.completed=
function(){this._onCompleted()};return g}(Oa),z,M=t.Observable=function(){function a(g){this._subscribe=g}z=a.prototype;a.isObservable=function(a){return a&&aa(a.subscribe)};z.subscribe=z.forEach=function(a,b,D){return this._subscribe("object"===typeof a?a:Na(a,b,D))};z.subscribeOnNext=function(a,b){return this._subscribe(Na("undefined"!==typeof b?function(D){a.call(b,D)}:a))};z.subscribeOnError=function(a,b){return this._subscribe(Na(null,"undefined"!==typeof b?function(D){a.call(b,D)}:a))};z.subscribeOnCompleted=
function(a,b){return this._subscribe(Na(null,null,"undefined"!==typeof b?function(){a.call(b)}:a))};return a}(),ub=t.internals.ScheduledObserver=function(a){function g(b,g){a.call(this);this.scheduler=b;this.observer=g;this.hasFaulted=this.isAcquired=!1;this.queue=[];this.disposable=new pa}G(g,a);g.prototype.next=function(a){var b=this;this.queue.push(function(){b.observer.onNext(a)})};g.prototype.error=function(a){var b=this;this.queue.push(function(){b.observer.onError(a)})};g.prototype.completed=
function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})};g.prototype.ensureActive=function(){var a=!1;!this.hasFaulted&&0<this.queue.length&&(a=!this.isAcquired,this.isAcquired=!0);a&&this.disposable.setDisposable(this.scheduler.scheduleRecursiveWithState(this,function(a,g){var n;if(0<a.queue.length){n=a.queue.shift();n=b(n)();if(n===L)return a.queue=[],a.hasFaulted=!0,f(n.e);g(a)}else a.isAcquired=!1}))};g.prototype.dispose=function(){a.prototype.dispose.call(this);this.disposable.dispose()};
return g}(Oa),ca=t.ObservableBase=function(a){function g(a){return a&&aa(a.dispose)?a:aa(a)?qa(a):na}function n(a,n){var D=n[0],c=n[1],c=b(c.subscribeCore).call(c,D);if(c===L&&!D.fail(L.e))return f(L.e);D.setDisposable(g(c))}function D(a){a=new fb(a);var b=[a,this];sa.scheduleRequired()?sa.scheduleWithState(b,n):n(null,b);return a}function c(){a.call(this,D)}G(c,a);c.prototype.subscribeCore=va;return c}(M),Ra=function(a){function g(b,g,n,c){this.resultSelector=t.helpers.isFunction(n)?n:null;this.selector=
t.internals.bindCallback(t.helpers.isFunction(g)?g:function(){return g},c,3);this.source=b;a.call(this)}function n(a,b,g,n){this.i=0;this.selector=b;this.resultSelector=g;this.source=n;this.isStopped=!1;this.o=a}G(g,a);g.prototype.subscribeCore=function(a){return this.source.subscribe(new n(a,this.selector,this.resultSelector,this))};n.prototype._wrapResult=function(a,b,g){return this.resultSelector?a.map(function(a,n){return this.resultSelector(b,a,g,n)},this):a};n.prototype.onNext=function(a){if(!this.isStopped){var g=
this.i++,n=b(this.selector)(a,g,this.source);if(n===L)return this.o.onError(n.e);t.helpers.isPromise(n)&&(n=t.Observable.fromPromise(n));t.helpers.isArrayLike(n)&&(n=t.Observable.from(n));this.o.onNext(this._wrapResult(n,a,g))}};n.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};return g}(ca),Ea=t.internals.Enumerable=function(){},vb=function(a){function g(b){this.sources=
b;a.call(this)}function n(a,b,g){this.o=a;this.s=b;this.e=g;this.isStopped=!1}G(g,a);g.prototype.subscribeCore=function(a){var g,c=new pa,B=oa.scheduleRecursiveWithState(this.sources._es6shim_iterator_(),function(B,d){if(!g){var e=b(B.next).call(B);if(e===L)return a.onError(e.e);if(e.done)return a.onCompleted();e=e.value;ja(e)&&(e=ma(e));var f=new T;c.setDisposable(f);f.setDisposable(e.subscribe(new n(a,d,B)))}});return new Z(c,B,qa(function(){g=!0}))};n.prototype.onNext=function(a){if(!this.isStopped)this.o.onNext(a)};
n.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};n.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.s(this.e))};n.prototype.dispose=function(){this.isStopped=!0};n.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return g}(ca);Ea.prototype.concat=function(){return new vb(this)};var wb=function(a){function g(b){this.sources=b;a.call(this)}G(g,a);g.prototype.subscribeCore=function(a){var g=this.sources._es6shim_iterator_(),
c,B=new pa,d=oa.scheduleRecursiveWithState(null,function(d,e){if(!c){var f=b(g.next).call(g);if(f===L)return a.onError(f.e);if(f.done)return null!==d?a.onError(d):a.onCompleted();f=f.value;ja(f)&&(f=ma(f));var t=new T;B.setDisposable(t);t.setDisposable(f.subscribe(function(b){a.onNext(b)},e,function(){a.onCompleted()}))}});return new Z(B,d,qa(function(){c=!0}))};return g}(ca);Ea.prototype.catchError=function(){return new wb(this)};Ea.prototype.catchErrorWhen=function(a){var g=this;return new S(function(n){var c=
new Ca,d=new Ca,e=a(c).subscribe(d),f=g._es6shim_iterator_(),t,k=new pa,m=oa.scheduleRecursive(function(a){if(!t){var g=b(f.next).call(f);if(g===L)return n.onError(g.e);if(g.done)n.onCompleted();else{g=g.value;ja(g)&&(g=ma(g));var B=new T,e=new T;k.setDisposable(new Z(e,B));B.setDisposable(g.subscribe(function(a){n.onNext(a)},function(g){e.setDisposable(d.subscribe(a,function(a){n.onError(a)},function(){n.onCompleted()}));c.onNext(g)},function(){n.onCompleted()}))}}});return new Z(e,k,m,qa(function(){t=
!0}))})};var xb=function(a){function g(a,g){this.v=a;this.c=null==g?-1:g}function b(a){this.v=a.v;this.l=a.c}G(g,a);g.prototype._es6shim_iterator_=function(){return new b(this)};b.prototype.next=function(){if(0===this.l)return ua;0<this.l&&this.l--;return{done:!1,value:this.v}};return g}(Ea),ab=Ea.repeat=function(a,g){return new xb(a,g)},yb=function(a){function g(a,g,b){this.s=a;this.fn=g?wa(g,b,3):null}function b(a){this.i=-1;this.s=a.s;this.l=this.s.length;this.fn=a.fn}G(g,a);g.prototype._es6shim_iterator_=
function(){return new b(this)};b.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:ua};return g}(Ea),gb=Ea.of=function(a,g,b){return new yb(a,g,b)},zb=function(a){function g(b){this.source=b;a.call(this)}function b(a){this.o=a;this.a=[];this.isStopped=!1}G(g,a);g.prototype.subscribeCore=function(a){return this.source.subscribe(new b(a))};b.prototype.onNext=function(a){this.isStopped||this.a.push(a)};b.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onNext(this.a),this.o.onCompleted())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return g}(ca);z.toArray=function(){return new zb(this)};M.create=function(a,b){return new S(a,b)};var db=M.defer=function(a){return new S(function(b){var n;try{n=a()}catch(c){return bb(c).subscribe(b)}ja(n)&&
(n=ma(n));return n.subscribe(b)})},hb=function(a){function b(g){this.scheduler=g;a.call(this)}function n(a,b){this.observer=a;this.scheduler=b}function c(a,b){b.onCompleted();return na}G(b,a);b.prototype.subscribeCore=function(a){return(new n(a,this.scheduler)).run()};n.prototype.run=function(){return this.scheduler.scheduleWithState(this.observer,c)};return b}(ca),Ab=new hb(oa),Bb=M.empty=function(a){ha(a)||(a=oa);return a===oa?Ab:new hb(a)},Db=function(a){function b(g,c,d){this.iterable=g;this.mapper=
c;this.scheduler=d;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new Cb(a,this)).run()};return b}(ca),Cb=function(){function a(b,n){this.o=b;this.parent=n}a.prototype.run=function(){var a=C(Object(this.parent.iterable)),n=this.o,c=this.parent.mapper;return this.parent.scheduler.scheduleRecursiveWithState(0,function(B,d){var e=b(a.next).call(a);if(e===L)return n.onError(e.e);if(e.done)return n.onCompleted();e=e.value;if(aa(c)&&(e=b(c)(e,B),e===L))return n.onError(e.e);n.onNext(e);
d(B+1)})};return a}(),cb=Math.pow(2,53)-1;k.prototype._es6shim_iterator_=function(){return new u(this._s)};u.prototype._es6shim_iterator_=function(){return this};u.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:ua};w.prototype._es6shim_iterator_=function(){return new m(this._a)};m.prototype._es6shim_iterator_=function(){return this};m.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:ua};var Eb=M.from=function(a,b,n,c){if(null==
a)throw Error("iterable cannot be null.");if(b&&!aa(b))throw Error("mapFn when provided must be a function");if(b)var d=wa(b,n,2);ha(c)||(c=sa);return new Db(a,d,c)},Qa=function(a){function b(g,c){this.args=g;this.scheduler=c;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new d(a,this)).run()};return b}(ca);d.prototype.run=function(){var a=this.observer,b=this.parent.args,n=b.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,d){if(c<n)a.onNext(b[c]),d(c+
1);else a.onCompleted()})};var Fb=M.fromArray=function(a,b){ha(b)||(b=sa);return new Qa(a,b)},Gb=new (function(a){function b(){a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return na};return b}(ca));M.never=function(){return Gb};M.of=function(){for(var a=arguments.length,b=Array(a),n=0;n<a;n++)b[n]=arguments[n];return new Qa(b,sa)};M.ofWithScheduler=function(a){for(var b=arguments.length,n=Array(b-1),c=1;c<b;c++)n[c-1]=arguments[c];return new Qa(n,a)};var Hb=function(a){function b(g,c){this.obj=
g;this.keys=Object.keys(g);this.scheduler=c;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new x(a,this)).run()};return b}(ca);x.prototype.run=function(){var a=this.observer,b=this.parent.obj,n=this.parent.keys,c=n.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(d,e){if(d<c){var f=n[d];a.onNext([f,b[f]]);e(d+1)}else a.onCompleted()})};M.pairs=function(a,b){b||(b=sa);return new Hb(a,b)};var Jb=function(a){function b(g,c,d){this.start=g;this.rangeCount=c;
this.scheduler=d;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new Ib(a,this)).run()};return b}(ca),Ib=function(){function a(b,n){this.observer=b;this.parent=n}a.prototype.run=function(){var a=this.parent.start,b=this.parent.rangeCount,c=this.observer;return this.parent.scheduler.scheduleRecursiveWithState(0,function(d,e){if(d<b)c.onNext(a+d),e(d+1);else c.onCompleted()})};return a}();M.range=function(a,b,n){ha(n)||(n=sa);return new Jb(a,b,n)};var Kb=function(a){function b(g,c,
d){this.value=g;this.repeatCount=null==c?-1:c;this.scheduler=d;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return(new J(a,this)).run()};return b}(ca);J.prototype.run=function(){var a=this.observer,b=this.parent.value;return this.parent.scheduler.scheduleRecursiveWithState(this.parent.repeatCount,function(n,c){if(-1===n||0<n)a.onNext(b),0<n&&n--;if(0===n)return a.onCompleted();c(n)})};M.repeat=function(a,b,c){ha(c)||(c=sa);return new Kb(a,b,c)};var Lb=function(a){function b(g,c){this.value=
g;this.scheduler=c;a.call(this)}function c(a,b,g){this.observer=a;this.value=b;this.scheduler=g}function d(a,b){var g=b[1];g.onNext(b[0]);g.onCompleted();return na}G(b,a);b.prototype.subscribeCore=function(a){return(new c(a,this.value,this.scheduler)).run()};c.prototype.run=function(){var a=[this.value,this.observer];return this.scheduler===oa?d(null,a):this.scheduler.scheduleWithState(a,d)};return b}(ca);M["return"]=M.just=function(a,b){ha(b)||(b=oa);return new Lb(a,b)};var Mb=function(a){function b(g,
c){this.error=g;this.scheduler=c;a.call(this)}function c(a,b){this.o=a;this.p=b}function d(a,b){b[1].onError(b[0])}G(b,a);b.prototype.subscribeCore=function(a){return(new c(a,this)).run()};c.prototype.run=function(){return this.p.scheduler.scheduleWithState([this.p.error,this.o],d)};return b}(ca),bb=M["throw"]=function(a,b){ha(b)||(b=oa);return new Mb(a,b)},nb=function(a){function g(b,g,c){this._o=b;this._s=g;this._fn=c;a.call(this)}G(g,a);g.prototype.next=function(a){this._o.onNext(a)};g.prototype.completed=
function(){return this._o.onCompleted()};g.prototype.error=function(a){a=b(this._fn)(a);if(a===L)return this._o.onError(a.e);ja(a)&&(a=ma(a));var g=new T;this._s.setDisposable(g);g.setDisposable(a.subscribe(this._o))};return g}(Oa);z["catch"]=function(a){return aa(a)?F(this,a):Nb([this,a])};var Nb=M["catch"]=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var b=arguments.length;a=Array(b);for(var c=0;c<b;c++)a[c]=arguments[c]}return gb(a).catchError()};z.combineLatest=function(){for(var a=
arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];Array.isArray(b[0])?b[0].unshift(this):b.unshift(this);return Ob.apply(this,b)};var Ob=M.combineLatest=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];var d=aa(b[a-1])?b.pop():y;Array.isArray(b[0])&&(b=b[0]);return new S(function(a){function c(b){e[b]=!0;if(f||(f=e.every(ta))){try{var g=d.apply(null,t)}catch(n){return a.onError(n)}a.onNext(g)}else if(B.filter(function(a,g){return g!==b}).every(ta))a.onCompleted()}
for(var n=b.length,e=h(n,H),f=!1,B=h(n,H),t=Array(n),k=Array(n),m=0;m<n;m++)(function(n){var d=b[n],e=new T;ja(d)&&(d=ma(d));e.setDisposable(d.subscribe(function(a){t[n]=a;c(n)},function(b){a.onError(b)},function(){B[n]=!0;B.every(ta)&&a.onCompleted()}));k[n]=e})(m);return new Z(k)},this)};z.concat=function(){for(var a=[],b=0,c=arguments.length;b<c;b++)a.push(arguments[b]);a.unshift(this);return Pb.apply(null,a)};var Qb=function(a){function b(g){this.sources=g;a.call(this)}function c(a,b){this.sources=
a;this.o=b}G(b,a);b.prototype.subscribeCore=function(a){return(new c(this.sources,a)).run()};c.prototype.run=function(){var a,b=new pa,g=this.sources,c=g.length,n=this.o,d=oa.scheduleRecursiveWithState(0,function(d,e){if(!a){if(d===c)return n.onCompleted();var f=g[d];ja(f)&&(f=ma(f));var B=new T;b.setDisposable(B);B.setDisposable(f.subscribe(function(a){n.onNext(a)},function(a){n.onError(a)},function(){e(d+1)}))}});return new Z(b,d,qa(function(){a=!0}))};return b}(ca),Pb=M.concat=function(){var a;
if(Array.isArray(arguments[0]))a=arguments[0];else{a=Array(arguments.length);for(var b=0,c=arguments.length;b<c;b++)a[b]=arguments[b]}return new Qb(a)};z.concatAll=function(){return this.merge(1)};var Sb=function(a){function b(g,c){this.source=g;this.maxConcurrent=c;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){var b=new Z;b.add(this.source.subscribe(new Rb(a,this.maxConcurrent,b)));return b};return b}(ca),Rb=function(){function a(b,g,c){this.o=b;this.max=g;this.g=c;this.done=!1;this.q=
[];this.activeCount=0;this.isStopped=!1}function b(a,g){this.parent=a;this.sad=g;this.isStopped=!1}a.prototype.handleSubscribe=function(a){var c=new T;this.g.add(c);ja(a)&&(a=ma(a));c.setDisposable(a.subscribe(new b(this,c)))};a.prototype.onNext=function(a){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(a)):this.q.push(a))};a.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};a.prototype.onCompleted=function(){this.isStopped||
(this.done=this.isStopped=!0,0===this.activeCount&&this.o.onCompleted())};a.prototype.dispose=function(){this.isStopped=!0};a.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};b.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};b.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=this.parent;a.g.remove(this.sad);
0<a.q.length?a.handleSubscribe(a.q.shift()):(a.activeCount--,a.done&&0===a.activeCount&&a.o.onCompleted())}};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return a}();z.merge=function(a){return"number"!==typeof a?Tb(this,a):new Sb(this,a)};var Tb=M.merge=function(){var a,b=[],c,d=arguments.length;arguments[0]?ha(arguments[0])?(a=arguments[0],c=1):(a=oa,c=0):(a=oa,c=1);for(;c<d;c++)b.push(arguments[c]);
Array.isArray(b[0])&&(b=b[0]);return e(a,b).mergeAll()},ib=t.CompositeError=function(a){this.name="NotImplementedError";this.innerErrors=a;this.message="This contains multiple errors. Check the innerErrors";Error.call(this)};ib.prototype=Error.prototype;M.mergeDelayError=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var b=arguments.length;a=Array(b);for(var c=0;c<b;c++)a[c]=arguments[c]}var d=e(null,a);return new S(function(a){function b(){if(0===e.length)a.onCompleted();else if(1===
e.length)a.onError(e[0]);else a.onError(new ib(e))}var g=new Z,c=new T,n=!1,e=[];g.add(c);c.setDisposable(d.subscribe(function(c){var d=new T;g.add(d);ja(c)&&(c=ma(c));d.setDisposable(c.subscribe(function(b){a.onNext(b)},function(a){e.push(a);g.remove(d);n&&1===g.length&&b()},function(){g.remove(d);n&&1===g.length&&b()}))},function(a){e.push(a);n=!0;1===g.length&&b()},function(){n=!0;1===g.length&&b()}));return g})};var Ub=function(a){function b(g){this.source=g;a.call(this)}function c(a,b){this.o=
a;this.g=b;this.done=this.isStopped=!1}function d(a,b){this.parent=a;this.sad=b;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){var b=new Z,g=new T;b.add(g);g.setDisposable(this.source.subscribe(new c(a,b)));return b};c.prototype.onNext=function(a){if(!this.isStopped){var b=new T;this.g.add(b);ja(a)&&(a=ma(a));b.setDisposable(a.subscribe(new d(this,b)))}};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||
(this.done=this.isStopped=!0,1===this.g.length&&this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};d.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};d.prototype.onCompleted=function(){if(!this.isStopped){var a=this.parent;this.isStopped=!0;a.g.remove(this.sad);a.done&&
1===a.g.length&&a.o.onCompleted()}};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return b}(ca);z.mergeAll=function(){return new Ub(this)};z.skipUntil=function(a){var b=this;return new S(function(c){var d=!1,e=new Z(b.subscribe(function(a){d&&c.onNext(a)},function(a){c.onError(a)},function(){d&&c.onCompleted()}));ja(a)&&(a=ma(a));var f=new T;e.add(f);f.setDisposable(a.subscribe(function(){d=
!0;f.dispose()},function(a){c.onError(a)},function(){f.dispose()}));return e},b)};var Vb=function(a){function b(g){this.source=g;a.call(this)}function c(a,b){this.o=a;this.inner=b;this.stopped=!1;this.latest=0;this.isStopped=this.hasLatest=!1}function d(a,b){this.parent=a;this.id=b;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){var b=new pa;a=this.source.subscribe(new c(a,b));return new Z(a,b)};c.prototype.onNext=function(a){if(!this.isStopped){var b=new T,g=++this.latest;this.hasLatest=
!0;this.inner.setDisposable(b);ja(a)&&(a=ma(a));b.setDisposable(a.subscribe(new d(this,g)))}};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.stopped=this.isStopped=!0,!this.hasLatest&&this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};d.prototype.onNext=function(a){this.isStopped||this.parent.latest===
this.id&&this.parent.o.onNext(a)};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&this.parent.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted()))};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return b}(ca);
z["switch"]=z.switchLatest=function(){return new Vb(this)};var Wb=function(a){function b(g,c){this.source=g;this.other=ja(c)?ma(c):c;a.call(this)}function c(a){this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return new Z(this.source.subscribe(a),this.other.subscribe(new c(a)))};c.prototype.onNext=function(a){if(!this.isStopped)this.o.onCompleted()};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){!this.isStopped&&
(this.isStopped=!0)};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return b}(ca);z.takeUntil=function(a){return new Wb(this,a)};z.withLatestFrom=function(){for(var a=arguments.length,g=Array(a),c=0;c<a;c++)g[c]=arguments[c];var d=g.pop(),e=this;Array.isArray(g[0])&&(g=g[0]);return new S(function(a){for(var c=g.length,n=h(c,H),f=!1,t=Array(c),k=Array(c+1),B=0;B<c;B++)(function(b){var c=g[b],d=new T;
ja(c)&&(c=ma(c));d.setDisposable(c.subscribe(function(a){t[b]=a;n[b]=!0;f=n.every(ta)},function(b){a.onError(b)},ka));k[b]=d})(B);B=new T;B.setDisposable(e.subscribe(function(g){g=[g].concat(t);if(f){g=b(d).apply(null,g);if(g===L)return a.onError(g.e);a.onNext(g)}},function(b){a.onError(b)},function(){a.onCompleted()}));k[c]=B;return new Z(k)},this)};z.zip=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,g=Array(a),c=0;c<a;c++)g[c]=arguments[c];var d=
aa(g[a-1])?g.pop():y;Array.isArray(g[0])&&(g=g[0]);var e=this;g.unshift(e);return new S(function(a){for(var c=g.length,n=h(c,N),f=h(c,H),t=Array(c),k=0;k<c;k++)(function(c){var k=g[c],B=new T;ja(k)&&(k=ma(k));B.setDisposable(k.subscribe(function(g){n[c].push(g);if(n.every(function(a){return 0<a.length})){g=n.map(function(a){return a.shift()});g=b(d).apply(e,g);if(g===L)return a.onError(g.e);a.onNext(g)}else if(f.filter(function(a,b){return b!==c}).every(ta))a.onCompleted()},function(b){a.onError(b)},
function(){f[c]=!0;f.every(ta)&&a.onCompleted()}));t[c]=B})(k);return new Z(t)},e)};M.zip=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];Array.isArray(b[0])&&(b=aa(b[1])?b[0].concat(b[1]):b[0]);a=b.shift();return a.zip.apply(a,b)};z.zipIterable=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,g=Array(a),c=0;c<a;c++)g[c]=arguments[c];var d=aa(g[a-1])?g.pop():y,e=this;g.unshift(e);return new S(function(a){for(var c=g.length,
n=h(c,N),f=h(c,H),t=Array(c),k=0;k<c;k++)(function(c){var k=g[c],m=new T;(Xa(k)||isIterable(k))&&(k=Eb(k));m.setDisposable(k.subscribe(function(g){n[c].push(g);if(n.every(function(a){return 0<a.length})){g=n.map(function(a){return a.shift()});g=b(d).apply(e,g);if(g===L)return a.onError(g.e);a.onNext(g)}else if(f.filter(function(a,b){return b!==c}).every(ta))a.onCompleted()},function(b){a.onError(b)},function(){f[c]=!0;f.every(ta)&&a.onCompleted()}));t[c]=m})(k);return new Z(t)},e)};z.asObservable=
function(){return new S(I(this),this)};z.dematerialize=function(){var a=this;return new S(function(b){return a.subscribe(function(a){return a.accept(b)},function(a){b.onError(a)},function(){b.onCompleted()})},this)};var Yb=function(a){function b(c,g,d){this.source=c;this.keyFn=g;this.comparer=d;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new Xb(a,this.keyFn,this.comparer))};return b}(ca),Xb=function(a){function c(b,g,d){this.o=b;this.keyFn=g;this.comparer=
d;this.hasCurrentKey=!1;this.currentKey=null;a.call(this)}G(c,a);c.prototype.next=function(a){var c=a,g;if(aa(this.keyFn)&&(c=b(this.keyFn)(a),c===L))return this.o.onError(c.e);if(this.hasCurrentKey&&(g=b(this.comparer)(this.currentKey,c),g===L))return this.o.onError(g.e);this.hasCurrentKey&&g||(this.hasCurrentKey=!0,this.currentKey=c,this.o.onNext(a))};c.prototype.error=function(a){this.o.onError(a)};c.prototype.completed=function(){this.o.onCompleted()};return c}(Oa);z.distinctUntilChanged=function(a,
b){b||(b=Ua);return new Yb(this,a,b)};var Zb=function(a){function c(b,g,d,e){this.source=b;this._oN=g;this._oE=d;this._oC=e;a.call(this)}function d(a,b){this.o=a;this.t=!b._oN||aa(b._oN)?Na(b._oN||ka,b._oE||ka,b._oC||ka):b._oN;this.isStopped=!1}G(c,a);c.prototype.subscribeCore=function(a){return this.source.subscribe(new d(a,this))};d.prototype.onNext=function(a){if(!this.isStopped){var c=b(this.t.onNext).call(this.t,a);if(c===L)this.o.onError(c.e);this.o.onNext(a)}};d.prototype.onError=function(a){if(!this.isStopped){this.isStopped=
!0;var c=b(this.t.onError).call(this.t,a);if(c===L)return this.o.onError(c.e);this.o.onError(a)}};d.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=b(this.t.onCompleted).call(this.t);if(a===L)return this.o.onError(a.e);this.o.onCompleted()}};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return c}(ca);z["do"]=z.tap=z.doAction=function(a,b,c){return new Zb(this,a,b,c)};z.doOnNext=
z.tapOnNext=function(a,b){return this.tap("undefined"!==typeof b?function(c){a.call(b,c)}:a)};z.doOnError=z.tapOnError=function(a,b){return this.tap(ka,"undefined"!==typeof b?function(c){a.call(b,c)}:a)};z.doOnCompleted=z.tapOnCompleted=function(a,b){return this.tap(ka,null,"undefined"!==typeof b?function(){a.call(b)}:a)};z["finally"]=function(a){var c=this;return new S(function(d){var e=b(c.subscribe).call(c,d);return e===L?(a(),f(e.e)):qa(function(){var c=b(e.dispose).call(e);a();c===L&&f(c.e)})},
this)};var $b=function(a){function b(c){this.source=c;a.call(this)}function c(a){this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new c(a))};c.prototype.onNext=ka;c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=
!0,this.observer.onError(a),!0)};return b}(ca);z.ignoreElements=function(){return new $b(this)};z.materialize=function(){var a=this;return new S(function(b){return a.subscribe(function(a){b.onNext(qb(a))},function(a){b.onNext(rb(a));b.onCompleted()},function(){b.onNext(sb());b.onCompleted()})},a)};z.repeat=function(a){return ab(this,a).concat()};z.retry=function(a){return ab(this,a).catchError()};z.retryWhen=function(a){return ab(this).catchErrorWhen(a)};var ac=function(a){function b(c,g,d,e){this.source=
c;this.accumulator=g;this.hasSeed=d;this.seed=e;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new E(a,this))};return b}(ca);E.prototype={onNext:function(a){if(!this.isStopped){!this.hasValue&&(this.hasValue=!0);this.hasAccumulation?this.accumulation=b(this.accumulator)(this.accumulation,a):(this.accumulation=this.hasSeed?b(this.accumulator)(this.seed,a):a,this.hasAccumulation=!0);if(this.accumulation===L)return this.o.onError(this.accumulation.e);this.o.onNext(this.accumulation)}},
onError:function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))},onCompleted:function(){this.isStopped||(this.isStopped=!0,!this.hasValue&&this.hasSeed&&this.o.onNext(this.seed),this.o.onCompleted())},dispose:function(){this.isStopped=!0},fail:function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)}};z.scan=function(){var a=!1,b,c=arguments[0];2===arguments.length&&(a=!0,b=arguments[1]);return new ac(this,c,a,b)};z.skipLast=function(a){if(0>a)throw new za;var b=this;
return new S(function(c){var d=[];return b.subscribe(function(b){d.push(b);d.length>a&&c.onNext(d.shift())},function(a){c.onError(a)},function(){c.onCompleted()})},b)};z.startWith=function(){var a,b=0;arguments.length&&ha(arguments[0])?(a=arguments[0],b=1):a=oa;for(var c=[],d=arguments.length;b<d;b++)c.push(arguments[b]);return gb([Fb(c,a),this]).concat()};z.takeLast=function(a){if(0>a)throw new za;var b=this;return new S(function(c){var d=[];return b.subscribe(function(b){d.push(b);d.length>a&&d.shift()},
function(a){c.onError(a)},function(){for(;0<d.length;)c.onNext(d.shift());c.onCompleted()})},b)};z.flatMapConcat=z.concatMap=function(a,b,c){return(new Ra(this,a,b,c)).merge(1)};var jb=function(a){function c(b,g,d){this.source=b;this.selector=wa(g,d,3);a.call(this)}function d(a,b){return function(c,g,d){return a.call(this,b.selector(c,g,d),g,d)}}function e(a,b,c){this.o=a;this.selector=b;this.source=c;this.i=0;this.isStopped=!1}G(c,a);c.prototype.internalMap=function(a,b){return new c(this.source,
d(a,this),b)};c.prototype.subscribeCore=function(a){return this.source.subscribe(new e(a,this.selector,this))};e.prototype.onNext=function(a){if(!this.isStopped){a=b(this.selector)(a,this.i++,this.source);if(a===L)return this.o.onError(a.e);this.o.onNext(a)}};e.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};e.prototype.dispose=function(){this.isStopped=!0};e.prototype.fail=
function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return c}(ca);z.map=z.select=function(a,b){var c="function"===typeof a?a:function(){return a};return this instanceof jb?this.internalMap(c,b):new jb(this,c,b)};z.pluck=function(){var a=arguments.length,b=Array(a);if(0===a)throw Error("List of properties cannot be empty.");for(var c=0;c<a;c++)b[c]=arguments[c];return this.map(O(b,a))};z.flatMap=z.selectMany=function(a,b,c){return(new Ra(this,a,b,c)).mergeAll()};t.Observable.prototype.flatMapWithMaxConcurrent=
function(a,b,c,d){return(new Ra(this,b,c,d)).merge(a)};t.Observable.prototype.flatMapLatest=function(a,b,c){return(new Ra(this,a,b,c)).switchLatest()};var bc=function(a){function b(c,g){this.source=c;this.skipCount=g;a.call(this)}function c(a,b){this.r=this.c=b;this.o=a;this.isStopped=!1}G(b,a);b.prototype.subscribeCore=function(a){return this.source.subscribe(new c(a,this.skipCount))};c.prototype.onNext=function(a){if(!this.isStopped)if(0>=this.r)this.o.onNext(a);else this.r--};c.prototype.onError=
function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return b}(ca);z.skip=function(a){if(0>a)throw new za;return new bc(this,a)};z.skipWhile=function(a,b){var c=this,d=wa(a,b,3);return new S(function(a){var b=0,g=!1;return c.subscribe(function(e){if(!g)try{g=
!d(e,b++,c)}catch(f){a.onError(f);return}g&&a.onNext(e)},function(b){a.onError(b)},function(){a.onCompleted()})},c)};z.take=function(a,b){if(0>a)throw new za;if(0===a)return Bb(b);var c=this;return new S(function(b){var g=a;return c.subscribe(function(a){0<g--&&(b.onNext(a),0>=g&&b.onCompleted())},function(a){b.onError(a)},function(){b.onCompleted()})},c)};z.takeWhile=function(a,b){var c=this,d=wa(a,b,3);return new S(function(a){var b=0,g=!0;return c.subscribe(function(e){if(g){try{g=d(e,b++,c)}catch(f){a.onError(f);
return}if(g)a.onNext(e);else a.onCompleted()}},function(b){a.onError(b)},function(){a.onCompleted()})},c)};var kb=function(a){function c(b,g,d){this.source=b;this.predicate=wa(g,d,3);a.call(this)}function d(a,b){return function(c,g,d){return b.predicate(c,g,d)&&a.call(this,c,g,d)}}function e(a,b,c){this.o=a;this.predicate=b;this.source=c;this.i=0;this.isStopped=!1}G(c,a);c.prototype.subscribeCore=function(a){return this.source.subscribe(new e(a,this.predicate,this))};c.prototype.internalFilter=function(a,
b){return new c(this.source,d(a,this),b)};e.prototype.onNext=function(a){if(!this.isStopped){var c=b(this.predicate)(a,this.i++,this.source);if(c===L)return this.o.onError(c.e);c&&this.o.onNext(a)}};e.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};e.prototype.dispose=function(){this.isStopped=!0};e.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,
this.o.onError(a),!0)};return c}(ca);z.filter=z.where=function(a,b){return this instanceof kb?this.internalFilter(a,b):new kb(this,a,b)};M.fromCallback=function(a,b,c){return function(){"undefined"===typeof b&&(b=this);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];d=b;f=new Sa;e.push(X(f,d,c));a.apply(d,e);return f.asObservable()}};M.fromNodeCallback=function(a,b,c){return function(){"undefined"===typeof b&&(b=this);for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];
d=b;f=new Sa;e.push(Y(f,d,c));a.apply(d,e);return f.asObservable()}};U.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)};M.fromEvent=function(a,b,c){return a.addListener?cc(function(c){a.addListener(b,c)},function(c){a.removeListener(b,c)},c):new S(function(d){return Q(a,b,R(d,c))})};var cc=M.fromEventPattern=function(a,c,d,e){ha(e)||(e=oa);return(new S(function(e){function f(){var a=arguments[0];if(aa(d)&&(a=b(d).apply(null,arguments),
a===L))return e.onError(a.e);e.onNext(a)}var t=a(f);return qa(function(){aa(c)&&c(f,t)})})).publish().refCount()},dc=function(a){function b(c){this.p=c;a.call(this)}G(b,a);b.prototype.subscribeCore=function(a){this.p.then(function(b){a.onNext(b);a.onCompleted()},function(b){a.onError(b)});return na};return b}(ca),ma=M.fromPromise=function(a){return new dc(a)};z.toPromise=function(a){a||(a=t.config.Promise);if(!a)throw new ia("Promise type not provided nor in Rx.config.Promise");var b=this;return new a(function(a,
c){var d,e=!1;b.subscribe(function(a){d=a;e=!0},c,function(){e&&a(d)})})};M.startAsync=function(a){var b;try{b=a()}catch(c){return bb(c)}return ma(b)};z.multicast=function(a,b){var c=this;return"function"===typeof a?new S(function(d){var e=c.multicast(a());return new Z(b(e).subscribe(d),e.connect())},c):new ec(c,a)};z.publish=function(a){return a&&aa(a)?this.multicast(function(){return new Ca},a):this.multicast(new Ca)};z.share=function(){return this.publish().refCount()};z.publishLast=function(a){return a&&
aa(a)?this.multicast(function(){return new Sa},a):this.multicast(new Sa)};z.publishValue=function(a,b){return 2===arguments.length?this.multicast(function(){return new lb(b)},a):this.multicast(new lb(a))};z.shareValue=function(a){return this.publishValue(a).refCount()};z.replay=function(a,b,c,d){return a&&aa(a)?this.multicast(function(){return new mb(b,c,d)},a):this.multicast(new mb(b,c,d))};z.shareReplay=function(a,b,c){return this.replay(null,a,b,c).refCount()};var ec=t.ConnectableObservable=function(a){function b(c,
g){var d=!1,e,f=c.asObservable();this.connect=function(){d||(d=!0,e=new Z(f.subscribe(g),qa(function(){d=!1})));return e};a.call(this,function(a){return g.subscribe(a)})}G(b,a);b.prototype.refCount=function(){var a,b=0,c=this;return new S(function(g){var d=1===++b,e=c.subscribe(g);d&&(a=c.connect());return function(){e.dispose();0===--b&&a.dispose()}})};return b}(M),fc=M.interval=function(a,b){return ba(a,a,ha(b)?b:Aa)};M.timer=function(a,b,c){var d;ha(c)||(c=Aa);null!=b&&"number"===typeof b?d=b:
ha(b)&&(c=b);return a instanceof Date&&void 0===d?ea(a.getTime(),c):a instanceof Date&&void 0!==d?P(a.getTime(),b,c):void 0===d?ga(a,c):ba(a,d,c)};z.delay=function(a,b){ha(b)||(b=Aa);return a instanceof Date?da(this,a.getTime(),b):V(this,a,b)};z.debounce=function(a,b){ha(b)||(b=Aa);var c=this;return new S(function(d){var e=new pa,f=!1,t,k=0,m=c.subscribe(function(c){f=!0;t=c;k++;var m=k;c=new T;e.setDisposable(c);c.setDisposable(b.scheduleWithRelative(a,function(){f&&k===m&&d.onNext(t);f=!1}))},function(a){e.dispose();
d.onError(a);f=!1;k++},function(){e.dispose();f&&d.onNext(t);d.onCompleted();f=!1;k++});return new Z(m,e)},this)};z.throttle=function(a,b){return this.debounce(a,b)};z.timestamp=function(a){ha(a)||(a=Aa);return this.map(function(b){return{value:b,timestamp:a.now()}})};z.sample=z.throttleLatest=function(a,b){ha(b)||(b=Aa);return"number"===typeof a?W(this,fc(a,b)):W(this,a)};z.timeout=function(a,b,c){null!=b&&"string"!==typeof b||(b=bb(Error(b||"Timeout")));ha(c)||(c=Aa);var d=this,e=a instanceof Date?
"scheduleWithAbsolute":"scheduleWithRelative";return new S(function(f){function t(){var d=k;A.setDisposable(c[e](a,function(){k===d&&(ja(b)&&(b=ma(b)),l.setDisposable(b.subscribe(f)))}))}var k=0,m=new T,l=new pa,A=new pa;l.setDisposable(m);t();m.setDisposable(d.subscribe(function(a){k++;f.onNext(a);t()},function(a){k++;f.onError(a)},function(){k++;f.onCompleted()}));return new Z(l,A)},d)};z.throttleFirst=function(a,b){ha(b)||(b=Aa);var c=+a||0;if(0>=c)throw new RangeError("windowDuration cannot be less or equal zero.");
var d=this;return new S(function(a){var e=0;return d.subscribe(function(d){var f=b.now();if(0===e||f-e>=c)e=f,a.onNext(d)},function(b){a.onError(b)},function(){a.onCompleted()})},d)};var gc=function(a){function b(a){var c=this.source.publish();a=c.subscribe(a);var d=na,g=this.pauser.distinctUntilChanged().subscribe(function(a){a?d=c.connect():(d.dispose(),d=na)});return new Z(a,d,g)}function c(d,e){this.source=d;this.controller=new Ca;this.pauser=e&&e.subscribe?this.controller.merge(e):this.controller;
a.call(this,b,d)}G(c,a);c.prototype.pause=function(){this.controller.onNext(!1)};c.prototype.resume=function(){this.controller.onNext(!0)};return c}(M);z.pausable=function(a){return new gc(this,a)};var hc=function(a){function b(a){function c(){for(;0<d.length;)a.onNext(d.shift())}var d=[],g;return fa(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(a,b){return{data:a,shouldFire:b}}).subscribe(function(b){if(void 0!==g&&b.shouldFire!=g)(g=b.shouldFire)&&c();else if(g=b.shouldFire)a.onNext(b.data);
else d.push(b.data)},function(b){c();a.onError(b)},function(){c();a.onCompleted()})}function c(d,e){this.source=d;this.controller=new Ca;this.pauser=e&&e.subscribe?this.controller.merge(e):this.controller;a.call(this,b,d)}G(c,a);c.prototype.pause=function(){this.controller.onNext(!1)};c.prototype.resume=function(){this.controller.onNext(!0)};return c}(M);z.pausableBuffered=function(a){return new hc(this,a)};var jc=function(a){function b(a){return this.source.subscribe(a)}function c(d,e,f){a.call(this,
b,d);this.subject=new ic(e,f);this.source=d.multicast(this.subject).refCount()}G(c,a);c.prototype.request=function(a){return this.subject.request(null==a?-1:a)};return c}(M),ic=function(a){function b(a){return this.subject.subscribe(a)}function c(d,e){null==d&&(d=!0);a.call(this,b);this.subject=new Ca;this.queue=(this.enableQueue=d)?[]:null;this.requestedCount=0;this.error=this.requestedDisposable=null;this.hasCompleted=this.hasFailed=!1;this.scheduler=e||sa}G(c,a);Ha(c.prototype,Ba,{onCompleted:function(){this.hasCompleted=
!0;this.enableQueue&&0!==this.queue.length?this.queue.push(xa.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(a){this.hasFailed=!0;this.error=a;this.enableQueue&&0!==this.queue.length?this.queue.push(xa.createOnError(a)):(this.subject.onError(a),this.disposeCurrentRequest())},onNext:function(a){0>=this.requestedCount?this.enableQueue&&this.queue.push(xa.createOnNext(a)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(a))},
_processRequest:function(a){if(this.enableQueue)for(;0<this.queue.length&&(0<a||"N"!==this.queue[0].kind);){var b=this.queue.shift();b.accept(this.subject);"N"===b.kind?a--:(this.disposeCurrentRequest(),this.queue=[])}return a},request:function(a){this.disposeCurrentRequest();var b=this;return this.requestedDisposable=this.scheduler.scheduleWithState(a,function(a,c){var d=b._processRequest(c);if(!b.hasCompleted&&!b.hasFailed&&0<d)return b.requestedCount=d,qa(function(){b.requestedCount=0})})},disposeCurrentRequest:function(){this.requestedDisposable&&
(this.requestedDisposable.dispose(),this.requestedDisposable=null)}});return c}(M);z.controlled=function(a,b){a&&ha(a)&&(b=a,a=!0);null==a&&(a=!0);return new jc(this,a,b)};z.pipe=function(a){function b(){c.resume()}var c=this.pausableBuffered();a.addListener("drain",b);c.subscribe(function(b){!a.write(String(b))&&c.pause()},function(b){a.emit("error",b)},function(){!a._isStdio&&a.end();a.removeListener("drain",b)});c.resume();return a};var S=t.AnonymousObservable=function(a){function c(a){return a&&
aa(a.dispose)?a:aa(a)?qa(a):na}function d(a,e){var t=e[0],k=e[1],k=b(k.__subscribe).call(k,t);if(k===L&&!t.fail(L.e))return f(L.e);t.setDisposable(c(k))}function e(a){a=new fb(a);var b=[a,this];sa.scheduleRequired()?sa.scheduleWithState(b,d):d(null,b);return a}function t(b,c){this.source=c;this.__subscribe=b;a.call(this,e)}G(t,a);return t}(M),fb=function(a){function c(b){a.call(this);this.observer=b;this.m=new T}G(c,a);var d=c.prototype;d.next=function(a){a=b(this.observer.onNext).call(this.observer,
a);a===L&&(this.dispose(),f(a.e))};d.error=function(a){a=b(this.observer.onError).call(this.observer,a);this.dispose();a===L&&f(a.e)};d.completed=function(){var a=b(this.observer.onCompleted).call(this.observer);this.dispose();a===L&&f(a.e)};d.setDisposable=function(a){this.m.setDisposable(a)};d.getDisposable=function(){return this.m.getDisposable()};d.dispose=function(){a.prototype.dispose.call(this);this.m.dispose()};return c}(Oa),Ta=function(a,b){this.subject=a;this.observer=b};Ta.prototype.dispose=
function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1);this.observer=null}};var Ca=t.Subject=function(a){function b(a){la(this);if(!this.isStopped)return this.observers.push(a),new Ta(this,a);if(this.hasError)return a.onError(this.error),na;a.onCompleted();return na}function c(){a.call(this,b);this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}G(c,a);Ha(c.prototype,Ba.prototype,{hasObservers:function(){return 0<
this.observers.length},onCompleted:function(){la(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,b=l(this.observers),c=b.length;a<c;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){la(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;for(var b=0,c=l(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){la(this);if(!this.isStopped)for(var b=0,c=l(this.observers),d=c.length;b<d;b++)c[b].onNext(a)},dispose:function(){this.isDisposed=
!0;this.observers=null}});c.create=function(a,b){return new kc(a,b)};return c}(M),Sa=t.AsyncSubject=function(a){function b(a){la(this);if(!this.isStopped)return this.observers.push(a),new Ta(this,a);if(this.hasError)a.onError(this.error);else{if(this.hasValue)a.onNext(this.value);a.onCompleted()}return na}function c(){a.call(this,b);this.hasValue=this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}G(c,a);Ha(c.prototype,Ba,{hasObservers:function(){la(this);return 0<this.observers.length},
onCompleted:function(){var a,b;la(this);if(!this.isStopped){this.isStopped=!0;var c=l(this.observers);b=c.length;if(this.hasValue)for(a=0;a<b;a++){var d=c[a];d.onNext(this.value);d.onCompleted()}else for(a=0;a<b;a++)c[a].onCompleted();this.observers.length=0}},onError:function(a){la(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=0,c=l(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){la(this);this.isStopped||(this.value=
a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0;this.value=this.exception=this.observers=null}});return c}(M),kc=t.AnonymousSubject=function(a){function b(a){return this.observable.subscribe(a)}function c(d,e){this.observer=d;this.observable=e;a.call(this,b)}G(c,a);Ha(c.prototype,Ba.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}});return c}(M),lb=t.BehaviorSubject=function(a){function b(a){la(this);
if(!this.isStopped)return this.observers.push(a),a.onNext(this.value),new Ta(this,a);if(this.hasError)a.onError(this.error);else a.onCompleted();return na}function c(d){a.call(this,b);this.value=d;this.observers=[];this.hasError=this.isStopped=this.isDisposed=!1}G(c,a);Ha(c.prototype,Ba,{getValue:function(){la(this);if(this.hasError)throw this.error;return this.value},hasObservers:function(){return 0<this.observers.length},onCompleted:function(){la(this);if(!this.isStopped){this.isStopped=!0;for(var a=
0,b=l(this.observers),c=b.length;a<c;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){la(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var b=0,c=l(this.observers),d=c.length;b<d;b++)c[b].onError(a);this.observers.length=0}},onNext:function(a){la(this);if(!this.isStopped){this.value=a;for(var b=0,c=l(this.observers),d=c.length;b<d;b++)c[b].onNext(a)}},dispose:function(){this.isDisposed=!0;this.exception=this.value=this.observers=null}});return c}(M),
mb=t.ReplaySubject=function(a){function b(a,c){return qa(function(){c.dispose();!a.isDisposed&&a.observers.splice(a.observers.indexOf(c),1)})}function c(a){a=new ub(this.scheduler,a);var d=b(this,a);la(this);this._trim(this.scheduler.now());this.observers.push(a);for(var e=0,f=this.q.length;e<f;e++)a.onNext(this.q[e].value);if(this.hasError)a.onError(this.error);else if(this.isStopped)a.onCompleted();a.ensureActive();return d}function d(b,g,f){this.bufferSize=null==b?e:b;this.windowSize=null==g?e:
g;this.scheduler=f||sa;this.q=[];this.observers=[];this.hasError=this.isDisposed=this.isStopped=!1;this.error=null;a.call(this,c)}var e=Math.pow(2,53)-1;G(d,a);Ha(d.prototype,Ba.prototype,{hasObservers:function(){return 0<this.observers.length},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;0<this.q.length&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){la(this);if(!this.isStopped){var b=this.scheduler.now();this.q.push({interval:b,value:a});this._trim(b);
for(var b=0,c=l(this.observers),d=c.length;b<d;b++){var g=c[b];g.onNext(a);g.ensureActive()}}},onError:function(a){la(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;var b=this.scheduler.now();this._trim(b);for(var b=0,c=l(this.observers),d=c.length;b<d;b++){var g=c[b];g.onError(a);g.ensureActive()}this.observers.length=0}},onCompleted:function(){la(this);if(!this.isStopped){this.isStopped=!0;var a=this.scheduler.now();this._trim(a);for(var a=0,b=l(this.observers),c=b.length;a<
c;a++){var d=b[a];d.onCompleted();d.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0;this.observers=null}});return d}(M);t.Pauser=function(a){function b(){a.call(this)}G(b,a);b.prototype.pause=function(){this.onNext(!1)};b.prototype.resume=function(){this.onNext(!0)};return b}(Ca);r.exports=t}).call(h,function(){return this}(),c(15))},function(r,h,c){(function(p){function q(a,b,c){var f=3>=arguments.length||void 0===arguments[3]?null:arguments[3];this.name="RequestError";
this.url=a;this.xhr=b;this.code=b.status;this.reason=f;this.message="request: "+c+" ("+a+")";Error.captureStackTrace&&Error.captureStackTrace(this,q)}function l(a,b){var c=b.code,f=b.method,k=b.message;this.name="RestCallMethodError";this.url=a;this.code=c;this.message="restmethodcall: webservice error status "+c+" ("+a+")"+(f?" ("+f+")":"")+(k?"\n"+k:"");Error.captureStackTrace&&Error.captureStackTrace(this,l)}function a(a,b,c){a=a.querySelector("RestCallResult");var f=+a.querySelector("Status").textContent;
if(0>f)throw new l(b,{code:f,method:c});return{output:a.querySelector("Output"),status:f}}function b(a){return"rest-call-method"==a.format?k(a):u.create(function(b){function c(a){var d=a.target,f=d.status;if(200>f||300<=f)return b.onError(new q(k,d,d.statusText));var f=Date.now()-v,m;m="document"==u?(new p.DOMParser).parseFromString(d.responseText,"text/xml"):d.response;if("json"==u&&"string"==typeof m)try{m=JSON.parse(m)}catch(l){m=null}if(null==m)return b.onError(new q(k,d,'null response with format "'+
u+'" (error while parsing or wrong content-type)'));if(w){var h;if(E){h=E;for(var C={},x,O=0;O<h.length;O++)x=h[O],C[x]=d.getResponseHeader(x);h=C}b.onNext({blob:m,size:a.total,duration:f,headers:h,url:d.responseURL||k,xhr:d})}else b.onNext(m);b.onCompleted()}function f(a){b.onError(new q(k,a,"error event"))}var k=a.url,m=a.data,l=a.headers,u=a.format,w=a.withMetadata,E=a.responseHeaders,h=new XMLHttpRequest;h.open(a.method||"GET",k,!0);h.responseType="document"==u?"text":u||"text";if(l)for(var C in l)h.setRequestHeader(C,
l[C]);h.addEventListener("load",c,!1);h.addEventListener("error",f,!1);var v=Date.now();h.send(m);return function(){var a=h.readyState;0<a&&4>a&&(h.removeEventListener("load",c),h.removeEventListener("error",f),h.abort());h=null}})}function f(a){return(a||"").toString().replace(w,function(a){return m[a]})}function h(a){var b="",c;for(c in a)var k=a[c],k="object"==typeof k?h(k):f(k),b=b+("<"+c+">"+k+"</"+c+">");return b}function k(c){c.method="POST";c.headers={"Content-Type":"application/xml"};c.data=
C.replace("{payload}",h(c.data));c.format="document";return b(c).map(function(b){return a(b,c.url,c.ScriptInfo)})}var u=c(3).Observable;q.prototype=Error();l.prototype=Error();var w=/[&<>]/g,m={"&":"&amp;","<":"&lt;",">":"&gt;"},C='<RestCallMethod xmlns:i="http://www.w3.org/2001/XMLSchema-instance">{payload}</RestCallMethod>';b.escapeXml=f;b.RequestError=q;b.RestCallMethodError=l;b.RestCallResult=a;b.getNodeTextContent=function(a,b){var c=a.querySelector(b);return c&&c.textContent};r.exports=b}).call(h,
function(){return this}())},function(r,h){function c(){f&&v&&(f=!1,v.length?b=v.concat(b):k=-1,b.length&&p())}function p(){if(!f){var a=setTimeout(c);f=!0;for(var l=b.length;l;){v=b;for(b=[];++k<l;)v&&v[k].run();k=-1;l=b.length}v=null;f=!1;clearTimeout(a)}}function q(a,b){this.fun=a;this.array=b}function l(){}var a=r.exports={},b=[],f=!1,v,k=-1;a.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var k=1;k<arguments.length;k++)c[k-1]=arguments[k];b.push(new q(a,c));1!==
b.length||f||setTimeout(p,0)};q.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=l;a.addListener=l;a.once=l;a.off=l;a.removeListener=l;a.removeAllListeners=l;a.emit=l;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(r,h,c){function p(a,b){if(!(a instanceof
b))throw new TypeError("Cannot call a class as a function");}function q(a){if("number"==typeof a)return a;for(var b=0,c=void 0,d=0;d<a.length;d++)c=a[d],b=(b<<5)-b+c,b&=b;return b}function l(a){if(!fa||!da||da.alwaysRenew)return null;var b=W;return(a=d.find(a,function(a){return a.type!==fa.type||a.persistentLicense&&"required"!=b.persistentState||a.distinctiveIdentifierRequired&&"required"!=b.distinctiveIdentifier?!1:!0}))?{keySystem:a,keySystemAccess:new O(fa,da,W)}:null}function a(a){var b=["temporary"],
c="optional",d="optional";a.persistentLicense&&(c="required",b.push("persistent-license"));a.persistentStateRequired&&(c="required");a.distinctiveIdentifierRequired&&(d="required");return{videoCapabilities:void 0,audioCapabilities:void 0,initDataTypes:["cenc"],distinctiveIdentifier:d,persistentState:c,sessionTypes:b}}function b(b){var c=l(b);if(c)return e.debug("eme: found compatible keySystem quickly",c),E(c);var f=d.flatten(b,function(a){return d.map(P[a.type],function(b){return{keyType:b,keySystem:a}})});
return F.create(function(b){function c(k){if(!d)if(k>=f.length)b.onError(Error("eme: could not find a compatible key system"));else{var t=f[k],m=t.keyType,l=t.keySystem,A=[a(l)];e.debug("eme: request keysystem access "+m+","+(k+1+" of "+f.length),A);X(m,A).then(function(a){e.info("eme: found compatible keysystem",m,A);b.onNext({keySystem:l,keySystemAccess:a});b.onCompleted()},function(){e.debug("eme: rejected access to keysystem",m,A);c(k+1)})}}var d=!1;c(0);(function(){return d=!0})})}function f(a,
b,c){var d=A,f=da;return y(c.createMediaKeys().then(function(k){da=k;W=c.getConfiguration();fa=b;A=a;if(a.mediaKeys===k)return Promise.resolve(k);f&&f!==da&&V.dispose();if(d&&d!==A)return e.debug("eme: unlink old video element and set mediakeys"),Y(d,null).then(function(){return Y(A,k)}).then(function(){return k});e.debug("eme: set mediakeys");return Y(A,k).then(function(){return k})}))}function v(a,b){var c=a.createSession(b);c.sessionType=b;return c}function k(a,b,c){e.debug("eme: generate request",
b,c);return y(a.generateRequest(b,c).then(function(){return a}))}function u(a,b){e.debug("eme: load persisted session",b);return y(a.load(b).then(function(b){return{success:b,session:a}}))}function w(a,b){var c=Error(a);b&&(c.reason=b);e.error(a,b);throw c;}function m(a){return d.isPromise(a)?y(a):d.isObservable(a)?a:E(a)}function C(a,c){function d(b,c){var k=c.keySystem,m=c.keySystemAccess;k.persistentLicense&&ba.setStorage(k.licenseStorage);var A=new Uint8Array(b.initData),u=b.initDataType,h=m.getConfiguration();
e.info("eme: encrypted event",b);return f(a,k,m).flatMap(function(a){return l(a,h,k,u,A).tap(function(a){ba.add(A,a);V.add(A,a)},function(a){e.error("eme: error during session management handler",a)})}).flatMap(function(a){return q(a,k).tapOnError(function(b){e.error("eme: error in session messages handler",a,b);ba["delete"](A);V.deleteAndClose(a.sessionId)})})}function l(a,b,c,d,f){var k=V.get(f);if(k)return e.debug("eme: reuse loaded session",k.sessionId),E(k);b=(k=0<=b.sessionTypes.indexOf("persistent-license"))&&
c.persistentLicense?"persistent-license":"temporary";return k&&c.persistentLicense&&(c=ba.get(f))?h(a,c,d,f):A(a,b,d,f)}function A(a,b,c,d){e.debug("eme: create a new "+b+" session");var f=v(a,b);return k(f,c,d)["catch"](function(f){var m=V.getFirst();if(!m)throw f;e.warn("eme: could not create a new session, retry after closing a currently loaded session",f);return F.from(m.close()).flatMap(function(){return k(v(a,b),c,d)})})}function h(a,b,c,d){e.debug("eme: create a new persistent-license session");
var f=v(a,"persistent-license");return u(f,b)["catch"](function(f){e.warn("eme: failed to load persisted session, do fallback",b,f);ba["delete"](d);V["delete"](b);return A(a,"persistent-license",c,d).map(function(a){return{success:!0,session:a}})}).flatMap(function(f){var k=f.session;if(f.success)return e.debug("eme: successfully loaded session"),E(k);e.warn("eme: no data stored for the loaded session, removing it",b);ba["delete"](d);V["delete"](b);k.remove()["catch"](function(a){return e.warn("eme: could not remove session",
a)});f=A(a,"persistent-license",c,d);return I(f,E(k))})}function q(a,b){e.debug("eme: handle message events for session",a.sessionId);var c=void 0,d=R(a).map(function(a){return w("eme: keyerror event "+a.errorCode+" / "+a.systemCode,a)}),f=ea(a).flatMap(function(d){c=d.sessionId;e.debug("eme: keystatuseschange event",c,a,d);for(var f=a.keyStatuses.values(),k=f.next();!k.done;k=f.next())(k=ga[k.value])&&w(k);if(!b.onKeyStatusesChange)return e.warn("eme: keystatuseschange event not handled"),N();f=
void 0;try{f=b.onKeyStatusesChange(d,a)}catch(t){f=F["throw"](t)}return m(f)["catch"](function(a){return w("eme: onKeyStatusesChange has failed "+("(reason:"+(a&&a.message||"unknown")+")"),a)})}),k=Q(a).flatMap(function(d){c=d.sessionId;var f=new Uint8Array(d.message),k=d.messageType||"license-request";e.debug("eme: event message type "+k,a,d);d=void 0;try{d=b.getLicense(f,k)}catch(t){d=F["throw"](t)}return m(d)["catch"](function(a){return w("eme: getLicense has failed "+("(reason: "+(a&&a.message||
"unknown")+")"),a)})}),f=I(k,f).concatMap(function(b){e.debug("eme: update session",c,b);return a.update(b,c)["catch"](function(a){return w("eme: error on session update "+c,a)})}).map(function(){return{type:"eme",value:{session:a,name:"session-updated"}}});return I(f,d)}return H(U(a),b(c),function(a,b){return[a,b]}).take(1).flatMap(function(a){return d(a[0],a[1])})}var d=c(1),e=c(4),x=c(6),J=c(2),F=c(3).Observable,H=F.combineLatest,N=F.empty,y=F.fromPromise,I=F.merge,E=F.just;h=c(8);var O=h.KeySystemAccess,
X=h.requestMediaKeySystemAccess,Y=h.setMediaKeys;h=h.emeEvents;var U=h.onEncrypted,Q=h.onKeyMessage,R=h.onKeyError,ea=h.onKeyStatusesChange,P={clearkey:["webkit-org.w3.clearkey","org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.youtube.playready","com.microsoft.playready"]},ga={"output-not-allowed":"eme: the required output protection is not available.",expired:"eme: a required key has expired and the content cannot be decrypted.","internal-error":"eme: an unknown error has occurred in the CDM."};
h=function(){function a(){p(this,a);this._entries=[]}a.prototype.getFirst=function(){if(0<this._entries.length)return this._entries[0].session};a.prototype.get=function(a){a=q(a);var b=d.find(this._entries,function(b){return b.initData===a});if(b)return b.session};a.prototype.add=function(a,b){var c=this;a=q(a);if(!this.get(a)){var d=function(){if(!b.sessionId)return{v:void 0};var d={session:b,initData:a};e.debug("eme-mem-store: add session",d);c._entries.push(d);b.closed.then(function(){e.debug("eme-mem-store: remove closed session",
d);var a=c._entries.indexOf(d);0<=a&&c._entries.splice(a,1)})}();if("object"===typeof d)return d.v}};a.prototype["delete"]=function(a){var b=d.find(this._entries,function(b){return b.session.sessionId===a});if(b){e.debug("eme-mem-store: delete session",a);var c=this._entries.indexOf(b);this._entries.splice(c,1);return b.session}};a.prototype.deleteAndClose=function(a){var b=this["delete"](a);return b?(e.debug("eme-mem-store: close session",a),b.close()):x.resolve()};a.prototype.dispose=function(){var a=
this._entries.map(function(a){return a.session.close()});this._entires=[];return x.all(a)};return a}();var ba=new (function(){function a(b){p(this,a);this.setStorage(b)}a.prototype.setStorage=function(a){if(this._storage!==a){J(a,"eme: no licenseStorage given for keySystem with persistentLicense");J.iface(a,"licenseStorage",{save:"function",load:"function"});this._storage=a;try{this._entries=this._storage.load(),J(Array.isArray(this._entries))}catch(b){e.warn("eme-persitent-store: could not get entries from license storage",
b),this.dispose()}}};a.prototype.get=function(a){a=q(a);var b=d.find(this._entries,function(b){return b.initData===a});if(b)return b.sessionId};a.prototype.add=function(a,b){a=q(a);if("persistent-license"==b.sessionType&&!this.get(a)){var c=b.sessionId;c&&(e.info("eme-persitent-store: add new session",c,b),this._entries.push({sessionId:c,initData:a}),this._save())}};a.prototype["delete"]=function(a){a=q(a);var b=d.find(this._entries,function(b){return b.initData===a});b&&(e.warn("eme-persitent-store: delete session from store",
b),b=this._entries.indexOf(b),this._entries.splice(b,1),this._save())};a.prototype.dispose=function(){this._entries=[];this._save()};a.prototype._save=function(){try{this._storage.save(this._entries)}catch(a){e.warn("eme-persitent-store: could not save licenses in localStorage")}};return a}())({load:function(){return[]},save:function(){}}),V=new h,da=void 0,W=void 0,fa=void 0,A=void 0;C.onEncrypted=U;C.getCurrentKeySystem=function(){return fa&&fa.type};C.dispose=function(){fa=da=null;V.dispose()};
r.exports=C},function(r,h,c){function p(a){this.name="OutOfIndexError";this.type=a;this.message="out of range in index "+a}function q(c){switch(c.indexType){case "template":return a;case "timeline":return b;case "list":return f;case "base":return v;default:throw Error("index-handler: unrecognized indexType "+c.indexType);}}c(2);var l=c(12).getAdaptationsByType,a=c(30),b=c(18),f=c(29),v=c(28);p.prototype=Error();h=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.adaptation=b;this.representation=c;this.index=c.index;this.handler=new (q(this.index))(this.index)}a.prototype.getInitSegment=function(){var a=this.index.initialization||{};return{id:"init_"+this.adaptation.id+"_"+this.representation.id,init:!0,media:a.media,range:a.range,indexRange:this.index.indexRange}};a.prototype.normalizeRange=function(a,b,c){var f=this.index.presentationTimeOffset||0,d=this.index.timescale||1;b||(b=0);c||(c=0);b=Math.min(b,c);return{time:a*d-f,up:(a+b)*d-f,to:(a+c)*d-
f}};a.prototype.getSegments=function(a,b,c){a=this.normalizeRange(a,b,c);b=a.up;c=a.to;if(!this.handler.checkRange(a.time))throw new p(this.index.indexType);return this.handler.getSegments(b,c)};a.prototype.insertNewSegments=function(a,b){for(var c=[],f=0;f<a.length;f++)this.handler.addSegment(a[f],b)&&c.push(a[f]);return c};a.prototype.setTimescale=function(a){var b=this.index;return b.timescale!==a?(b.timescale=a,!0):!1};a.prototype.scale=function(a){return a/this.index.timescale};return a}();r.exports=
{OutOfIndexError:p,IndexHandler:h,getLiveEdge:function(a){var b=l(a,"video")[0].representations[0].index;return q(b).getLiveEdge(b,a)}}},function(r,h,c){function p(c){var a=c.ts,b=c.d;c=c.r;return-1===b?a:a+(c+1)*b}var q=c(1);h=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=a;this.timeline=a.timeline}c.getLiveEdge=function(a,b){var c=p(q.last(a.timeline))/a.timescale-b.suggestedPresentationDelay;return Math.max(a.timeline[0].ts/
a.timescale+1,c)};c.prototype.createSegment=function(a,b,c){return{id:a,media:this.index.media,time:a,number:void 0,range:b,duration:c}};c.prototype.calculateRepeat=function(a,b){var c=a.r||0;0>c&&(c=Math.ceil(((b?b.t:Infinity)-a.ts)/a.d)-1);return c};c.prototype.checkRange=function(a){var b=q.last(this.timeline);if(!b)return!0;0>b.d&&(b={ts:b.ts,d:0,r:b.r});return a<=p(b)};c.prototype.getSegmentIndex=function(a){for(var b=this.timeline,c=0,l=b.length;c<l;){var k=c+l>>>1;b[k].ts<a?c=k+1:l=k}return 0<
c?c-1:c};c.prototype.getSegmentNumber=function(a,b,c){a=b-a;return 0<a?Math.floor(a/c):0};c.prototype.getSegments=function(a,b){var c=this.index.timeline,l=[],k=c.length,h=this.getSegmentIndex(a)-1,q=c.length&&c[0].d||0;a:for(;!(++h>=k);){var m=c[h],p=m.d,d=m.ts,e=m.range,q=Math.max(q,p);if(0>p){d+q<b&&l.push(this.createSegment(d,e,void 0));break}for(var m=this.calculateRepeat(m,c[h+1]),x=this.getSegmentNumber(d,a,p),J;(J=d+x*p)<b;)if(x++<=m)l.push(this.createSegment(J,e,p));else continue a;break}return l};
c.prototype.addSegment=function(a,b){var c=this.timeline,l=c.length,k=c[l-1];if(b&&a.ts===b.ts){var h=a.ts+a.d,q=h-(k.ts+k.d*k.r);if(0>=q)return!1;-1===k.d&&((l=c[l-2])&&l.d===q?(l.r++,c.pop()):k.d=q);c.push({d:-1,ts:h,r:0});return!0}return a.ts>=p(k)?(k.d===a.d?k.r++:c.push({d:a.d,ts:a.ts,r:0}),!0):!1};return c}();r.exports=h},function(r,h,c){function p(a,b){var c=a.playbackRate,h=a.duration,k=a.currentTime,q=a.readyState,p=new l(a.buffered),m=p.getRange(k),C=p.getGap(k);return{name:b,ts:k,range:m,
gap:C,duration:h,playback:c,readyState:q,stalled:null,buffered:p}}var q=c(3).Observable,l=c(9).BufferedRanges;r.exports={getEmptyTimings:function(){return{name:"timeupdate",ts:0,range:null,gap:Infinity,duration:0,playback:1,readyState:0,stalled:!1,buffered:new l}},getTimings:p,timingsSampler:function(a){return q.create(function(b){function c(f){var k=l,m=f&&f.type||"timeupdate";f=p(a,m);var k=k.stalled,h=f.gap;(m="loadedmetadata"==m||k)||(m=(m=f.range)?.5>=f.duration-(h+m.end):!1);f.stalled=m||!(.5>=
h||Infinity===h)?k&&Infinity>h&&h>("seeking"==k.name?.5:5)?null:k:{name:f.name,playback:f.playback};l=f;b.onNext(l)}var l=p(a,"init"),k=setInterval(c,1E3);a.addEventListener("play",c);a.addEventListener("progress",c);a.addEventListener("seeking",c);a.addEventListener("seeked",c);a.addEventListener("loadedmetadata",c);b.onNext(l);return function(){clearInterval(k);a.removeEventListener("play",c);a.removeEventListener("progress",c);a.removeEventListener("seeking",c);a.removeEventListener("seeked",c);
a.removeEventListener("loadedmetadata",c)}}).shareValue({name:"init",stalled:null})},seekingsSampler:function(a){return a.filter(function(a){return"seeking"==a.name&&(Infinity===a.gap||-2>a.gap)}).skip(1).startWith(!0)},getLiveGap:function(a,b){if(!b.isLive)return Infinity;var c=b.availabilityStartTime,l=b.presentationLiveGap;return Date.now()/1E3-a-(c+l+10)},toWallClockTime:function(a,b){return new Date(1E3*(a+b.availabilityStartTime))},fromWallClockTime:function(a,b){var c=a,l=b.suggestedPresentationDelay,
k=b.presentationLiveGap,h=b.timeShiftBufferDepth;"number"!=typeof c&&(c=c.getTime());var q=Date.now();return Math.max(Math.min(c,q-1E3*(k+l)),q-1E3*h)/1E3-b.availabilityStartTime}}},function(r,h){function c(c){return c*(1+.3*(2*Math.random()-1))}r.exports={getFuzzedDelay:c,getBackedoffDelay:function(h){return c(h*Math.pow(2,(1>=arguments.length||void 0===arguments[1]?1:arguments[1])-1))}}},function(r,h){r.exports=function(c,h,q){function l(){var a=f-Date.now();if(0<a)b=setTimeout(l,a);else switch(b=
null,v.length){case 0:return c();case 1:return c(v[0]);case 2:return c(v[0],v[1]);case 3:return c(v[0],v[1],v[2]);default:return c.apply(null,v)}}function a(){var c=arguments.length,m=0;for(v=Array(c);m<c;m++)v[m]=arguments[m];if(k&&!u)return u=!0,f=Date.now(),l();c=f;f=Date.now()+h;if(!b||f<c)b&&clearTimeout(b),b=setTimeout(l,h);return a}var b=null,f=0,v=[],k=!(!q||!q.leading),u=!1;a.isWaiting=function(){return!!b};a.dispose=function(){b&&(clearTimeout(b),b=null)};return a}},function(r,h){r.exports=
function(c){c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],c.children=[],c.webpackPolyfill=1);return c}},function(r,h){function c(c){return function(h,l){return null==h?l:c*l+(1-c)*h}}r.exports=function(h,q){return h.map(function(c){return c.value.response}).filter(function(c){return 2E3<c.size}).map(function(c){return c.size/c.duration*8E3}).scan(c(q.alpha))}},function(r,h,c){function p(a,b){return"number"==typeof a&&0<a?a:b}function q(a,b){var c=2>=arguments.length||void 0===arguments[2]?
0:arguments[2];return f.findLast(a,function(a){return a/b<=1-c})||a[0]}function l(a,b){var c=f.find(a,function(a){return a.width>=b});return c?c.bitrate:Infinity}function a(a,b){return b?f.find(a,function(a){return a.lang===b}):null}function b(a,b){return a.filter(function(a){return a.type===b})}var f=c(1),v=c(4);h=c(3);var k=h.BehaviorSubject,u=h.CompositeDisposable,w=h.Observable.combineLatest,m=c(5).only,C=c(23),d={defaultLanguage:"fra",defaultSubtitle:"",defaultBufferSize:30,defaultBufferThreshold:.3};
r.exports=function(c,h,r){function F(b){return Q.changes().map(function(c){return a(b,c)||b[0]})}function H(b){return R.changes().map(function(c){return a(b,c)})}var N=f.defaults(3>=arguments.length||void 0===arguments[3]?{}:arguments[3],d),y=N.defaultSubtitle,I=N.defaultBufferSize,E=N.defaultBufferThreshold,O=N.initVideoBitrate,X=N.initAudioBitrate,Y=r.videoWidth,U=r.inBackground,Q=new k(N.defaultLanguage),R=new k(y),ea={audio:C(b(c,"audio"),{alpha:.6}).publishValue(X||0),video:C(b(c,"video"),{alpha:.6}).publishValue(O||
0)},P=new u(f.map(f.values(ea),function(a){return a.connect()})),ga={audio:new k(Infinity),video:new k(Infinity)},ba={audio:new k(Infinity),video:new k(Infinity)},V={audio:new k(I),video:new k(I),text:new k(I)};return{setLanguage:function(a){Q.onNext(a)},setSubtitle:function(a){R.onNext(a)},getLanguage:function(){return Q.value},getSubtitle:function(){return R.value},getAverageBitrates:function(){return ea},getAudioMaxBitrate:function(){return ba.audio.value},getVideoMaxBitrate:function(){return ba.video.value},
getAudioBufferSize:function(){return V.audio.value},getVideoBufferSize:function(){return V.video.value},setAudioBitrate:function(a){ga.audio.onNext(p(a,Infinity))},setVideoBitrate:function(a){ga.video.onNext(p(a,Infinity))},setAudioMaxBitrate:function(a){ba.audio.onNext(p(a,Infinity))},setVideoMaxBitrate:function(a){ba.video.onNext(p(a,Infinity))},setAudioBufferSize:function(a){V.audio.onNext(p(a,I))},setVideoBufferSize:function(a){V.video.onNext(p(a,I))},getBufferAdapters:function(a){var b=a.type,
c=a.bitrates,d=a.representations;a=d[0];if(1<d.length){a=ga[b];var e=ba[b],h=ea[b].map(function(a,b){return q(c,a,0===b?0:E)}).changes().customDebounce(2E3,{leading:!0});"video"==b&&(e=w(e,Y,U,function(a,b,e){if(e)return c[0];b=l(d,b);return b<a?b:a}));a=w(a,e,h,function(a,b,c){return Infinity>a?a:Infinity>b?Math.min(b,c):c}).map(function(a){return f.find(d,function(b){return b.bitrate===q(c,a)})}).changes(function(a){return a.id}).tap(function(a){return v.info("bitrate",b,a.bitrate)})}else a=m(a);
return{representations:a,bufferSizes:V[b]||new k(I)}},getAdaptationsChoice:function(a,b){if("audio"==a)return F(b);if("text"==a)return H(b);if(1==b.length)return m(b[0]);throw Error("adaptive: unknown type "+a+" for adaptation chooser");},dispose:function(){P&&(P.dispose(),P=null)}}}},function(r,h,c){var p=c(1),q=c(4),l=c(9).BufferedRanges;h=c(3);var a=h.Observable,b=h.Subject,f=a.combineLatest,v=a.defer,k=a.empty,u=a.from,w=a.just,m=a.merge,C=a.timer;h=c(5);var d=h.first,e=h.on,x=c(46).ArraySet;
c=c(17);var J=c.IndexHandler,F=c.OutOfIndexError;r.exports=function(a){function c(a){return function(b){return v(function(){return O.updating?d(fa).flatMap(function(){return a(b)}):a(b)})}}function h(a,b){for(var c=a.ts,d=a.buffered,e=d.getRange(c),d=d.getOuterRanges(c),f=[],k=0;k<d.length;k++){var m=d[k];c-b<m.end?f.push(m):c+b>m.start&&f.push(m)}e&&(q.debug("buffer: gc removing part of inner range",f),c-b>e.start&&f.push({start:e.start,end:c-b}),c+b<e.end&&f.push({start:c+b,end:e.end}));return f}
function r(){q.warn("buffer: running garbage collector");return Q.take(1).flatMap(function(a){var b=h(a,240);0===b.length&&(b=h(a,30));q.debug("buffer: gc cleaning",b);return u(b.map(ka)).concatAll()})}function E(a){function b(c){if(e.test(c.id))return!1;if(c.init||null==c.time)return!0;var f=d.scale(c.time);c=d.scale(c.duration);return(f=W.hasRange(f,c))?1.5*f.bitrate<a.bitrate:!0}function c(b,e,f,k){var m=[];k&&(q.debug("add init segment",R),m.push(d.getInitSegment()));if(0===e.readyState)return m;
k=e.ts;e=Math.max(0,Math.min(f,e.liveGap,(e.duration||Infinity)-k));b=b.getGap(k);b=b>ga&&Infinity>b?Math.min(b,ba):0;(f=W.getRange(k))&&f.bitrate===a.bitrate&&(f=Math.floor(f.end-k),f>b&&(b=f));k=d.getSegments(k,b,e);return m.concat(k)}var d=new J(X,a),e=new x,h=f(Q,da,A,function(a,b){return{timing:a,bufferSize:b}}).flatMap(function(d,f){var m=d.timing,t=d.bufferSize,A=new l(O.buffered);ea&&!W.equals(A)&&(q.debug("intersect new buffer",R),W.intersect(A));var h;try{h=c(A,m,t,0===f),h=p.filter(h,b)}catch(E){if(E instanceof
F)return P.onNext({type:"out-of-index",value:E}),k();throw E;}return u(p.map(h,function(b){e.add(b.id);return{adaptation:X,representation:a,segment:b}}))}).concatMap(Y).concatMap(function(a){var b=a.parsed.blob;return t(b)["catch"](function(a){if("QuotaExceededError"==a.name)return r().flatMap(function(){return t(b)});throw a;}).map(a)}).map(function(b){var c=b.parsed;e.remove(b.segment.id);var f=c.timescale;f&&d.setTimescale(f);f=c.nextSegments;c=c.currentSegment;f=f?d.insertNewSegments(f,c):[];
c&&W.insert(a.bitrate,d.scale(c.ts),d.scale(c.ts+c.d));return{type:"segment",value:p.extend({addedSegments:f},b)}});return m(h,P)["catch"](function(b){if(412!==b.code)throw b;return w({type:"precondition-failed",value:b}).concat(C(2E3)).concat(E(a))})}var O=a.sourceBuffer,X=a.adaptation,Y=a.pipeline,U=a.adapters,Q=a.timings;a=a.seekings;var R=X.type,ea="audio"==R||"video"==R,P=new b,ga="video"==R?4:1,ba="video"==R?6:1,V=U.representations,da=U.bufferSizes,W=new l,fa=m(e(O,"update"),e(O,"error").map(function(a){if(a.target&&
a.target.error)throw a.target.error;q.error("buffer: error event",a);throw Error("buffer: error event");})).share(),A=fa.ignoreElements().startWith(!0),t=c(function(a){O.appendBuffer(a);return d(fa)}),ka=c(function(a){O.remove(a.start,a.end);return d(fa)});return f(V,a,p.identity).flatMapLatest(E)}},function(r,h){var c=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.cache={}}c.prototype.add=function(c,l){var a=c.segment;a.init&&(this.cache[a.id]=
l)};c.prototype.get=function(c){c=c.segment;return c.init&&(c=this.cache[c.id],null!=c)?c:null};return c}();r.exports={InitializationSegmentCache:c}},function(r,h,c){h=c(3).Observable;var p=h.merge,q=h.interval;c=c(8);var l=c.visibilityChange,a=c.videoSizeChange,b=window.devicePixelRatio||1;r.exports=function(c){var h=l().filter(function(a){return!1===a}),k=l().customDebounce(6E4).filter(function(a){return!0===a}),h=p(h,k).startWith(!1);return{videoWidth:p(q(2E4),a().customDebounce(500)).startWith("init").map(function(){return c.clientWidth*
b}).changes(),inBackground:h}}},function(r,h,c){function p(c,l){if("function"!==typeof l&&null!==l)throw new TypeError("Super expression must either be null or a function, not "+typeof l);c.prototype=Object.create(l&&l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});l&&(Object.setPrototypeOf?Object.setPrototypeOf(c,l):c.__proto__=l)}h=function(c){function l(a){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");c.call(this,a)}p(l,c);l.getLiveEdge=
function(){throw Error("not implemented");};l.prototype.addSegment=function(a){this.index.timeline.push(a);return!0};return l}(c(18));r.exports=h},function(r,h){var c=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=h}c.getLiveEdge=function(){throw Error("not implemented");};c.prototype.checkRange=function(c){var l=this.index,a=l.list;c=Math.floor(c/l.duration);return 0<=c&&c<a.length};c.prototype.createSegment=function(c,l){var a=
this.index.list[c];return{id:c,media:a.media,time:l,number:void 0,range:a.range,duration:this.index.duration}};c.prototype.getSegments=function(c,l){for(var a=this.index.duration,b=Math.floor(c/a),f=Math.floor(l/a),h=[];b<f;)h.push(this.createSegment(b,b*a)),b++;return h};c.prototype.addSegment=function(){return!1};return c}();r.exports=c},function(r,h){var c=function(){function c(h){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=h}c.getLiveEdge=function(c,
l){return Date.now()/1E3-l.availabilityStartTime-l.suggestedPresentationDelay};c.prototype.checkRange=function(){return!0};c.prototype.createSegment=function(c){var l=this.index,a=l.startNumber,l=l.duration;null==a&&(a=1);c=Math.floor(c/l)+a;return{id:c,media:this.index.media,time:c*l,number:c,range:void 0,duration:this.index.duration}};c.prototype.getSegments=function(c,l){for(var a=this.index.duration,b=[],f=c;f<=l;f+=a)b.push(this.createSegment(f));return b};c.prototype.addSegment=function(){return!1};
return c}();r.exports=c},function(r,h,c){function p(c,l,h){function m(a){return d(a).simpleTimeout(r,"timeout").map(function(b){b=q.extend({response:b},a);F.add(a,b);h.onNext({type:c,value:b});return b})}var p=l.resolver,d=l.loader,e=l.parser,x=3>=arguments.length||void 0===arguments[3]?{}:arguments[3];e||(e=f);d||(d=f);p||(p=f);var x=q.defaults(x,{totalRetry:3,timeout:1E4,cache:v}),r=x.timeout,F=x.cache,H={retryDelay:500,totalRetry:x.totalRetry,shouldRetry:function(a){return 500<=a.code||200>a.code||
/timeout/.test(a.message)||/request: error event/.test(a.message)}};return function(c){return p(c).flatMap(function(c){var d=a(function(){return m(c)},H),e=F.get(c);return q.isPromise(e)?b(e)["catch"](d):null===e?d():f(e)}).flatMap(function(a){return e(a).map(function(b){return q.extend({parsed:b},a)})})}}var q=c(1);h=c(3);var l=h.Subject;h=h.Observable;var a=c(5).retryWithBackoff,b=h.fromPromise,f=h.just,v={add:function(){},get:function(){return null}};r.exports=function(){var a=new l;return{createPipelines:function(b,
c){c=c||{};var f=[],l;for(l in b)f[l]=p(l,b[l],a,c[l]);return f},metrics:a}}},function(r,h,c){function p(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function q(a){x(a.man,"player: no manifest loaded")}function l(a,b){return a.filter(function(a){return a.type==
b}).pluck("value")}var a=c(6),b=c(1),f=c(4);h=c(3);var v=h.CompositeDisposable,k=h.BehaviorSubject,u=h.Observable,w=h.Subject,m=u.combineLatest,C=u.defer,d=c(5).on;h=c(10);var e=c(47),x=c(2),u=c(8),J=u.HTMLVideoElement_,F=u.exitFullscreen,H=u.requestFullscreen,N=u.isFullscreen,y=u.onFullscreenChange,u=c(19),I=u.getEmptyTimings,E=u.timingsSampler,O=u.toWallClockTime,X=u.fromWallClockTime,Y=u.getLiveGap,U=c(26).InitializationSegmentCache,Q=c(9).BufferedRanges,R=c(36).parseTimeFragment,ea=c(27),P=c(12),
ga=c(40),ba=c(31),V=c(24),da=c(34),W=c(16);c=function(c){function h(a){var b=this;if(!(this instanceof h))throw new TypeError("Cannot call a class as a function");var d=a.videoElement,e=a.transport,m=a.transportOptions,l=a.defaultLanguage,p=a.defaultSubtitle,q=a.initVideoBitrate;a=a.initAudioBitrate;c.call(this);this.defaultTransport=e;this.defaultTransportOptions=m||{};d||(d=document.createElement("video"));x(d instanceof J,"requires an actual HTMLVideoElement");d.preload="auto";this.version="1.4.2";
this.video=d;this.fullscreen=y(d).subscribe(function(){return b.trigger("fullscreenChange",b.isFullscreen())});this.playing=new k;this.stream=new w;var m=ba(),e=m.createPipelines,m=m.metrics,u=E(d),d=ea(d);this.createPipelines=e;this.metrics=m;this.timings=u;this.adaptive=V(m,u,d,{initVideoBitrate:q,initAudioBitrate:a,defaultLanguage:l,defaultSubtitle:p});this.muted=.1;this._setState("STOPPED");this.resetStates();this.log=f}p(h,c);h.prototype.resetStates=function(){this.man=null;this.reps={video:null,
audio:null,text:null};this.adas={video:null,audio:null,text:null};this.evts={};this.frag={start:null,end:null}};h.prototype._clear=function(){this.subscriptions&&(this.subscriptions.dispose(),this.subscriptions=null)};h.prototype.stop=function(){"STOPPED"!==this.state&&(this.resetStates(),this._clear(),this._setState("STOPPED"))};h.prototype.dispose=function(){this.stop();this.metrics.dispose();this.adaptive.dispose();this.fullscreen.dispose();this.stream.dispose();this.video=this.createPipelines=
this.timings=this.stream=this.fullscreen=this.adaptive=this.metrics=null};h.prototype.__recordState=function(a,b){this.evts[a]!==b&&(this.evts[a]=b,this.trigger(a+"Change",b))};h.prototype._parseOptions=function(a){var c=b.defaults(b.cloneObject(a),{transport:this.defaultTransport,transportOptions:{},keySystems:[],timeFragment:{},subtitles:[],autoPlay:!1,directFile:!1}),d=c.transport,e=c.transportOptions,f=c.url,k=c.manifests,m=c.keySystems,h=c.timeFragment,l=c.subtitles,E=c.autoPlay,c=c.directFile,
h=R(h);x(!!k^!!f,"player: you have to pass either a url or a list of manifests");k&&(m=k[0],f=m.url,l=m.subtitles||[],m=b.compact(b.pluck(k,"keySystem")));b.isString(d)&&(d=ga[d]);b.isFunction(d)&&(d=d(b.defaults(e,this.defaultTransportOptions)));x(d,"player: transport "+a.transport+" is not supported");c&&(c=P.createDirectFileManifest());return{url:f,keySystems:m,subtitles:l,timeFragment:h,autoPlay:E,transport:d,directFile:c}};h.prototype.loadVideo=function(){var a=this,c=0>=arguments.length||void 0===
arguments[0]?{}:arguments[0],c=this._parseOptions(c);f.info("loadvideo",c);var e=c,k=e.url,h=e.keySystems,E=e.subtitles,A=e.timeFragment,p=e.autoPlay,c=e.transport,u=e.directFile;this.stop();this.frag=A;this.playing.onNext(p);var q=this.createPipelines(c,{audio:{cache:new U},video:{cache:new U}}),Q=this.adaptive,c=this.timings,e=this.video,P;try{P=da({url:k,keySystems:h,subtitles:E,timings:c,timeFragment:A,adaptive:Q,pipelines:q,videoElement:e,autoPlay:p,directFile:u})}catch(w){P=C(function(){throw w;
})}P=P.publish();var k=l(P,"segment"),h=l(P,"manifest"),E=l(P,"stalled").startWith(null),A=l(P,"loaded").filter(function(a){return!0===a}),u=u?A:m(A,l(k.pluck("adaptation"),"audio"),l(k.pluck("adaptation"),"video"),b.noop),u=u.take(1),E=u.map("LOADED").concat(m(this.playing,E,function(a,b){return b?"seeking"==b.name?"SEEKING":"BUFFERING":a?"PLAYING":"PAUSED"})).changes().startWith("LOADING"),ga=this.subscriptions=new v;P=[d(e,["play","pause"]).each(function(b){return a.playing.onNext("play"==b.type)}),
k.each(function(b){var c=b.adaptation.type,d=b.representation,e=b.adaptation;a.reps[c]=d;a.adas[c]=e;"text"==c&&a.__recordState("subtitle",e.lang);"video"==c&&a.__recordState("videoBitrate",d.bitrate);"audio"==c&&(a.__recordState("language",e.lang),a.__recordState("audioBitrate",d.bitrate));a.trigger("progress",b)}),h.each(function(b){a.man=b;a.trigger("manifestChange",b)}),E.each(function(b){return a._setState(b)}),c.each(function(b){return a._triggerTimeChange(b)}),P.subscribe(function(){},function(b){a.resetStates();
a.trigger("error",b);a._setState("STOPPED");a._clear()},function(){a.resetStates();a._setState("ENDED");a._clear()}),P.subscribe(function(b){return a.stream.onNext(b)},function(b){return a.stream.onNext({type:"error",value:b})}),P.connect()];b.each(P,function(a){return ga.add(a)});this.subscriptions||ga.dispose();this._triggerTimeChange();return u.toPromise()};h.prototype._setState=function(a){this.state!==a&&(this.state=a,this.trigger("playerStateChange",a))};h.prototype._triggerTimeChange=function(a){this.man&&
a?(this.man.isLive&&0<a.ts&&(a.wallClockTime=O(a.ts,this.man),a.liveGap=Y(a.ts,this.man)),this.trigger("currentTimeChange",a)):this.trigger("currentTimeChange",I())};h.prototype.getManifest=function(){return this.man};h.prototype.getVideoElement=function(){return this.video};h.prototype.getNativeTextTrack=function(){return this.video.textTracks[0]};h.prototype.getPlayerState=function(){return this.state};h.prototype.isLive=function(){q(this);return this.man.isLive};h.prototype.getUrl=function(){q(this);
return this.man.locations[0]};h.prototype.getVideoDuration=function(){return this.video.duration};h.prototype.getVideoLoadedTime=function(){return(new Q(this.video.buffered)).getSize(this.video.currentTime)};h.prototype.getVideoPlayedTime=function(){return(new Q(this.video.buffered)).getLoaded(this.video.currentTime)};h.prototype.getCurrentTime=function(){if(!this.man)return 0;var a=this.video.currentTime;return this.man.isLive?O(a,this.man):a};h.prototype.getStartTime=function(){return this.frag.start};
h.prototype.getEndTime=function(){return this.frag.end};h.prototype.getPlaybackRate=function(){return this.video.playbackRate};h.prototype.getVolume=function(){return this.video.volume};h.prototype.isFullscreen=function(){return N()};h.prototype.getAvailableLanguages=function(){return this.man&&P.getAvailableLanguages(this.man)||[]};h.prototype.getAvailableSubtitles=function(){return this.man&&P.getAvailableSubtitles(this.man)||[]};h.prototype.getLanguage=function(){return this.adaptive.getLanguage()};
h.prototype.getSubtitle=function(){return this.adaptive.getSubtitle()};h.prototype.getAvailableVideoBitrates=function(){var a=P.getAdaptationsByType(this.man,"video");return a[0]&&a[0].bitrates||[]};h.prototype.getAvailableAudioBitrates=function(){var a=this.adas.audio;return a&&a.bitrates||[]};h.prototype.getVideoBitrate=function(){return this.evts.videoBitrate};h.prototype.getAudioBitrate=function(){return this.evts.audioBitrate};h.prototype.getVideoMaxBitrate=function(){return this.adaptive.getVideoMaxBitrate()};
h.prototype.getAudioMaxBitrate=function(){return this.adaptive.getAudioMaxBitrate()};h.prototype.getVideoBufferSize=function(){return this.adaptive.getVideoBufferSize()};h.prototype.getAudioBufferSize=function(){return this.adaptive.getAudioBufferSize()};h.prototype.getAverageBitrates=function(){return this.adaptive.getAverageBitrates()};h.prototype.getMetrics=function(){return this.metrics};h.prototype.getTimings=function(){return this.timings};h.prototype.play=function(){this.video.play()};h.prototype.pause=
function(){this.video.pause()};h.prototype.setPlaybackRate=function(b){var c=this;return new a(function(a){return a(c.video.playbackRate=b)})};h.prototype.goToStart=function(){return this.seekTo(this.getStartTime())};h.prototype.seekTo=function(b){var c=this;return new a(function(a){x(c.man);var d=c.video.currentTime;c.man.isLive&&(b=X(b,c.man));b!==d?(f.info("seek to",b),a(c.video.currentTime=b)):a(d)})};h.prototype.setFullscreen=function(){!1===(0>=arguments.length||void 0===arguments[0]?!0:arguments[0])?
F():H(this.video)};h.prototype.setVolume=function(a){a!==this.video.volume&&(this.video.volume=a,this.trigger("volumeChange",a))};h.prototype.mute=function(){this.muted=this.getVolume()||.1;this.setVolume(0)};h.prototype.unMute=function(){0===this.getVolume()&&this.setVolume(this.muted)};h.prototype.setLanguage=function(c){var d=this;return new a(function(a){x(b.contains(d.getAvailableLanguages(),c),"player: unknown language");a(d.adaptive.setLanguage(c))})};h.prototype.setSubtitle=function(c){var d=
this;return(new a(function(a){x(!c||b.contains(d.getAvailableSubtitles(),c),"player: unknown subtitle");a(d.adaptive.setSubtitle(c||""))})).then(function(){c||d.__recordState("subtitle",null)})};h.prototype.setVideoBitrate=function(c){var d=this;return new a(function(a){x(0===c||b.contains(d.getAvailableVideoBitrates(),c),"player: video bitrate unavailable");a(d.adaptive.setVideoBitrate(c))})};h.prototype.setAudioBitrate=function(c){var d=this;return new a(function(a){x(0===c||b.contains(d.getAvailableAudioBitrates(),
c),"player: audio bitrate unavailable");a(d.adaptive.setAudioBitrate(c))})};h.prototype.setVideoMaxBitrate=function(b){var c=this;return new a(function(a){a(c.adaptive.setVideoMaxBitrate(b))})};h.prototype.setAudioMaxBitrate=function(b){var c=this;return new a(function(a){a(c.adaptive.setAudioMaxBitrate(b))})};h.prototype.setVideoBufferSize=function(b){var c=this;return new a(function(a){return a(c.adaptive.setVideoBufferSize(b))})};h.prototype.setAudioBufferSize=function(b){var c=this;return new a(function(a){return a(c.adaptive.setAudioBufferSize(b))})};
h.prototype.getStreamObservable=function(){return this.stream};h.prototype.getDebug=function(){return e.getDebug(this)};h.prototype.showDebug=function(){e.showDebug(this,this.video)};h.prototype.hideDebug=function(){e.hideDebug()};h.prototype.toggleDebug=function(){e.toggleDebug(this,this.video)};h.prototype.getCurrentKeySystem=function(){return W.getCurrentKeySystem()};return h}(h);r.exports=c},function(r,h,c){function p(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}h=c(10);var q=c(9).BufferedRanges,l=c(6),a=c(2);c=function(b){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this);this.codec=a;this.updating=!1;this.readyState="opened";this.buffered=new q}p(c,b);c.prototype.appendBuffer=function(a){var b=this;return this._lock(function(){return b._append(a)})};
c.prototype.remove=function(a,b){var c=this;return this._lock(function(){return c._remove(a,b)})};c.prototype.abort=function(){this.remove(0,Infinity);this.updating=!1;this.readyState="closed";this._abort()};c.prototype._append=function(){};c.prototype._remove=function(){};c.prototype._abort=function(){};c.prototype._lock=function(b){var c=this;a(!this.updating,"text-buffer: cannot remove while updating");this.updating=!0;this.trigger("updatestart");return(new l(function(a){return a(b())})).then(function(){return c._unlock("update")},
function(a){return c._unlock("error",a)})};c.prototype._unlock=function(a,b){this.trigger(a,b);this.updating=!1;this.trigger("updateend")};return c}(h);r.exports=c},function(r,h,c){function p(a,b){return f.create(function(c){b.src=a;c.onNext({url:a});return function(){b.src=""}})}function q(a){return"audio"==a||"video"==a}var l=c(1),a=c(4),b=c(2),f=c(3).Observable;h=c(5);var v=h.first,k=h.on;h=c(19);var u=h.getLiveGap,w=h.seekingsSampler,m=h.fromWallClockTime,C=c(5).retryWithBackoff,d=f.empty,e=f.never,
x=f.just,J=f.merge,F=f.combineLatest,H=Math.min;h=c(8);var N=h.MediaSource_,y=h.sourceOpen,I=h.canPlay,E=h.loadedMetadata,O=c(35),X=c(17).getLiveEdge,Y=c(25),U=c(16);c=c(12);var Q=c.normalizeManifest,R=c.mergeManifestsIndex,ea=c.mutateManifestLiveGap,P=c.getAdaptations;r.exports=function(c){function h(b,c,d){var e=d.type;d=d.codec;if(q(e))ya[e]?b=ya[e]:(a.info("add sourcebuffer",d),b=c.addSourceBuffer(d),ya[e]=b);else{if(c=G[e])try{c.abort()}catch(f){a.warn(f)}finally{delete G[e]}if("text"==e)a.info("add text sourcebuffer",
d),b=new O(b,d);else throw e="stream: unknown buffer type "+e,a.error(e),Error(e);G[e]=b}return b}function r(b,c,d){b=d.type;var e=q(b);e?(d=ya[b],delete ya[b]):(d=G[b],delete G[b]);if(d)try{d.abort(),e&&c.removeSourceBuffer(d)}catch(f){a.warn(f)}}function da(a){var b=L.map(function(b){var c;Xa?(c=l.cloneObject(b),c.ts=H(b.ts,ua),c.duration=H(b.duration,ua)):c=b;c.liveGap=u(b.ts,a);return c}),c=w(b);return{timings:b,seekings:c}}function W(b,c,f,k){var m=c.type;return Ka.getAdaptationsChoice(m,c.adaptations).flatMapLatest(function(l){if(!l)return r(ia,
b,c),e();var t=Ka.getBufferAdapters(l);l=Y({sourceBuffer:h(ia,b,c),pipeline:za[m],adaptation:l,timings:f,seekings:k,adapters:t});return q(m)?l:l["catch"](function(b){a.error("buffer",m,"has crashed",b);return d()})})}function fa(c){var d=E(ia).tap(function(){var d=c.duration,e=Ga,f=ua,k=/^\d*(\.\d+)? ?%$/;l.isString(e)&&k.test(e)&&(e=parseFloat(e)/100*d);l.isString(f)&&k.test(f)&&(ua=parseFloat(f)/100*d);if(Infinity===f||"100%"===f)f=d;c.isLive?e=e?m(e,c):X(c):b(e<d&&f<=d,"stream: bad startTime and endTime");
a.info("set initial time",e);ia.currentTime=e}),e=I(ia).tap(function(){a.info("canplay event");La&&ia.play();La=!0});return v(F(d,e,l.noop)).map({type:"loaded",value:!0}).startWith({type:"loaded",value:!1})}function A(){return ja&&ja.length?U(ia,ja):U.onEncrypted(ia).map(function(){a.error("eme: ciphered media and no keySystem passed");throw Error("eme: ciphered media and no keySystem passed");})}function t(b){var c=1>=arguments.length||void 0===arguments[1]?!0:arguments[1];return b.distinctUntilChanged(null,
function(b,d){var e=d.stalled,f=b.stalled,k;k=f||e?f&&e?f.name==e.name:!1:!0;!k&&c&&(f?(a.info("resume playback",d.ts,d.name),ia.playbackRate=f.playback):(a.info("stop playback",d.ts,d.name),ia.playbackRate=0));e&&(e=d.buffered.getNextRangeGap(d.ts),1>e&&(f=d.ts+e+1/60,ia.currentTime=f,a.warn("discontinuity seek",d.ts,e,f)));return k}).map(function(a){return{type:"stalled",value:a.stalled}})}function ka(a){return a&&"out-of-index"==a.type}function ta(b,c){if(ka(c))return a.info("out of index"),wa({url:b.locations[0]}).map(function(a){a=
a.parsed;return{type:"manifest",value:R(b,Q(a.url,a.manifest,aa))}});c&&"precondition-failed"==c.type&&(ea(b,1),a.warn("precondition failed",b.presentationLiveGap));return x(c)}function Fa(a,b,c,d){var e=l.map(P(b),function(b){return W(a,b,c,d)}),e=J(e);return b.isLive?e.distinctUntilChanged(null,function(a,b){return ka(b)&&ka(a)}).concatMap(function(a){return ta(b,a)}):e}function Ua(b,c){var d=da(c),e=d.timings,f=d.seekings,d=x({type:"manifest",value:c}),m=fa(c),f=Fa(b,c,e,f),h=A(),e=t(e,!0),l=k(ia,
"error").flatMap(function(){var b="stream: video element MEDIA_ERR code "+ia.error.code;a.error(b);throw Error(b);});return J(d,m,h,f,e,l)}function Va(){var a=da(va,{timeInterval:1E3}).timings,b=x({type:"manifest",value:va}),c=fa(va),a=t(a,!1);return J(b,c,a)}var Pa=c.url,ja=c.keySystems,aa=c.subtitles,L=c.timings,Da=c.timeFragment,Ka=c.adaptive,za=c.pipelines,ia=c.videoElement,La=c.autoPlay,va=c.directFile;b(N,"player: browser is required to support MediaSource");var Ga=Da.start,ua=Da.end,Xa=Infinity>
ua,wa=za.manifest,ya={},G={};c=L.filter(function(a){var b=a.ts;a=a.duration;return 0<a&&.2>H(a,ua)-b}).take(1).share();if(va)return p(Pa,ia).flatMap(Va).takeUntil(c);Da=C(function(b){var c=b.url,d=b.mediaSource;b=y(d);return wa({url:c}).zip(b,l.identity).flatMap(function(b){b=b.parsed;b=Q(b.url,b.manifest,aa);d.duration=Infinity===b.duration?Number.MAX_VALUE:b.duration;a.info("set duration",d.duration);return Ua(d,b)})},{retryDelay:500,totalRetry:3,resetDelay:6E4,shouldRetry:function(b,c){if(/MEDIA_ERR/.test(b.message))return!1;
a.warn("stream retry",b,c);return!0}});return function(b,c){return f.create(function(d){var e=new N,f=c.src=URL.createObjectURL(e);d.onNext({url:b,mediaSource:e});a.info("create mediasource object",f);return function(){if(e&&"closed"!=e.readyState){var b=e.readyState;l.each(l.cloneArray(e.sourceBuffers),function(c){try{"open"==b&&c.abort(),e.removeSourceBuffer(c)}catch(d){a.warn("error while disposing souceBuffer",d)}})}l.each(l.keys(G),function(b){b=G[b];try{b.abort()}catch(c){a.warn("error while disposing souceBuffer",
c)}});c.src="";if(f)try{URL.revokeObjectURL(f)}catch(d){a.warn("error while revoking ObjectURL",d)}f=e=G=ya=null}})}(Pa,ia).flatMap(Da).takeUntil(c)}},function(r,h,c){function p(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var q=c(6),l=c(1);
h=c(33);var a=window.VTTCue||window.TextTrackCue;h=function(b){function c(a,k){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this,k);this.video=a;this.codec=k;this.isVTT=/^text\/vtt/.test(k);var h=document.createElement("track"),l=h.track;this.trackElement=h;this.track=l;h.kind="subtitles";l.mode="showing";a.appendChild(h)}p(c,b);c.prototype.createCuesFromArray=function(b){return b.length?l.compact(l.map(b,function(b){var c=b.start,f=b.end;if(b=b.text)return new a(c,
f,b)})):[]};c.prototype._append=function(a){var b=this;if(this.isVTT)a=new Blob([a],{type:"text/vtt"}),a=URL.createObjectURL(a),this.trackElement.src=a,this.buffered.insert(0,Infinity);else{var c=this.createCuesFromArray(a);c.length&&(l.each(c,function(a){return b.track.addCue(a)}),a=c[0],c=l.last(c),this.buffered.insert(0,a.startTime,c.endTime))}return q.resolve()};c.prototype._remove=function(a,b){var c=this.track;l.each(l.cloneArray(c.cues),function(f){var m=f.startTime,h=f.endTime;m>=a&&m<=b&&
h<=b&&c.removeCue(f)})};c.prototype._abort=function(){var a=this.trackElement,b=this.video;a&&b&&b.hasChildNodes(a)&&b.removeChild(a);this.track.mode="disabled";this.size=0;this.video=this.track=this.trackElement=null};return c}(h);r.exports=h},function(r,h,c){function p(a){if(!a)return!1;a=a.replace(/^npt\:/,"").replace(/\.$/,"");var b,c;a=a.split(":");var h=a.length;switch(h){case 3:b=parseInt(a[0],10);c=parseInt(a[1],10);a=parseFloat(a[2]);break;case 2:b=0;c=parseInt(a[0],10);a=parseFloat(a[1]);
break;case 1:c=b=0;a=parseFloat(a[0]);break;default:return!1}f(23>=b,v);f(59>=c,v);f(1>=h||60>a,v);return 3600*b+60*c+a}function q(a){if(!a)return!1;var b,c,h,l;a=a.split(":");switch(a.length){case 3:b=parseInt(a[0],10);c=parseInt(a[1],10);h=parseInt(a[2],10);l=a=0;break;case 4:b=parseInt(a[0],10);c=parseInt(a[1],10);h=parseInt(a[2],10);-1===a[3].indexOf(".")?(a=parseInt(a[3],10),l=0):(l=a[3].split("."),a=parseInt(l[0],10),l=parseInt(l[1],10));break;default:return!1}f(23>=b,v);f(59>=c,v);f(59>=h,
v);return 3600*b+60*c+h+.001*a+1E-6*l}function l(a){return new Date(Date.parse(a))}function a(a){return a?a:!1}var b=c(1),f=c(2),v="Invalid MediaFragment";r.exports={parseTimeFragment:function(c){if(b.isString(c)){var h=c,w=h.split(",");f(2>=w.length,v);c=w[0]?w[0]:"";w=w[1]?w[1]:"";f((c||w)&&(!c||w||-1===h.indexOf(",")),v);c=c.replace(/^smpte(-25|-30|-30-drop)?\:/,"").replace("clock:","");var h=/^((npt\:)?((\d+\:(\d\d)\:(\d\d))|((\d\d)\:(\d\d))|(\d+))(\.\d*)?)?$/,m=/^(\d+\:\d\d\:\d\d(\:\d\d(\.\d\d)?)?)?$/,
C=/^((\d{4})(-(\d{2})(-(\d{2})(T(\d{2})\:(\d{2})(\:(\d{2})(\.(\d+))?)?(Z|(([-\+])(\d{2})\:(\d{2})))?)?)?)?)?$/,d=/^(\d*(\.\d+)? ?%)?$/;if(h.test(c)&&h.test(w))h=p;else if(m.test(c)&&m.test(w))h=q;else if(C.test(c)&&C.test(w))h=l;else if(d.test(c)&&d.test(w))h=a;else throw Error(v);c=h(c);w=h(w);f(!1!==c||!1!==w,v);c={start:!1===c?"":c,end:!1===w?"":w}}else c=b.pick(c,["start","end"]);b.isString(c.start)&&b.isString(c.end)?(c.start||(c.start="0%"),c.end||(c.end="100%")):(c.start||(c.start=0),c.end||
(c.end=Infinity));b.isString(c.start)&&b.isString(c.end)?(f(0<=parseFloat(c.start)&&100>=parseFloat(c.start),"player: startTime should be between 0% and 100%"),f(0<=parseFloat(c.end)&&100>=parseFloat(c.end),"player: endTime should be between 0% and 100%")):(f((b.isNumber(c.start)||b.isDate(c.start))&&(b.isNumber(c.end)||b.isDate(c.end)),"player: timeFragment should have interface { start, end } where start and end are numbers or dates"),f(c.start<c.end,"player: startTime should be lower than endTime"),
f(0<=c.start,"player: startTime should be greater than 0"));return c}}},function(r,h,c){function p(a){var b=a[0];return(a=a[1])&&Infinity!==a?"bytes="+ +b+"-"+ +a:"bytes="+ +b+"-"}var q=c(1);h=c(3).Observable;var l=h.empty,a=h.merge,b=h.just;c(2);var f=c(14),v=c(11).resolveURL;h=c(38);var k=h.parseSidx,u=h.patchPssh,w=c(39),m=function(a){a.withMetadata=!0;return f(a)};r.exports=function(){var c=(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]).contentProtectionParser;c||(c=q.noop);var d=
{loader:function(b){var c=b.adaptation,d=b.representation,f=b.segment,h=f.media,k=f.range;b=f.indexRange;if(f.init&&!(h||k||b))return l();k=q.isArray(k)?{Range:p(k)}:null;if(h)var u=f.time,f=f.number,h=-1===h.indexOf("$")?h:h.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,d.id).replace(/\$Bandwidth\$/g,d.bitrate).replace(/\$Number\$/g,f).replace(/\$Time\$/g,u);else h="";c=v(c.rootURL,c.baseURL,d.baseURL,h);d=m({url:c,format:"arraybuffer",headers:k});return q.isArray(b)?(b=m({url:c,format:"arraybuffer",
headers:{Range:p(b)}}),a(d,b)):d},parser:function(a){var c=a.adaptation,d=a.segment;a=new Uint8Array(a.response.blob);var f=d.init,h=d.indexRange,m,l,p;if(h=k(a,h?h[0]:0))m=h.segments,l=h.timescale;f||(0<=d.time&&0<=d.duration?p={ts:d.time,d:d.duration}:h&&1===h.segments.length&&(p={ts:h.segments[0].ts,d:h.segments[0].d}));f&&c.contentProtection&&(a=u(a,c.contentProtection));return b({blob:a,currentSegment:p,nextSegments:m,timescale:l})}};return{manifest:{loader:function(a){return m({url:a.url,format:"document"})},
parser:function(a){a=a.response;return b({manifest:w(a.blob,c),url:a.url})}},audio:d,video:d,text:{loader:function(){}}}}},function(r,h,c){function p(a,b){for(var c=0,e=a.length,h,k;c+8<e&&(k=f(a,c),h=f(a,c+4),l(0<k,"dash: out of range size"),h!==b);)c+=k;if(c>=e)return-1;l(c+k<=e,"dash: atom out of range");return c}function q(b){var c=b.systemId;b=b.privateData;c=c.replace(/-/g,"");l(32===c.length);c=w(4,k(c),a(b.length),b);return w(a(c.length+8),u("pssh"),c)}var l=c(2);h=c(7);var a=h.itobe4,b=h.be8toi,
f=h.be4toi,v=h.be2toi,k=h.hexToBytes,u=h.strToBytes,w=h.concat;r.exports={parseSidx:function(a,c){var d=p(a,1936286840);if(-1==d)return null;var e=f(a,d),d=d+4+4,h=a[d],d=d+8,k=f(a,d),d=d+4;if(0===h)h=f(a,d),d+=4,c+=f(a,d)+e,d+=4;else if(1===h)h=b(a,d),d+=8,c+=b(a,d)+e,d+=8;else return null;for(var e=[],d=d+2,l=v(a,d),d=d+2;0<=--l;){var q=f(a,d),d=d+4,u=q&2147483647;if(1==(q&2147483648)>>>31)throw Error("not implemented");q=f(a,d);d+=4;d+=4;e.push({ts:h,d:q,r:0,range:[c,c+u-1]});h+=q;c+=u}return{segments:e,
timescale:k}},patchPssh:function(b,c){if(!c||!c.length)return b;var d=p(b,1836019574);if(-1==d)return b;for(var e=f(b,d),h=[b.subarray(d,d+e)],k=0;k<c.length;k++)h.push(q(c[k]));h=w.apply(null,h);h.set(a(h.length),0);return w(b.subarray(0,d),h,b.subarray(d+e))}}},function(r,h,c){function p(a){var b=O.last(a.timeline);return(b.ts+(b.r+1)*b.d)/a.timescale}function q(a,b){var c=ea[a.nodeName];X(c,"parser: no attributes for "+a.nodeName);return O.reduce(c,function(b,c){var d=c.k,e=c.fn,f=c.n,h=c.def;
a.hasAttribute(d)?b[f||d]=e(a.getAttribute(d)):null!=h&&(b[f||d]=h);return b},b||{})}function l(a){return a}function a(a){return"true"==a}function b(a){return"true"==a?!0:"false"==a?!1:parseInt(a)}function f(a){return new Date(Date.parse(a))}function v(a){if(!a)return 0;var b=Y.exec(a);X(b,"parser: "+a+" is not a valid ISO8601 duration");return 31536E3*parseFloat(b[2]||0)+2592E3*parseFloat(b[4]||0)+86400*parseFloat(b[6]||0)+3600*parseFloat(b[8]||0)+60*parseFloat(b[10]||0)+parseFloat(b[12]||0)}function k(a){var b=
Q.exec(a);if(!b)return-1;a=parseInt(b[1])||0;b=parseInt(b[2])||0;return 0<b?a/b:a}function u(a){return a}function w(a){return(a=U.exec(a))?[+a[1],+a[2]]:null}function m(a,b,c){for(a=a.firstElementChild;a;)c=b(c,a.nodeName,a),a=a.nextElementSibling;return c}function C(a){var b=m(a,function(a,b,c){if("Initialization"==b){var d,e;c.hasAttribute("range")&&(d=w(c.getAttribute("range")));c.hasAttribute("sourceURL")&&(e=c.getAttribute("sourceURL"));a.initialization={range:d,media:e}}return a},q(a));"SegmentBase"==
a.nodeName&&(b.indexType="base",b.timeline=[]);return b}function d(a){return m(a,function(a,b,c){"SegmentTimeline"==b&&(a.indexType="timeline",a.timeline=e(c));return a},C(a))}function e(a){return m(a,function(a,b,c){b=a.length;c=q(c);null==c.ts&&(b=0<b&&a[b-1],c.ts=b?b.ts+b.d*(b.r+1):0);null==c.r&&(c.r=0);a.push(c);return a},[])}function x(a){a=d(a);a.indexType||(a.indexType="template");return a}function J(a){var b=d(a);b.list=[];b.indexType="list";return m(a,function(a,b,c){"SegmentURL"==b&&a.list.push(q(c));
return a},b)}function F(a){var b=m(a,function(a,b,c){switch(b){case "BaseURL":a.baseURL=c.textContent;break;case "SegmentBase":a.index=C(c);break;case "SegmentList":a.index=J(c);break;case "SegmentTemplate":a.index=x(c)}return a},{});return q(a,b)}function H(a,b){var c=m(a,function(a,c,d){switch(c){case "ContentProtection":c=b(q(d),d);a.contentProtection=c;break;case "ContentComponent":a.contentComponent=q(d);break;case "BaseURL":a.baseURL=d.textContent;break;case "SegmentBase":a.index=C(d);break;
case "SegmentList":a.index=J(d);break;case "SegmentTemplate":a.index=x(d);break;case "Representation":c=F(d),null==c.id&&(c.id=a.representations.length),a.representations.push(c)}return a},{representations:[]});return q(a,c)}function N(a,b){var c=q(a,m(a,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "AdaptationSet":c=H(d,b),null==c.id&&(c.id=a.adaptations.length),a.adaptations.push(c)}return a},{adaptations:[]}));c.baseURL&&O.each(c.adaptations,function(a){return O.defaults(a,
{baseURL:c.baseURL})});return c}function y(a,b){var c=a.documentElement;X.equal(c.nodeName,"MPD","parser: document root should be MPD");var d=m(c,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "Location":a.locations.push(d.textContent);break;case "Period":a.periods.push(N(d,b))}return a},{transportType:"dash",periods:[],locations:[]}),d=q(c,d);/isoff-live/.test(d.profiles)&&(c=(c=O.find(d.periods[0].adaptations,function(a){return"video/mp4"==a.mimeType}))&&c.index,c=c.timeline?
p(c):Date.now()/1E3-60,d.availabilityStartTime=d.availabilityStartTime.getTime()/1E3,d.presentationLiveGap=Date.now()/1E3-(c+d.availabilityStartTime));return d}function I(a,b){return y((new DOMParser).parseFromString(a,"application/xml"),b)}function E(a,b){if(O.isString(a))return I(a,b);if(a instanceof window.Document)return y(a,b);throw Error("parser: unsupported type to parse");}var O=c(1),X=c(2),Y=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,U=/([0-9]+)-([0-9]+)/,
Q=/([0-9]+)(\/([0-9]+))?/;h=[{k:"profiles",fn:l},{k:"width",fn:parseInt},{k:"height",fn:parseInt},{k:"frameRate",fn:k},{k:"audioSamplingRate",fn:l},{k:"mimeType",fn:l},{k:"segmentProfiles",fn:l},{k:"codecs",fn:l},{k:"maximumSAPPeriod",fn:parseFloat},{k:"maxPlayoutRate",fn:parseFloat},{k:"codingDependency",fn:a}];c=[{k:"timescale",fn:parseInt},{k:"presentationTimeOffset",fn:parseFloat,def:0},{k:"indexRange",fn:w},{k:"indexRangeExact",fn:a},{k:"availabilityTimeOffset",fn:parseFloat},{k:"availabilityTimeComplete",
fn:a}];var R=c.concat([{k:"duration",fn:parseInt},{k:"startNumber",fn:parseInt}]),ea={ContentProtection:[{k:"schemeIdUri",fn:l},{k:"value",fn:l}],SegmentURL:[{k:"media",fn:l},{k:"mediaRange",fn:w},{k:"index",fn:l},{k:"indexRange",fn:w}],S:[{k:"t",fn:parseInt,n:"ts"},{k:"d",fn:parseInt},{k:"r",fn:parseInt}],SegmentTimeline:[],SegmentBase:c,SegmentTemplate:R.concat([{k:"initialization",fn:function(a){return{media:a,range:void 0}}},{k:"index",fn:l},{k:"media",fn:l},{k:"bitstreamSwitching",fn:l}]),SegmentList:R,
ContentComponent:[{k:"id",fn:l},{k:"lang",fn:l},{k:"contentType",fn:l},{k:"par",fn:u}],Representation:h.concat([{k:"id",fn:l},{k:"bandwidth",fn:parseInt,n:"bitrate"},{k:"qualityRanking",fn:parseInt}]),AdaptationSet:h.concat([{k:"id",fn:l},{k:"group",fn:parseInt},{k:"lang",fn:l},{k:"contentType",fn:l},{k:"par",fn:u},{k:"minBandwidth",fn:parseInt,n:"minBitrate"},{k:"maxBandwidth",fn:parseInt,n:"maxBitrate"},{k:"minWidth",fn:parseInt},{k:"maxWidth",fn:parseInt},{k:"minHeight",fn:parseInt},{k:"maxHeight",
fn:parseInt},{k:"minFrameRate",fn:k},{k:"maxFrameRate",fn:k},{k:"segmentAlignment",fn:b},{k:"subsegmentAlignment",fn:b},{k:"bitstreamSwitching",fn:a}]),Period:[{k:"id",fn:l},{k:"start",fn:v},{k:"duration",fn:v},{k:"bitstreamSwitching",fn:a}],MPD:[{k:"id",fn:l},{k:"profiles",fn:l},{k:"type",fn:l},{k:"availabilityStartTime",fn:f},{k:"availabilityEndTime",fn:f},{k:"publishTime",fn:f},{k:"mediaPresentationDuration",fn:v,n:"duration"},{k:"minimumUpdatePeriod",fn:v},{k:"minBufferTime",fn:v},{k:"timeShiftBufferDepth",
fn:v},{k:"suggestedPresentationDelay",fn:v},{k:"maxSegmentDuration",fn:v},{k:"maxSubsegmentDuration",fn:v}]};E.parseFromString=I;E.parseFromDocument=y;r.exports=E},function(r,h,c){r.exports={smooth:c(41),dash:c(37)}},function(r,h,c){function p(a){return(a=a.match(E))&&a[1]||""}function q(a,b){return b?a.replace(E,"?token="+b):a.replace(E,"")}function l(a,b,c){return k(a.rootURL,a.baseURL,b.baseURL).replace(/\{bitrate\}/g,b.bitrate).replace(/\{start time\}/g,c.time)}h=c(1);var a=c(3).Observable,b=
a.empty,f=a.just,v=c(14),k=c(11).resolveURL,u=c(7).bytesToStr,w=c(4),m=c(43),a=c(42),C=a.patchSegment,d=a.createVideoInitSegment,e=a.createAudioInitSegment,x=a.getMdat,J=a.getTraf,F=a.parseTfrf,H=a.parseTfxd,a=c(44).parseSami;c=c(45).parseTTML;var N={"application/x-sami":a,"application/smil":a,"application/ttml+xml":c,"application/ttml+xml+mp4":c,"text/vtt":h.identity},y=/\.(isml?)(\?token=\S+)?$/,I=/\.wsx?(\?token=\S+)?/,E=/\?token=(\S+)/,O=function(a){a.withMetadata=!0;return v(a)};r.exports=function(){function a(b,
c,d){var e,f;c.isLive?(b=J(b))?(e=F(b),f=H(b)):w.warn("smooth: could not find traf atom"):e=null;f||(f={d:d.duration,ts:d.time});return{nextSegments:e,currentSegment:f}}var c=m(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]),h={loader:function(a){var b=a.adaptation,c=a.representation;a=a.segment;if(a.init){var h;a=b.smoothProtection||{};switch(b.type){case "video":h=d(c.index.timescale,c.width,c.height,72,72,4,c.codecPrivateData,a.keyId,a.keySystems);break;case "audio":h=e(c.index.timescale,
c.channels,c.bitsPerSample,c.packetSize,c.samplingRate,c.codecPrivateData,a.keyId,a.keySystems)}return f({blob:h,size:h.length,duration:100})}var k;if(h=a.range)k=h[0],k=(h=h[1])&&Infinity!==h?"bytes="+ +k+"-"+ +h:"bytes="+ +k+"-",k={Range:k};b=l(b,c,a);return O({url:b,format:"arraybuffer",headers:k})},parser:function(b){var c=b.adaptation,d=b.response;b=b.segment;if(b.init)return f({blob:d.blob,timings:null});d=new Uint8Array(d.blob);b=a(d,c,b);c=b.nextSegments;b=b.currentSegment;return f({blob:C(d,
b.ts),nextSegments:c,currentSegment:b})}};return{manifest:{resolver:function(a){a=a.url;var b=p(a);return(I.test(a)?O({url:q(a,""),format:"document"}).map(function(a){return a.blob.getElementsByTagName("media")[0].getAttribute("src")}):f(a)).map(function(a){var c=a.match(y);a=c?a.replace(c[1],c[1]+"/manifest"):a;return{url:q(a,b)}})},loader:function(a){return O({url:a.url,format:"document"})},parser:function(a){a=a.response;return f({manifest:c(a.blob),url:a.url})}},audio:h,video:h,text:{loader:function(a){var c=
a.adaptation,d=a.representation,e=a.segment;if(e.init)return b();a=d.mimeType;c=l(c,d,e);return 0<=a.indexOf("mp4")?O({url:c,format:"arraybuffer"}):O({url:c,format:"text"})},parser:function(b){var c=b.response,d=b.adaptation,e=b.representation;b=b.segment;var h=d.lang,k=e.mimeType,l=N[k];if(!l)throw Error("smooth: could not find a text-track parser for the type "+k);var m=c.blob;0<=k.indexOf("mp4")?(m=new Uint8Array(m),c=u(x(m))):c=m;k=a(m,d,b);d=k.nextSegments;k=k.currentSegment;return f({blob:l(c,
h,b.time/e.index.timescale),currentSegment:k,nextSegments:d})}}}}},function(r,h,c){function p(a,b){return k(x(b.length+8),N(a),b)}function q(a,b,c,d,f){for(var h=0,k=a.length,l;h<k;){l=e(a,h);if(1970628964===e(a,h+4)&&e(a,h+8)===b&&e(a,h+12)===c&&e(a,h+16)===d&&e(a,h+20)===f)return a.subarray(h+24,h+l);h+=l}}function l(a,b){for(var c=0,d=a.length,f,h;c+8<d&&(h=e(a,c),f=e(a,c+4),v(0<h,"dash: out of range size"),f!==b);)c+=h;if(!(c>=d))return a.subarray(c+8,c+h)}function a(a,b,c,d){var e=[a,b,c];f.each(d,
function(a){a=y.pssh(a.systemId,a.privateData,a.keyIds);e.push(a)});return e}function b(b,c,d,e,f,h,l){d=y.mult("stbl",[d,p("stts",new Uint8Array(8)),p("stsc",new Uint8Array(8)),p("stsz",new Uint8Array(12)),p("stco",new Uint8Array(8))]);var m=p("url ",new Uint8Array([0,0,0,1])),m=y.dref(m),m=y.mult("dinf",[m]);e=y.mult("minf",[e,m,d]);c=y.hdlr(c);d=y.mdhd(b);c=y.mult("mdia",[d,c,e]);f=y.tkhd(f,h,1);f=y.mult("trak",[f,c]);h=y.trex(1);h=y.mult("mvex",[h]);b=y.mvhd(b,1);l=y.mult("moov",a(b,h,f,l));b=
y.ftyp("isom",["isom","iso2","iso6","avc1","dash"]);return k(b,l)}var f=c(1),v=c(2);h=c(7);var k=h.concat,u=h.strToBytes,w=h.hexToBytes,m=h.bytesToHex,C=h.be2toi,d=h.itobe2,e=h.be4toi,x=h.itobe4,J=h.be8toi,F=h.itobe8,H=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350],N=f.memoize(u),y={mult:function(a,b){return p(a,k.apply(null,b))},avc1encv:function(a,b,c,e,f,h,l,m,q,w){return p(a,k(6,d(b),16,d(c),d(e),d(f),2,d(h),6,[0,1,l.length],u(l),31-l.length,d(m),[255,255],q,"encv"===a?
w:[]))},avcc:function(a,b,c){return p("avcC",k([1,a[1],a[2],a[3],252|(2===c?1:4===c?3:0),225],d(a.length),a,[1],d(b.length),b))},dref:function(a){return p("dref",k(7,[1],a))},esds:function(a,b){return p("esds",k(4,[3,25],d(a),[0,4,17,64,21],11,[5,2],w(b),[6,1,2]))},frma:function(a){return p("frma",u(a))},free:function(a){return p("free",new Uint8Array(a-8))},ftyp:function(a,b){return p("ftyp",k.apply(null,[u(a),[0,0,0,1]].concat(b.map(u))))},hdlr:function(a){var b=void 0,c=void 0;switch(a){case "video":b=
"vide";c="VideoHandler";break;case "audio":b="soun";c="SoundHandler";break;default:b="hint",c=""}return p("hdlr",k(8,u(b),12,u(c),1))},mdhd:function(a){return p("mdhd",k(12,x(a),8))},moof:function(a,b){return y.mult("moof",[a,b])},mp4aenca:function(a,b,c,e,f,h,l,m){return p(a,k(6,d(b),8,d(c),d(e),2,d(f),d(h),2,l,"enca"===a?m:[]))},mvhd:function(a,b){return p("mvhd",k(12,x(a),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,d(b+1)))},pssh:function(a){var b=1>=arguments.length||void 0===arguments[1]?
[]:arguments[1],c=2>=arguments.length||void 0===arguments[2]?[]:arguments[2];a=a.replace(/-/g,"");v(32===a.length,"wrong system id length");var d,e=c.length;0<e?(d=1,c=k.apply(null,[x(e)].concat(c))):(d=0,c=[]);return p("pssh",k([d,0,0,0],w(a),c,x(b.length),b))},saio:function(a,b,c,d){return p("saio",k(4,[0,0,0,1],x(a.length+b.length+c.length+d.length+8+8+8+8)))},saiz:function(a){if(0===a.length)return p("saiz",new Uint8Array);var b=e(a,0),c=e(a,4),d=new Uint8Array(9+c);d.set(x(c),5);for(var c=9,
f=8,h,k;f<a.length;)f+=8,2===(b&2)?(k=2,h=C(a,f),f+=2+6*h):k=h=0,d[c]=6*h+8+k,c++;return p("saiz",d)},schm:function(a,b){return p("schm",k(4,u(a),x(b)))},senc:function(a){return p("senc",a)},smhd:function(){return p("smhd",new Uint8Array(8))},stsd:function(a){return p("stsd",k.apply(null,[7,[a.length]].concat(a)))},tkhd:function(a,b,c){return p("tkhd",k(x(7),8,x(c),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],d(a),2,d(b),2))},trex:function(a){return p("trex",k(4,x(a),[0,0,0,1],12))},tfdt:function(a){return p("tfdt",
k([1,0,0,0],F(a)))},tenc:function(a,b,c){return p("tenc",k(6,[a,b],w(c)))},traf:function(a,b,c,d,e){var f=[a,b,c];d&&f.push(y.senc(d),y.saiz(d),y.saio(e,a,b,c));return y.mult("traf",f)},trun:function(a){if(a[11]&1)return a;var b=new Uint8Array(a.length+4);b.set(x(a.length+4),0);b.set(a.subarray(4,16),4);b[11]|=1;b.set([0,0,0,0],16);b.set(a.subarray(16,a.length),20);return b},vmhd:function(){var a=new Uint8Array(12);a[3]=1;return p("vmhd",a)}},I={traf:function(a){return(a=l(a,1836019558))?l(a,1953653094):
null},senc:function(a){return q(a,2721664850,1520127764,2722393154,2086964724)},tfxd:function(a){return q(a,1830656773,1121273062,2162299933,2952222642)},tfrf:function(a){return q(a,3565190898,3392751253,2387879627,2655430559)},mdat:function(a){return l(a,1835295092)}};r.exports={getMdat:I.mdat,getTraf:I.traf,parseTfrf:function(a){a=I.tfrf(a);if(!a)return[];for(var b=[],c=a[0],d=a[4],f=0;f<d;f++){var h,k;1==c?(k=J(a,16*f+5),h=J(a,16*f+13)):(k=e(a,8*f+5),h=e(a,8*f+9));b.push({ts:k,d:h})}return b},
parseTfxd:function(a){if(a=I.tfxd(a))return{d:J(a,12),ts:J(a,4)}},createVideoInitSegment:function(a,c,d,e,f,h,k,l,m){m||(m=[]);var p=k.split("00000001");k=p[2];p=w(p[1]);k=w(k);h=y.avcc(p,k,h);m.length?(l=y.tenc(1,8,l),l=y.mult("schi",[l]),k=y.schm("cenc",65536),p=y.frma("avc1"),l=y.mult("sinf",[p,k,l]),e=y.avc1encv("encv",1,c,d,e,f,"AVC Coding",24,h,l)):e=y.avc1encv("avc1",1,c,d,e,f,"AVC Coding",24,h);e=y.stsd([e]);return b(a,"video",e,y.vmhd(),c,d,m)},createAudioInitSegment:function(a,c,e,f,h,k,
l,p){p||(p=[]);k||(k=H.indexOf(h),k=((32|k&31)<<4|c&31)<<3,k=m(d(k)));k=y.esds(1,k);if(p.length){l=y.tenc(1,8,l);l=y.mult("schi",[l]);var q=y.schm("cenc",65536),u=y.frma("mp4a");l=y.mult("sinf",[u,q,l]);c=y.mp4aenca("enca",1,c,e,f,h,k,l)}else c=y.mp4aenca("mp4a",1,c,e,f,h,k);c=y.stsd([c]);return b(a,"audio",c,y.smhd(),0,0,p)},patchSegment:function(a,b){var c=a.subarray(0,e(a,0)),d=y.tfdt(b),f=d.length,h=e(c,8),k=e(c,8+h),l=e(c,8+h+8),m=e(c,8+h+8+l),p=c.subarray(8,8+h),q=c.subarray(8+h+8,8+h+8+k-8),
k=q.subarray(0,l),m=q.subarray(l,l+m);k.set([0,0,0,1],12);q=I.senc(q);m=y.trun(m);d=y.traf(k,d,m,q,p);p=y.moof(p,d);f=8+h+8+l+f;l=a.length;h=p.length;d=c.length;c=a.subarray(d,l);l=new Uint8Array(h+(l-d));l.set(p,0);l.set(c,h);l.set(x(p.length+8),f+16);return l}}},function(r,h,c){function p(a){return"boolean"==typeof a?a:"string"==typeof a?"TRUE"===a.toUpperCase():!1}function q(b){var c=a.last(b.timeline);return(c.ts+(c.r+1)*c.d)/b.timescale}function l(a){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",
privateData:f.concat([8,1,18,16],a)}]}var a=c(1),b=c(2),f=c(7),v={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},k={audio:"mp4a.40.2",video:"avc1.4D401E"};h={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4"};c={AACL:"mp4a.40.5",AACH:"mp4a.40.5",AVC1:"avc1.4D401E",H264:"avc1.4D401E"};var u={audio:[["Bitrate","bitrate",parseInt],["AudioTag","audiotag",parseInt],["FourCC","mimeType",h],["FourCC","codecs",c],["Channels","channels",parseInt],["SamplingRate",
"samplingRate",parseInt],["BitsPerSample","bitsPerSample",parseInt],["PacketSize","packetSize",parseInt],["CodecPrivateData","codecPrivateData",String]],video:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",h],["FourCC","codecs",c],["MaxWidth","width",parseInt],["MaxHeight","height",parseInt],["CodecPrivateData","codecPrivateData",String]],text:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",h]]};r.exports=function(){function c(a,b,d){for(a=a.firstElementChild;a;)d=b(d,a.nodeName,a),a=a.nextElementSibling;
return d}function h(b,c){return a.reduce(c,function(c,d){var e=d[0],f=d[2];c[d[1]]=a.isFunction(f)?f(b.getAttribute(e)):f[b.getAttribute(e)];return c},{})}function r(d,e){d.hasAttribute("Timescale")&&(e=+d.getAttribute("Timescale"));var f=d.getAttribute("Type"),l=d.getAttribute("Subtype"),p=u[f];b(p,"parser: unrecognized QualityLevel type "+f);var q=0,x=c(d,function(a,b,c){switch(b){case "QualityLevel":c=h(c,p);if("video"!=f||c.bitrate>N)c.id=q++,a.representations.push(c);break;case "c":b=a.index;
var d=a.index.timeline,e=d.length,k=0<e?d[e-1]:{d:0,ts:0,r:0},l=+c.getAttribute("d"),t=c.getAttribute("t");(c=+c.getAttribute("r"))&&c--;0<e&&!k.d&&(k.d=t-k.ts,d[e-1]=k);0<e&&l==k.d&&null==t?k.r+=(c||0)+1:d.push({d:l,ts:null==t?k.ts+k.d*(k.r+1):+t,r:c});b.timeline=d}return a},{representations:[],index:{timeline:[],indexType:"timeline",timescale:e,initialization:{}}}),C=x.representations,x=x.index;b(C.length,"parser: adaptation should have at least one representation");var y=C[0].codecs;y||(y=k[f],
a.each(C,function(a){return a.codecs=y}));var J=C[0].mimeType;J||(J=v[f],a.each(C,function(a){return a.mimeType=J}));return"ADVT"==l?null:{type:f,index:x,representations:C,name:d.getAttribute("Name"),lang:d.getAttribute("Language"),baseURL:d.getAttribute("Url")}}function d(a){return e((new DOMParser).parseFromString(a,"application/xml"))}function e(d){d=d.documentElement;b.equal(d.nodeName,"SmoothStreamingMedia","parser: document root should be SmoothStreamingMedia");b(/^[2]-[0-2]$/.test(d.getAttribute("MajorVersion")+
"-"+d.getAttribute("MinorVersion")),"Version should be 2.0, 2.1 or 2.2");var e=+d.getAttribute("Timescale")||1E7,h=0,k=c(d,function(a,c,d){switch(c){case "Protection":d=d.firstElementChild;b.equal(d.nodeName,"ProtectionHeader","parser: Protection should have ProtectionHeader child");c=f.strToBytes(atob(d.textContent));var k;k=f.le2toi(c,8);k=f.bytesToUTF16Str(c.subarray(10,10+k));k=(new DOMParser).parseFromString(k,"application/xml").querySelector("KID").textContent;k=f.guidToUuid(atob(k)).toLowerCase();
var l=f.hexToBytes(k);d=d.getAttribute("SystemID").toLowerCase().replace(/\{|\}/g,"");c={keyId:k,keySystems:[{systemId:d,privateData:c}].concat(y(l))};a.protection=c;break;case "StreamIndex":if(c=r(d,e))c.id=h++,a.adaptations.push(c)}return a},{protection:null,adaptations:[]}),l=k.protection,k=k.adaptations;a.each(k,function(a){return a.smoothProtection=l});var m,u,x,v,J=p(d.getAttribute("IsLive"));if(J){m=F;x=+d.getAttribute("DVRWindowLength")/e;v=H;u=a.find(k,function(a){return"video"==a.type});
var N=a.find(k,function(a){return"audio"==a.type});u=Math.min(q(u.index),q(N.index));u=Date.now()/1E3-(u+v)}return{transportType:"smoothstreaming",profiles:"",type:J?"dynamic":"static",suggestedPresentationDelay:m,timeShiftBufferDepth:x,presentationLiveGap:u,availabilityStartTime:v,periods:[{duration:(+d.getAttribute("Duration")||Infinity)/e,adaptations:k,laFragCount:+d.getAttribute("LookAheadFragmentCount")}]}}function x(b){if(a.isString(b))return d(b);if(b instanceof window.Document)return e(b);
throw Error("parser: unsupported type to parse");}var J=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],F=J.suggestedPresentationDelay||20,H=J.referenceDateTime||Date.UTC(1970,0,1,0,0,0,0)/1E3,N=J.minRepresentationBitrate||19E4,y=J.keySystems||l;x.parseFromString=d;x.parseFromDocument=e;return x}},function(r,h,c){function p(c){return c.replace(b,"\n").replace(a,function(a,b){return String.fromCharCode(b)})}var q=c(1),l=c(2),a=/&#([0-9]+);/g,b=/<br>/gi,f=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,
v=/\s*<p class=([^>]+)>(.*)/i,k=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;r.exports={parseSami:function(a,b){var c=/<sync[ >]/ig,h=/<sync[ >]|<\/body>/ig,d=[],e=a.match(f)[1],x,r=h.exec(a),r=/\.(\S+)\s*{([^}]*)}/gi,F;for(x={};F=r.exec(e);){var H=F[1];F=F[2].match(/\s*lang:\s*(\S+);/i)[1];H&&F&&(x[F]=H)}e=x[b];for(l(e,"sami: could not find lang "+b+" in CSS");;){x=c.exec(a);r=h.exec(a);if(!x&&!r)break;if(!x||!r||x.index>=r.index)throw Error("parse error");x=a.slice(x.index,r.index);r=x.match(k);if(!r)throw Error("parse error: sync time attribute");
H=+r[1];if(isNaN(H))throw Error("parse error: sync time attribute NaN");r=d;x=x.split("\n");H/=1E3;F=x.length;for(var N=void 0;0<=--F;)if(N=x[F].match(v)){var y=N[2];e===N[1]&&("&nbsp;"===y?q.last(r).end=H:r.push({text:p(y),start:H}))}}return d}}},function(r,h,c){function p(b,c){var f=0;b=b.firstChild;for(var h=[],d;b;){if(1===b.nodeType)switch(b.tagName.toUpperCase()){case "P":d=b;var e=c,k=q(d.getAttribute("begin"),e),r=q(d.getAttribute("end"),e),F=q(d.getAttribute("dur"),0);if(!l.isNumber(k)&&
!l.isNumber(r)&&!l.isNumber(F))throw Error("ttml: unsupported timestamp format");0<F?(null==k&&(k=f||e),null==r&&(r=k+F)):null==r&&(r=q(d.getAttribute("duration"),0),r=0<=r?r+k:Number.MAX_VALUE);d={id:d.getAttribute("xml:id")||d.getAttribute("id"),text:decodeURIComponent(v(d.innerHTML.replace(a,"\n"))),start:k,end:r};f=d.end;h.push(d);break;case "DIV":d=q(b.getAttribute("begin"),0),null==d&&(d=c),h.push.apply(h,p(b,d))}b=b.nextSibling}return h}function q(a,c){if(a){var h;if(h=a.match(b)){var l=h[3],
d=h[4],e=h[6];return 3600*parseInt(h[2]||0,10)+60*parseInt(l,10)+parseInt(d,10)+parseFloat("0."+e)}if(h=a.match(f))return l=h[4],parseFloat(h[1])*k[l]+c}}var l=c(1),a=/<br[^>]+>/gm,b=/^(([0-9]+):)?([0-9]+):([0-9]+)(\.([0-9]+))?$/,f=/(([0-9]+)(\.[0-9]+)?)(ms|h|m|s)/,v=window.escape,k={h:3600,m:60,s:1,ms:.001};r.exports={parseTTML:function(a,b,c){a=l.isString(a)?(new DOMParser).parseFromString(a,"text/xml"):a;if(!(a instanceof window.Document||a instanceof window.HTMLElement))throw Error("ttml: needs a Document to parse");
a=a.querySelector("tt");if(!a)throw Error("ttml: could not find <tt> tag");a=p(a.querySelector("body"),0);l.each(a,function(a){a.start+=c;a.end+=c});return a}}},function(r,h){function c(){this.arr=[]}c.prototype.add=function(c){this.arr.push(c)};c.prototype.remove=function(c){c=this.arr.indexOf(c);0<=c&&this.arr.splice(c,1)};c.prototype.test=function(c){return 0<=this.arr.indexOf(c)};c.prototype.size=function(){return this.arr.length};r.exports={ArraySet:c}},function(r,h,c){function p(a){return null==
a?"":String(a).replace(u,function(a){return w[a]})}function q(a){var b=a.getAverageBitrates(),c,e;b.video.subscribe(function(a){return e=a|0}).dispose();b.audio.subscribe(function(a){return c=a|0}).dispose();return{manifest:a.man,version:a.version,timeFragment:a.frag,currentTime:a.getCurrentTime(),state:a.getPlayerState(),buffer:f(a.video.buffered),volume:a.getVolume(),video:{adaptation:a.adas.video,representation:a.reps.video,maxBitrate:a.getVideoMaxBitrate(),bufferSize:a.getVideoBufferSize(),avrBitrate:e},
audio:{adaptation:a.adas.audio,representation:a.reps.audio,maxBitrate:a.getAudioMaxBitrate(),bufferSize:a.getAudioBufferSize(),avrBitrate:c}}}function l(a,b){var c=b.parentNode.querySelector("#cp--debug-infos-content");if(c){var e;try{e=q(a)}catch(f){return}var h=e,k=h.video,l=h.audio,h=h.manifest;e="<b>Player v"+e.version+"</b> ("+e.state+")<br>";h&&k&&l&&(e+=["Container: "+p(h.transportType),"Live: "+p(""+h.isLive),"Downloading bitrate (Kbit/s): "+(k.representation.bitrate/1E3).toFixed(3)+"/"+(l.representation.bitrate/
1E3).toFixed(3),"Estimated bandwidth (Kbit/s): "+(k.avrBitrate/1E3).toFixed(3)+"/"+(l.avrBitrate/1E3).toFixed(3),"Location: "+h.locations[0]].join("<br>"));c.innerHTML=e}}function a(a,c){var d="<style>\n#cp--debug-infos {\n  position: absolute;\n  top: "+p(c.offsetTop+10)+"px;\n  left: "+p(c.offsetLeft+10)+'px;\n  width: 500px;\n  height: 300px;\n  background-color: rgba(10, 10, 10, 0.83);\n  overflow: hidden;\n  color: white;\n  text-align: left;\n  padding: 2em;\n  box-sizing: border-box;\n}\n#cp--debug-hide-infos {\n  float: right;\n  cursor: pointer;\n}\n</style>\n<div id="cp--debug-infos">\n  <a id="cp--debug-hide-infos">[x]</a>\n  <p id="cp--debug-infos-content"></p>\n</div>',
e=c.parentNode,f=e.querySelector("#cp--debug-infos-container");f||(f=document.createElement("div"),f.setAttribute("id","cp--debug-infos-container"),e.appendChild(f));f.innerHTML=d;k||(k=e.querySelector("#cp--debug-hide-infos"),k.addEventListener("click",function(){return b(c)}));v&&clearInterval(v);v=setInterval(function(){return l(a,c)},1E3);l(a,c)}function b(a){(a=a.parentNode.querySelector("#cp--debug-infos-container"))&&a.parentNode.removeChild(a);v&&(clearInterval(v),v=null);k&&(k.removeEventListener("click",
b),k=null)}var f=c(9).bufferedToArray,v,k,u=/[&<>"']/g,w={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};r.exports={getDebug:q,showDebug:a,hideDebug:b,toggleDebug:function(c,f){f.parentNode.querySelector("#cp--debug-infos-container")?b(f):a(c,f)}}},function(r,h,c){var p;(function(q,l,a){(function(){function b(a){return"function"===typeof a}function f(){return function(){q.nextTick(w)}}function r(){var a=0,b=new P(w),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=
a=++a%2}}function k(){var a=new MessageChannel;a.port1.onmessage=w;return function(){a.port2.postMessage(0)}}function u(){return function(){setTimeout(w,1)}}function w(){for(var a=0;a<Q;a+=2)(0,ga[a])(ga[a+1]),ga[a]=void 0,ga[a+1]=void 0;Q=0}function m(){}function C(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function d(a,b,c){R(function(a){var d=!1,e=C(c,b,function(c){d||(d=!0,b!==c?x(a,c):F(a,c))},function(b){d||(d=!0,H(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,H(a,e))},a)}
function e(a,b){1===b._state?F(a,b._result):2===a._state?H(a,b._result):N(b,void 0,function(b){x(a,b)},function(b){H(a,b)})}function x(a,c){if(a===c)H(a,new TypeError("You cannot resolve a promise with itself"));else if("function"===typeof c||"object"===typeof c&&null!==c)if(c.constructor===a.constructor)e(a,c);else{var f;try{f=c.then}catch(h){V.error=h,f=V}f===V?H(a,V.error):void 0===f?F(a,c):b(f)?d(a,c,f):F(a,c)}else F(a,c)}function J(a){a._onerror&&a._onerror(a._result);y(a)}function F(a,b){void 0===
a._state&&(a._result=b,a._state=1,0!==a._subscribers.length&&R(y,a))}function H(a,b){void 0===a._state&&(a._state=2,a._result=b,R(J,a))}function N(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null;e[f]=b;e[f+1]=c;e[f+2]=d;0===f&&a._state&&R(y,a)}function y(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,h=0;h<b.length;h+=3)d=b[h],e=b[h+c],d?E(c,d,e,f):e(f);a._subscribers.length=0}}function I(){this.error=null}function E(a,c,d,e){var f=b(d),h,k,l,m;if(f){try{h=d(e)}catch(p){da.error=
p,h=da}h===da?(m=!0,k=h.error,h=null):l=!0;if(c===h){H(c,new TypeError("A promises callback cannot return that same promise."));return}}else h=e,l=!0;void 0===c._state&&(f&&l?x(c,h):m?H(c,k):1===a?F(c,h):2===a&&H(c,h))}function O(a,b){try{b(function(b){x(a,b)},function(b){H(a,b)})}catch(c){H(a,c)}}function X(a,b,c,d){this._instanceConstructor=a;this.promise=new a(m,d);this._abortOnReject=c;this._validateInput(b)?(this._input=b,this._remaining=this.length=b.length,this._init(),0===this.length?F(this.promise,
this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&F(this.promise,this._result))):H(this.promise,this._validationError())}function Y(a){this._id=W++;this._result=this._state=void 0;this._subscribers=[];if(m!==a){if(!b(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof Y))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
O(this,a)}}var U=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},Q=0,R=function(a,b){ga[Q]=a;ga[Q+1]=b;Q+=2;2===Q&&ba()},ea="undefined"!==typeof window?window:{},P=ea.MutationObserver||ea.WebKitMutationObserver,ea="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,ga=Array(1E3),ba;ba="undefined"!==typeof q&&"[object process]"==={}.toString.call(q)?f():P?r():ea?k():u();var V=new I,da=new I;
X.prototype._validateInput=function(a){return U(a)};X.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};X.prototype._init=function(){this._result=Array(this.length)};X.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;void 0===b._state&&d<a;d++)this._eachEntry(c[d],d)};X.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a._state?(a._onerror=null,
this._settledAt(a._state,b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(1,b,a))};X.prototype._settledAt=function(a,b,c){var d=this.promise;void 0===d._state&&(this._remaining--,this._abortOnReject&&2===a?H(d,c):this._result[b]=this._makeResult(a,b,c));0===this._remaining&&F(d,this._result)};X.prototype._makeResult=function(a,b,c){return c};X.prototype._willSettleAt=function(a,b){var c=this;N(a,void 0,function(a){c._settledAt(1,b,a)},function(a){c._settledAt(2,
b,a)})};var W=0;Y.all=function(a,b){return(new X(this,a,!0,b)).promise};Y.race=function(a,b){function c(a){x(e,a)}function d(a){H(e,a)}var e=new this(m,b);if(!U(a))return H(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,h=0;void 0===e._state&&h<f;h++)N(this.resolve(a[h]),void 0,c,d);return e};Y.resolve=function(a,b){if(a&&"object"===typeof a&&a.constructor===this)return a;var c=new this(m,b);x(c,a);return c};Y.reject=function(a,b){var c=new this(m,b);H(c,a);return c};Y.prototype=
{constructor:Y,then:function(a,b){var c=this._state;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(m),e=this._result;if(c){var f=arguments[c-1];R(function(){E(c,d,f,e)})}else N(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}};var fa={Promise:Y,polyfill:function(){var a;a="undefined"!==typeof l?l:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var c;
new a.Promise(function(a){c=a});return b(c)}()||(a.Promise=Y)}};c(49).amd?!(p=function(){return fa}.call(h,c,h,a),void 0!==p&&(a.exports=p)):"undefined"!==typeof a&&a.exports?a.exports=fa:"undefined"!==typeof this&&(this.ES6Promise=fa)}).call(this)}).call(h,c(15),function(){return this}(),c(22)(r))},function(r,h){r.exports=function(){throw Error("define cannot be used indirect");}}])});
