(function(r,k){"object"===typeof exports&&"object"===typeof module?module.exports=k():"function"===typeof define&&define.amd?define([],k):"object"===typeof exports?exports.RxPlayer=k():r.RxPlayer=k()})(this,function(){return function(r){function k(n){if(c[n])return c[n].exports;var p=c[n]={exports:{},id:n,loaded:!1};r[n].call(p.exports,p,p.exports,k);p.loaded=!0;return p.exports}var c={};k.m=r;k.c=c;k.p="";return k(0)}([function(r,k,c){r.exports=c(32)},function(r,k){function c(a,b){for(var f=-1,h=
a?a.length:0;++f<h;)if(a[f]===b)return f;return-1}function n(a){return!!a&&"object"==typeof a&&"[object Date]"==h.call(a)||!1}function p(a){return!!a&&"function"==typeof a||!1}function g(a){return"number"==typeof a}function a(a){return!!a&&"object"==typeof a||!1}function b(a){return"string"==typeof a}function q(b){for(var f=arguments,h=1;h<f.length;h++){var d=f[h];if(a(d))for(var l=B(d),c=0,q=l.length;c<q;c++)b[l[c]]=d[l[c]]}return b}function t(a,b){for(var f=a?a.length:0,h=-1,d=Array(f);++h<f;)d[h]=
b(a[h],h);return d}function d(a,b,f){for(var h=a?a.length:0,d=-1;++d<h;)f=b(f,a[d],d);return f}function v(a,b){for(var f=a?a.length:0,h=-1,d=[];++h<f;)b(a[h],h)&&d.push(a[h]);return d}function w(a,f){for(var h in a)if(f.hasOwnProperty(h)){var d=a[h],l=f[h];b(d)||g(d)||n(d)?a[h]=l:y(d)?(d.length=0,G.apply(d,l)):a[h]=w(d,l)}return a}var l=Object.prototype,h=l.toString,f=l.hasOwnProperty,y=Array.isArray,G=Array.prototype.push,B=Object.keys||function(a){var b=[],f;for(f in a)a.hasOwnProperty(f)&&b.push(a[f]);
return b},l=function(){var a=0;return function(b){b||(b="");return""+b+a++}}();r.exports={chunk:function(a,b){for(var f=[],h=0,d=-1,l=a?a.length:0;++d<l;)f[h]?f[h].length===b?f[++h]=[a[d]]:f[h].push(a[d]):f[h]=[a[d]];return f},compact:function(a){return v(a,function(a){return null!=a})},contains:function(a,b){return-1<c(a,b)},cloneArray:function(a){for(var b=a?a.length:0,f=-1,h=Array(b);++f<b;)h[f]=a[f];return h},cloneObject:function(a){return q({},a)},defaults:function(a,b){for(var f in b)"undefined"==
typeof a[f]&&(a[f]=b[f]);return a},each:function(a,b){for(var f=a?a.length:0,h=-1;++h<f;)b(a[h],h)},extend:q,values:function(a){for(var b=B(a),f=-1,h=b.length,d=Array(h);++f<h;)d[f]=a[b[f]];return d},filter:v,find:function(a,b){for(var f=-1,h=a?a.length:0;++f<h;)if(b(a[f],f))return a[f]},between:function(a,b,f){for(var h=-1,d=a?a.length:0;++h<d;)if(a[h][b]<=f&&a[h+1]&&f<a[h+1][b])return a[h]},findLast:function(a,b){for(var f=a?a.length:0;0<=--f;)if(b(a[f],f))return a[f]},flatten:function(a,b){for(var f=
b?t(a,b):a,h=-1,d=f?f.length:0,l=[];++h<d;){var c=f[h];if(c&&"object"==typeof c&&"number"==typeof c.length){var q=-1,y=c.length,g=l.length;for(l.length+=y;++q<y;)l[g++]=c[q]}else l.push(c)}return l},groupBy:function(a,b){var f;f=p(b)?b:function(a){return a[b]};return d(a,function(a,b){var h=f(b);(y(a[h])?a[h]:a[h]=[]).push(b);return a},{})},identity:function(a){return a},indexOf:c,isArray:y,isDate:n,isFunction:p,isNumber:g,isObject:a,isString:b,isPromise:function(a){return!!a&&"function"==typeof a.then},
isObservable:function(a){return!!a&&"function"==typeof a.subscribe},keys:B,last:function(a){return a[a.length-1]},map:t,memoize:function(a,b){var h=function I(){var h=I.cache,d=b?b.apply(this,arguments):arguments[0];return f.call(h,d)?h[d]:h[d]=a.apply(this,arguments)};h.cache={};return h},noop:function(){},pad:function(a,b){a=a.toString();return a.length>=b?a:(Array(b+1).join("0")+a).slice(-b)},pick:function(a,b){return d(b,function(b,f){f in a&&(b[f]=a[f]);return b},{})},pluck:function(a,b){return t(a,
function(a){return a[b]})},reduce:d,simpleMerge:w,sortedIndex:function(a,b,f){var h=0,d=a?a.length:h;for(b=f(b);h<d;){var l=h+d>>>1;f(a[l])<b?h=l+1:d=l}return h},sortedMerge:function(a,b,f){for(var h=0,d=0,l=0,c=a.length,q=b.length,y=[];h<c&&d<q;)a[h][f]<=b[d][f]?(y[l]=a[h],h++,l++):0<l&&b[d][f]<=y[l-1][f]?d++:(y[l]=b[d],d++,l++);if(h<c)for(f=h;f<c;f++)y[l]=a[f],l++;else for(f=d;f<q;f++)y[l]=b[f],l++;return y},tryCatch:function(a){try{return a()}catch(b){return b}},uniqueId:l}},function(r,k){function c(p){this.name=
"AssertionError";this.message=p;Error.captureStackTrace&&Error.captureStackTrace(this,c)}function n(p,g){if(!p)throw new c(g);}c.prototype=Error();n.equal=function(c,g,a){return n(c===g,a)};n.iface=function(c,g,a){n(c,g+" should be an object");for(var b in a)n.equal(typeof c[b],a[b],g+" should have property "+b+" as a "+a[b])};r.exports=n},function(r,k,c){c(5);r.exports=c(12)},function(r,k){function c(){}var n={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4},p=function(){};c.error=p;c.warn=p;c.info=p;c.debug=
p;c.setLevel=function(g){"string"==typeof g&&(g=n[g]);c.error=g>=n.ERROR?console.error.bind(console):p;c.warn=g>=n.WARNING?console.warn.bind(console):p;c.info=g>=n.INFO?console.info.bind(console):p;c.debug=g>=n.DEBUG?console.log.bind(console):p};r.exports=c},function(r,k,c){k=c(12);var n=k.Observable,p=k.SingleAssignmentDisposable;k=k.config;var g=n.fromEvent,a=n.merge,b=n.timer,q=c(20).getBackedoffDelay,t=c(1),d=t.isArray,v=t.map,w=t.noop,l=c(21);k.useNativeEvents=!0;c=n.prototype;c.log=function(){return this};
c.each=function(a){return this.subscribe(a,w)};var h=function(a,b){return a===b};c.changes=function(a){return this.distinctUntilChanged(a,h)};c.customDebounce=function(a,b){var h=this;return n.create(function(d){var c=l(function(a){return d.onNext(a)},a,b),q=h.subscribe(c,function(a){return d.onError(a)},function(){return d.onCompleted()});return function(){c.dispose();q.dispose()}})};c.simpleTimeout=function(a){var b=1>=arguments.length||void 0===arguments[1]?"timeout":arguments[1],h=this;return n.create(function(d){var l=
new p,c=setTimeout(function(){return d.onError(Error(b))},a);l.setDisposable(h.subscribe(function(a){clearTimeout(c);d.onNext(a)},function(a){return d.onError(a)},function(a){return d.onCompleted()}));return function(){clearTimeout(c);l.dispose()}})};r.exports={on:function(b,h){return d(h)?a(v(h,function(a){return g(b,a)})):g(b,h)},first:function(a){return a.take(1)},only:function(a){return n.never().startWith(a)},retryWithBackoff:function(a,h){var d=h.retryDelay,c=h.totalRetry,g=h.shouldRetry,t=
h.resetDelay,v=0,n;n=0<t?l(function(){return v=0},t):w;return function L(){for(var h=0,l=arguments.length,y=Array(l);h<l;h++)y[h]=arguments[h];return a.apply(null,y)["catch"](function(a){if(g&&!g(a,v)||v++>=c)throw a;a=q(d,v);return b(a).flatMap(function(){n();return L.apply(null,y)})})}}}},function(r,k,c){r.exports=c(48).Promise},function(r,k,c){function n(a){for(var b=a.length,c=new Uint8Array(b),g=0;g<b;g++)c[g]=a.charCodeAt(g)&255;return c}function p(a,b){b||(b="");for(var c="",g=0;g<a.byteLength;g++)c+=
(a[g]>>>4).toString(16),c+=(a[g]&15).toString(16),b.length&&(c+=b);return c}var g=c(2);r.exports={totalBytes:function(a){for(var b=0,c=0;c<a.length;c++)b+=a[c].byteLength;return b},strToBytes:n,bytesToStr:function(a){return String.fromCharCode.apply(null,a)},bytesToUTF16Str:function(a){for(var b="",c=a.length,g=0;g<c;g+=2)b+=String.fromCharCode(a[g]);return b},hexToBytes:function(a){for(var b=a.length,c=new Uint8Array(b/2),g=0,d=0;g<b;g+=2,d++)c[d]=parseInt(a.substr(g,2),16)&255;return c},bytesToHex:p,
concat:function(){for(var a=arguments.length,b=-1,c=0,g;++b<a;)g=arguments[b],c+="number"===typeof g?g:g.length;for(var c=new Uint8Array(c),d=0,b=-1;++b<a;)g=arguments[b],"number"===typeof g?d+=g:0<g.length&&(c.set(g,d),d+=g.length);return c},be2toi:function(a,b){return(a[0+b]<<8)+(a[1+b]<<0)},be4toi:function(a,b){return 16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b]},be8toi:function(a,b){return 4294967296*(16777216*a[0+b]+65536*a[1+b]+256*a[2+b]+a[3+b])+16777216*a[4+b]+65536*a[5+b]+256*a[6+b]+a[7+
b]},le2toi:function(a,b){return(a[0+b]<<0)+(a[1+b]<<8)},le4toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]},le8toi:function(a,b){return a[0+b]+256*a[1+b]+65536*a[2+b]+16777216*a[3+b]+(a[4+b]+256*a[5+b]+65536*a[6+b]+16777216*a[7+b]*4294967296)},itobe2:function(a){return new Uint8Array([a>>>8&255,a&255])},itobe4:function(a){return new Uint8Array([a>>>24&255,a>>>16&255,a>>>8&255,a&255])},itobe8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a>>>24&255,
a>>>16&255,a>>>8&255,a&255,b>>>24&255,b>>>16&255,b>>>8&255,b&255])},itole2:function(a){return new Uint8Array([a&255,a>>>8&255])},itole4:function(a){return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255])},itole8:function(a){var b=a%4294967296;a=(a-b)/4294967296;return new Uint8Array([a&255,a>>>8&255,a>>>16&255,a>>>24&255,b&255,b>>>8&255,b>>>16&255,b>>>24&255])},guidToUuid:function(a){g.equal(a.length,16,"UUID length should be 16");var b=n(a);a=b[0];var c=b[1],t=b[2],d=b[3],v=b[4],w=b[5],l=
b[6],h=b[7],f=b.subarray(8,10),b=b.subarray(10,16),y=new Uint8Array(16);y[0]=d;y[1]=t;y[2]=c;y[3]=a;y[4]=w;y[5]=v;y[6]=h;y[7]=l;y.set(f,8);y.set(b,10);return p(y)},toBase64URL:function(a){return btoa(a).replace(/\=+$/,"")}}},function(r,k,c){function n(a){return a&&"function"==typeof a.then?a:w.resolve(a)}function p(a){return function(){var b;try{b=a.apply(this,arguments)}catch(h){return w.reject(h)}return n(b)}}function g(a,b){return v.flatten(a,function(a){return v.map(b||L,function(b){return b+
a})})}function a(a,b){return v.find(b,function(b){var h;h=document.createElement(a.tagName);b="on"+b;b in h?h=!0:(h.setAttribute(b,"return;"),h=v.isFunction(h[b]));return h})}function b(b,h){var f;b=g(b,h);return function(h){return h instanceof S?("undefined"==typeof f&&(f=a(h,b)||null),f?F(h,f):B()):K(h,b)}}function q(a,b){function h(){var a=0>=arguments.length||void 0===arguments[0]?{}:arguments[0];a.errorCode&&(a={systemCode:a.systemCode,code:a.errorCode.code});this.name="KeySessionError";this.mediaKeyError=
a;this.message="MediaKeyError code:"+a.code+" and systemCode:"+a.systemCode}h.prototype=Error();return function(f,d){var c=v.isFunction(b)?b.call(this):this,l=X(c),g=U(c).map(function(a){throw new h(c.error||a);});try{return a.call(this,f,d),G(l,g).take(1).toPromise()}catch(y){return w.reject(y)}}}function t(a,b){if(b instanceof ca)return b._setVideo(a);if(a.setMediaKeys)return a.setMediaKeys(b);if(null!==b){if(a.WebkitSetMediaKeys)return a.WebkitSetMediaKeys(b);if(a.mozSetMediaKeys)return a.mozSetMediaKeys(b);
if(a.msSetMediaKeys)return new w(function(h,f){1<=a.readyState?(a.msSetMediaKeys(b),h()):a.addEventListener("loadedmetatdata",function(){try{a.msSetMediaKeys(b)}catch(d){return f(d)}finally{a.removeEventListener("loadedmetatdata")}h()})});throw Error("compat: cannot find setMediaKeys method");}}function d(){return!!(x.fullscreenElement||x.mozFullScreenElement||x.webkitFullscreenElement||x.msFullscreenElement)}var v=c(1);c(4);var w=c(6),l=c(10);k=c(7);var h=k.bytesToStr,f=k.strToBytes,y=c(2);k=c(3).Observable;
var G=k.merge,B=k.never,F=k.fromEvent,E=k.just,K=c(5).on,x=document,I=window,L=["","webkit","moz","ms"],S=I.HTMLElement;c=I.HTMLVideoElement;var Q=I.MediaSource||I.MozMediaSource||I.WebKitMediaSource||I.MSMediaSource,O=I.MediaKeys||I.MozMediaKeys||I.WebKitMediaKeys||I.MSMediaKeys;k="Microsoft Internet Explorer"==navigator.appName||"Netscape"==navigator.appName&&/Trident\//.test(navigator.userAgent);var ca=v.noop,M;navigator.requestMediaKeySystemAccess&&(M=function(a,b){return navigator.requestMediaKeySystemAccess(a,
b)});k=b(k?["progress"]:["loadedmetadata"]);var Z=b(["sourceopen","webkitsourceopen"]),V=b(["encrypted","needkey"]),aa=b(["keymessage","message"]),X=b(["keyadded","ready"]),U=b(["keyerror","error"]),R=b(["keystatuseschange"]),V={onEncrypted:V,onKeyMessage:aa,onKeyStatusesChange:R,onKeyError:U};if(!M&&c.prototype.webkitGenerateKeyRequest){var da=function(a,b){var h=this;l.call(this);this._vid=a;this._key=b;this._con=G(aa(a),X(a),U(a)).subscribe(function(a){return h.trigger(a.type,a)})};da.prototype=
v.extend({},l.prototype,{generateRequest:p(function(a,b){this._vid.webkitGenerateKeyRequest(this._key,b)}),update:q(function(a,b){if(0<=this._key.indexOf("clearkey")){var d=JSON.parse(h(a)),c=f(atob(d.keys[0].k)),d=f(atob(d.keys[0].kid));this._vid.webkitAddKey(this._key,c,d,b)}else this._vid.webkitAddKey(this._key,a,null,b)}),close:p(function(){this._con&&this._con.dispose();this._vid=this._con=null})});ca=function(a){this.ks_=a};ca.prototype={_setVideo:function(a){this._vid=a},createSession:function(){return new da(this._vid,
this.ks_)}};var la=function(a){var b=x.querySelector("video")||x.createElement("video");return b&&b.canPlayType?!!b.canPlayType("video/mp4",a):!1};M=function(a,b){if(!la(a))return w.reject();for(var h=function(h){var f=b[h];h=f.initDataTypes;var c=f.sessionTypes,l=f.distinctiveIdentifier,g=f.persistentState;if(d=(d=(d=(d=(d=!0,!h||v.find(h,function(a){return"cenc"===a})))&&(!c||v.filter(c,function(a){return"temporary"===a}).length===c.length))&&"required"!==l)&&"required"!==g)return{v:w.resolve({createMediaKeys:function(){return w.resolve(new ca(a),
f)}})}},f=0;f<b.length;f++){var d,c=h(f);if("object"===typeof c)return c.v}return w.reject()}}else if(O&&!M){var ta=function(a){l.call(this);this._mk=a};ta.prototype=v.extend(l.prototype,{generateRequest:p(function(a,b){var h=this;this._ss=this._mk.memCreateSession("video/mp4",b);this._con=G(aa(this._ss),X(this._ss),U(this._ss)).subscribe(function(a){return h.trigger(a.type,a)})}),update:q(function(a,b){y(this._ss);this._ss.update(a,b)},function(){return this._ss}),close:p(function(){this._ss&&(this._ss.close(),
this._ss=null,this._con.dispose(),this._con=null)})});O.prototype.alwaysRenew=!0;O.prototype.memCreateSession=O.prototype.createSession;O.prototype.createSession=function(){return new ta(this)};M=function(a,b){if(!O.isTypeSupported(a))return w.reject();for(var h=function(h){var f=b[h];h=f.initDataTypes;var c=f.distinctiveIdentifier;if(d=(d=(d=!0,!h||v.find(h,function(a){return"cenc"===a})))&&"required"!==c)return{v:w.resolve({createMediaKeys:function(){return w.resolve(new ca(a),f)}})}},f=0;f<b.length;f++){var d,
c=h(f);if("object"===typeof c)return c.v}return w.reject()}}O||(R=function(){throw Error("eme: MediaKeys is not available");},O={create:R,isTypeSupported:R});I.WebKitSourceBuffer&&!I.WebKitSourceBuffer.prototype.addEventListener&&(R=I.WebKitSourceBuffer.prototype,v.extend(R,l.prototype),R.__listeners=[],R.appendBuffer=function(a){if(this.updating)throw Error("SourceBuffer updating");this.trigger("updatestart");this.updating=!0;try{this.append(a)}catch(b){this.__emitUpdate("error",b);return}this.__emitUpdate("update")},
R.__emitUpdate=function(a,b){var h=this;setTimeout(function(){h.trigger(a,b);h.updating=!1;h.trigger("updateend")},0)});R=b(["fullscreenchange","FullscreenChange"],L.concat("MS"));r.exports={HTMLVideoElement_:c,MediaSource_:Q,isCodecSupported:function(a){return!!Q&&Q.isTypeSupported(a)},sourceOpen:function(a){return"open"==a.readyState?E():Z(a).take(1)},loadedMetadataEvent:k,requestMediaKeySystemAccess:M,setMediaKeys:function(a,b){return n(t(a,b))},emeEvents:V,isFullscreen:d,onFullscreenChange:R,
requestFullscreen:function(a){if(!d()){if(a.requestFullscreen)return a.requestFullscreen();if(a.msRequestFullscreen)return a.msRequestFullscreen();if(a.mozRequestFullScreen)return a.mozRequestFullScreen();if(a.webkitRequestFullscreen)return a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)}},exitFullscreen:function(){if(d()){if(x.exitFullscreen)return x.exitFullscreen();if(x.msExitFullscreen)return x.msExitFullscreen();if(x.mozCancelFullScreen)return x.mozCancelFullScreen();if(x.webkitExitFullscreen)return x.webkitExitFullscreen()}},
videoSizeChange:function(){return K(I,"resize")},visibilityChange:function(){var a;null!=x.hidden?a="":null!=x.mozHidden?a="moz":null!=x.msHidden?a="ms":null!=x.webkitHidden&&(a="webkit");var b=a?a+"Hidden":"hidden";return K(x,a+"visibilitychange").map(function(){return x[b]})}}},function(r,k,c){function n(a){if(d.isArray(a))return a;for(var b=-1,f=a.length,c=Array(f);++b<f;)c[b]={start:a.start(b),end:a.end(b),bitrate:0};return c}function p(a,b){return a.start<=b&&b<a.end}function g(b,h){for(var f=
0;f<h.length;f++)if(a(b,h[f]))return h[f];return null}function a(a,b){return p(a,b.start)||p(a,b.end)||p(b,a.start)}function b(a,b){return p(a,b.start)&&p(a,b.end)}function q(a,b){return Math.abs(b.start-a.end)<w||Math.abs(b.end-a.start)<w}function t(a,b,f){var d=Math.min(a.start,b.start);a=Math.max(a.end,b.end);return{start:d,end:a,bitrate:f}}var d=c(1),v=c(2),w=1/60;k=function(){function d(a){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.ranges=a?n(a):[];
this.length=this.ranges.length}d.prototype.start=function(a){return this.ranges[a].start};d.prototype.end=function(a){return this.ranges[a].end};d.prototype.hasRange=function(a,b){for(var d=a+b,c=0;c<this.ranges.length;c++){var g=this.ranges[c],l=g.start,g=g.end;if(l-a<=w&&a-g<=w&&l-d<=w&&d-g<=w)return this.ranges[c]}return null};d.prototype.getRange=function(a){for(var b=0;b<this.ranges.length;b++)if(p(this.ranges[b],a))return this.ranges[b];return null};d.prototype.getGap=function(a){var b=this.getRange(a);
return b?b.end-a:Infinity};d.prototype.getLoaded=function(a){var b=this.getRange(a);return b?a-b.start:0};d.prototype.getSize=function(a){return(a=this.getRange(a))?a.end-a.start:0};d.prototype.getNextRangeGap=function(a){for(var b=this.ranges,d=-1,c;++d<b.length;){var g=b[d].start;if(g>a){c=g;break}}return null!=c?c-a:Infinity};d.prototype.insert=function(d,f,c){var g=this.ranges;v(f<=c);if(f!=c){d={start:f,end:c,bitrate:d};for(f=0;f<g.length;f++){c=g[f];var l=a(d,c),n=q(d,c);if(l||n)if(d.bitrate===
c.bitrate)d=t(d,c,c.bitrate),g.splice(f--,1);else if(l)if(b(c,d))g.splice(++f,0,d),l=c.end,c.end=d.start,d={start:d.end,end:l,bitrate:c.bitrate};else if(b(d,c))g.splice(f--,1);else if(c.start<d.start)c.end=d.start;else{c.start=d.end;break}else break;else if(0===f){if(d.end<=g[0].start)break}else if(g[f-1].end<=d.start&&d.end<=c.start)break}g.splice(f,0,d);for(d=0;d<g.length;d++)f=g[d],f.start===f.end&&g.splice(d++,1);for(d=1;d<g.length;d++)f=g[d-1],c=g[d],f.bitrate===c.bitrate&&q(f,c)&&(f=t(f,c,c.bitrate),
g.splice(--d,2,f))}this.length=this.ranges.length;return this.ranges};d.prototype.remove=function(a,b){this.intersect(new d([{start:0,end:a},{start:b,end:Infinity}]))};d.prototype.equals=function(a){var b;a:{b=this.ranges;a=a.ranges;for(var d=0;d<b.length;d++){var c=b[d],l=g(c,a);if(!l||l.start>c.start||l.end<c.end){b=!1;break a}}b=!0}return b};d.prototype.intersect=function(a){var b=this.ranges;a=a.ranges;for(var d=0;d<b.length;d++){var c=b[d],l=g(c,a);l?(l.start>c.start&&(c.start=l.start),l.end<
c.end&&(c.end=l.end)):b.splice(d--,1)}this.length=this.ranges.length;return this.ranges};return d}();r.exports={bufferedToArray:n,BufferedRanges:k}},function(r,k,c){function n(){this.__listeners={}}var p=c(1),g=c(2);n.prototype.addEventListener=function(a,b){g("function"==typeof b,"eventemitter: second argument should be a function");this.__listeners[a]||(this.__listeners[a]=[]);this.__listeners[a].push(b)};n.prototype.removeEventListener=function(a,b){if(0===arguments.length)this.__listeners={};
else if(this.__listeners.hasOwnProperty(a))if(1===arguments.length)delete this.__listeners[a];else{var c=this.__listeners[a],g=c.indexOf(b);~g&&c.splice(g,1);c.length||delete this.__listeners[a]}};n.prototype.trigger=function(a,b){if(this.__listeners.hasOwnProperty(a)){var c=this.__listeners[a].slice();p.each(c,function(a){try{a(b)}catch(d){console.error(d,d.stack)}})}};n.prototype.on=n.prototype.addEventListener;n.prototype.off=n.prototype.removeEventListener;r.exports=n},function(r,k){var c=/^(?:[a-z]+:)?\/\//i,
n=/\/[\.]{1,2}\//;r.exports={resolveURL:function(){var p=arguments.length;if(0===p)return"";for(var g="",a=0;a<p;a++){var b=arguments[a];"string"===typeof b&&""!==b&&(c.test(b)?g=b:("/"===b[0]&&(b=b.substr(1)),"/"===g[g.length-1]&&(g=g.substr(0,g.length-1)),g=g+"/"+b))}if(n.test(g)){p=[];g=g.split("/");a=0;for(b=g.length;a<b;a++)".."==g[a]?p.pop():"."!=g[a]&&p.push(g[a]);p=p.join("/")}else p=g;return p},parseBaseURL:function(c){var g=c.lastIndexOf("/");return 0<=g?c.substring(0,g+1):c}}},function(r,
k,c){(function(n,p){function g(a){for(var e=a.length,m=Array(e),A=0;A<e;A++)m[A]=a[A];return m}function a(){try{return La.apply(this,arguments)}catch(a){return J.e=a,J}}function b(C){if(!Y(C))throw new TypeError("fn must be a function");La=C;return a}function q(a){throw a;}function t(a,e){for(var m=Array(a),A=0;A<a;A++)m[A]=e();return m}function d(a){this._s=a}function v(a){this._s=a;this._l=a.length;this._i=0}function w(a){this._a=a}function l(a){this._a=a;a=+a.length;if(isNaN(a))a=0;else if(0!==
a&&"number"===typeof a&&u.isFinite(a)){var e;e=+a;e=0===e?e:isNaN(e)?e:0>e?-1:1;a=e*Math.floor(Math.abs(a));a=0>=a?0:a>cb?cb:a}this._l=a;this._i=0}function h(a){var e=a._es6shim_iterator_;if(!e&&"string"===typeof a)return a=new d(a),a._es6shim_iterator_();if(!e&&void 0!==a.length)return a=new w(a),a._es6shim_iterator_();if(!e)throw new TypeError("Object is not iterable");return a._es6shim_iterator_()}function f(a,e){this.observer=a;this.parent=e}function y(a,e){ea(a)||(a=ra);return new Ra(e,a)}function k(a,
e){this.observer=a;this.parent=e}function B(a,e){this.observer=a;this.parent=e}function F(a,e){return new P(function(m){var A=new T,b=new oa;b.setDisposable(A);A.setDisposable(a.subscribe(new nb(m,b,e)));return b},a)}function E(){return!1}function K(){return[]}function x(){for(var a=arguments.length,e=Array(a),m=0;m<a;m++)e[m]=arguments[m];return e}function I(a){return function(e){return a.subscribe(e)}}function L(a,e){this.o=a;this.accumulator=e.accumulator;this.hasSeed=e.hasSeed;this.seed=e.seed;
this.hasAccumulation=!1;this.accumulation=null;this.isStopped=this.hasValue=!1}function S(a,e){return function(m){var A=m;for(m=0;m<e;m++)if(A=A[a[m]],"undefined"===typeof A)return;return A}}function Q(a,e,m){return function(){for(var A=arguments.length,fa=Array(A),d=0;d<A;d++)fa[d]=arguments[d];if(Y(m)){fa=b(m).apply(e,fa);if(fa===J)return a.onError(fa.e);a.onNext(fa)}else if(1>=fa.length)a.onNext(fa[0]);else a.onNext(fa);a.onCompleted()}}function O(a,e,m){return function(){var A=arguments[0];if(A)return a.onError(A);
for(var A=arguments.length,fa=[],d=1;d<A;d++)fa[d-1]=arguments[d];if(Y(m)){fa=b(m).apply(e,fa);if(fa===J)return a.onError(fa.e);a.onNext(fa)}else if(1>=fa.length)a.onNext(fa[0]);else a.onNext(fa);a.onCompleted()}}function ca(a,e,m){this._e=a;this._n=e;this._fn=m;this._e.addEventListener(this._n,this._fn,!1);this.isDisposed=!1}function M(a,e,m){var A=Object.prototype.toString.call(a);if("[object NodeList]"===A||"[object HTMLCollection]"===A){for(var A=new W,b=0,d=a.length;b<d;b++)A.add(M(a.item(b),
e,m));return A}return new ca(a,e,m)}function Z(a,e){return function(){var m=arguments[0];Y(e)&&(m=e.apply(null,arguments));a.onNext(m)}}function V(a,e){return new P(function(m){return e.scheduleWithAbsolute(a,function(){m.onNext(0);m.onCompleted()})})}function aa(a,e,m){return new P(function(A){var b=a,d=Xa(e);return m.scheduleRecursiveWithAbsoluteAndState(0,b,function(a,e){if(0<d){var C=m.now();b+=d;b<=C&&(b=C+d)}A.onNext(a);e(a+1,b)})})}function X(a,e){return new P(function(m){return e.scheduleWithRelative(Xa(a),
function(){m.onNext(0);m.onCompleted()})})}function U(a,e,m){return a===e?new P(function(a){return m.schedulePeriodicWithState(0,e,function(e){a.onNext(e);return e+1})}):db(function(){return aa(m.now()+a,e,m)})}function R(a,e,m){return new P(function(A){var b=!1,d=new oa,c=null,f=[],h=!1,g;g=a.materialize().timestamp(m).subscribe(function(a){"E"===a.value.kind?(f=[],f.push(a),c=a.value.exception,a=!h):(f.push({value:a.value,timestamp:a.timestamp+e}),a=!b,b=!0);if(a)if(null!==c)A.onError(c);else a=
new T,d.setDisposable(a),a.setDisposable(m.scheduleRecursiveWithRelative(e,function(a){var e,C,d;if(null===c){h=!0;do e=null,0<f.length&&0>=f[0].timestamp-m.now()&&(e=f.shift().value),null!==e&&e.accept(A);while(null!==e);d=!1;C=0;0<f.length?(d=!0,C=Math.max(0,f[0].timestamp-m.now())):b=!1;e=c;h=!1;if(null!==e)A.onError(e);else d&&a(C)}}))});return new W(g,d)},a)}function da(a,e,m){return db(function(){return R(a,e-m.now(),m)})}function la(a,e){return new P(function(m){function A(){c&&(c=!1,m.onNext(d));
b&&m.onCompleted()}var b=!1,d,c=!1,f=new T;f.setDisposable(a.subscribe(function(a){c=!0;d=a},function(a){m.onError(a)},function(){b=!0;f.dispose()}));return new W(f,e.subscribe(A,function(a){m.onError(a)},A))},a)}function ta(a,e,m){return new P(function(A){function d(a,e){g[e]=a;c[e]=!0;if(f||(f=c.every(ua))){if(l)return A.onError(l);var C=b(m).apply(null,g);if(C===J)return A.onError(C.e);A.onNext(C)}h&&g[1]&&A.onCompleted()}var c=[!1,!1],f=!1,h=!1,g=Array(2),l;return new W(a.subscribe(function(a){d(a,
0)},function(a){if(g[1])A.onError(a);else l=a},function(){h=!0;g[1]&&A.onCompleted()}),e.subscribe(function(a){d(a,1)},function(a){A.onError(a)},function(){h=!0;d(!0,1)}))},a)}var u=n,D={internals:{},config:{Promise:c(6)},helpers:{}},na=D.helpers.noop=function(){},ua=D.helpers.identity=function(a){return a},Ea=D.helpers.defaultNow=Date.now,Wa=D.helpers.defaultComparer=function(a,e){return wa(a,e)},Qa=D.helpers.defaultSubComparer=function(a,e){return a>e?1:a<e?-1:0},Ka=D.helpers.defaultError=function(a){throw a;
},ha=D.helpers.isPromise=function(a){return!!a&&"function"!==typeof a.subscribe&&"function"===typeof a.then},Y=D.helpers.isFunction=function(a){return"function"==typeof a||!1},J={e:{}},La;(D.EmptyError=function(){this.message="Sequence contains no elements.";this.name="EmptyError";Error.call(this)}).prototype=Error.prototype;var Ma=D.ObjectDisposedError=function(){this.message="Object has been disposed";this.name="ObjectDisposedError";Error.call(this)};Ma.prototype=Error.prototype;var ga=D.ArgumentOutOfRangeError=
function(){this.message="Argument out of range";this.name="ArgumentOutOfRangeError";Error.call(this)};ga.prototype=Error.prototype;var ya=D.NotSupportedError=function(a){this.message=a||"This operation is not supported";this.name="NotSupportedError";Error.call(this)};ya.prototype=Error.prototype;var Ca=D.NotImplementedError=function(a){this.message=a||"This operation is not implemented";this.name="NotImplementedError";Error.call(this)};Ca.prototype=Error.prototype;var Fa=D.helpers.notImplemented=
function(){throw new Ca;},va=D.helpers.notSupported=function(){throw new ya;},Ga=D.doneEnumerator={done:!0,value:void 0},Sa=D.helpers.isArrayLike=function(a){return a&&void 0!==a.length},sa=D.internals.bindCallback=function(a,e,m){return e?function(){return a.apply(e,arguments)}:a};D.internals.isObject=function(a){var e=typeof a;return a&&("function"==e||"object"==e)||!1};var wa=D.internals.isEqual=function(a,e){if(a===e)return!0;if(!a||!e||"object"!==typeof a||"object"!==typeof e)return!1;for(var m in a)if(a.hasOwnProperty(m)&&
(!e.hasOwnProperty(m)||a[m]!==e[m]))return!1;for(m in e)if(e.hasOwnProperty(m)&&!a.hasOwnProperty(m))return!1;return!0},H=D.internals.inherits=function(a,e){function m(){this.constructor=a}m.prototype=e.prototype;a.prototype=new m},Ha=D.internals.addProperties=function(a){for(var e=1,m=arguments.length;e<m;e++){var A=arguments[e],b;for(b in A)a[b]=A[b]}},W=D.CompositeDisposable=function(){var a=[],e,m;if(Array.isArray(arguments[0]))a=arguments[0],m=a.length;else for(m=arguments.length,a=Array(m),
e=0;e<m;e++)a[e]=arguments[e];for(e=0;e<m;e++)if(!ob(a[e]))throw new TypeError("Not a disposable");this.disposables=a;this.isDisposed=!1;this.length=a.length},Ya=W.prototype;Ya.add=function(a){this.isDisposed?a.dispose():(this.disposables.push(a),this.length++)};Ya.remove=function(a){var e=!1;if(!this.isDisposed){var m=this.disposables.indexOf(a);-1!==m&&(e=!0,this.disposables.splice(m,1),this.length--,a.dispose())}return e};Ya.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;for(var a=
this.disposables.length,e=Array(a),m=0;m<a;m++)e[m]=this.disposables[m];this.disposables=[];for(m=this.length=0;m<a;m++)e[m].dispose()}};var Ia=D.Disposable=function(a){this.isDisposed=!1;this.action=a||na};Ia.prototype.dispose=function(){this.isDisposed||(this.action(),this.isDisposed=!0)};var pa=Ia.create=function(a){return new Ia(a)},ka=Ia.empty={dispose:na},ob=Ia.isDisposable=function(a){return a&&Y(a.dispose)},ia=Ia.checkDisposed=function(a){if(a.isDisposed)throw new Ma;},T=D.SingleAssignmentDisposable=
function(){this.isDisposed=!1;this.current=null};T.prototype.getDisposable=function(){return this.current};T.prototype.setDisposable=function(a){if(this.current)throw Error("Disposable has already been assigned");var e=this.isDisposed;!e&&(this.current=a);e&&a&&a.dispose()};T.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};var oa=D.SerialDisposable=function(){this.isDisposed=!1;this.current=null};oa.prototype.getDisposable=
function(){return this.current};oa.prototype.setDisposable=function(a){var e=this.isDisposed;if(!e){var m=this.current;this.current=a}m&&m.dispose();e&&a&&a.dispose()};oa.prototype.dispose=function(){if(!this.isDisposed){this.isDisposed=!0;var a=this.current;this.current=null}a&&a.dispose()};D.RefCountDisposable=function(){function a(e){this.disposable=e;this.disposable.count++;this.isInnerDisposed=!1}function e(a){this.underlyingDisposable=a;this.isPrimaryDisposed=this.isDisposed=!1;this.count=0}
a.prototype.dispose=function(){this.disposable.isDisposed||this.isInnerDisposed||(this.isInnerDisposed=!0,this.disposable.count--,0===this.disposable.count&&this.disposable.isPrimaryDisposed&&(this.disposable.isDisposed=!0,this.disposable.underlyingDisposable.dispose()))};e.prototype.dispose=function(){this.isDisposed||this.isPrimaryDisposed||(this.isPrimaryDisposed=!0,0===this.count&&(this.isDisposed=!0,this.underlyingDisposable.dispose()))};e.prototype.getDisposable=function(){return this.isDisposed?
ka:new a(this)};return e}();var Na=D.internals.ScheduledItem=function(a,e,m,A,b){this.scheduler=a;this.state=e;this.action=m;this.dueTime=A;this.comparer=b||Qa;this.disposable=new T};Na.prototype.invoke=function(){this.disposable.setDisposable(this.invokeCore())};Na.prototype.compareTo=function(a){return this.comparer(this.dueTime,a.dueTime)};Na.prototype.isCancelled=function(){return this.disposable.isDisposed};Na.prototype.invokeCore=function(){return this.action(this.scheduler,this.state)};var qa=
D.Scheduler=function(){function a(e,m,b,C){this.now=e;this._schedule=m;this._scheduleRelative=b;this._scheduleAbsolute=C}function e(a,e){e();return ka}a.isScheduler=function(e){return e instanceof a};var m=a.prototype;m.schedule=function(a){return this._schedule(a,e)};m.scheduleWithState=function(a,e){return this._schedule(a,e)};m.scheduleWithRelative=function(a,m){return this._scheduleRelative(m,a,e)};m.scheduleWithRelativeAndState=function(a,e,m){return this._scheduleRelative(a,e,m)};m.scheduleWithAbsolute=
function(a,m){return this._scheduleAbsolute(m,a,e)};m.scheduleWithAbsoluteAndState=function(a,e,m){return this._scheduleAbsolute(a,e,m)};a.now=Ea;a.normalize=function(a){0>a&&(a=0);return a};return a}(),Xa=qa.normalize,ea=qa.isScheduler;(function(a){function e(a,e){function m(e){var b=!1,d=!1,c=a.scheduleWithState(e,function(a,e){b?C.remove(c):d=!0;A(e,m);return ka});d||(C.add(c),b=!0)}var b=e[0],A=e[1],C=new W;A(b,m);return C}function m(a,e,m){function b(e,A){var c=!1,fa=!1,f=a[m](e,A,function(a,
e){c?d.remove(f):fa=!0;C(e,b);return ka});fa||(d.add(f),c=!0)}var A=e[0],C=e[1],d=new W;C(A,b);return d}function b(a,e){return m(a,e,"scheduleWithRelativeAndState")}function d(a,e){return m(a,e,"scheduleWithAbsoluteAndState")}function c(a,e){a(function(m){e(a,m)})}a.scheduleRecursive=function(a){return this.scheduleRecursiveWithState(a,c)};a.scheduleRecursiveWithState=function(a,m){return this.scheduleWithState([a,m],e)};a.scheduleRecursiveWithRelative=function(a,e){return this.scheduleRecursiveWithRelativeAndState(e,
a,c)};a.scheduleRecursiveWithRelativeAndState=function(a,e,m){return this._scheduleRelative([a,m],e,b)};a.scheduleRecursiveWithAbsolute=function(a,e){return this.scheduleRecursiveWithAbsoluteAndState(e,a,c)};a.scheduleRecursiveWithAbsoluteAndState=function(a,e,m){return this._scheduleAbsolute([a,m],e,d)}})(qa.prototype);(function(a){qa.prototype.schedulePeriodic=function(a,m){return this.schedulePeriodicWithState(null,a,m)};qa.prototype.schedulePeriodicWithState=function(a,m,b){if("undefined"===typeof u.setInterval)throw new ya;
m=Xa(m);var C=a,d=u.setInterval(function(){C=b(C)},m);return pa(function(){u.clearInterval(d)})}})(qa.prototype);var ma=qa.immediate=function(){return new qa(Ea,function(a,e){return e(this,a)},va,va)}(),ra=qa.currentThread=function(){function a(){for(;0<e.length;){var m=e.shift();!m.isCancelled()&&m.invoke()}}var e,m=new qa(Ea,function(m,d){var c=new Na(this,m,d,this.now());if(e)e.push(c);else{e=[c];var f=b(a)();e=null;if(f===J)return q(f.e)}return c.disposable},va,va);m.scheduleRequired=function(){return!e};
return m}();D.internals.SchedulePeriodicRecursive=function(){function a(e,b){b(0,this._period);try{this._state=this._action(this._state)}catch(C){throw this._cancel.dispose(),C;}}function e(a,e,b,C){this._scheduler=a;this._state=e;this._period=b;this._action=C}e.prototype.start=function(){var e=new T;this._cancel=e;e.setDisposable(this._scheduler.scheduleRecursiveWithRelativeAndState(0,this._period,a.bind(this)));return e};return e}();var Ja,Za,eb=function(){var a,e=na;if(u.setTimeout)a=u.setTimeout,
e=u.clearTimeout;else if(u.WScript)a=function(a,e){u.WScript.Sleep(e);a()};else throw new ya;return{setTimeout:a,clearTimeout:e}}(),$a=eb.setTimeout,pb=eb.clearTimeout;(function(){function a(e){if(d)$a(function(){a(e)},0);else{var m=A[e];if(m&&(d=!0,m=b(m)(),Za(e),d=!1,m===J))return q(m.e)}}function e(){if(!u.postMessage||u.importScripts)return!1;var a=!1,e=u.onmessage;u.onmessage=function(){a=!0};u.postMessage("","*");u.onmessage=e;return a}var m=1,A={},d=!1;Za=function(a){delete A[a]};String(toString).replace(/[.*+?^${}()|[\]\\]/g,
"\\$&").replace(/toString| for [^\]]+/g,".*?");var c=n.setImmediate;if(Y(c))Ja=function(e){var b=m++;A[b]=e;c(function(){a(b)});return b};else if("undefined"!==typeof p&&"[object process]"==={}.toString.call(p))Ja=function(e){var b=m++;A[b]=e;p.nextTick(function(){a(b)});return b};else if(e()){var f=function(e){"string"===typeof e.data&&e.data.substring(0,h.length)===h&&a(e.data.substring(h.length))},h="ms.rx.schedule"+Math.random();u.addEventListener?u.addEventListener("message",f,!1):u.attachEvent?
u.attachEvent("onmessage",f):u.onmessage=f;Ja=function(a){var e=m++;A[e]=a;u.postMessage(h+currentId,"*");return e}}else if(u.MessageChannel){var g=new u.MessageChannel;g.port1.onmessage=function(e){a(e.data)};Ja=function(a){var e=m++;A[e]=a;g.port2.postMessage(e);return e}}else Ja="document"in u&&"onreadystatechange"in u.document.createElement("script")?function(e){var b=u.document.createElement("script"),d=m++;A[d]=e;b.onreadystatechange=function(){a(d);b.onreadystatechange=null;b.parentNode.removeChild(b);
b=null};u.document.documentElement.appendChild(b);return d}:function(e){var b=m++;A[b]=e;$a(function(){a(b)},0);return b}})();var za=qa.timeout=qa["default"]=function(){return new qa(Ea,function(a,e){var m=this,b=new T,d=Ja(function(){!b.isDisposed&&b.setDisposable(e(m,a))});return new W(b,pa(function(){Za(d)}))},function(a,e,m){var b=this;e=qa.normalize(e);var d=new T;if(0===e)return b.scheduleWithState(a,m);var c=$a(function(){!d.isDisposed&&d.setDisposable(m(b,a))},e);return new W(d,pa(function(){pb(c)}))},
function(a,e,m){return this.scheduleWithRelativeAndState(a,e-this.now(),m)})}(),xa=D.Notification=function(){function a(e,m,b,C,d,c){this.kind=e;this.value=m;this.exception=b;this._accept=C;this._acceptObservable=d;this.toString=c}a.prototype.accept=function(a,m,b){return a&&"object"===typeof a?this._acceptObservable(a):this._accept(a,m,b)};a.prototype.toObservable=function(a){var m=this;ea(a)||(a=ma);return new P(function(b){return a.scheduleWithState(m,function(a,e){e._acceptObservable(b);"N"===
e.kind&&b.onCompleted()})})};return a}(),qb=xa.createOnNext=function(){function a(e){return e(this.value)}function e(a){return a.onNext(this.value)}function m(){return"OnNext("+this.value+")"}return function(b){return new xa("N",b,null,a,e,m)}}(),rb=xa.createOnError=function(){function a(e,m){return m(this.exception)}function e(a){return a.onError(this.exception)}function m(){return"OnError("+this.exception+")"}return function(b){return new xa("E",null,b,a,e,m)}}(),sb=xa.createOnCompleted=function(){function a(e,
m,b){return b()}function e(a){return a.onCompleted()}function m(){return"OnCompleted()"}return function(){return new xa("C",null,null,a,e,m)}}(),Aa=D.Observer=function(){},Oa=Aa.create=function(a,e,m){a||(a=na);e||(e=Ka);m||(m=na);return new tb(a,e,m)},Pa=D.internals.AbstractObserver=function(a){function e(){this.isStopped=!1}H(e,a);e.prototype.next=Fa;e.prototype.error=Fa;e.prototype.completed=Fa;e.prototype.onNext=function(a){!this.isStopped&&this.next(a)};e.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.error(a))};e.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.completed())};e.prototype.dispose=function(){this.isStopped=!0};e.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.error(a),!0)};return e}(Aa),tb=D.AnonymousObserver=function(a){function e(e,b,d){a.call(this);this._onNext=e;this._onError=b;this._onCompleted=d}H(e,a);e.prototype.next=function(a){this._onNext(a)};e.prototype.error=function(a){this._onError(a)};e.prototype.completed=
function(){this._onCompleted()};return e}(Pa),z,N=D.Observable=function(){function a(e){this._subscribe=e}z=a.prototype;a.isObservable=function(a){return a&&Y(a.subscribe)};z.subscribe=z.forEach=function(a,m,b){return this._subscribe("object"===typeof a?a:Oa(a,m,b))};z.subscribeOnNext=function(a,m){return this._subscribe(Oa("undefined"!==typeof m?function(b){a.call(m,b)}:a))};z.subscribeOnError=function(a,m){return this._subscribe(Oa(null,"undefined"!==typeof m?function(b){a.call(m,b)}:a))};z.subscribeOnCompleted=
function(a,m){return this._subscribe(Oa(null,null,"undefined"!==typeof m?function(){a.call(m)}:a))};return a}(),ub=D.internals.ScheduledObserver=function(a){function e(e,b){a.call(this);this.scheduler=e;this.observer=b;this.hasFaulted=this.isAcquired=!1;this.queue=[];this.disposable=new oa}H(e,a);e.prototype.next=function(a){var e=this;this.queue.push(function(){e.observer.onNext(a)})};e.prototype.error=function(a){var e=this;this.queue.push(function(){e.observer.onError(a)})};e.prototype.completed=
function(){var a=this;this.queue.push(function(){a.observer.onCompleted()})};e.prototype.ensureActive=function(){var a=!1;!this.hasFaulted&&0<this.queue.length&&(a=!this.isAcquired,this.isAcquired=!0);a&&this.disposable.setDisposable(this.scheduler.scheduleRecursiveWithState(this,function(a,e){var m;if(0<a.queue.length){m=a.queue.shift();m=b(m)();if(m===J)return a.queue=[],a.hasFaulted=!0,q(m.e);e(a)}else a.isAcquired=!1}))};e.prototype.dispose=function(){a.prototype.dispose.call(this);this.disposable.dispose()};
return e}(Pa),ba=D.ObservableBase=function(a){function e(a){return a&&Y(a.dispose)?a:Y(a)?pa(a):ka}function m(a,m){var A=m[0],d=m[1],d=b(d.subscribeCore).call(d,A);if(d===J&&!A.fail(J.e))return q(J.e);A.setDisposable(e(d))}function A(a){a=new fb(a);var e=[a,this];ra.scheduleRequired()?ra.scheduleWithState(e,m):m(null,e);return a}function d(){a.call(this,A)}H(d,a);d.prototype.subscribeCore=Fa;return d}(N),Ta=function(a){function e(e,b,m,d){this.resultSelector=D.helpers.isFunction(m)?m:null;this.selector=
D.internals.bindCallback(D.helpers.isFunction(b)?b:function(){return b},d,3);this.source=e;a.call(this)}function m(a,e,b,m){this.i=0;this.selector=e;this.resultSelector=b;this.source=m;this.isStopped=!1;this.o=a}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new m(a,this.selector,this.resultSelector,this))};m.prototype._wrapResult=function(a,e,b){return this.resultSelector?a.map(function(a,m){return this.resultSelector(e,a,b,m)},this):a};m.prototype.onNext=function(a){if(!this.isStopped){var e=
this.i++,m=b(this.selector)(a,e,this.source);if(m===J)return this.o.onError(m.e);D.helpers.isPromise(m)&&(m=D.Observable.fromPromise(m));D.helpers.isArrayLike(m)&&(m=D.Observable.from(m));this.o.onNext(this._wrapResult(m,a,e))}};m.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};m.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};return e}(ba),Da=D.internals.Enumerable=function(){},vb=function(a){function e(e){this.sources=
e;a.call(this)}function m(a,e,m){this.o=a;this.s=e;this.e=m;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){var e,d=new oa,C=ma.scheduleRecursiveWithState(this.sources._es6shim_iterator_(),function(C,c){if(!e){var f=b(C.next).call(C);if(f===J)return a.onError(f.e);if(f.done)return a.onCompleted();f=f.value;ha(f)&&(f=ja(f));var h=new T;d.setDisposable(h);h.setDisposable(f.subscribe(new m(a,c,C)))}});return new W(d,C,pa(function(){e=!0}))};m.prototype.onNext=function(a){if(!this.isStopped)this.o.onNext(a)};
m.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};m.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.s(this.e))};m.prototype.dispose=function(){this.isStopped=!0};m.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);Da.prototype.concat=function(){return new vb(this)};var wb=function(a){function e(e){this.sources=e;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){var e=this.sources._es6shim_iterator_(),
d,C=new oa,c=ma.scheduleRecursiveWithState(null,function(c,f){if(!d){var h=b(e.next).call(e);if(h===J)return a.onError(h.e);if(h.done)return null!==c?a.onError(c):a.onCompleted();h=h.value;ha(h)&&(h=ja(h));var g=new T;C.setDisposable(g);g.setDisposable(h.subscribe(function(e){a.onNext(e)},f,function(){a.onCompleted()}))}});return new W(C,c,pa(function(){d=!0}))};return e}(ba);Da.prototype.catchError=function(){return new wb(this)};Da.prototype.catchErrorWhen=function(a){var e=this;return new P(function(m){var d=
new Ba,c=new Ba,f=a(d).subscribe(c),h=e._es6shim_iterator_(),g,l=new oa,u=ma.scheduleRecursive(function(a){if(!g){var e=b(h.next).call(h);if(e===J)return m.onError(e.e);if(e.done)m.onCompleted();else{e=e.value;ha(e)&&(e=ja(e));var C=new T,f=new T;l.setDisposable(new W(f,C));C.setDisposable(e.subscribe(function(a){m.onNext(a)},function(e){f.setDisposable(c.subscribe(a,function(a){m.onError(a)},function(){m.onCompleted()}));d.onNext(e)},function(){m.onCompleted()}))}}});return new W(f,l,u,pa(function(){g=
!0}))})};var xb=function(a){function e(a,e){this.v=a;this.c=null==e?-1:e}function m(a){this.v=a.v;this.l=a.c}H(e,a);e.prototype._es6shim_iterator_=function(){return new m(this)};m.prototype.next=function(){if(0===this.l)return Ga;0<this.l&&this.l--;return{done:!1,value:this.v}};return e}(Da),ab=Da.repeat=function(a,e){return new xb(a,e)},yb=function(a){function e(a,e,m){this.s=a;this.fn=e?sa(e,m,3):null}function m(a){this.i=-1;this.s=a.s;this.l=this.s.length;this.fn=a.fn}H(e,a);e.prototype._es6shim_iterator_=
function(){return new m(this)};m.prototype.next=function(){return++this.i<this.l?{done:!1,value:this.fn?this.fn(this.s[this.i],this.i,this.s):this.s[this.i]}:Ga};return e}(Da),gb=Da.of=function(a,e,m){return new yb(a,e,m)},zb=function(a){function e(e){this.source=e;a.call(this)}function m(a){this.o=a;this.a=[];this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new m(a))};m.prototype.onNext=function(a){this.isStopped||this.a.push(a)};m.prototype.onError=function(a){this.isStopped||
(this.isStopped=!0,this.o.onError(a))};m.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onNext(this.a),this.o.onCompleted())};m.prototype.dispose=function(){this.isStopped=!0};m.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);z.toArray=function(){return new zb(this)};N.create=function(a,e){return new P(a,e)};var db=N.defer=function(a){return new P(function(e){var m;try{m=a()}catch(b){return bb(b).subscribe(e)}ha(m)&&
(m=ja(m));return m.subscribe(e)})},hb=function(a){function e(e){this.scheduler=e;a.call(this)}function m(a,e){this.observer=a;this.scheduler=e}function b(a,e){e.onCompleted();return ka}H(e,a);e.prototype.subscribeCore=function(a){return(new m(a,this.scheduler)).run()};m.prototype.run=function(){return this.scheduler.scheduleWithState(this.observer,b)};return e}(ba),Ab=new hb(ma),Bb=N.empty=function(a){ea(a)||(a=ma);return a===ma?Ab:new hb(a)},Db=function(a){function e(e,b,d){this.iterable=e;this.mapper=
b;this.scheduler=d;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return(new Cb(a,this)).run()};return e}(ba),Cb=function(){function a(e,b){this.o=e;this.parent=b}a.prototype.run=function(){var a=h(Object(this.parent.iterable)),m=this.o,d=this.parent.mapper;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,C){var f=b(a.next).call(a);if(f===J)return m.onError(f.e);if(f.done)return m.onCompleted();f=f.value;if(Y(d)&&(f=b(d)(f,c),f===J))return m.onError(f.e);m.onNext(f);
C(c+1)})};return a}(),cb=Math.pow(2,53)-1;d.prototype._es6shim_iterator_=function(){return new v(this._s)};v.prototype._es6shim_iterator_=function(){return this};v.prototype.next=function(){return this._i<this._l?{done:!1,value:this._s.charAt(this._i++)}:Ga};w.prototype._es6shim_iterator_=function(){return new l(this._a)};l.prototype._es6shim_iterator_=function(){return this};l.prototype.next=function(){return this._i<this._l?{done:!1,value:this._a[this._i++]}:Ga};var Eb=N.from=function(a,e,b,d){if(null==
a)throw Error("iterable cannot be null.");if(e&&!Y(e))throw Error("mapFn when provided must be a function");if(e)var c=sa(e,b,2);ea(d)||(d=ra);return new Db(a,c,d)},Ra=function(a){function e(e,b){this.args=e;this.scheduler=b;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return(new f(a,this)).run()};return e}(ba);f.prototype.run=function(){var a=this.observer,e=this.parent.args,b=e.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(d,c){if(d<b)a.onNext(e[d]),c(d+
1);else a.onCompleted()})};var Fb=N.fromArray=function(a,e){ea(e)||(e=ra);return new Ra(a,e)},Gb=new (function(a){function e(){a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return ka};return e}(ba));N.never=function(){return Gb};N.of=function(){for(var a=arguments.length,e=Array(a),b=0;b<a;b++)e[b]=arguments[b];return new Ra(e,ra)};N.ofWithScheduler=function(a){for(var e=arguments.length,b=Array(e-1),d=1;d<e;d++)b[d-1]=arguments[d];return new Ra(b,a)};var Hb=function(a){function e(e,b){this.obj=
e;this.keys=Object.keys(e);this.scheduler=b;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return(new k(a,this)).run()};return e}(ba);k.prototype.run=function(){var a=this.observer,e=this.parent.obj,b=this.parent.keys,d=b.length;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,f){if(c<d){var h=b[c];a.onNext([h,e[h]]);f(c+1)}else a.onCompleted()})};N.pairs=function(a,e){e||(e=ra);return new Hb(a,e)};var Jb=function(a){function e(e,b,d){this.start=e;this.rangeCount=b;
this.scheduler=d;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return(new Ib(a,this)).run()};return e}(ba),Ib=function(){function a(e,b){this.observer=e;this.parent=b}a.prototype.run=function(){var a=this.parent.start,b=this.parent.rangeCount,d=this.observer;return this.parent.scheduler.scheduleRecursiveWithState(0,function(c,f){if(c<b)d.onNext(a+c),f(c+1);else d.onCompleted()})};return a}();N.range=function(a,e,b){ea(b)||(b=ra);return new Jb(a,e,b)};var Kb=function(a){function e(e,b,
d){this.value=e;this.repeatCount=null==b?-1:b;this.scheduler=d;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return(new B(a,this)).run()};return e}(ba);B.prototype.run=function(){var a=this.observer,e=this.parent.value;return this.parent.scheduler.scheduleRecursiveWithState(this.parent.repeatCount,function(b,d){if(-1===b||0<b)a.onNext(e),0<b&&b--;if(0===b)return a.onCompleted();d(b)})};N.repeat=function(a,e,b){ea(b)||(b=ra);return new Kb(a,e,b)};var Lb=function(a){function e(e,b){this.value=
e;this.scheduler=b;a.call(this)}function b(a,e,m){this.observer=a;this.value=e;this.scheduler=m}function d(a,e){var b=e[1];b.onNext(e[0]);b.onCompleted();return ka}H(e,a);e.prototype.subscribeCore=function(a){return(new b(a,this.value,this.scheduler)).run()};b.prototype.run=function(){var a=[this.value,this.observer];return this.scheduler===ma?d(null,a):this.scheduler.scheduleWithState(a,d)};return e}(ba);N["return"]=N.just=function(a,e){ea(e)||(e=ma);return new Lb(a,e)};var Mb=function(a){function e(e,
b){this.error=e;this.scheduler=b;a.call(this)}function b(a,e){this.o=a;this.p=e}function d(a,e){e[1].onError(e[0])}H(e,a);e.prototype.subscribeCore=function(a){return(new b(a,this)).run()};b.prototype.run=function(){return this.p.scheduler.scheduleWithState([this.p.error,this.o],d)};return e}(ba),bb=N["throw"]=function(a,e){ea(e)||(e=ma);return new Mb(a,e)},nb=function(a){function e(e,b,d){this._o=e;this._s=b;this._fn=d;a.call(this)}H(e,a);e.prototype.next=function(a){this._o.onNext(a)};e.prototype.completed=
function(){return this._o.onCompleted()};e.prototype.error=function(a){a=b(this._fn)(a);if(a===J)return this._o.onError(a.e);ha(a)&&(a=ja(a));var e=new T;this._s.setDisposable(e);e.setDisposable(a.subscribe(this._o))};return e}(Pa);z["catch"]=function(a){return Y(a)?F(this,a):Nb([this,a])};var Nb=N["catch"]=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var e=arguments.length;a=Array(e);for(var b=0;b<e;b++)a[b]=arguments[b]}return gb(a).catchError()};z.combineLatest=function(){for(var a=
arguments.length,e=Array(a),b=0;b<a;b++)e[b]=arguments[b];Array.isArray(e[0])?e[0].unshift(this):e.unshift(this);return Ob.apply(this,e)};var Ob=N.combineLatest=function(){for(var a=arguments.length,e=Array(a),b=0;b<a;b++)e[b]=arguments[b];var d=Y(e[a-1])?e.pop():x;Array.isArray(e[0])&&(e=e[0]);return new P(function(a){function b(e){c[e]=!0;if(f||(f=c.every(ua))){try{var m=d.apply(null,C)}catch(g){return a.onError(g)}a.onNext(m)}else if(h.filter(function(a,b){return b!==e}).every(ua))a.onCompleted()}
for(var m=e.length,c=t(m,E),f=!1,h=t(m,E),C=Array(m),g=Array(m),l=0;l<m;l++)(function(m){var d=e[m],c=new T;ha(d)&&(d=ja(d));c.setDisposable(d.subscribe(function(a){C[m]=a;b(m)},function(e){a.onError(e)},function(){h[m]=!0;h.every(ua)&&a.onCompleted()}));g[m]=c})(l);return new W(g)},this)};z.concat=function(){for(var a=[],e=0,b=arguments.length;e<b;e++)a.push(arguments[e]);a.unshift(this);return Pb.apply(null,a)};var Qb=function(a){function e(e){this.sources=e;a.call(this)}function b(a,e){this.sources=
a;this.o=e}H(e,a);e.prototype.subscribeCore=function(a){return(new b(this.sources,a)).run()};b.prototype.run=function(){var a,e=new oa,b=this.sources,m=b.length,d=this.o,c=ma.scheduleRecursiveWithState(0,function(c,f){if(!a){if(c===m)return d.onCompleted();var h=b[c];ha(h)&&(h=ja(h));var C=new T;e.setDisposable(C);C.setDisposable(h.subscribe(function(a){d.onNext(a)},function(a){d.onError(a)},function(){f(c+1)}))}});return new W(e,c,pa(function(){a=!0}))};return e}(ba),Pb=N.concat=function(){var a;
if(Array.isArray(arguments[0]))a=arguments[0];else{a=Array(arguments.length);for(var e=0,b=arguments.length;e<b;e++)a[e]=arguments[e]}return new Qb(a)};z.concatAll=function(){return this.merge(1)};var Sb=function(a){function e(e,b){this.source=e;this.maxConcurrent=b;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){var e=new W;e.add(this.source.subscribe(new Rb(a,this.maxConcurrent,e)));return e};return e}(ba),Rb=function(){function a(e,b,d){this.o=e;this.max=b;this.g=d;this.done=!1;this.q=
[];this.activeCount=0;this.isStopped=!1}function e(a,e){this.parent=a;this.sad=e;this.isStopped=!1}a.prototype.handleSubscribe=function(a){var b=new T;this.g.add(b);ha(a)&&(a=ja(a));b.setDisposable(a.subscribe(new e(this,b)))};a.prototype.onNext=function(a){this.isStopped||(this.activeCount<this.max?(this.activeCount++,this.handleSubscribe(a)):this.q.push(a))};a.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};a.prototype.onCompleted=function(){this.isStopped||
(this.done=this.isStopped=!0,0===this.activeCount&&this.o.onCompleted())};a.prototype.dispose=function(){this.isStopped=!0};a.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};e.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};e.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};e.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=this.parent;a.g.remove(this.sad);
0<a.q.length?a.handleSubscribe(a.q.shift()):(a.activeCount--,a.done&&0===a.activeCount&&a.o.onCompleted())}};e.prototype.dispose=function(){this.isStopped=!0};e.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return a}();z.merge=function(a){return"number"!==typeof a?Tb(this,a):new Sb(this,a)};var Tb=N.merge=function(){var a,e=[],b,d=arguments.length;arguments[0]?ea(arguments[0])?(a=arguments[0],b=1):(a=ma,b=0):(a=ma,b=1);for(;b<d;b++)e.push(arguments[b]);
Array.isArray(e[0])&&(e=e[0]);return y(a,e).mergeAll()},ib=D.CompositeError=function(a){this.name="NotImplementedError";this.innerErrors=a;this.message="This contains multiple errors. Check the innerErrors";Error.call(this)};ib.prototype=Error.prototype;N.mergeDelayError=function(){var a;if(Array.isArray(arguments[0]))a=arguments[0];else{var e=arguments.length;a=Array(e);for(var b=0;b<e;b++)a[b]=arguments[b]}var d=y(null,a);return new P(function(a){function e(){if(0===f.length)a.onCompleted();else if(1===
f.length)a.onError(f[0]);else a.onError(new ib(f))}var b=new W,m=new T,c=!1,f=[];b.add(m);m.setDisposable(d.subscribe(function(d){var m=new T;b.add(m);ha(d)&&(d=ja(d));m.setDisposable(d.subscribe(function(e){a.onNext(e)},function(a){f.push(a);b.remove(m);c&&1===b.length&&e()},function(){b.remove(m);c&&1===b.length&&e()}))},function(a){f.push(a);c=!0;1===b.length&&e()},function(){c=!0;1===b.length&&e()}));return b})};var Ub=function(a){function e(e){this.source=e;a.call(this)}function b(a,e){this.o=
a;this.g=e;this.done=this.isStopped=!1}function d(a,e){this.parent=a;this.sad=e;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){var e=new W,d=new T;e.add(d);d.setDisposable(this.source.subscribe(new b(a,e)));return e};b.prototype.onNext=function(a){if(!this.isStopped){var e=new T;this.g.add(e);ha(a)&&(a=ja(a));e.setDisposable(a.subscribe(new d(this,e)))}};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){this.isStopped||
(this.done=this.isStopped=!0,1===this.g.length&&this.o.onCompleted())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};d.prototype.onNext=function(a){if(!this.isStopped)this.parent.o.onNext(a)};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.o.onError(a))};d.prototype.onCompleted=function(){if(!this.isStopped){var a=this.parent;this.isStopped=!0;a.g.remove(this.sad);a.done&&
1===a.g.length&&a.o.onCompleted()}};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return e}(ba);z.mergeAll=function(){return new Ub(this)};z.skipUntil=function(a){var e=this;return new P(function(b){var d=!1,c=new W(e.subscribe(function(a){d&&b.onNext(a)},function(a){b.onError(a)},function(){d&&b.onCompleted()}));ha(a)&&(a=ja(a));var f=new T;c.add(f);f.setDisposable(a.subscribe(function(){d=
!0;f.dispose()},function(a){b.onError(a)},function(){f.dispose()}));return c},e)};var Vb=function(a){function e(e){this.source=e;a.call(this)}function b(a,e){this.o=a;this.inner=e;this.stopped=!1;this.latest=0;this.isStopped=this.hasLatest=!1}function d(a,e){this.parent=a;this.id=e;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){var e=new oa;a=this.source.subscribe(new b(a,e));return new W(a,e)};b.prototype.onNext=function(a){if(!this.isStopped){var e=new T,b=++this.latest;this.hasLatest=
!0;this.inner.setDisposable(e);ha(a)&&(a=ja(a));e.setDisposable(a.subscribe(new d(this,b)))}};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){this.isStopped||(this.stopped=this.isStopped=!0,!this.hasLatest&&this.o.onCompleted())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};d.prototype.onNext=function(a){this.isStopped||this.parent.latest===
this.id&&this.parent.o.onNext(a)};d.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&this.parent.o.onError(a))};d.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.parent.latest===this.id&&(this.parent.hasLatest=!1,this.parent.isStopped&&this.parent.o.onCompleted()))};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.parent.o.onError(a),!0)};return e}(ba);
z["switch"]=z.switchLatest=function(){return new Vb(this)};var Wb=function(a){function e(e,b){this.source=e;this.other=ha(b)?ja(b):b;a.call(this)}function b(a){this.o=a;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return new W(this.source.subscribe(a),this.other.subscribe(new b(a)))};b.prototype.onNext=function(a){if(!this.isStopped)this.o.onCompleted()};b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){!this.isStopped&&
(this.isStopped=!0)};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);z.takeUntil=function(a){return new Wb(this,a)};z.withLatestFrom=function(){for(var a=arguments.length,e=Array(a),d=0;d<a;d++)e[d]=arguments[d];var c=e.pop(),f=this;Array.isArray(e[0])&&(e=e[0]);return new P(function(a){for(var d=e.length,m=t(d,E),h=!1,g=Array(d),C=Array(d+1),l=0;l<d;l++)(function(b){var d=e[b],c=new T;
ha(d)&&(d=ja(d));c.setDisposable(d.subscribe(function(a){g[b]=a;m[b]=!0;h=m.every(ua)},function(e){a.onError(e)},na));C[b]=c})(l);l=new T;l.setDisposable(f.subscribe(function(e){e=[e].concat(g);if(h){e=b(c).apply(null,e);if(e===J)return a.onError(e.e);a.onNext(e)}},function(e){a.onError(e)},function(){a.onCompleted()}));C[d]=l;return new W(C)},this)};z.zip=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,e=Array(a),d=0;d<a;d++)e[d]=arguments[d];var c=
Y(e[a-1])?e.pop():x;Array.isArray(e[0])&&(e=e[0]);var f=this;e.unshift(f);return new P(function(a){for(var d=e.length,m=t(d,K),h=t(d,E),g=Array(d),C=0;C<d;C++)(function(d){var C=e[d],l=new T;ha(C)&&(C=ja(C));l.setDisposable(C.subscribe(function(e){m[d].push(e);if(m.every(function(a){return 0<a.length})){e=m.map(function(a){return a.shift()});e=b(c).apply(f,e);if(e===J)return a.onError(e.e);a.onNext(e)}else if(h.filter(function(a,e){return e!==d}).every(ua))a.onCompleted()},function(e){a.onError(e)},
function(){h[d]=!0;h.every(ua)&&a.onCompleted()}));g[d]=l})(C);return new W(g)},f)};N.zip=function(){for(var a=arguments.length,e=Array(a),b=0;b<a;b++)e[b]=arguments[b];Array.isArray(e[0])&&(e=Y(e[1])?e[0].concat(e[1]):e[0]);a=e.shift();return a.zip.apply(a,e)};z.zipIterable=function(){if(0===arguments.length)throw Error("invalid arguments");for(var a=arguments.length,e=Array(a),d=0;d<a;d++)e[d]=arguments[d];var c=Y(e[a-1])?e.pop():x,f=this;e.unshift(f);return new P(function(a){for(var d=e.length,
m=t(d,K),h=t(d,E),g=Array(d),l=0;l<d;l++)(function(d){var l=e[d],C=new T;(Sa(l)||isIterable(l))&&(l=Eb(l));C.setDisposable(l.subscribe(function(e){m[d].push(e);if(m.every(function(a){return 0<a.length})){e=m.map(function(a){return a.shift()});e=b(c).apply(f,e);if(e===J)return a.onError(e.e);a.onNext(e)}else if(h.filter(function(a,e){return e!==d}).every(ua))a.onCompleted()},function(e){a.onError(e)},function(){h[d]=!0;h.every(ua)&&a.onCompleted()}));g[d]=C})(l);return new W(g)},f)};z.asObservable=
function(){return new P(I(this),this)};z.dematerialize=function(){var a=this;return new P(function(e){return a.subscribe(function(a){return a.accept(e)},function(a){e.onError(a)},function(){e.onCompleted()})},this)};var Yb=function(a){function e(e,b,d){this.source=e;this.keyFn=b;this.comparer=d;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new Xb(a,this.keyFn,this.comparer))};return e}(ba),Xb=function(a){function e(e,b,d){this.o=e;this.keyFn=b;this.comparer=
d;this.hasCurrentKey=!1;this.currentKey=null;a.call(this)}H(e,a);e.prototype.next=function(a){var e=a,d;if(Y(this.keyFn)&&(e=b(this.keyFn)(a),e===J))return this.o.onError(e.e);if(this.hasCurrentKey&&(d=b(this.comparer)(this.currentKey,e),d===J))return this.o.onError(d.e);this.hasCurrentKey&&d||(this.hasCurrentKey=!0,this.currentKey=e,this.o.onNext(a))};e.prototype.error=function(a){this.o.onError(a)};e.prototype.completed=function(){this.o.onCompleted()};return e}(Pa);z.distinctUntilChanged=function(a,
e){e||(e=Wa);return new Yb(this,a,e)};var Zb=function(a){function e(e,b,d,m){this.source=e;this._oN=b;this._oE=d;this._oC=m;a.call(this)}function d(a,e){this.o=a;this.t=!e._oN||Y(e._oN)?Oa(e._oN||na,e._oE||na,e._oC||na):e._oN;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new d(a,this))};d.prototype.onNext=function(a){if(!this.isStopped){var e=b(this.t.onNext).call(this.t,a);if(e===J)this.o.onError(e.e);this.o.onNext(a)}};d.prototype.onError=function(a){if(!this.isStopped){this.isStopped=
!0;var e=b(this.t.onError).call(this.t,a);if(e===J)return this.o.onError(e.e);this.o.onError(a)}};d.prototype.onCompleted=function(){if(!this.isStopped){this.isStopped=!0;var a=b(this.t.onCompleted).call(this.t);if(a===J)return this.o.onError(a.e);this.o.onCompleted()}};d.prototype.dispose=function(){this.isStopped=!0};d.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);z["do"]=z.tap=z.doAction=function(a,e,b){return new Zb(this,a,e,b)};z.doOnNext=
z.tapOnNext=function(a,e){return this.tap("undefined"!==typeof e?function(b){a.call(e,b)}:a)};z.doOnError=z.tapOnError=function(a,e){return this.tap(na,"undefined"!==typeof e?function(b){a.call(e,b)}:a)};z.doOnCompleted=z.tapOnCompleted=function(a,e){return this.tap(na,null,"undefined"!==typeof e?function(){a.call(e)}:a)};z["finally"]=function(a){var e=this;return new P(function(d){var c=b(e.subscribe).call(e,d);return c===J?(a(),q(c.e)):pa(function(){var e=b(c.dispose).call(c);a();e===J&&q(e.e)})},
this)};var $b=function(a){function e(e){this.source=e;a.call(this)}function b(a){this.o=a;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new b(a))};b.prototype.onNext=na;b.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=
!0,this.observer.onError(a),!0)};return e}(ba);z.ignoreElements=function(){return new $b(this)};z.materialize=function(){var a=this;return new P(function(e){return a.subscribe(function(a){e.onNext(qb(a))},function(a){e.onNext(rb(a));e.onCompleted()},function(){e.onNext(sb());e.onCompleted()})},a)};z.repeat=function(a){return ab(this,a).concat()};z.retry=function(a){return ab(this,a).catchError()};z.retryWhen=function(a){return ab(this).catchErrorWhen(a)};var ac=function(a){function e(e,b,d,c){this.source=
e;this.accumulator=b;this.hasSeed=d;this.seed=c;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new L(a,this))};return e}(ba);L.prototype={onNext:function(a){if(!this.isStopped){!this.hasValue&&(this.hasValue=!0);this.hasAccumulation?this.accumulation=b(this.accumulator)(this.accumulation,a):(this.accumulation=this.hasSeed?b(this.accumulator)(this.seed,a):a,this.hasAccumulation=!0);if(this.accumulation===J)return this.o.onError(this.accumulation.e);this.o.onNext(this.accumulation)}},
onError:function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))},onCompleted:function(){this.isStopped||(this.isStopped=!0,!this.hasValue&&this.hasSeed&&this.o.onNext(this.seed),this.o.onCompleted())},dispose:function(){this.isStopped=!0},fail:function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)}};z.scan=function(){var a=!1,e,b=arguments[0];2===arguments.length&&(a=!0,e=arguments[1]);return new ac(this,b,a,e)};z.skipLast=function(a){if(0>a)throw new ga;var e=this;
return new P(function(b){var d=[];return e.subscribe(function(e){d.push(e);d.length>a&&b.onNext(d.shift())},function(a){b.onError(a)},function(){b.onCompleted()})},e)};z.startWith=function(){var a,e=0;arguments.length&&ea(arguments[0])?(a=arguments[0],e=1):a=ma;for(var b=[],d=arguments.length;e<d;e++)b.push(arguments[e]);return gb([Fb(b,a),this]).concat()};z.takeLast=function(a){if(0>a)throw new ga;var e=this;return new P(function(b){var d=[];return e.subscribe(function(e){d.push(e);d.length>a&&d.shift()},
function(a){b.onError(a)},function(){for(;0<d.length;)b.onNext(d.shift());b.onCompleted()})},e)};z.flatMapConcat=z.concatMap=function(a,e,b){return(new Ta(this,a,e,b)).merge(1)};var jb=function(a){function e(e,b,d){this.source=e;this.selector=sa(b,d,3);a.call(this)}function d(a,e){return function(b,d,c){return a.call(this,e.selector(b,d,c),d,c)}}function c(a,e,b){this.o=a;this.selector=e;this.source=b;this.i=0;this.isStopped=!1}H(e,a);e.prototype.internalMap=function(a,b){return new e(this.source,
d(a,this),b)};e.prototype.subscribeCore=function(a){return this.source.subscribe(new c(a,this.selector,this))};c.prototype.onNext=function(a){if(!this.isStopped){a=b(this.selector)(a,this.i++,this.source);if(a===J)return this.o.onError(a.e);this.o.onNext(a)}};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=
function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);z.map=z.select=function(a,e){var b="function"===typeof a?a:function(){return a};return this instanceof jb?this.internalMap(b,e):new jb(this,b,e)};z.pluck=function(){var a=arguments.length,e=Array(a);if(0===a)throw Error("List of properties cannot be empty.");for(var b=0;b<a;b++)e[b]=arguments[b];return this.map(S(e,a))};z.flatMap=z.selectMany=function(a,e,b){return(new Ta(this,a,e,b)).mergeAll()};D.Observable.prototype.flatMapWithMaxConcurrent=
function(a,e,b,d){return(new Ta(this,e,b,d)).merge(a)};D.Observable.prototype.flatMapLatest=function(a,e,b){return(new Ta(this,a,e,b)).switchLatest()};var bc=function(a){function e(e,b){this.source=e;this.skipCount=b;a.call(this)}function b(a,e){this.r=this.c=e;this.o=a;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new b(a,this.skipCount))};b.prototype.onNext=function(a){if(!this.isStopped)if(0>=this.r)this.o.onNext(a);else this.r--};b.prototype.onError=
function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};b.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};b.prototype.dispose=function(){this.isStopped=!0};b.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,this.o.onError(a),!0)};return e}(ba);z.skip=function(a){if(0>a)throw new ga;return new bc(this,a)};z.skipWhile=function(a,e){var b=this,d=sa(a,e,3);return new P(function(a){var e=0,c=!1;return b.subscribe(function(f){if(!c)try{c=
!d(f,e++,b)}catch(h){a.onError(h);return}c&&a.onNext(f)},function(e){a.onError(e)},function(){a.onCompleted()})},b)};z.take=function(a,e){if(0>a)throw new ga;if(0===a)return Bb(e);var b=this;return new P(function(e){var d=a;return b.subscribe(function(a){0<d--&&(e.onNext(a),0>=d&&e.onCompleted())},function(a){e.onError(a)},function(){e.onCompleted()})},b)};z.takeWhile=function(a,e){var b=this,d=sa(a,e,3);return new P(function(a){var e=0,c=!0;return b.subscribe(function(f){if(c){try{c=d(f,e++,b)}catch(h){a.onError(h);
return}if(c)a.onNext(f);else a.onCompleted()}},function(e){a.onError(e)},function(){a.onCompleted()})},b)};var kb=function(a){function e(e,b,d){this.source=e;this.predicate=sa(b,d,3);a.call(this)}function d(a,e){return function(b,d,c){return e.predicate(b,d,c)&&a.call(this,b,d,c)}}function c(a,e,b){this.o=a;this.predicate=e;this.source=b;this.i=0;this.isStopped=!1}H(e,a);e.prototype.subscribeCore=function(a){return this.source.subscribe(new c(a,this.predicate,this))};e.prototype.internalFilter=function(a,
b){return new e(this.source,d(a,this),b)};c.prototype.onNext=function(a){if(!this.isStopped){var e=b(this.predicate)(a,this.i++,this.source);if(e===J)return this.o.onError(e.e);e&&this.o.onNext(a)}};c.prototype.onError=function(a){this.isStopped||(this.isStopped=!0,this.o.onError(a))};c.prototype.onCompleted=function(){this.isStopped||(this.isStopped=!0,this.o.onCompleted())};c.prototype.dispose=function(){this.isStopped=!0};c.prototype.fail=function(a){return this.isStopped?!1:(this.isStopped=!0,
this.o.onError(a),!0)};return e}(ba);z.filter=z.where=function(a,e){return this instanceof kb?this.internalFilter(a,e):new kb(this,a,e)};N.fromCallback=function(a,e,b){return function(){"undefined"===typeof e&&(e=this);for(var d=arguments.length,c=Array(d),f=0;f<d;f++)c[f]=arguments[f];d=e;f=new Ua;c.push(Q(f,d,b));a.apply(d,c);return f.asObservable()}};N.fromNodeCallback=function(a,e,b){return function(){"undefined"===typeof e&&(e=this);for(var d=arguments.length,c=Array(d),f=0;f<d;f++)c[f]=arguments[f];
d=e;f=new Ua;c.push(O(f,d,b));a.apply(d,c);return f.asObservable()}};ca.prototype.dispose=function(){this.isDisposed||(this._e.removeEventListener(this._n,this._fn,!1),this.isDisposed=!0)};N.fromEvent=function(a,e,b){return a.addListener?cc(function(b){a.addListener(e,b)},function(b){a.removeListener(e,b)},b):new P(function(d){return M(a,e,Z(d,b))})};var cc=N.fromEventPattern=function(a,e,d,c){ea(c)||(c=ma);return(new P(function(c){function f(){var a=arguments[0];if(Y(d)&&(a=b(d).apply(null,arguments),
a===J))return c.onError(a.e);c.onNext(a)}var h=a(f);return pa(function(){Y(e)&&e(f,h)})})).publish().refCount()},dc=function(a){function e(e){this.p=e;a.call(this)}H(e,a);e.prototype.subscribeCore=function(a){this.p.then(function(e){a.onNext(e);a.onCompleted()},function(e){a.onError(e)});return ka};return e}(ba),ja=N.fromPromise=function(a){return new dc(a)};z.toPromise=function(a){a||(a=D.config.Promise);if(!a)throw new ya("Promise type not provided nor in Rx.config.Promise");var e=this;return new a(function(a,
b){var d,c=!1;e.subscribe(function(a){d=a;c=!0},b,function(){c&&a(d)})})};N.startAsync=function(a){var e;try{e=a()}catch(b){return bb(b)}return ja(e)};z.multicast=function(a,e){var b=this;return"function"===typeof a?new P(function(d){var c=b.multicast(a());return new W(e(c).subscribe(d),c.connect())},b):new ec(b,a)};z.publish=function(a){return a&&Y(a)?this.multicast(function(){return new Ba},a):this.multicast(new Ba)};z.share=function(){return this.publish().refCount()};z.publishLast=function(a){return a&&
Y(a)?this.multicast(function(){return new Ua},a):this.multicast(new Ua)};z.publishValue=function(a,e){return 2===arguments.length?this.multicast(function(){return new lb(e)},a):this.multicast(new lb(a))};z.shareValue=function(a){return this.publishValue(a).refCount()};z.replay=function(a,e,b,d){return a&&Y(a)?this.multicast(function(){return new mb(e,b,d)},a):this.multicast(new mb(e,b,d))};z.shareReplay=function(a,e,b){return this.replay(null,a,e,b).refCount()};var ec=D.ConnectableObservable=function(a){function e(e,
b){var d=!1,c,f=e.asObservable();this.connect=function(){d||(d=!0,c=new W(f.subscribe(b),pa(function(){d=!1})));return c};a.call(this,function(a){return b.subscribe(a)})}H(e,a);e.prototype.refCount=function(){var a,e=0,b=this;return new P(function(d){var c=1===++e,f=b.subscribe(d);c&&(a=b.connect());return function(){f.dispose();0===--e&&a.dispose()}})};return e}(N),fc=N.interval=function(a,e){return U(a,a,ea(e)?e:za)};N.timer=function(a,e,b){var d;ea(b)||(b=za);null!=e&&"number"===typeof e?d=e:ea(e)&&
(b=e);return a instanceof Date&&void 0===d?V(a.getTime(),b):a instanceof Date&&void 0!==d?aa(a.getTime(),e,b):void 0===d?X(a,b):U(a,d,b)};z.delay=function(a,e){ea(e)||(e=za);return a instanceof Date?da(this,a.getTime(),e):R(this,a,e)};z.debounce=function(a,e){ea(e)||(e=za);var b=this;return new P(function(d){var c=new oa,f=!1,h,g=0,l=b.subscribe(function(b){f=!0;h=b;g++;var m=g;b=new T;c.setDisposable(b);b.setDisposable(e.scheduleWithRelative(a,function(){f&&g===m&&d.onNext(h);f=!1}))},function(a){c.dispose();
d.onError(a);f=!1;g++},function(){c.dispose();f&&d.onNext(h);d.onCompleted();f=!1;g++});return new W(l,c)},this)};z.throttle=function(a,e){return this.debounce(a,e)};z.timestamp=function(a){ea(a)||(a=za);return this.map(function(e){return{value:e,timestamp:a.now()}})};z.sample=z.throttleLatest=function(a,e){ea(e)||(e=za);return"number"===typeof a?la(this,fc(a,e)):la(this,a)};z.timeout=function(a,e,b){null!=e&&"string"!==typeof e||(e=bb(Error(e||"Timeout")));ea(b)||(b=za);var d=this,c=a instanceof
Date?"scheduleWithAbsolute":"scheduleWithRelative";return new P(function(f){function h(){var d=g;D.setDisposable(b[c](a,function(){g===d&&(ha(e)&&(e=ja(e)),u.setDisposable(e.subscribe(f)))}))}var g=0,l=new T,u=new oa,D=new oa;u.setDisposable(l);h();l.setDisposable(d.subscribe(function(a){g++;f.onNext(a);h()},function(a){g++;f.onError(a)},function(){g++;f.onCompleted()}));return new W(u,D)},d)};z.throttleFirst=function(a,e){ea(e)||(e=za);var b=+a||0;if(0>=b)throw new RangeError("windowDuration cannot be less or equal zero.");
var d=this;return new P(function(a){var c=0;return d.subscribe(function(d){var f=e.now();if(0===c||f-c>=b)c=f,a.onNext(d)},function(e){a.onError(e)},function(){a.onCompleted()})},d)};var gc=function(a){function e(a){var e=this.source.publish();a=e.subscribe(a);var b=ka,d=this.pauser.distinctUntilChanged().subscribe(function(a){a?b=e.connect():(b.dispose(),b=ka)});return new W(a,b,d)}function b(d,c){this.source=d;this.controller=new Ba;this.pauser=c&&c.subscribe?this.controller.merge(c):this.controller;
a.call(this,e,d)}H(b,a);b.prototype.pause=function(){this.controller.onNext(!1)};b.prototype.resume=function(){this.controller.onNext(!0)};return b}(N);z.pausable=function(a){return new gc(this,a)};var hc=function(a){function e(a){function e(){for(;0<b.length;)a.onNext(b.shift())}var b=[],d;return ta(this.source,this.pauser.startWith(!1).distinctUntilChanged(),function(a,e){return{data:a,shouldFire:e}}).subscribe(function(c){if(void 0!==d&&c.shouldFire!=d)(d=c.shouldFire)&&e();else if(d=c.shouldFire)a.onNext(c.data);
else b.push(c.data)},function(b){e();a.onError(b)},function(){e();a.onCompleted()})}function b(d,c){this.source=d;this.controller=new Ba;this.pauser=c&&c.subscribe?this.controller.merge(c):this.controller;a.call(this,e,d)}H(b,a);b.prototype.pause=function(){this.controller.onNext(!1)};b.prototype.resume=function(){this.controller.onNext(!0)};return b}(N);z.pausableBuffered=function(a){return new hc(this,a)};var jc=function(a){function e(a){return this.source.subscribe(a)}function b(d,c,f){a.call(this,
e,d);this.subject=new ic(c,f);this.source=d.multicast(this.subject).refCount()}H(b,a);b.prototype.request=function(a){return this.subject.request(null==a?-1:a)};return b}(N),ic=function(a){function e(a){return this.subject.subscribe(a)}function b(d,c){null==d&&(d=!0);a.call(this,e);this.subject=new Ba;this.queue=(this.enableQueue=d)?[]:null;this.requestedCount=0;this.error=this.requestedDisposable=null;this.hasCompleted=this.hasFailed=!1;this.scheduler=c||ra}H(b,a);Ha(b.prototype,Aa,{onCompleted:function(){this.hasCompleted=
!0;this.enableQueue&&0!==this.queue.length?this.queue.push(xa.createOnCompleted()):(this.subject.onCompleted(),this.disposeCurrentRequest())},onError:function(a){this.hasFailed=!0;this.error=a;this.enableQueue&&0!==this.queue.length?this.queue.push(xa.createOnError(a)):(this.subject.onError(a),this.disposeCurrentRequest())},onNext:function(a){0>=this.requestedCount?this.enableQueue&&this.queue.push(xa.createOnNext(a)):(0===this.requestedCount--&&this.disposeCurrentRequest(),this.subject.onNext(a))},
_processRequest:function(a){if(this.enableQueue)for(;0<this.queue.length&&(0<a||"N"!==this.queue[0].kind);){var e=this.queue.shift();e.accept(this.subject);"N"===e.kind?a--:(this.disposeCurrentRequest(),this.queue=[])}return a},request:function(a){this.disposeCurrentRequest();var e=this;return this.requestedDisposable=this.scheduler.scheduleWithState(a,function(a,b){var d=e._processRequest(b);if(!e.hasCompleted&&!e.hasFailed&&0<d)return e.requestedCount=d,pa(function(){e.requestedCount=0})})},disposeCurrentRequest:function(){this.requestedDisposable&&
(this.requestedDisposable.dispose(),this.requestedDisposable=null)}});return b}(N);z.controlled=function(a,e){a&&ea(a)&&(e=a,a=!0);null==a&&(a=!0);return new jc(this,a,e)};z.pipe=function(a){function e(){b.resume()}var b=this.pausableBuffered();a.addListener("drain",e);b.subscribe(function(e){!a.write(String(e))&&b.pause()},function(e){a.emit("error",e)},function(){!a._isStdio&&a.end();a.removeListener("drain",e)});b.resume();return a};var P=D.AnonymousObservable=function(a){function e(a){return a&&
Y(a.dispose)?a:Y(a)?pa(a):ka}function d(a,c){var f=c[0],h=c[1],h=b(h.__subscribe).call(h,f);if(h===J&&!f.fail(J.e))return q(J.e);f.setDisposable(e(h))}function c(a){a=new fb(a);var e=[a,this];ra.scheduleRequired()?ra.scheduleWithState(e,d):d(null,e);return a}function f(e,b){this.source=b;this.__subscribe=e;a.call(this,c)}H(f,a);return f}(N),fb=function(a){function e(e){a.call(this);this.observer=e;this.m=new T}H(e,a);var d=e.prototype;d.next=function(a){a=b(this.observer.onNext).call(this.observer,
a);a===J&&(this.dispose(),q(a.e))};d.error=function(a){a=b(this.observer.onError).call(this.observer,a);this.dispose();a===J&&q(a.e)};d.completed=function(){var a=b(this.observer.onCompleted).call(this.observer);this.dispose();a===J&&q(a.e)};d.setDisposable=function(a){this.m.setDisposable(a)};d.getDisposable=function(){return this.m.getDisposable()};d.dispose=function(){a.prototype.dispose.call(this);this.m.dispose()};return e}(Pa),Va=function(a,e){this.subject=a;this.observer=e};Va.prototype.dispose=
function(){if(!this.subject.isDisposed&&null!==this.observer){var a=this.subject.observers.indexOf(this.observer);this.subject.observers.splice(a,1);this.observer=null}};var Ba=D.Subject=function(a){function e(a){ia(this);if(!this.isStopped)return this.observers.push(a),new Va(this,a);if(this.hasError)return a.onError(this.error),ka;a.onCompleted();return ka}function b(){a.call(this,e);this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}H(b,a);Ha(b.prototype,Aa.prototype,{hasObservers:function(){return 0<
this.observers.length},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;for(var a=0,e=g(this.observers),b=e.length;a<b;a++)e[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;for(var e=0,b=g(this.observers),d=b.length;e<d;e++)b[e].onError(a);this.observers.length=0}},onNext:function(a){ia(this);if(!this.isStopped)for(var e=0,b=g(this.observers),d=b.length;e<d;e++)b[e].onNext(a)},dispose:function(){this.isDisposed=
!0;this.observers=null}});b.create=function(a,e){return new kc(a,e)};return b}(N),Ua=D.AsyncSubject=function(a){function e(a){ia(this);if(!this.isStopped)return this.observers.push(a),new Va(this,a);if(this.hasError)a.onError(this.error);else{if(this.hasValue)a.onNext(this.value);a.onCompleted()}return ka}function b(){a.call(this,e);this.hasValue=this.isStopped=this.isDisposed=!1;this.observers=[];this.hasError=!1}H(b,a);Ha(b.prototype,Aa,{hasObservers:function(){ia(this);return 0<this.observers.length},
onCompleted:function(){var a,e;ia(this);if(!this.isStopped){this.isStopped=!0;var b=g(this.observers);e=b.length;if(this.hasValue)for(a=0;a<e;a++){var d=b[a];d.onNext(this.value);d.onCompleted()}else for(a=0;a<e;a++)b[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var e=0,b=g(this.observers),d=b.length;e<d;e++)b[e].onError(a);this.observers.length=0}},onNext:function(a){ia(this);this.isStopped||(this.value=
a,this.hasValue=!0)},dispose:function(){this.isDisposed=!0;this.value=this.exception=this.observers=null}});return b}(N),kc=D.AnonymousSubject=function(a){function e(a){return this.observable.subscribe(a)}function b(d,c){this.observer=d;this.observable=c;a.call(this,e)}H(b,a);Ha(b.prototype,Aa.prototype,{onCompleted:function(){this.observer.onCompleted()},onError:function(a){this.observer.onError(a)},onNext:function(a){this.observer.onNext(a)}});return b}(N),lb=D.BehaviorSubject=function(a){function e(a){ia(this);
if(!this.isStopped)return this.observers.push(a),a.onNext(this.value),new Va(this,a);if(this.hasError)a.onError(this.error);else a.onCompleted();return ka}function b(d){a.call(this,e);this.value=d;this.observers=[];this.hasError=this.isStopped=this.isDisposed=!1}H(b,a);Ha(b.prototype,Aa,{getValue:function(){ia(this);if(this.hasError)throw this.error;return this.value},hasObservers:function(){return 0<this.observers.length},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;for(var a=
0,e=g(this.observers),b=e.length;a<b;a++)e[a].onCompleted();this.observers.length=0}},onError:function(a){ia(this);if(!this.isStopped){this.hasError=this.isStopped=!0;this.error=a;for(var e=0,b=g(this.observers),d=b.length;e<d;e++)b[e].onError(a);this.observers.length=0}},onNext:function(a){ia(this);if(!this.isStopped){this.value=a;for(var e=0,b=g(this.observers),d=b.length;e<d;e++)b[e].onNext(a)}},dispose:function(){this.isDisposed=!0;this.exception=this.value=this.observers=null}});return b}(N),
mb=D.ReplaySubject=function(a){function e(a,e){return pa(function(){e.dispose();!a.isDisposed&&a.observers.splice(a.observers.indexOf(e),1)})}function b(a){a=new ub(this.scheduler,a);var d=e(this,a);ia(this);this._trim(this.scheduler.now());this.observers.push(a);for(var c=0,f=this.q.length;c<f;c++)a.onNext(this.q[c].value);if(this.hasError)a.onError(this.error);else if(this.isStopped)a.onCompleted();a.ensureActive();return d}function d(e,f,h){this.bufferSize=null==e?c:e;this.windowSize=null==f?c:
f;this.scheduler=h||ra;this.q=[];this.observers=[];this.hasError=this.isDisposed=this.isStopped=!1;this.error=null;a.call(this,b)}var c=Math.pow(2,53)-1;H(d,a);Ha(d.prototype,Aa.prototype,{hasObservers:function(){return 0<this.observers.length},_trim:function(a){for(;this.q.length>this.bufferSize;)this.q.shift();for(;0<this.q.length&&a-this.q[0].interval>this.windowSize;)this.q.shift()},onNext:function(a){ia(this);if(!this.isStopped){var e=this.scheduler.now();this.q.push({interval:e,value:a});this._trim(e);
for(var e=0,b=g(this.observers),d=b.length;e<d;e++){var c=b[e];c.onNext(a);c.ensureActive()}}},onError:function(a){ia(this);if(!this.isStopped){this.isStopped=!0;this.error=a;this.hasError=!0;var e=this.scheduler.now();this._trim(e);for(var e=0,b=g(this.observers),d=b.length;e<d;e++){var c=b[e];c.onError(a);c.ensureActive()}this.observers.length=0}},onCompleted:function(){ia(this);if(!this.isStopped){this.isStopped=!0;var a=this.scheduler.now();this._trim(a);for(var a=0,e=g(this.observers),b=e.length;a<
b;a++){var d=e[a];d.onCompleted();d.ensureActive()}this.observers.length=0}},dispose:function(){this.isDisposed=!0;this.observers=null}});return d}(N);D.Pauser=function(a){function e(){a.call(this)}H(e,a);e.prototype.pause=function(){this.onNext(!1)};e.prototype.resume=function(){this.onNext(!0)};return e}(Ba);r.exports=D}).call(k,function(){return this}(),c(14))},function(r,k,c){(function(n){function p(a,b,d){var c=3>=arguments.length||void 0===arguments[3]?null:arguments[3];this.name="RequestError";
this.url=a;this.xhr=b;this.code=b.status;this.reason=c;this.message="request: "+d+" ("+a+")";Error.captureStackTrace&&Error.captureStackTrace(this,p)}function g(a,b){var d=b.code,c=b.method,h=b.message;this.name="RestCallMethodError";this.url=a;this.code=d;this.message="restmethodcall: webservice error status "+d+" ("+a+")"+(c?" ("+c+")":"")+(h?"\n"+h:"");Error.captureStackTrace&&Error.captureStackTrace(this,g)}function a(a,b,d){a=a.querySelector("RestCallResult");var c=+a.querySelector("Status").textContent;
if(0>c)throw new g(b,{code:c,method:d});return{output:a.querySelector("Output"),status:c}}function b(a){return"rest-call-method"==a.format?d(a):v.create(function(b){function d(a){var c=a.target,f=c.status;if(200>f||300<=f)return b.onError(new p(h,c,c.statusText));var f=Date.now()-r,g;g="document"==q?(new n.DOMParser).parseFromString(c.responseText,"text/xml"):c.response;if("json"==q&&"string"==typeof g)try{g=JSON.parse(g)}catch(l){g=null}if(null==g)return b.onError(new p(h,c,'null response with format "'+
q+'" (error while parsing or wrong content-type)'));if(v){var t;if(w){t=w;for(var k={},G,da=0;da<t.length;da++)G=t[da],k[G]=c.getResponseHeader(G);t=k}b.onNext({blob:g,size:a.total,duration:f,headers:t,url:c.responseURL||h,xhr:c})}else b.onNext(g);b.onCompleted()}function c(a){b.onError(new p(h,a,"error event"))}var h=a.url,g=a.data,l=a.headers,q=a.format,v=a.withMetadata,w=a.responseHeaders,t=new XMLHttpRequest;t.open(a.method||"GET",h,!0);t.responseType="document"==q?"text":q||"text";if(l)for(var k in l)t.setRequestHeader(k,
l[k]);t.addEventListener("load",d,!1);t.addEventListener("error",c,!1);var r=Date.now();t.send(g);return function(){var a=t.readyState;0<a&&4>a&&(t.removeEventListener("load",d),t.removeEventListener("error",c),t.abort());t=null}})}function q(a){return(a||"").toString().replace(w,function(a){return l[a]})}function t(a){var b="",d;for(d in a)var c=a[d],c="object"==typeof c?t(c):q(c),b=b+("<"+d+">"+c+"</"+d+">");return b}function d(d){d.method="POST";d.headers={"Content-Type":"application/xml"};d.data=
h.replace("{payload}",t(d.data));d.format="document";return b(d).map(function(b){return a(b,d.url,d.ScriptInfo)})}var v=c(3).Observable;p.prototype=Error();g.prototype=Error();var w=/[&<>]/g,l={"&":"&amp;","<":"&lt;",">":"&gt;"},h='<RestCallMethod xmlns:i="http://www.w3.org/2001/XMLSchema-instance">{payload}</RestCallMethod>';b.escapeXml=q;b.RequestError=p;b.RestCallMethodError=g;b.RestCallResult=a;b.getNodeTextContent=function(a,b){var d=a.querySelector(b);return d&&d.textContent};r.exports=b}).call(k,
function(){return this}())},function(r,k){function c(){q=!1;t.length?b=t.concat(b):d=-1;b.length&&n()}function n(){if(!q){var a=setTimeout(c);q=!0;for(var g=b.length;g;){t=b;for(b=[];++d<g;)t&&t[d].run();d=-1;g=b.length}t=null;q=!1;clearTimeout(a)}}function p(a,b){this.fun=a;this.array=b}function g(){}var a=r.exports={},b=[],q=!1,t,d=-1;a.nextTick=function(a){var d=Array(arguments.length-1);if(1<arguments.length)for(var c=1;c<arguments.length;c++)d[c-1]=arguments[c];b.push(new p(a,d));1!==b.length||
q||setTimeout(n,0)};p.prototype.run=function(){this.fun.apply(null,this.array)};a.title="browser";a.browser=!0;a.env={};a.argv=[];a.version="";a.versions={};a.on=g;a.addListener=g;a.once=g;a.off=g;a.removeListener=g;a.removeAllListeners=g;a.emit=g;a.binding=function(a){throw Error("process.binding is not supported");};a.cwd=function(){return"/"};a.chdir=function(a){throw Error("process.chdir is not supported");};a.umask=function(){return 0}},function(r,k,c){function n(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function");
}function p(a){var b=[],d="optional",c="optional";a.persistentLicense?(d="required",b.push("persistent-license")):b.push("temporary");a.persistentStateRequired&&(d="required");a.distinctiveIdentifierRequired&&(c="required");return{videoCapabilities:void 0,audioCapabilities:void 0,initDataTypes:["cenc"],distinctiveIdentifier:c,persistentState:d,sessionTypes:b}}function g(a){if(U&&X&&!X.alwaysRenew){var b=w.find(a,function(a){return a.type==U.type&&a.persistentLicense==U.persistentLicense&&a.persistentStateRequired===
U.persistentStateRequired&&a.distinctiveIdentifierRequired==U.distinctiveIdentifierRequired});if(b)return l.debug("eme: found compatible keySystem quickly",b),K({keySystem:b,keySystemAccess:aa})}var d=w.flatten(a,function(a){return w.map(ca[a.type],function(b){return{keyType:b,keySystem:a}})});return y.create(function(a){function b(f){if(!c)if(f>=d.length)a.onError(Error("eme: could not find a compatible key system"));else{var h=d[f],g=h.keyType,q=h.keySystem,v=[p(q)];l.debug("eme: request keysystem access "+
g+","+(f+1+" of "+d.length),v);x(g,v).then(function(b){l.info("eme: found compatible keysystem",g,v);a.onNext({keySystem:q,keySystemAccess:b});a.onCompleted()},function(){l.debug("eme: rejected access to keysystem",g,v);b(f+1)})}}var c=!1;b(0);(function(){return c=!0})})}function a(a,b,d){return F(d.createMediaKeys().then(function(d){X=d;U=b;l.debug("eme: set mediakeys");return I(a,d).then(function(){return d})}))}function b(a,b,d){l.debug("eme: generate request",b,d);return F(a.generateRequest(b,
d).then(function(){return a}))}function q(a,b){l.debug("eme: load persisted session",b);return F(a.load(b).then(function(){return a}))}function t(a,b){var d=Error(a);b&&(d.reason=b);l.error(a,b);throw d;}function d(a){return w.isPromise(a)?F(a):w.isObservable(a)?a:K(a)}function v(c,f){function h(b,d){var f=d.keySystem,g=d.keySystemAccess;f.persistentLicense&&Z.setStorage(f.licenseStorage);var q=new Uint8Array(b.initData),t=b.initDataType;l.info("eme: encrypted event",b);return a(c,f,g).flatMap(function(a){return v(a,
f,t,q).tap(function(a){Z.add(q,a);V.add(a)},function(a){l.error("eme: error during session management handler",a)})}).flatMap(function(a){return u(a,f).tapOnError(function(b){l.error("eme: error in session messages handler",a,b);Z["delete"](q,a);V["delete"](a.sessionId)})})}function v(a,d,c,f){var h=Z.get(f),g=V.get(h);if(g)return l.debug("eme: reuse loaded session",h),K(g);var u=void 0,u=d.persistentLicense?"persistent-license":"temporary";l.debug("eme: create a "+u+" session");g=a.createSession(u);
return d.persistentLicense&&h?q(g,h)["catch"](function(d){l.warn("eme: failed to load persisted session, do fallback",h,d);Z["delete"](f,null);return F(V["delete"](h)).flatMap(function(){g=a.createSession(u);return b(g,c,f)})}):b(g,c,f)["catch"](function(d){var h=V.getFirst();if(!h)throw d;l.warn("eme: could not create a new session, retry after closing a currently loaded session",d);return F(h.close()).flatMap(function(){g=a.createSession(u);return b(g,c,f)})})}function u(a,b){var c=void 0,f=Q(a).map(function(a){return t("eme: keyerror event "+
a.errorCode+" / "+a.systemCode,a)}),h=O(a).flatMap(function(f){c=f.sessionId;l.debug("eme: keystatuseschange event",c,a,f);for(var h=a.keyStatuses.values(),g=h.next();!g.done;g=h.next())(g=M[g.value])&&t(g);if(!b.onKeyStatusesChange)return l.warn("eme: keystatuseschange event not handled"),B();h=void 0;try{h=b.onKeyStatusesChange(f,a)}catch(u){h=y["throw"](u)}return d(h)["catch"](function(a){return t("eme: onKeyStatusesChange has failed (reason: "+(a&&a.message||"unknown")+")",a)})}),g=S(a).flatMap(function(f){c=
f.sessionId;var h=f.message,g=f.messageType;g||(g="license-request");l.debug("eme: event message type "+g,a,f);f=void 0;try{f=b.getLicense(new Uint8Array(h),g)}catch(u){f=y["throw"](u)}return d(f)["catch"](function(a){return t("eme: getLicense has failed (reason: "+(a&&a.message||"unknown")+")",a)})}),h=E(g,h).concatMap(function(b){l.debug("eme: update session",c,b);return a.update(b,c)["catch"](function(a){return t("eme: error on session update "+c,a)})}).map(function(){return{type:"eme",value:{session:a,
name:"session-updated"}}});return E(h,f)}return y.create(function(a){var b=G(L(c),g(f),h).take(1).mergeAll().subscribe(a);return function(){b&&b.dispose();I(c,null)["catch"](function(a){return l.warn(a)})}})}var w=c(1),l=c(4),h=c(6),f=c(2),y=c(3).Observable,G=y.combineLatest,B=y.empty,F=y.fromPromise,E=y.merge,K=y.just;k=c(8);var x=k.requestMediaKeySystemAccess,I=k.setMediaKeys;k=k.emeEvents;var L=k.onEncrypted,S=k.onKeyMessage,Q=k.onKeyError,O=k.onKeyStatusesChange,ca={clearkey:["webkit-org.w3.clearkey",
"org.w3.clearkey"],widevine:["com.widevine.alpha"],playready:["com.youtube.playready","com.microsoft.playready"]},M={"output-not-allowed":"eme: the required output protection is not available.",expired:"eme: a required key has expired and the content cannot be decrypted.","internal-error":"eme: an unknown error has occurred in the CDM."};k=function(){function a(){n(this,a);this._hash={}}a.prototype.getFirst=function(){for(var a in this._hash)return this._hash[a]};a.prototype.get=function(a){return this._hash[a]};
a.prototype.add=function(a){var b=this,d=a.sessionId;f(d);this._hash[d]||(l.debug("eme-store: add persisted session in store",d),this._hash[d]=a,a.closed.then(function(){l.debug("eme-store: remove persisted session from store",d);delete b._hash[d]}))};a.prototype["delete"]=function(a){var b=this._hash[a];return b?(delete this._hash[a],b.close()):h.resolve()};a.prototype.dispose=function(){var a=[],b;for(b in this._hash)a.push(this._hash[b].close());this._hash={};return h.all(a)};return a}();var Z=
new (function(){function a(b){n(this,a);this.setStorage(b)}a.prototype.setStorage=function(a){if(this._storage!==a){f(a,"eme: no licenseStorage given for keySystem with persistentLicense");f.iface(a,"licenseStorage",{save:"function",load:"function"});this._storage=a;try{this._entries=this._storage.load(),f(Array.isArray(this._entries))}catch(b){l.warn("eme-store: could not get entries from license storage",b),this.dispose()}}};a.prototype.hashInitData=function(a){if("number"==typeof a)return a;for(var b=
0,d=void 0,c=0;c<a.length;c++)d=a[c],b=(b<<5)-b+d,b&=b;return b};a.prototype.get=function(a){a=this.hashInitData(a);var b=w.find(this._entries,function(b){return b.initData===a});if(b)return b.sessionId};a.prototype.add=function(a,b){a=this.hashInitData(a);if(!this.get(a)){var d=b.sessionId;f(d);l.info("eme-store: store new session",d,b);this._entries.push({sessionId:d,initData:a});this._save()}};a.prototype["delete"]=function(a,b){a=this.hashInitData(a);var d=w.find(this._entries,function(b){return b.initData===
a});d&&(l.warn("eme-store: delete session from store",d.sessionId),d=this._entries.indexOf(d),this._entries.splice(d,1),this._save());b&&(l.warn("eme-store: remove session from system",b.sessionId),b.remove())};a.prototype.dispose=function(){this._entries=[];this._save()};a.prototype._save=function(){try{this._storage.save(this._entries)}catch(a){l.warn("eme-store: could not save licenses in localStorage")}};return a}())({load:function(){return[]},save:function(){}}),V=new k,aa={createMediaKeys:function(){return h.resolve(X)}},
X=void 0,U=void 0;v.onEncrypted=L;v.getCurrentKeySystem=function(){return U&&U.type};v.dispose=function(){U=X=null;V.dispose()};r.exports=v},function(r,k,c){function n(a){this.name="OutOfIndexError";this.type=a;this.message="out of range in index "+a}function p(c){switch(c.indexType){case "template":return g;case "timeline":return a;case "list":return b;case "base":return q;default:throw Error("index-handler: unrecognized indexType "+c.indexType);}}c(2);var g=c(30),a=c(17),b=c(29),q=c(28);n.prototype=
Error();k=function(){function a(b,c){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");this.adaptation=b;this.representation=c;this.index=c.index;this.handler=new (p(this.index))(this.index)}a.prototype.getInitSegment=function(){var a=this.index.initialization||{};return{id:"init_"+this.adaptation.id+"_"+this.representation.id,init:!0,media:a.media,range:a.range,indexRange:this.index.indexRange}};a.prototype.normalizeRange=function(a,b,c){var g=this.index.presentationTimeOffset||
0,h=this.index.timescale||1;b||(b=0);c||(c=0);b=Math.min(b,c);return{time:a*h-g,up:(a+b)*h-g,to:(a+c)*h-g}};a.prototype.getSegments=function(a,b,c){a=this.normalizeRange(a,b,c);b=a.up;c=a.to;if(!this.handler.checkRange(a.time))throw new n(this.index.indexType);return this.handler.getSegments(b,c)};a.prototype.insertNewSegments=function(a,b){for(var c=[],g=0;g<a.length;g++)this.handler.addSegment(a[g],b)&&c.push(a[g]);return c};a.prototype.setTimescale=function(a){var b=this.index;return b.timescale!==
a?(b.timescale=a,!0):!1};a.prototype.scale=function(a){return a/this.index.timescale};return a}();r.exports={OutOfIndexError:n,IndexHandler:k,getLiveEdge:function(a){var b=a.adaptations.video[0].representations[0].index;return p(b).getLiveEdge(b,a)}}},function(r,k,c){function n(c){var a=c.ts,b=c.d;c=c.r;return-1===b?a:a+(c+1)*b}var p=c(1);k=function(){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=a;this.timeline=a.timeline}c.getLiveEdge=
function(a,b){var c=n(p.last(a.timeline))/a.timescale-b.suggestedPresentationDelay;return Math.max(a.timeline[0].ts/a.timescale+1,c)};c.prototype.createSegment=function(a,b,c){return{id:a,media:this.index.media,time:a,number:void 0,range:b,duration:c}};c.prototype.calculateRepeat=function(a,b){var c=a.r||0;0>c&&(c=Math.ceil(((b?b.t:Infinity)-a.ts)/a.d)-1);return c};c.prototype.checkRange=function(a){var b=p.last(this.timeline);if(!b)return!0;0>b.d&&(b={ts:b.ts,d:0,r:b.r});return a<=n(b)};c.prototype.getSegmentIndex=
function(a){for(var b=this.timeline,c=0,g=b.length;c<g;){var d=c+g>>>1;b[d].ts<a?c=d+1:g=d}return 0<c?c-1:c};c.prototype.getSegmentNumber=function(a,b,c){a=b-a;return 0<a?Math.floor(a/c):0};c.prototype.getSegments=function(a,b){var c=this.index.timeline,g=[],d=c.length,v=this.getSegmentIndex(a)-1,n=c.length&&c[0].d||0;a:for(;!(++v>=d);){var l=c[v],h=l.d,f=l.ts,p=l.range,n=Math.max(n,h);if(0>h){f+n<b&&g.push(this.createSegment(f,p,void 0));break}for(var l=this.calculateRepeat(l,c[v+1]),k=this.getSegmentNumber(f,
a,h),B;(B=f+k*h)<b;)if(k++<=l)g.push(this.createSegment(B,p,h));else continue a;break}return g};c.prototype.addSegment=function(a,b){var c=this.timeline,g=c.length,d=c[g-1];if(b&&a.ts===b.ts){var v=a.ts+a.d,p=v-(d.ts+d.d*d.r);if(0>=p)return!1;-1===d.d&&((g=c[g-2])&&g.d===p?(g.r++,c.pop()):d.d=p);c.push({d:-1,ts:v,r:0});return!0}return a.ts>=n(d)?(d.d===a.d?d.r++:c.push({d:a.d,ts:a.ts,r:0}),!0):!1};return c}();r.exports=k},function(r,k,c){function n(a,d,c){a.id=a.id||b.uniqueId();var g=a.adaptations,
g=g.concat(c||[]),g=b.map(g,function(a){return p(a,d)}),g=b.filter(g,function(a){return 0>l.indexOf(a.type)?(q.warn("not supported adaptation type",a.type),!1):!0});t(0<g.length);a.adaptations=b.groupBy(g,"type");return a}function p(d,c){t("undefined"!=typeof d.id);b.defaults(d,c);var g=b.pick(d,w),l=b.map(d.representations,function(a){t("undefined"!=typeof a.id);b.defaults(a,g);var d=a.index;t(d);d.timescale||(d.timescale=1);a.bitrate||(a.bitrate=1);"mp4a.40.02"==a.codecs&&(a.codecs="mp4a.40.2");
return a}).sort(function(a,b){return a.bitrate-b.bitrate}),q=d.type,n=d.mimeType;n||(n=l[0].mimeType);t(n);d.mimeType=n;q||(q=d.type=n.split("/")[0]);if("video"==q||"audio"==q)l=b.filter(l,function(b){return v(a(b))});t(0<l.length,"manifest: no compatible representation for this adaptation");d.representations=l;d.bitrates=b.pluck(l,"bitrate");return d}function g(a){b.isArray(a)||(a=[a]);return b.flatten(a,function(a){var d=a.mimeType,c=a.url,h=a.language;a=a.languages;h&&(a=[h]);return b.map(a,function(a){return{id:b.uniqueId(),
type:"text",lang:a,mimeType:d,rootURL:c,baseURL:"",representations:[{id:b.uniqueId(),mimeType:d,index:{indexType:"template",duration:Number.MAX_VALUE,timescale:1,startNumber:0}}]}})})}function a(a){return a.mimeType+';codecs="'+a.codecs+'"'}var b=c(1),q=c(4),t=c(2),d=c(11).parseBaseURL,v=c(8).isCodecSupported,w="profiles width height frameRate audioSamplingRate mimeType segmentProfiles codecs maximumSAPPeriod maxPlayoutRate codingDependency index".split(" "),l=["audio","video","text"];r.exports={normalizeManifest:function(a,
c,l){t(c.transportType);c.id=c.id||b.uniqueId();c.type=c.type||"static";var q=c.locations;q&&q.length||(c.locations=[a]);c.isLive="dynamic"==c.type;var v={rootURL:d(c.locations[0]),baseURL:c.baseURL,isLive:c.isLive};l&&(l=g(l));a=b.map(c.periods,function(a){return n(a,v,l)});b.extend(c,a[0]);c.periods=null;c.duration||(c.duration=Infinity);c.isLive&&(c.suggestedPresentationDelay=c.suggestedPresentationDelay||15,c.availabilityStartTime=c.availabilityStartTime||0);return c},mergeManifestsIndex:function(a,
d){var c=a.adaptations,g=d.adaptations,l;for(l in c){var q=g[l];b.each(c[l],function(a,d){b.simpleMerge(a.index,q[d].index)})}return a},mutateManifestLiveGap:function(a){var b=1>=arguments.length||void 0===arguments[1]?1:arguments[1];a.isLive&&(a.presentationLiveGap+=b)},getCodec:a,getAdaptations:function(d){var c=d.adaptations,g=[];b.each(b.keys(c),function(b){var d=c[b];g.push({type:b,adaptations:d,codec:a(d[0].representations[0])})});return g},getAvailableSubtitles:function(a){return b.pluck(a.adaptations.text,
"lang")},getAvailableLanguages:function(a){return b.pluck(a.adaptations.audio,"lang")}}},function(r,k,c){function n(a,b){var c=a.playbackRate,n=a.duration,d=a.currentTime,v=a.readyState,p=new g(a.buffered),l=p.getRange(d),h=p.getGap(d);return{name:b,ts:d,range:l,gap:h,duration:n,playback:c,readyState:v,stalled:null,buffered:p}}var p=c(3).Observable,g=c(9).BufferedRanges;r.exports={timingsSampler:function(a){return p.create(function(b){function c(d){var q=g,l=d&&d.type||"timeupdate";d=n(a,l);var q=
q.stalled,h=d.gap;(l="loadedmetadata"==l||q)||(l=(l=d.range)?.5>=d.duration-(h+l.end):!1);d.stalled=l||!(.5>=h||Infinity===h)?q&&Infinity>h&&h>("seeking"==q.name?.5:5)?null:q:{name:d.name,playback:d.playback};g=d;b.onNext(g)}var g=n(a,"init"),d=setInterval(c,1E3);a.addEventListener("play",c);a.addEventListener("progress",c);a.addEventListener("seeking",c);a.addEventListener("seeked",c);a.addEventListener("loadedmetadata",c);b.onNext(g);return function(){clearInterval(d);a.removeEventListener("play",
c);a.removeEventListener("progress",c);a.removeEventListener("seeking",c);a.removeEventListener("seeked",c);a.removeEventListener("loadedmetadata",c)}}).shareValue({name:"init",stalled:null})},seekingsSampler:function(a){return a.filter(function(a){return"seeking"==a.name&&(Infinity===a.gap||-2>a.gap)}).skip(1).startWith(!0)},getLiveGap:function(a,b){if(!b.isLive)return Infinity;var c=b.availabilityStartTime,g=b.presentationLiveGap;return Date.now()/1E3-a-(c+g+10)},toWallClockTime:function(a,b){return new Date(1E3*
(a+b.availabilityStartTime))},fromWallClockTime:function(a,b){var c=a,g=b.suggestedPresentationDelay,d=b.presentationLiveGap,n=b.timeShiftBufferDepth;"number"!=typeof c&&(c=c.getTime());var p=Date.now(),n=p-1E3*n;return Math.max(Math.min(c,p-1E3*(d+g)),n)/1E3-b.availabilityStartTime}}},function(r,k){function c(c){var p=.3*(2*Math.random()-1);return c*(1+p)}r.exports={getFuzzedDelay:c,getBackedoffDelay:function(n){return c(n*Math.pow(2,(1>=arguments.length||void 0===arguments[1]?1:arguments[1])-1))}}},
function(r,k){r.exports=function(c,n,p){function g(){var a=q-Date.now();if(0<a)b=setTimeout(g,a);else switch(b=null,k.length){case 0:return c();case 1:return c(k[0]);case 2:return c(k[0],k[1]);case 3:return c(k[0],k[1],k[2]);default:return c.apply(null,k)}}function a(){var c=arguments.length,l=0;for(k=Array(c);l<c;l++)k[l]=arguments[l];if(d&&!v)return v=!0,q=Date.now(),g();c=q;q=Date.now()+n;if(!b||q<c)b&&clearTimeout(b),b=setTimeout(g,n);return a}var b=null,q=0,k=[],d=!(!p||!p.leading),v=!1;a.isWaiting=
function(){return!!b};a.dispose=function(){b&&(clearTimeout(b),b=null)};return a}},function(r,k){r.exports=function(c){c.webpackPolyfill||(c.deprecate=function(){},c.paths=[],c.children=[],c.webpackPolyfill=1);return c}},function(r,k){function c(c){return function(p,g){return null==p?g:c*g+(1-c)*p}}r.exports=function(n,p){return n.map(function(c){return c.value.response}).filter(function(c){return 2E3<c.size}).map(function(c){return c.size/c.duration*8E3}).scan(c(p.alpha))}},function(r,k,c){function n(a,
b){return"number"==typeof a&&0<a?a:b}function p(a,b){var d=2>=arguments.length||void 0===arguments[2]?0:arguments[2];return q.findLast(a,function(a){return a/b<=1-d})||a[0]}function g(a,b){var d=q.find(a,function(a){return a.width>=b});return d?d.bitrate:Infinity}function a(a,b){return b?q.find(a,function(a){return a.lang===b}):null}function b(a,b){return a.filter(function(a){return a.type===b})}var q=c(1),t=c(4);k=c(3);var d=k.BehaviorSubject,v=k.CompositeDisposable,w=k.Observable.combineLatest,
l=c(5).only,h=c(23),f={defLanguage:"fra",defSubtitle:"",defBufSize:30,defBufThreshold:.3};r.exports=function(c,k,B){function r(b){return M.changes().map(function(d){return a(b,d)||b[0]})}function E(b){return Z.changes().map(function(d){return a(b,d)})}var K=q.defaults(3>=arguments.length||void 0===arguments[3]?{}:arguments[3],f),x=K.defSubtitle,I=K.defBufSize,L=K.defBufThreshold,S=K.initVideoBitrate,Q=K.initAudioBitrate,O=B.videoWidth,ca=B.inBackground,M=new d(K.defLanguage),Z=new d(x),V={audio:h(b(c,
"audio"),{alpha:.6}).publishValue(Q||0),video:h(b(c,"video"),{alpha:.6}).publishValue(S||0)},aa=new v(q.map(q.values(V),function(a){return a.connect()})),X={audio:new d(Infinity),video:new d(Infinity)},U={audio:new d(Infinity),video:new d(Infinity)},R={audio:new d(I),video:new d(I),text:new d(I)};return{setLanguage:function(a){M.onNext(a)},setSubtitle:function(a){Z.onNext(a)},getLanguage:function(){return M.value},getSubtitle:function(){return Z.value},getAverageBitrates:function(){return V},getAudioMaxBitrate:function(){return U.audio.value},
getVideoMaxBitrate:function(){return U.video.value},getAudioBufferSize:function(){return R.audio.value},getVideoBufferSize:function(){return R.video.value},setAudioBitrate:function(a){X.audio.onNext(n(a,Infinity))},setVideoBitrate:function(a){X.video.onNext(n(a,Infinity))},setAudioMaxBitrate:function(a){U.audio.onNext(n(a,Infinity))},setVideoMaxBitrate:function(a){U.video.onNext(n(a,Infinity))},setAudioBufferSize:function(a){R.audio.onNext(n(a,I))},setVideoBufferSize:function(a){R.video.onNext(n(a,
I))},getBufferAdapters:function(a){var b=a.type,c=a.bitrates,f=a.representations;a=f[0];if(1<f.length){a=X[b];var h=U[b],n=V[b].map(function(a,b){return p(c,a,0===b?0:L)}).changes().customDebounce(2E3,{leading:!0});"video"==b&&(h=w(h,O,ca,function(a,b,d){if(d)return c[0];b=g(f,b);return b<a?b:a}));a=w(a,h,n,function(a,b,d){return Infinity>a?a:Infinity>b?Math.min(b,d):d}).map(function(a){return q.find(f,function(b){return b.bitrate===p(c,a)})}).changes(function(a){return a.id}).tap(function(a){return t.info("bitrate",
b,a.bitrate)})}else a=l(a);return{representations:a,bufferSizes:R[b]||new d(I)}},getAdaptationsChoice:function(a,b){if("audio"==a)return r(b);if("text"==a)return E(b);if(1==b.length)return l(b[0]);throw Error("adaptive: unknown type "+a+" for adaptation chooser");},dispose:function(){aa&&(aa.dispose(),aa=null)}}}},function(r,k,c){var n=c(1),p=c(4);c(2);var g=c(9).BufferedRanges;k=c(3);var a=k.Observable,b=k.Subject,q=a.combineLatest,t=a.defer,d=a.empty,v=a.from,w=a.just,l=a.merge,h=a.timer;k=c(5);
var f=k.first,y=k.on,G=c(46).ArraySet;c=c(16);var B=c.IndexHandler,F=c.OutOfIndexError;r.exports=function(a){function c(a){L.appendBuffer(a);return f(la)}function k(a){return t(function(){return L.updating?f(la).flatMap(function(){return c(a)}):c(a)})}function r(a){function b(d){if(t.test(d.id))return!1;if(d.init||null==d.time)return!0;var c=f.scale(d.time);d=f.scale(d.duration);return(c=da.hasRange(c,d))?1.5*c.bitrate<a.bitrate:!0}function c(b,d,g,h){var l=[];h&&(p.debug("add init segment",M),l.push(f.getInitSegment()));
if(0===d.readyState)return l;h=d.ts;d=Math.max(0,Math.min(g,d.liveGap,(d.duration||Infinity)-h));b=b.getGap(h);b=b>aa&&Infinity>b?Math.min(b,X):0;(g=da.getRange(h))&&g.bitrate===a.bitrate&&(g=Math.floor(g.end-h),g>b&&(b=g));h=f.getSegments(h,b,d);return l.concat(h)}var f=new B(S,a),t=new G,y=q(ca,R,ta,function(a,b){return{timing:a,bufferSize:b}}).flatMap(function(f,h){var l=f.timing,q=f.bufferSize,k=new g(L.buffered);Z&&!da.equals(k)&&(p.debug("intersect new buffer",M),da.intersect(k));var aa;try{aa=
c(k,l,q,0===h),aa=n.filter(aa,b)}catch(y){if(y instanceof F)return V.onNext({type:"out-of-index",value:y}),d();throw y;}return v(n.map(aa,function(b){t.add(b.id);return{adaptation:S,representation:a,segment:b}}))}).concatMap(Q).concatMap(function(a){return k(a.parsed.blob).map(a)}).map(function(b){var d=b.parsed;t.remove(b.segment.id);var c=d.timescale;c&&f.setTimescale(c);c=d.nextSegments;d=d.currentSegment;c=c?f.insertNewSegments(c,d):[];d&&da.insert(a.bitrate,f.scale(d.ts),f.scale(d.ts+d.d));return{type:"segment",
value:n.extend({addedSegments:c},b)}});return l(y,V)["catch"](function(b){if(412!==b.code)throw b;return w({type:"precondition-failed",value:b}).concat(h(2E3)).concat(r(a))})}var L=a.sourceBuffer,S=a.adaptation,Q=a.pipeline,O=a.adapters,ca=a.timings;a=a.seekings;var M=S.type,Z="audio"==M||"video"==M,V=new b,aa="video"==M?4:1,X="video"==M?6:1,U=O.representations,R=O.bufferSizes,da=new g,la=l(y(L,"update"),y(L,"error").map(function(a){p.error("buffer: error event",a);throw Error("buffer: error event");
})).share(),ta=la.ignoreElements().startWith(!0);return q(U,a,n.identity).flatMapLatest(r)}},function(r,k){var c=function(){function c(){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.cache={}}c.prototype.add=function(c,g){var a=c.segment;a.init&&(this.cache[a.id]=g)};c.prototype.get=function(c){c=c.segment;return c.init&&(c=this.cache[c.id],null!=c)?c:null};return c}();r.exports={InitializationSegmentCache:c}},function(r,k,c){k=c(3).Observable;var n=k.merge,
p=k.interval;c=c(8);var g=c.visibilityChange,a=c.videoSizeChange,b=window.devicePixelRatio||1;r.exports=function(c){var k=g().filter(function(a){return!1===a}),d=g().customDebounce(6E4).filter(function(a){return!0===a}),k=n(k,d).startWith(!1);return{videoWidth:n(p(2E4),a().customDebounce(500)).startWith("init").map(function(){return c.clientWidth*b}).changes(),inBackground:k}}},function(r,k,c){function n(c,g){if("function"!==typeof g&&null!==g)throw new TypeError("Super expression must either be null or a function, not "+
typeof g);c.prototype=Object.create(g&&g.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});g&&(Object.setPrototypeOf?Object.setPrototypeOf(c,g):c.__proto__=g)}k=function(c){function g(a){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");c.call(this,a)}n(g,c);g.getLiveEdge=function(){throw Error("not implemented");};g.prototype.addSegment=function(a){this.index.timeline.push(a);return!0};return g}(c(17));r.exports=k},function(r,k){var c=function(){function c(k){if(!(this instanceof
c))throw new TypeError("Cannot call a class as a function");this.index=k}c.getLiveEdge=function(){throw Error("not implemented");};c.prototype.checkRange=function(c){var g=this.index,a=g.list;c=Math.floor(c/g.duration);return 0<=c&&c<a.length};c.prototype.createSegment=function(c,g){var a=this.index.list[c];return{id:c,media:a.media,time:g,number:void 0,range:a.range,duration:this.index.duration}};c.prototype.getSegments=function(c,g){for(var a=this.index.duration,b=Math.floor(c/a),k=Math.floor(g/
a),n=[];b<k;)n.push(this.createSegment(b,b*a)),b++;return n};c.prototype.addSegment=function(){return!1};return c}();r.exports=c},function(r,k){var c=function(){function c(k){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.index=k}c.getLiveEdge=function(c,g){return Date.now()/1E3-g.availabilityStartTime-g.suggestedPresentationDelay};c.prototype.checkRange=function(){return!0};c.prototype.createSegment=function(c){var g=this.index,a=g.startNumber,g=g.duration;
null==a&&(a=1);c=Math.floor(c/g)+a;return{id:c,media:this.index.media,time:c*g,number:c,range:void 0,duration:this.index.duration}};c.prototype.getSegments=function(c,g){for(var a=this.index.duration,b=[],k=c;k<=g;k+=a)b.push(this.createSegment(k));return b};c.prototype.addSegment=function(){return!1};return c}();r.exports=c},function(r,k,c){function n(d,c,g){function l(a){return f(a).simpleTimeout(r,"timeout").map(function(b){b=p.extend({response:b},a);F.add(a,b);g.onNext({type:d,value:b});return b})}
var h=c.resolver,f=c.loader,k=c.parser,n=3>=arguments.length||void 0===arguments[3]?{}:arguments[3];k||(k=q);f||(f=q);h||(h=q);var n=p.defaults(n,{totalRetry:3,timeout:1E4,cache:t}),r=n.timeout,F=n.cache,E={retryDelay:500,totalRetry:n.totalRetry,shouldRetry:function(a){return 500<=a.code||200>a.code||/timeout/.test(a.message)||/request: error event/.test(a.message)}};return function(d){return h(d).flatMap(function(d){var c=a(function(){return l(d)},E),f=F.get(d);return p.isPromise(f)?b(f)["catch"](c):
null===f?c():q(f)}).flatMap(function(a){return k(a).map(function(b){return p.extend({parsed:b},a)})})}}var p=c(1);k=c(3);var g=k.Subject;k=k.Observable;var a=c(5).retryWithBackoff,b=k.fromPromise,q=k.just,t={add:function(){},get:function(){return null}};r.exports=function(){var a=new g;return{createPipelines:function(b,c){c=c||{};var g=[],h;for(h in b)g[h]=n(h,b[h],a,c[h]);return g},metrics:a}}},function(r,k,c){function n(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+
typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}function p(a){B(a.man,"player: no manifest loaded")}function g(a,b){return a.filter(function(a){return a.type==b}).pluck("value")}var a=c(6),b=c(1),q=c(4);k=c(3);var t=k.CompositeDisposable,d=k.BehaviorSubject,v=k.Observable,w=k.Subject,l=v.combineLatest,h=v.defer,f=v.zip,y=c(5).on;k=c(10);var G=c(47),B=c(2),v=c(8),
F=v.HTMLVideoElement_,E=v.exitFullscreen,K=v.requestFullscreen,x=v.isFullscreen,I=v.onFullscreenChange,v=c(19),L=v.timingsSampler,S=v.toWallClockTime,Q=v.fromWallClockTime,O=v.getLiveGap,ca=c(26).InitializationSegmentCache,M=c(9).BufferedRanges,Z=c(36).parseTimeFragment,V=c(27),aa=c(18),X=c(40),U=c(31),R=c(24),da=c(34),la=c(15);c=function(c){function u(a){var b=this;if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");var f=a.videoElement,g=a.transport,h=a.transportOptions,
l=a.initVideoBitrate;a=a.initAudioBitrate;c.call(this);this.defaultTransport=g;this.defaultTransportOptions=h||{};f||(f=document.createElement("video"));B(f instanceof F,"requires an actual HTMLVideoElement");f.preload="auto";this.version="1.3.0";this.video=f;this.fullscreen=I(f).subscribe(function(){return b.trigger("fullscreenChange",b.isFullscreen())});this.playing=new d;this.stream=new w;var h=U(),g=h.createPipelines,h=h.metrics,k=L(f),f=V(f);this.createPipelines=g;this.metrics=h;this.timings=
k;this.adaptive=R(h,k,f,{initVideoBitrate:l,initAudioBitrate:a});this.muted=.1;this._setState("STOPPED");this.resetStates();this.log=q}n(u,c);u.prototype.resetStates=function(){this.man=null;this.reps={video:null,audio:null,text:null};this.adas={video:null,audio:null,text:null};this.evts={};this.frag={start:null,end:null}};u.prototype._clear=function(){this.subscriptions&&(this.subscriptions.dispose(),this.subscriptions=null)};u.prototype.stop=function(){"STOPPED"!==this.state&&(this.resetStates(),
this._clear(),this._setState("STOPPED"))};u.prototype.dispose=function(){this.stop();this.metrics.dispose();this.adaptive.dispose();this.fullscreen.dispose();this.stream.dispose();this.video=this.createPipelines=this.timings=this.stream=this.fullscreen=this.adaptive=this.metrics=null};u.prototype.__recordState=function(a,b){this.evts[a]!==b&&(this.evts[a]=b,this.trigger(a+"Change",b))};u.prototype._parseOptions=function(a){var d=b.defaults(b.cloneObject(a),{transport:this.defaultTransport,transportOptions:{},
keySystems:[],timeFragment:{},subtitles:[],autoPlay:!1,directFile:!1}),c=d.transport,f=d.transportOptions,g=d.url,h=d.manifests,l=d.keySystems,u=d.timeFragment,k=d.subtitles,n=d.autoPlay,d=d.directFile,u=Z(u);B(!!h^!!g,"player: you have to pass either a url or a list of manifests");h&&(l=h[0],g=l.url,k=l.subtitles||[],l=b.compact(b.pluck(h,"keySystem")));b.isString(c)&&(c=X[c]);b.isFunction(c)&&(c=c(b.defaults(f,this.defaultTransportOptions)));B(c,"player: transport "+a.transport+" is not supported");
d&&(d={isLive:!1,duration:Infinity});return{url:g,keySystems:l,subtitles:k,timeFragment:u,autoPlay:n,transport:c,directFile:d}};u.prototype.loadVideo=function(){var a=this,d=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],d=this._parseOptions(d);q.info("loadvideo",d);var c=d,u=c.url,k=c.keySystems,n=c.subtitles,v=c.timeFragment,M=c.autoPlay,d=c.transport,L=c.directFile;this.stop();this.frag=v;this.playing.onNext(M);var aa=this.createPipelines(d,{audio:{cache:new ca},video:{cache:new ca}}),
p=this.adaptive,d=this.timings,c=this.video,w;try{w=da({url:u,keySystems:k,subtitles:n,timings:d,timeFragment:v,adaptive:p,pipelines:aa,videoElement:c,autoPlay:M,directFile:L})}catch(X){w=h(function(){throw X;})}w=w.publish();var u=g(w,"segment"),k=g(w,"manifest"),n=g(w,"stalled").startWith(null),v=g(w,"loaded").filter(function(a){return!0===a}),L=L?v:f(v,g(u.pluck("adaptation"),"audio"),g(u.pluck("adaptation"),"video"),b.noop),L=L.take(1),n=L.map("LOADED").concat(l(this.playing,n,function(a,b){return b?
"seeking"==b.name?"SEEKING":"BUFFERING":a?"PLAYING":"PAUSED"})).changes().startWith("LOADING"),Q=this.subscriptions=new t;w=[y(c,["play","pause"]).each(function(b){return a.playing.onNext("play"==b.type)}),u.each(function(b){var d=b.adaptation.type,c=b.representation,f=b.adaptation;a.reps[d]=c;a.adas[d]=f;"text"==d&&a.__recordState("subtitle",f.lang);"video"==d&&a.__recordState("videoBitrate",c.bitrate);"audio"==d&&(a.__recordState("language",f.lang),a.__recordState("audioBitrate",c.bitrate));a.trigger("progress",
b)}),k.each(function(b){a.man=b;a.trigger("manifestChange",b)}),n.each(function(b){return a._setState(b)}),d.each(function(b){a.man&&(a.man.isLive&&0<b.ts&&(b.wallClockTime=S(b.ts,a.man),b.liveGap=O(b.ts,a.man)),a.trigger("currentTimeChange",b))}),w.subscribe(function(){},function(b){a.resetStates();a.trigger("error",b);a._setState("STOPPED");a._clear()},function(){a.resetStates();a._setState("ENDED");a._clear()}),w.subscribe(function(b){return a.stream.onNext(b)},function(b){return a.stream.onNext({type:"error",
value:b})}),w.connect()];b.each(w,function(a){return Q.add(a)});this.subscriptions||Q.dispose();return L.toPromise()};u.prototype._setState=function(a){this.state!==a&&(this.state=a,this.trigger("playerStateChange",a))};u.prototype.getManifest=function(){return this.man};u.prototype.getVideoElement=function(){return this.video};u.prototype.getNativeTextTrack=function(){return this.video.textTracks[0]};u.prototype.getPlayerState=function(){return this.state};u.prototype.isLive=function(){p(this);return this.man.isLive};
u.prototype.getUrl=function(){p(this);return this.man.locations[0]};u.prototype.getVideoDuration=function(){return this.video.duration};u.prototype.getVideoLoadedTime=function(){return(new M(this.video.buffered)).getSize(this.video.currentTime)};u.prototype.getVideoPlayedTime=function(){return(new M(this.video.buffered)).getLoaded(this.video.currentTime)};u.prototype.getCurrentTime=function(){if(!this.man)return NaN;var a=this.video.currentTime;return this.man.isLive?S(a,this.man):a};u.prototype.getStartTime=
function(){return this.frag.start};u.prototype.getEndTime=function(){return this.frag.end};u.prototype.getPlaybackRate=function(){return this.video.playbackRate};u.prototype.getVolume=function(){return this.video.volume};u.prototype.isFullscreen=function(){return x()};u.prototype.getAvailableLanguages=function(){return this.man&&aa.getAvailableLanguages(this.man)||[]};u.prototype.getAvailableSubtitles=function(){return this.man&&aa.getAvailableSubtitles(this.man)||[]};u.prototype.getLanguage=function(){return this.adaptive.getLanguage()};
u.prototype.getSubtitle=function(){return this.adaptive.getSubtitle()};u.prototype.getAvailableVideoBitrates=function(){var a=this.man&&this.man.adaptations.video[0];return a&&a.bitrates||[]};u.prototype.getAvailableAudioBitrates=function(){var a=this.adas.audio;return a&&a.bitrates||[]};u.prototype.getVideoBitrate=function(){return this.evts.videoBitrate};u.prototype.getAudioBitrate=function(){return this.evts.audioBitrate};u.prototype.getVideoMaxBitrate=function(){return this.adaptive.getVideoMaxBitrate()};
u.prototype.getAudioMaxBitrate=function(){return this.adaptive.getAudioMaxBitrate()};u.prototype.getVideoBufferSize=function(){return this.adaptive.getVideoBufferSize()};u.prototype.getAudioBufferSize=function(){return this.adaptive.getAudioBufferSize()};u.prototype.getAverageBitrates=function(){return this.adaptive.getAverageBitrates()};u.prototype.getMetrics=function(){return this.metrics};u.prototype.getTimings=function(){return this.timings};u.prototype.play=function(){this.video.play()};u.prototype.pause=
function(){this.video.pause()};u.prototype.setPlaybackRate=function(b){var d=this;return new a(function(a){return a(d.video.playbackRate=b)})};u.prototype.goToStart=function(){return this.seekTo(this.getStartTime())};u.prototype.seekTo=function(b){var d=this;return new a(function(a){B(d.man);var c=d.video.currentTime;d.man.isLive&&(b=Q(b,d.man));b!==c?(q.info("seek to",b),a(d.video.currentTime=b)):a(c)})};u.prototype.setFullscreen=function(){!1===(0>=arguments.length||void 0===arguments[0]?!0:arguments[0])?
E():K(this.video)};u.prototype.setVolume=function(a){a!==this.video.volume&&(this.video.volume=a,this.trigger("volumeChange",a))};u.prototype.mute=function(){this.muted=this.getVolume()||.1;this.setVolume(0)};u.prototype.unMute=function(){0===this.getVolume()&&this.setVolume(this.muted)};u.prototype.setLanguage=function(d){var c=this;return new a(function(a){B(b.contains(c.getAvailableLanguages(),d),"player: unknown language");a(c.adaptive.setLanguage(d))})};u.prototype.setSubtitle=function(d){var c=
this;return(new a(function(a){B(!d||b.contains(c.getAvailableSubtitles(),d),"player: unknown subtitle");a(c.adaptive.setSubtitle(d||""))})).then(function(){d||c.__recordState("subtitle",null)})};u.prototype.setVideoBitrate=function(d){var c=this;return new a(function(a){B(0===d||b.contains(c.getAvailableVideoBitrates(),d),"player: video bitrate unavailable");a(c.adaptive.setVideoBitrate(d))})};u.prototype.setAudioBitrate=function(d){var c=this;return new a(function(a){B(0===d||b.contains(c.getAvailableAudioBitrates(),
d),"player: audio bitrate unavailable");a(c.adaptive.setAudioBitrate(d))})};u.prototype.setVideoMaxBitrate=function(b){var d=this;return new a(function(a){a(d.adaptive.setVideoMaxBitrate(b))})};u.prototype.setAudioMaxBitrate=function(b){var d=this;return new a(function(a){a(d.adaptive.setAudioMaxBitrate(b))})};u.prototype.setVideoBufferSize=function(b){var d=this;return new a(function(a){return a(d.adaptive.setVideoBufferSize(b))})};u.prototype.setAudioBufferSize=function(b){var d=this;return new a(function(a){return a(d.adaptive.setAudioBufferSize(b))})};
u.prototype.getStreamObservable=function(){return this.stream};u.prototype.getDebug=function(){return G.getDebug(this)};u.prototype.showDebug=function(){G.showDebug(this,this.video)};u.prototype.hideDebug=function(){G.hideDebug()};u.prototype.toggleDebug=function(){G.toggleDebug(this,this.video)};u.prototype.getCurrentKeySystem=function(){return la.getCurrentKeySystem()};return u}(k);r.exports=c},function(r,k,c){function n(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+
typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}k=c(10);var p=c(9).BufferedRanges,g=c(6),a=c(2);c=function(b){function c(a){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this);this.codec=a;this.updating=!1;this.readyState="opened";this.buffered=new p}n(c,b);c.prototype.appendBuffer=function(a){var b=this;return this._lock(function(){return b._append(a)})};
c.prototype.remove=function(a,b){var c=this;return this._lock(function(){return c._remove(a,b)})};c.prototype.abort=function(){this.remove(0,Infinity);this.updating=!1;this.readyState="closed";this._abort()};c.prototype._append=function(){};c.prototype._remove=function(){};c.prototype._abort=function(){};c.prototype._lock=function(b){var d=this;a(!this.updating,"text-buffer: cannot remove while updating");this.updating=!0;this.trigger("updatestart");return(new g(function(a){return a(b())})).then(function(){return d._unlock("update")},
function(a){return d._unlock("error",a)})};c.prototype._unlock=function(a,b){this.trigger(a,b);this.updating=!1;this.trigger("updateend")};return c}(k);r.exports=c},function(r,k,c){function n(a,b){return q.create(function(d){b.src=a;d.onNext({url:a});return function(){b.src=""}})}function p(a){return"audio"==a||"video"==a}var g=c(1),a=c(4),b=c(2),q=c(3).Observable;k=c(5);var t=k.first,d=k.on;k=c(19);var v=k.getLiveGap,w=k.seekingsSampler,l=k.fromWallClockTime,h=c(5).retryWithBackoff,f=q.empty,y=q.never,
G=q.just,B=q.merge,F=q.zip,E=Math.min;k=c(8);var K=k.MediaSource_,x=k.sourceOpen,I=k.loadedMetadataEvent,L=c(35),S=c(16).getLiveEdge,Q=c(25),O=c(15);c=c(18);var ca=c.normalizeManifest,M=c.mergeManifestsIndex,Z=c.mutateManifestLiveGap,V=c.getAdaptations;r.exports=function(c){function k(b,d,c){var f=c.type;c=c.codec;if(p(f))sa[f]?b=sa[f]:(a.info("add sourcebuffer",c),b=d.addSourceBuffer(c),sa[f]=b);else{if(d=wa[f])try{d.abort()}catch(g){a.warn(g)}finally{delete wa[f]}if("text"==f)a.info("add text sourcebuffer",
c),b=new L(b,c);else throw f="stream: unknown buffer type "+f,a.error(f),Error(f);wa[f]=b}return b}function r(b,d,c){b=c.type;var f=p(b);f?(c=sa[b],delete sa[b]):(c=wa[b],delete wa[b]);if(c)try{c.abort(),f&&d.removeSourceBuffer(c)}catch(g){a.warn(g)}}function R(a){var b=Y.map(function(b){var d;Ga?(d=g.cloneObject(b),d.ts=E(b.ts,va),d.duration=E(b.duration,va)):d=b;d.liveGap=v(b.ts,a);return d}),d=w(b);return{timings:b,seekings:d}}function da(b,d,c,g){var h=d.type;return La.getAdaptationsChoice(h,
d.adaptations).flatMapLatest(function(l){if(!l)return r(ga,b,d),y();var u=La.getBufferAdapters(l);l=Q({sourceBuffer:k(ga,b,d),pipeline:Ma[h],adaptation:l,timings:c,seekings:g,adapters:u});return p(h)?l:l["catch"](function(b){a.error("buffer",h,"has crashed",b);return f()})})}function la(c){var f=I(ga).tap(function(){var d=c.duration,f=Fa,h=va,u=/^\d*(\.\d+)? ?%$/;g.isString(f)&&u.test(f)&&(f=parseFloat(f)/100*d);g.isString(h)&&u.test(h)&&(va=parseFloat(h)/100*d);if(Infinity===h||"100%"===h)h=d;c.isLive?
f=f?l(f,c):S(c):b(f<d&&h<=d,"stream: bad startTime and endTime");a.info("set initial time",f);ga.currentTime=f}),h=d(ga,"canplay").tap(function(){a.info("canplay event");ya&&ga.play();ya=!0});return t(F(f,h,g.noop)).map({type:"loaded",value:!0}).startWith({type:"loaded",value:!1})}function ta(){return Ka&&Ka.length?O(ga,Ka):O.onEncrypted(ga).map(function(){a.error("eme: ciphered media and no keySystem passed");throw Error("eme: ciphered media and no keySystem passed");})}function u(b){var d=1>=arguments.length||
void 0===arguments[1]?!0:arguments[1];return b.distinctUntilChanged(null,function(b,c){var f=c.stalled,h=b.stalled,g;g=h||f?h&&f?h.name==f.name:!1:!0;!g&&d&&(h?(a.warn("resume playback",c.ts,c.name),ga.playbackRate=h.playback):(a.warn("stop playback",c.ts,c.name),ga.playbackRate=0));f&&(f=c.buffered.getNextRangeGap(c.ts),1>f&&(h=c.ts+f+1/60,ga.currentTime=h,a.warn("discontinuity seek",c.ts,f,h)));return g}).map(function(a){return{type:"stalled",value:a.stalled}})}function D(a){return a&&"out-of-index"==
a.type}function na(b,d){if(D(d))return a.warn("out of index"),Sa({url:b.locations[0]}).map(function(a){a=a.parsed;return{type:"manifest",value:M(b,ca(a.url,a.manifest,ha))}});d&&"precondition-failed"==d.type&&(Z(b,1),a.warn("precondition failed",b.presentationLiveGap));return G(d)}function ua(a,b,d,c){var f=g.map(V(b),function(b){return da(a,b,d,c)}),f=B(f);return b.isLive?f.distinctUntilChanged(null,function(a,b){return D(b)&&D(a)}).concatMap(function(a){return na(b,a)}):f}function Ea(b,c){var f=
R(c),h=f.timings,g=f.seekings,f=G({type:"manifest",value:c}),l=la(c),g=ua(b,c,h,g),k=ta(),h=u(h,!0),n=d(ga,"error").flatMap(function(){var b="stream: video element MEDIA_ERR code "+ga.error.code;a.error(b);throw Error(b);});return B(f,l,k,g,h,n)}function Wa(){var a=R(Ca,{timeInterval:1E3}).timings,b=G({type:"manifest",value:Ca}),d=la(Ca),a=u(a,!1);return B(b,d,a)}var Qa=c.url,Ka=c.keySystems,ha=c.subtitles,Y=c.timings,J=c.timeFragment,La=c.adaptive,Ma=c.pipelines,ga=c.videoElement,ya=c.autoPlay,Ca=
c.directFile;b(K,"player: browser is required to support MediaSource");var Fa=J.start,va=J.end,Ga=Infinity>va,Sa=Ma.manifest,sa={},wa={};c=Y.filter(function(a){var b=a.ts;a=a.duration;return 0<a&&.2>E(a,va)-b}).take(1).share();if(Ca)return n(Qa,ga).flatMap(Wa).takeUntil(c);J=h(function(b){var d=b.url,c=b.mediaSource;b=x(c);return Sa({url:d}).zip(b,g.identity).flatMap(function(b){b=b.parsed;b=ca(b.url,b.manifest,ha);c.duration=Infinity===b.duration?Number.MAX_VALUE:b.duration;a.info("set duration",
c.duration);return Ea(c,b)})},{retryDelay:500,totalRetry:3,resetDelay:6E4,shouldRetry:function(b,d){if(/MEDIA_ERR/.test(b.message))return!1;a.warn("stream retry",b,d);return!0}});return function(b,d){return q.create(function(c){var f=new K,h=d.src=URL.createObjectURL(f);c.onNext({url:b,mediaSource:f});a.info("create mediasource object",h);return function(){if(f&&"closed"!=f.readyState){var b=f.readyState;g.each(g.cloneArray(f.sourceBuffers),function(d){try{"open"==b&&d.abort(),f.removeSourceBuffer(d)}catch(c){a.warn("error while disposing souceBuffer",
c)}})}g.each(g.keys(wa),function(b){b=wa[b];try{b.abort()}catch(d){a.warn("error while disposing souceBuffer",d)}});d.src="";if(h)try{URL.revokeObjectURL(h)}catch(c){a.warn("error while revoking ObjectURL",c)}h=f=wa=sa=null}})}(Qa,ga).flatMap(J).takeUntil(c)}},function(r,k,c){function n(a,c){if("function"!==typeof c&&null!==c)throw new TypeError("Super expression must either be null or a function, not "+typeof c);a.prototype=Object.create(c&&c.prototype,{constructor:{value:a,enumerable:!1,writable:!0,
configurable:!0}});c&&(Object.setPrototypeOf?Object.setPrototypeOf(a,c):a.__proto__=c)}var p=c(6),g=c(1);k=c(33);var a=window.VTTCue||window.TextTrackCue;k=function(b){function c(a,d){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");b.call(this,d);this.video=a;this.codec=d;this.isVTT=/^text\/vtt/.test(d);var g=document.createElement("track"),k=g.track;this.trackElement=g;this.track=k;g.kind="subtitles";k.mode="showing";a.appendChild(g)}n(c,b);c.prototype.createCuesFromArray=
function(b){return b.length?g.compact(g.map(b,function(b){var c=b.start,g=b.end;if(b=b.text)return new a(c,g,b)})):[]};c.prototype._append=function(a){var b=this;if(this.isVTT)a=new Blob([a],{type:"text/vtt"}),a=URL.createObjectURL(a),this.trackElement.src=a,this.buffered.insert(0,Infinity);else{var c=this.createCuesFromArray(a);c.length&&(g.each(c,function(a){return b.track.addCue(a)}),a=c[0],c=g.last(c),this.buffered.insert(0,a.startTime,c.endTime))}return p.resolve()};c.prototype._remove=function(a,
b){var c=this.track;g.each(g.cloneArray(c.cues),function(g){var l=g.startTime,h=g.endTime;l>=a&&l<=b&&h<=b&&c.removeCue(g)})};c.prototype._abort=function(){var a=this.trackElement,b=this.video;a&&b&&b.hasChildNodes(a)&&b.removeChild(a);this.track.mode="disabled";this.size=0;this.video=this.track=this.trackElement=null};return c}(k);r.exports=k},function(r,k,c){function n(a){if(!a)return!1;a=a.replace(/^npt\:/,"").replace(/\.$/,"");var b,c;a=a.split(":");var g=a.length;switch(g){case 3:b=parseInt(a[0],
10);c=parseInt(a[1],10);a=parseFloat(a[2]);break;case 2:b=0;c=parseInt(a[0],10);a=parseFloat(a[1]);break;case 1:c=b=0;a=parseFloat(a[0]);break;default:return!1}q(23>=b,t);q(59>=c,t);q(1>=g||60>a,t);return 3600*b+60*c+a}function p(a){if(!a)return!1;var b,c,g,h;a=a.split(":");switch(a.length){case 3:b=parseInt(a[0],10);c=parseInt(a[1],10);g=parseInt(a[2],10);h=a=0;break;case 4:b=parseInt(a[0],10);c=parseInt(a[1],10);g=parseInt(a[2],10);-1===a[3].indexOf(".")?(a=parseInt(a[3],10),h=0):(h=a[3].split("."),
a=parseInt(h[0],10),h=parseInt(h[1],10));break;default:return!1}q(23>=b,t);q(59>=c,t);q(59>=g,t);return 3600*b+60*c+g+.001*a+1E-6*h}function g(a){return new Date(Date.parse(a))}function a(a){return a?a:!1}var b=c(1),q=c(2),t="Invalid MediaFragment";r.exports={parseTimeFragment:function(c){if(b.isString(c)){var k=c,w=k.split(",");q(2>=w.length,t);c=w[0]?w[0]:"";w=w[1]?w[1]:"";q((c||w)&&(!c||w||-1===k.indexOf(",")),t);c=c.replace(/^smpte(-25|-30|-30-drop)?\:/,"").replace("clock:","");var k=/^((npt\:)?((\d+\:(\d\d)\:(\d\d))|((\d\d)\:(\d\d))|(\d+))(\.\d*)?)?$/,
l=/^(\d+\:\d\d\:\d\d(\:\d\d(\.\d\d)?)?)?$/,h=/^((\d{4})(-(\d{2})(-(\d{2})(T(\d{2})\:(\d{2})(\:(\d{2})(\.(\d+))?)?(Z|(([-\+])(\d{2})\:(\d{2})))?)?)?)?)?$/,f=/^(\d*(\.\d+)? ?%)?$/;if(k.test(c)&&k.test(w))k=n;else if(l.test(c)&&l.test(w))k=p;else if(h.test(c)&&h.test(w))k=g;else if(f.test(c)&&f.test(w))k=a;else throw Error(t);c=k(c);w=k(w);q(!1!==c||!1!==w,t);c={start:!1===c?"":c,end:!1===w?"":w}}else c=b.pick(c,["start","end"]);b.isString(c.start)&&b.isString(c.end)?(c.start||(c.start="0%"),c.end||
(c.end="100%")):(c.start||(c.start=0),c.end||(c.end=Infinity));b.isString(c.start)&&b.isString(c.end)?(q(0<=parseFloat(c.start)&&100>=parseFloat(c.start),"player: startTime should be between 0% and 100%"),q(0<=parseFloat(c.end)&&100>=parseFloat(c.end),"player: endTime should be between 0% and 100%")):(q((b.isNumber(c.start)||b.isDate(c.start))&&(b.isNumber(c.end)||b.isDate(c.end)),"player: timeFragment should have interface { start, end } where start and end are numbers or dates"),q(c.start<c.end,
"player: startTime should be lower than endTime"),q(0<=c.start,"player: startTime should be greater than 0"));return c}}},function(r,k,c){function n(a){var b=a[0];return(a=a[1])&&Infinity!==a?"bytes="+ +b+"-"+ +a:"bytes="+ +b+"-"}var p=c(1);k=c(3).Observable;var g=k.empty,a=k.merge,b=k.just;c(2);var q=c(13),t=c(11).resolveURL;k=c(38);var d=k.parseSidx,v=k.patchPssh,w=c(39),l=function(a){a.withMetadata=!0;return q(a)};r.exports=function(){var c=(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]).contentProtectionParser;
c||(c=p.noop);var f={loader:function(b){var c=b.adaptation,d=b.representation,f=b.segment,h=f.media,k=f.range;b=f.indexRange;if(f.init&&!(h||k||b))return g();k=p.isArray(k)?{Range:n(k)}:null;if(h)var q=f.time,f=f.number,h=-1===h.indexOf("$")?h:h.replace(/\$\$/g,"$").replace(/\$RepresentationID\$/g,d.id).replace(/\$Bandwidth\$/g,d.bitrate).replace(/\$Number\$/g,f).replace(/\$Time\$/g,q);else h="";c=t(c.rootURL,c.baseURL,d.baseURL,h);d=l({url:c,format:"arraybuffer",headers:k});return p.isArray(b)?(b=
l({url:c,format:"arraybuffer",headers:{Range:n(b)}}),a(d,b)):d},parser:function(a){var c=a.adaptation,f=a.segment;a=new Uint8Array(a.response.blob);var g=f.init,h=f.indexRange,l,k,n;if(h=d(a,h?h[0]:0))l=h.segments,k=h.timescale;g||(0<=f.time&&0<=f.duration?n={ts:f.time,d:f.duration}:h&&1===h.segments.length&&(n={ts:h.segments[0].ts,d:h.segments[0].d}));g&&c.contentProtection&&(a=v(a,c.contentProtection));return b({blob:a,currentSegment:n,nextSegments:l,timescale:k})}};return{manifest:{loader:function(a){return l({url:a.url,
format:"document"})},parser:function(a){a=a.response;return b({manifest:w(a.blob,c),url:a.url})}},audio:f,video:f,text:{loader:function(){}}}}},function(r,k,c){function n(a,b){for(var c=0,d=a.length,k,n;c+8<d&&(n=q(a,c),k=q(a,c+4),g(0<n,"dash: out of range size"),k!==b);)c+=n;if(c>=d)return-1;g(c+n<=d,"dash: atom out of range");return c}function p(b){var c=b.systemId;b=b.privateData;c=c.replace(/-/g,"");g(32===c.length);c=w(4,d(c),a(b.length),b);return w(a(c.length+8),v("pssh"),c)}var g=c(2);k=c(7);
var a=k.itobe4,b=k.be8toi,q=k.be4toi,t=k.be2toi,d=k.hexToBytes,v=k.strToBytes,w=k.concat;r.exports={parseSidx:function(a,c){var d=n(a,1936286840);if(-1==d)return null;var g=q(a,d),d=d+4+4,k=a[d],d=d+8,p=q(a,d),d=d+4;if(0===k)k=q(a,d),d+=4,c+=q(a,d)+g,d+=4;else if(1===k)k=b(a,d),d+=8,c+=b(a,d)+g,d+=8;else return null;for(var g=[],d=d+2,v=t(a,d),d=d+2;0<=--v;){var w=q(a,d),d=d+4,r=w&2147483647;if(1==(w&2147483648)>>>31)throw Error("not implemented");w=q(a,d);d+=4;d+=4;g.push({ts:k,d:w,r:0,range:[c,
c+r-1]});k+=w;c+=r}return{segments:g,timescale:p}},patchPssh:function(b,c){if(!c||!c.length)return b;var d=n(b,1836019574);if(-1==d)return b;for(var g=q(b,d),k=[b.subarray(d,d+g)],v=0;v<c.length;v++)k.push(p(c[v]));k=w.apply(null,k);k.set(a(k.length),0);return w(b.subarray(0,d),k,b.subarray(d+g))}}},function(r,k,c){function n(a){var b=S.last(a.timeline);return(b.ts+(b.r+1)*b.d)/a.timescale}function p(a,b){var c=V[a.nodeName];Q(c,"parser: no attributes for "+a.nodeName);return S.reduce(c,function(b,
c){var d=c.k,f=c.fn,g=c.n,h=c.def;a.hasAttribute(d)?b[g||d]=f(a.getAttribute(d)):null!=h&&(b[g||d]=h);return b},b||{})}function g(a){return a}function a(a){return"true"==a}function b(a){return"true"==a?!0:"false"==a?!1:parseInt(a)}function q(a){return new Date(Date.parse(a))}function t(a){if(!a)return 0;var b=O.exec(a);Q(b,"parser: "+a+" is not a valid ISO8601 duration");return 31536E3*parseFloat(b[2]||0)+2592E3*parseFloat(b[4]||0)+86400*parseFloat(b[6]||0)+3600*parseFloat(b[8]||0)+60*parseFloat(b[10]||
0)+parseFloat(b[12]||0)}function d(a){var b=M.exec(a);if(!b)return-1;a=parseInt(b[1])||0;b=parseInt(b[2])||0;return 0<b?a/b:a}function v(a){return a}function w(a){return(a=ca.exec(a))?[+a[1],+a[2]]:null}function l(a,b,c){for(a=a.firstElementChild;a;)c=b(c,a.nodeName,a),a=a.nextElementSibling;return c}function h(a){var b=l(a,function(a,b,c){if("Initialization"==b){var d,f;c.hasAttribute("range")&&(d=w(c.getAttribute("range")));c.hasAttribute("sourceURL")&&(f=c.getAttribute("sourceURL"));a.initialization=
{range:d,media:f}}return a},p(a));"SegmentBase"==a.nodeName&&(b.indexType="base",b.timeline=[]);return b}function f(a){return l(a,function(a,b,c){"SegmentTimeline"==b&&(a.indexType="timeline",a.timeline=y(c));return a},h(a))}function y(a){return l(a,function(a,b,c){b=a.length;c=p(c);null==c.ts&&(b=0<b&&a[b-1],c.ts=b?b.ts+b.d*(b.r+1):0);null==c.r&&(c.r=0);a.push(c);return a},[])}function G(a){a=f(a);a.indexType||(a.indexType="template");return a}function B(a){var b=f(a);b.list=[];b.indexType="list";
return l(a,function(a,b,c){"SegmentURL"==b&&a.list.push(p(c));return a},b)}function F(a){var b=l(a,function(a,b,c){switch(b){case "BaseURL":a.baseURL=c.textContent;break;case "SegmentBase":a.index=h(c);break;case "SegmentList":a.index=B(c);break;case "SegmentTemplate":a.index=G(c)}return a},{});return p(a,b)}function E(a,b){var c=l(a,function(a,c,d){switch(c){case "ContentProtection":c=b(p(d),d);a.contentProtection=c;break;case "ContentComponent":a.contentComponent=p(d);break;case "BaseURL":a.baseURL=
d.textContent;break;case "SegmentBase":a.index=h(d);break;case "SegmentList":a.index=B(d);break;case "SegmentTemplate":a.index=G(d);break;case "Representation":c=F(d),null==c.id&&(c.id=a.representations.length),a.representations.push(c)}return a},{representations:[]});return p(a,c)}function K(a,b){var c=p(a,l(a,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "AdaptationSet":c=E(d,b),null==c.id&&(c.id=a.adaptations.length),a.adaptations.push(c)}return a},{adaptations:[]}));
c.baseURL&&S.each(c.adaptations,function(a){return S.defaults(a,{baseURL:c.baseURL})});return c}function x(a,b){var c=a.documentElement;Q.equal(c.nodeName,"MPD","parser: document root should be MPD");var d=l(c,function(a,c,d){switch(c){case "BaseURL":a.baseURL=d.textContent;break;case "Location":a.locations.push(d.textContent);break;case "Period":a.periods.push(K(d,b))}return a},{transportType:"dash",periods:[],locations:[]}),d=p(c,d);/isoff-live/.test(d.profiles)&&(c=(c=S.find(d.periods[0].adaptations,
function(a){return"video/mp4"==a.mimeType}))&&c.index,c=c.timeline?n(c):Date.now()/1E3-60,d.availabilityStartTime=d.availabilityStartTime.getTime()/1E3,d.presentationLiveGap=Date.now()/1E3-(c+d.availabilityStartTime));return d}function I(a,b){return x((new DOMParser).parseFromString(a,"application/xml"),b)}function L(a,b){if(S.isString(a))return I(a,b);if(a instanceof window.Document)return x(a,b);throw Error("parser: unsupported type to parse");}var S=c(1),Q=c(2),O=/^P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,
ca=/([0-9]+)-([0-9]+)/,M=/([0-9]+)(\/([0-9]+))?/;k=[{k:"profiles",fn:g},{k:"width",fn:parseInt},{k:"height",fn:parseInt},{k:"frameRate",fn:d},{k:"audioSamplingRate",fn:g},{k:"mimeType",fn:g},{k:"segmentProfiles",fn:g},{k:"codecs",fn:g},{k:"maximumSAPPeriod",fn:parseFloat},{k:"maxPlayoutRate",fn:parseFloat},{k:"codingDependency",fn:a}];c=[{k:"timescale",fn:parseInt},{k:"presentationTimeOffset",fn:parseFloat,def:0},{k:"indexRange",fn:w},{k:"indexRangeExact",fn:a},{k:"availabilityTimeOffset",fn:parseFloat},
{k:"availabilityTimeComplete",fn:a}];var Z=c.concat([{k:"duration",fn:parseInt},{k:"startNumber",fn:parseInt}]),V={ContentProtection:[{k:"schemeIdUri",fn:g},{k:"value",fn:g}],SegmentURL:[{k:"media",fn:g},{k:"mediaRange",fn:w},{k:"index",fn:g},{k:"indexRange",fn:w}],S:[{k:"t",fn:parseInt,n:"ts"},{k:"d",fn:parseInt},{k:"r",fn:parseInt}],SegmentTimeline:[],SegmentBase:c,SegmentTemplate:Z.concat([{k:"initialization",fn:function(a){return{media:a,range:void 0}}},{k:"index",fn:g},{k:"media",fn:g},{k:"bitstreamSwitching",
fn:g}]),SegmentList:Z,ContentComponent:[{k:"id",fn:g},{k:"lang",fn:g},{k:"contentType",fn:g},{k:"par",fn:v}],Representation:k.concat([{k:"id",fn:g},{k:"bandwidth",fn:parseInt,n:"bitrate"},{k:"qualityRanking",fn:parseInt}]),AdaptationSet:k.concat([{k:"id",fn:g},{k:"group",fn:parseInt},{k:"lang",fn:g},{k:"contentType",fn:g},{k:"par",fn:v},{k:"minBandwidth",fn:parseInt,n:"minBitrate"},{k:"maxBandwidth",fn:parseInt,n:"maxBitrate"},{k:"minWidth",fn:parseInt},{k:"maxWidth",fn:parseInt},{k:"minHeight",fn:parseInt},
{k:"maxHeight",fn:parseInt},{k:"minFrameRate",fn:d},{k:"maxFrameRate",fn:d},{k:"segmentAlignment",fn:b},{k:"subsegmentAlignment",fn:b},{k:"bitstreamSwitching",fn:a}]),Period:[{k:"id",fn:g},{k:"start",fn:t},{k:"duration",fn:t},{k:"bitstreamSwitching",fn:a}],MPD:[{k:"id",fn:g},{k:"profiles",fn:g},{k:"type",fn:g},{k:"availabilityStartTime",fn:q},{k:"availabilityEndTime",fn:q},{k:"publishTime",fn:q},{k:"mediaPresentationDuration",fn:t,n:"duration"},{k:"minimumUpdatePeriod",fn:t},{k:"minBufferTime",fn:t},
{k:"timeShiftBufferDepth",fn:t},{k:"suggestedPresentationDelay",fn:t},{k:"maxSegmentDuration",fn:t},{k:"maxSubsegmentDuration",fn:t}]};L.parseFromString=I;L.parseFromDocument=x;r.exports=L},function(r,k,c){r.exports={smooth:c(41),dash:c(37)}},function(r,k,c){function n(a){return(a=a.match(L))&&a[1]||""}function p(a,b){return b?a.replace(L,"?token="+b):a.replace(L,"")}function g(a,b,c){return d(a.rootURL,a.baseURL,b.baseURL).replace(/\{bitrate\}/g,b.bitrate).replace(/\{start time\}/g,c.time)}k=c(1);
var a=c(3).Observable,b=a.empty,q=a.just,t=c(13),d=c(11).resolveURL,v=c(7).bytesToStr,w=c(4),l=c(43),a=c(42),h=a.patchSegment,f=a.createVideoInitSegment,y=a.createAudioInitSegment,G=a.getMdat,B=a.getTraf,F=a.parseTfrf,E=a.parseTfxd,a=c(44).parseSami;c=c(45).parseTTML;var K={"application/x-sami":a,"application/smil":a,"application/ttml+xml":c,"application/ttml+xml+mp4":c,"text/vtt":k.identity},x=/\.(isml?)(\?token=\S+)?$/,I=/\.wsx?(\?token=\S+)?/,L=/\?token=(\S+)/,S=function(a){a.withMetadata=!0;return t(a)};
r.exports=function(){function a(b,c,d){var f,g;c.isLive?(b=B(b))?(f=F(b),g=E(b)):w.warn("smooth: could not find traf atom"):f=null;g||(g={d:d.duration,ts:d.time});return{nextSegments:f,currentSegment:g}}var c=l(0>=arguments.length||void 0===arguments[0]?{}:arguments[0]),d={loader:function(a){var b=a.adaptation,c=a.representation;a=a.segment;if(a.init){var d;a=b.smoothProtection||{};switch(b.type){case "video":d=f(c.index.timescale,c.width,c.height,72,72,4,c.codecPrivateData,a.keyId,a.keySystems);
break;case "audio":d=y(c.index.timescale,c.channels,c.bitsPerSample,c.packetSize,c.samplingRate,c.codecPrivateData,a.keyId,a.keySystems)}return q({blob:d,size:d.length,duration:100})}var h;if(d=a.range)h=d[0],h=(d=d[1])&&Infinity!==d?"bytes="+ +h+"-"+ +d:"bytes="+ +h+"-",h={Range:h};b=g(b,c,a);return S({url:b,format:"arraybuffer",headers:h})},parser:function(b){var c=b.adaptation,d=b.response;b=b.segment;if(b.init)return q({blob:d.blob,timings:null});d=new Uint8Array(d.blob);b=a(d,c,b);c=b.nextSegments;
b=b.currentSegment;return q({blob:h(d,b.ts),nextSegments:c,currentSegment:b})}};return{manifest:{resolver:function(a){a=a.url;var b=n(a);return(I.test(a)?S({url:p(a,""),format:"document"}).map(function(a){return a.blob.getElementsByTagName("media")[0].getAttribute("src")}):q(a)).map(function(a){var c=a.match(x);a=c?a.replace(c[1],c[1]+"/manifest"):a;return{url:p(a,b)}})},loader:function(a){return S({url:a.url,format:"document"})},parser:function(a){a=a.response;return q({manifest:c(a.blob),url:a.url})}},
audio:d,video:d,text:{loader:function(a){var c=a.adaptation,d=a.representation,f=a.segment;if(f.init)return b();a=d.mimeType;c=g(c,d,f);return 0<=a.indexOf("mp4")?S({url:c,format:"arraybuffer"}):S({url:c,format:"text"})},parser:function(b){var c=b.response,d=b.adaptation,f=b.representation;b=b.segment;var g=d.lang,h=f.mimeType,l=K[h];if(!l)throw Error("smooth: could not find a text-track parser for the type "+h);var k=c.blob;0<=h.indexOf("mp4")?(k=new Uint8Array(k),c=v(G(k))):c=k;h=a(k,d,b);d=h.nextSegments;
h=h.currentSegment;return q({blob:l(c,g,b.time/f.index.timescale),currentSegment:h,nextSegments:d})}}}}},function(r,k,c){function n(a,b){return d(G(b.length+8),K(a),b)}function p(a,b,c,d,f){for(var g=0,h=a.length,l;g<h;){l=y(a,g);if(1970628964===y(a,g+4)&&y(a,g+8)===b&&y(a,g+12)===c&&y(a,g+16)===d&&y(a,g+20)===f)return a.subarray(g+24,g+l);g+=l}}function g(a,b){for(var c=0,d=a.length,f,g;c+8<d&&(g=y(a,c),f=y(a,c+4),t(0<g,"dash: out of range size"),f!==b);)c+=g;if(!(c>=d))return a.subarray(c+8,c+g)}
function a(a,b,c,d){var f=[a,b,c];q.each(d,function(a){a=x.pssh(a.systemId,a.privateData,a.keyIds);f.push(a)});return f}function b(b,c,f,g,h,l,k){f=x.mult("stbl",[f,n("stts",new Uint8Array(8)),n("stsc",new Uint8Array(8)),n("stsz",new Uint8Array(12)),n("stco",new Uint8Array(8))]);var p=n("url ",new Uint8Array([0,0,0,1])),p=x.dref(p),p=x.mult("dinf",[p]);g=x.mult("minf",[g,p,f]);c=x.hdlr(c);f=x.mdhd(b);c=x.mult("mdia",[f,c,g]);h=x.tkhd(h,l,1);h=x.mult("trak",[h,c]);l=x.trex(1);l=x.mult("mvex",[l]);
b=x.mvhd(b,1);k=x.mult("moov",a(b,l,h,k));b=x.ftyp("isom",["isom","iso2","iso6","avc1","dash"]);return d(b,k)}var q=c(1),t=c(2);k=c(7);var d=k.concat,v=k.strToBytes,w=k.hexToBytes,l=k.bytesToHex,h=k.be2toi,f=k.itobe2,y=k.be4toi,G=k.itobe4,B=k.be8toi,F=k.itobe8,E=[96E3,88200,64E3,48E3,44100,32E3,24E3,22050,16E3,12E3,11025,8E3,7350],K=q.memoize(v),x={mult:function(a,b){return n(a,d.apply(null,b))},avc1encv:function(a,b,c,g,h,l,k,p,q,w){return n(a,d(6,f(b),16,f(c),f(g),f(h),2,f(l),6,[0,1,k.length],v(k),
31-k.length,f(p),[255,255],q,"encv"===a?w:[]))},avcc:function(a,b,c){return n("avcC",d([1,a[1],a[2],a[3],252|(2===c?1:4===c?3:0),225],f(a.length),a,[1],f(b.length),b))},dref:function(a){return n("dref",d(7,[1],a))},esds:function(a,b){return n("esds",d(4,[3,25],f(a),[0,4,17,64,21],11,[5,2],w(b),[6,1,2]))},frma:function(a){return n("frma",v(a))},free:function(a){return n("free",new Uint8Array(a-8))},ftyp:function(a,b){return n("ftyp",d.apply(null,[v(a),[0,0,0,1]].concat(b.map(v))))},hdlr:function(a){return n("hdlr",
d(8,v("audio"===a?"soun":"vide"),12,v("Media Handler")))},mdhd:function(a){return n("mdhd",d(12,G(a),8))},moof:function(a,b){return x.mult("moof",[a,b])},mp4aenca:function(a,b,c,g,h,l,k,p){return n(a,d(6,f(b),8,f(c),f(g),2,f(h),f(l),2,k,"enca"===a?p:[]))},mvhd:function(a,b){return n("mvhd",d(12,G(a),4,[0,1],2,[1,0],10,[0,1],14,[0,1],14,[64,0,0,0],26,f(b+1)))},pssh:function(a){var b=1>=arguments.length||void 0===arguments[1]?[]:arguments[1],c=2>=arguments.length||void 0===arguments[2]?[]:arguments[2];
a=a.replace(/-/g,"");t(32===a.length,"wrong system id length");var f,g=c.length;0<g?(f=1,c=d.apply(null,[G(g)].concat(c))):(f=0,c=[]);return n("pssh",d([f,0,0,0],w(a),c,G(b.length),b))},saio:function(a,b,c,f){return n("saio",d(4,[0,0,0,1],G(a.length+b.length+c.length+f.length+8+8+8+8)))},saiz:function(a){if(0===a.length)return n("saiz",new Uint8Array);var b=y(a,0),c=y(a,4),d=new Uint8Array(9+c);d.set(G(c),5);for(var c=9,f=8,g,l;f<a.length;)f+=8,2===(b&2)?(l=2,g=h(a,f),f+=2+6*g):l=g=0,d[c]=6*g+8+l,
c++;return n("saiz",d)},schm:function(a,b){return n("schm",d(4,v(a),G(b)))},senc:function(a){return n("senc",a)},smhd:function(){return n("smhd",new Uint8Array(8))},stsd:function(a){return n("stsd",d.apply(null,[7,[a.length]].concat(a)))},tkhd:function(a,b,c){return n("tkhd",d(G(7),8,G(c),20,[1,0,0,0],[0,1,0,0],12,[0,1,0,0],12,[64,0,0,0],f(a),2,f(b),2))},trex:function(a){return n("trex",d(4,G(a),[0,0,0,1],12))},tfdt:function(a){return n("tfdt",d([1,0,0,0],F(a)))},tenc:function(a,b,c){return n("tenc",
d(6,[a,b],w(c)))},traf:function(a,b,c,d,f){var g=[a,b,c];d&&g.push(x.senc(d),x.saiz(d),x.saio(f,a,b,c));return x.mult("traf",g)},vmhd:function(){var a=new Uint8Array(12);a[3]=1;return n("vmhd",a)}},I={traf:function(a){return(a=g(a,1836019558))?g(a,1953653094):null},senc:function(a){return p(a,2721664850,1520127764,2722393154,2086964724)},tfxd:function(a){return p(a,1830656773,1121273062,2162299933,2952222642)},tfrf:function(a){return p(a,3565190898,3392751253,2387879627,2655430559)},mdat:function(a){return g(a,
1835295092)}};r.exports={getMdat:I.mdat,getTraf:I.traf,parseTfrf:function(a){a=I.tfrf(a);if(!a)return[];for(var b=[],c=a[0],d=a[4],f=0;f<d;f++){var g,h;1==c?(h=B(a,16*f+5),g=B(a,16*f+13)):(h=y(a,8*f+5),g=y(a,8*f+9));b.push({ts:h,d:g})}return b},parseTfxd:function(a){if(a=I.tfxd(a))return{d:B(a,12),ts:B(a,4)}},createVideoInitSegment:function(a,c,d,f,g,h,l,k,n){n||(n=[]);var p=l.split("00000001");l=p[2];p=w(p[1]);l=w(l);h=x.avcc(p,l,h);n.length?(k=x.tenc(1,8,k),k=x.mult("schi",[k]),l=x.schm("cenc",
65536),p=x.frma("avc1"),k=x.mult("sinf",[p,l,k]),f=x.avc1encv("encv",1,c,d,f,g,"AVC Coding",24,h,k)):f=x.avc1encv("avc1",1,c,d,f,g,"AVC Coding",24,h);f=x.stsd([f]);return b(a,"video",f,x.vmhd(),c,d,n)},createAudioInitSegment:function(a,c,d,g,h,k,n,p){p||(p=[]);k||(k=E.indexOf(h),k=((32|k&31)<<4|c&31)<<3,k=l(f(k)));k=x.esds(1,k);if(p.length){n=x.tenc(1,8,n);n=x.mult("schi",[n]);var q=x.schm("cenc",65536),v=x.frma("mp4a");n=x.mult("sinf",[v,q,n]);c=x.mp4aenca("enca",1,c,d,g,h,k,n)}else c=x.mp4aenca("mp4a",
1,c,d,g,h,k);c=x.stsd([c]);return b(a,"audio",c,x.smhd(),0,0,p)},patchSegment:function(a,b){var c=a.subarray(0,y(a,0)),d=x.tfdt(b),f=d.length,g=y(c,8),h=y(c,8+g),l=y(c,8+g+8),k=y(c,8+g+8+l),n=c.subarray(8,8+g),p=c.subarray(8+g+8,8+g+8+h-8),h=p.subarray(0,l),k=p.subarray(l,l+k);h.set([0,0,0,1],12);p=I.senc(p);d=x.traf(h,d,k,p,n);n=x.moof(n,d);f=8+g+8+l+f;l=a.length;g=n.length;d=c.length;c=a.subarray(d,l);l=new Uint8Array(g+(l-d));l.set(n,0);l.set(c,g);l.set(G(n.length+8),f+16);return l}}},function(r,
k,c){function n(a){return"boolean"==typeof a?a:"string"==typeof a?"TRUE"===a.toUpperCase():!0}function p(b){var c=a.last(b.timeline);return(c.ts+(c.r+1)*c.d)/b.timescale}function g(a){return[{systemId:"edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",privateData:q.concat([8,1,18,16],a)}]}var a=c(1),b=c(2),q=c(7),t={audio:"audio/mp4",video:"video/mp4",text:"application/ttml+xml"},d={audio:"mp4a.40.2",video:"avc1.4D401E"};k={AACL:"audio/mp4",AVC1:"video/mp4",H264:"video/mp4",TTML:"application/ttml+xml+mp4"};c=
{AACL:"mp4a.40.5",AACH:"mp4a.40.5",AVC1:"avc1.4D401E",H264:"avc1.4D401E"};var v={audio:[["Bitrate","bitrate",parseInt],["AudioTag","audiotag",parseInt],["FourCC","mimeType",k],["FourCC","codecs",c],["Channels","channels",parseInt],["SamplingRate","samplingRate",parseInt],["BitsPerSample","bitsPerSample",parseInt],["PacketSize","packetSize",parseInt],["CodecPrivateData","codecPrivateData",String]],video:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",k],["FourCC","codecs",c],["MaxWidth","width",
parseInt],["MaxHeight","height",parseInt],["CodecPrivateData","codecPrivateData",String]],text:[["Bitrate","bitrate",parseInt],["FourCC","mimeType",k]]};r.exports=function(){function c(a,b,d){for(a=a.firstElementChild;a;)d=b(d,a.nodeName,a),a=a.nextElementSibling;return d}function l(b,c){return a.reduce(c,function(c,d){var f=d[0],g=d[2];c[d[1]]=a.isFunction(g)?g(b.getAttribute(f)):g[b.getAttribute(f)];return c},{})}function h(f,g){f.hasAttribute("Timescale")&&(g=+f.getAttribute("Timescale"));var h=
f.getAttribute("Type"),k=f.getAttribute("Subtype"),n=v[h];b(n,"parser: unrecognized QualityLevel type "+h);var p=0,q=c(f,function(a,b,c){switch(b){case "QualityLevel":c=l(c,n);if("video"!=h||c.bitrate>K)c.id=p++,a.representations.push(c);break;case "c":b=a.index;var d=a.index.timeline,f=d.length,g=0<f?d[f-1]:{d:0,ts:0,r:0},k=+c.getAttribute("d"),q=c.getAttribute("t");(c=+c.getAttribute("r"))&&c--;0<f&&k==g.d&&null==q?g.r+=(c||0)+1:d.push({d:k,ts:null==q?g.ts+g.d*(g.r+1):+q,r:c});b.timeline=d}return a},
{representations:[],index:{timeline:[],indexType:"timeline",timescale:g,initialization:{}}}),r=q.representations,q=q.index;b(r.length,"parser: adaptation should have at least one representation");var y=r[0].codecs;y||(y=d[h],a.each(r,function(a){return a.codecs=y}));var x=r[0].mimeType;x||(x=t[h],a.each(r,function(a){return a.mimeType=x}));return"ADVT"==k?null:{type:h,index:q,representations:r,name:f.getAttribute("Name"),lang:f.getAttribute("Language"),baseURL:f.getAttribute("Url")}}function f(a){return k((new DOMParser).parseFromString(a,
"application/xml"))}function k(d){d=d.documentElement;b.equal(d.nodeName,"SmoothStreamingMedia","parser: document root should be SmoothStreamingMedia");b(/^[2]-[0-2]$/.test(d.getAttribute("MajorVersion")+"-"+d.getAttribute("MinorVersion")),"Version should be 2.0, 2.1 or 2.2");var f=+d.getAttribute("Timescale")||1E7,g=0,l=c(d,function(a,c,d){switch(c){case "Protection":d=d.firstElementChild;b.equal(d.nodeName,"ProtectionHeader","parser: Protection should have ProtectionHeader child");c=q.strToBytes(atob(d.textContent));
var l;l=q.le2toi(c,8);l=q.bytesToUTF16Str(c.subarray(10,10+l));l=(new DOMParser).parseFromString(l,"application/xml").querySelector("KID").textContent;l=q.guidToUuid(atob(l)).toLowerCase();var k=q.hexToBytes(l);d=d.getAttribute("SystemID").toLowerCase().replace(/\{|\}/g,"");c={keyId:l,keySystems:[{systemId:d,privateData:c}].concat(x(k))};a.protection=c;break;case "StreamIndex":if(c=h(d,f))c.id=g++,a.adaptations.push(c)}return a},{protection:null,adaptations:[]}),v=l.protection,l=l.adaptations;a.each(l,
function(a){return a.smoothProtection=v});var r,t,y,B,G=n(d.getAttribute("IsLive"));if(G){r=F;y=+d.getAttribute("DVRWindowLength")/f;B=E;t=a.find(l,function(a){return"video"==a.type});var K=a.find(l,function(a){return"audio"==a.type});t=Math.min(p(t.index),p(K.index));t=Date.now()/1E3-(t+B)}return{transportType:"smoothstreaming",profiles:"",type:G?"dynamic":"static",suggestedPresentationDelay:r,timeShiftBufferDepth:y,presentationLiveGap:t,availabilityStartTime:B,periods:[{duration:(+d.getAttribute("Duration")||
Infinity)/f,adaptations:l,laFragCount:+d.getAttribute("LookAheadFragmentCount")}]}}function r(b){if(a.isString(b))return f(b);if(b instanceof window.Document)return k(b);throw Error("parser: unsupported type to parse");}var B=0>=arguments.length||void 0===arguments[0]?{}:arguments[0],F=B.suggestedPresentationDelay||20,E=B.referenceDateTime||Date.UTC(1970,0,1,0,0,0,0)/1E3,K=B.minRepresentationBitrate||19E4,x=B.keySystems||g;r.parseFromString=f;r.parseFromDocument=k;return r}},function(r,k,c){function n(c){return c.replace(b,
"\n").replace(a,function(a,b){return String.fromCharCode(b)})}var p=c(1),g=c(2),a=/&#([0-9]+);/g,b=/<br>/gi,q=/<style[^>]*>([\s\S]*?)<\/style[^>]*>/i,t=/\s*<p class=([^>]+)>(.*)/i,d=/<sync[^>]+?start="?([0-9]*)"?[^0-9]/i;r.exports={parseSami:function(a,b){var c=/<sync[ >]/ig,h=/<sync[ >]|<\/body>/ig,f=[],k=a.match(q)[1],r,B=h.exec(a),B=/\.(\S+)\s*{([^}]*)}/gi,F;for(r={};F=B.exec(k);){var E=F[1];F=F[2].match(/\s*lang:\s*(\S+);/i)[1];E&&F&&(r[F]=E)}k=r[b];for(g(k,"sami: could not find lang "+b+" in CSS");;){r=
c.exec(a);B=h.exec(a);if(!r&&!B)break;if(!r||!B||r.index>=B.index)throw Error("parse error");r=a.slice(r.index,B.index);B=r.match(d);if(!B)throw Error("parse error: sync time attribute");E=+B[1];if(isNaN(E))throw Error("parse error: sync time attribute NaN");B=f;r=r.split("\n");E/=1E3;F=r.length;for(var K=void 0;0<=--F;)if(K=r[F].match(t)){var x=K[2];k===K[1]&&("&nbsp;"===x?p.last(B).end=E:B.push({text:n(x),start:E}))}}return f}}},function(r,k,c){function n(b,c){var d=0;b=b.firstChild;for(var h=[],
f;b;){if(1===b.nodeType)switch(b.tagName.toUpperCase()){case "P":f=b;var k=c,q=p(f.getAttribute("begin"),k),r=p(f.getAttribute("end"),k),F=p(f.getAttribute("dur"),0);if(!g.isNumber(q)&&!g.isNumber(r)&&!g.isNumber(F))throw Error("ttml: unsupported timestamp format");0<F?(null==q&&(q=d||k),null==r&&(r=q+F)):null==r&&(r=p(f.getAttribute("duration"),0),r=0<=r?r+q:Number.MAX_VALUE);f={id:f.getAttribute("xml:id")||f.getAttribute("id"),text:decodeURIComponent(t(f.innerHTML.replace(a,"\n"))),start:q,end:r};
d=f.end;h.push(f);break;case "DIV":f=p(b.getAttribute("begin"),0),null==f&&(f=c),h.push.apply(h,n(b,f))}b=b.nextSibling}return h}function p(a,c){if(a){var g;if(g=a.match(b)){var h=g[3],f=g[4],k=g[6];return 3600*parseInt(g[2]||0,10)+60*parseInt(h,10)+parseInt(f,10)+parseFloat("0."+k)}if(g=a.match(q))return h=g[4],parseFloat(g[1])*d[h]+c}}var g=c(1),a=/<br[^>]+>/gm,b=/^(([0-9]+):)?([0-9]+):([0-9]+)(\.([0-9]+))?$/,q=/(([0-9]+)(\.[0-9]+)?)(ms|h|m|s)/,t=window.escape,d={h:3600,m:60,s:1,ms:.001};r.exports=
{parseTTML:function(a,b,c){a=g.isString(a)?(new DOMParser).parseFromString(a,"text/xml"):a;if(!(a instanceof window.Document||a instanceof window.HTMLElement))throw Error("ttml: needs a Document to parse");a=a.querySelector("tt");if(!a)throw Error("ttml: could not find <tt> tag");a=n(a.querySelector("body"),0);g.each(a,function(a){a.start+=c;a.end+=c});return a}}},function(r,k){function c(){this.arr=[]}c.prototype.add=function(c){this.arr.push(c)};c.prototype.remove=function(c){c=this.arr.indexOf(c);
0<=c&&this.arr.splice(c,1)};c.prototype.test=function(c){return 0<=this.arr.indexOf(c)};c.prototype.size=function(){return this.arr.length};r.exports={ArraySet:c}},function(r,k,c){function n(a){return null==a?"":String(a).replace(v,function(a){return w[a]})}function p(a){var b=a.getAverageBitrates(),c,d;b.video.subscribe(function(a){return d=a|0}).dispose();b.audio.subscribe(function(a){return c=a|0}).dispose();return{manifest:a.man,version:a.version,timeFragment:a.frag,currentTime:a.getCurrentTime(),
state:a.getPlayerState(),buffer:q(a.video.buffered),volume:a.getVolume(),video:{adaptation:a.adas.video,representation:a.reps.video,maxBitrate:a.getVideoMaxBitrate(),bufferSize:a.getVideoBufferSize(),avrBitrate:d},audio:{adaptation:a.adas.audio,representation:a.reps.audio,maxBitrate:a.getAudioMaxBitrate(),bufferSize:a.getAudioBufferSize(),avrBitrate:c}}}function g(a,b){var c=b.parentNode.querySelector("#cp--debug-infos-content");if(c){var d;try{d=p(a)}catch(g){return}var k=d,q=k.video,r=k.audio,k=
k.manifest;d="<b>Player v"+d.version+"</b> ("+d.state+")<br>";k&&q&&r&&(d+=["Container: "+n(k.transportType),"Live: "+n(""+k.isLive),"Downloading bitrate (Kbit/s): "+(q.representation.bitrate/1E3).toFixed(3)+"/"+(r.representation.bitrate/1E3).toFixed(3),"Estimated bandwidth (Kbit/s): "+(q.avrBitrate/1E3).toFixed(3)+"/"+(r.avrBitrate/1E3).toFixed(3),"Location: "+k.locations[0]].join("<br>"));c.innerHTML=d}}function a(a,c){var f="<style>\n#cp--debug-infos {\n  position: absolute;\n  top: "+n(c.offsetTop+
10)+"px;\n  left: "+n(c.offsetLeft+10)+'px;\n  width: 500px;\n  height: 300px;\n  background-color: rgba(10, 10, 10, 0.83);\n  overflow: hidden;\n  color: white;\n  text-align: left;\n  padding: 2em;\n  box-sizing: border-box;\n}\n#cp--debug-hide-infos {\n  float: right;\n  cursor: pointer;\n}\n</style>\n<div id="cp--debug-infos">\n  <a id="cp--debug-hide-infos">[x]</a>\n  <p id="cp--debug-infos-content"></p>\n</div>',k=c.parentNode,p=k.querySelector("#cp--debug-infos-container");p||(p=document.createElement("div"),
p.setAttribute("id","cp--debug-infos-container"),k.appendChild(p));p.innerHTML=f;d||(d=k.querySelector("#cp--debug-hide-infos"),d.addEventListener("click",function(){return b(c)}));t&&clearInterval(t);t=setInterval(function(){return g(a,c)},1E3);g(a,c)}function b(a){(a=a.parentNode.querySelector("#cp--debug-infos-container"))&&a.parentNode.removeChild(a);t&&(clearInterval(t),t=null);d&&(d.removeEventListener("click",b),d=null)}var q=c(9).bufferedToArray,t,d,v=/[&<>"']/g,w={"&":"&amp;","<":"&lt;",
">":"&gt;",'"':"&quot;","'":"&#39;"};r.exports={getDebug:p,showDebug:a,hideDebug:b,toggleDebug:function(c,d){d.parentNode.querySelector("#cp--debug-infos-container")?b(d):a(c,d)}}},function(r,k,c){var n;(function(p,g,a){(function(){function b(a){return"function"===typeof a}function q(){return function(){p.nextTick(w)}}function r(){var a=0,b=new aa(w),c=document.createTextNode("");b.observe(c,{characterData:!0});return function(){c.data=a=++a%2}}function d(){var a=new MessageChannel;a.port1.onmessage=
w;return function(){a.port2.postMessage(0)}}function v(){return function(){setTimeout(w,1)}}function w(){for(var a=0;a<M;a+=2)(0,X[a])(X[a+1]),X[a]=void 0,X[a+1]=void 0;M=0}function l(){}function h(a,b,c,d){try{a.call(b,c,d)}catch(f){return f}}function f(a,b,c){Z(function(a){var d=!1,f=h(c,b,function(c){d||(d=!0,b!==c?G(a,c):F(a,c))},function(b){d||(d=!0,E(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&f&&(d=!0,E(a,f))},a)}function y(a,b){1===b._state?F(a,b._result):2===a._state?E(a,b._result):
K(b,void 0,function(b){G(a,b)},function(b){E(a,b)})}function G(a,c){if(a===c)E(a,new TypeError("You cannot resolve a promise with itself"));else if("function"===typeof c||"object"===typeof c&&null!==c)if(c.constructor===a.constructor)y(a,c);else{var d;try{d=c.then}catch(g){R.error=g,d=R}d===R?E(a,R.error):void 0===d?F(a,c):b(d)?f(a,c,d):F(a,c)}else F(a,c)}function B(a){a._onerror&&a._onerror(a._result);x(a)}function F(a,b){void 0===a._state&&(a._result=b,a._state=1,0!==a._subscribers.length&&Z(x,
a))}function E(a,b){void 0===a._state&&(a._state=2,a._result=b,Z(B,a))}function K(a,b,c,d){var f=a._subscribers,g=f.length;a._onerror=null;f[g]=b;f[g+1]=c;f[g+2]=d;0===g&&a._state&&Z(x,a)}function x(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,f,g=a._result,h=0;h<b.length;h+=3)d=b[h],f=b[h+c],d?L(c,d,f,g):f(g);a._subscribers.length=0}}function I(){this.error=null}function L(a,c,d,f){var g=b(d),h,k,l,n;if(g){try{h=d(f)}catch(p){da.error=p,h=da}h===da?(n=!0,k=h.error,h=null):l=!0;if(c===
h){E(c,new TypeError("A promises callback cannot return that same promise."));return}}else h=f,l=!0;void 0===c._state&&(g&&l?G(c,h):n?E(c,k):1===a?F(c,h):2===a&&E(c,h))}function S(a,b){try{b(function(b){G(a,b)},function(b){E(a,b)})}catch(c){E(a,c)}}function Q(a,b,c,d){this._instanceConstructor=a;this.promise=new a(l,d);this._abortOnReject=c;this._validateInput(b)?(this._input=b,this._remaining=this.length=b.length,this._init(),0===this.length?F(this.promise,this._result):(this.length=this.length||
0,this._enumerate(),0===this._remaining&&F(this.promise,this._result))):E(this.promise,this._validationError())}function O(a){this._id=la++;this._result=this._state=void 0;this._subscribers=[];if(l!==a){if(!b(a))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof O))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");S(this,a)}}var ca=
Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)},M=0,Z=function(a,b){X[M]=a;X[M+1]=b;M+=2;2===M&&U()},V="undefined"!==typeof window?window:{},aa=V.MutationObserver||V.WebKitMutationObserver,V="undefined"!==typeof Uint8ClampedArray&&"undefined"!==typeof importScripts&&"undefined"!==typeof MessageChannel,X=Array(1E3),U;U="undefined"!==typeof p&&"[object process]"==={}.toString.call(p)?q():aa?r():V?d():v();var R=new I,da=new I;Q.prototype._validateInput=
function(a){return ca(a)};Q.prototype._validationError=function(){return Error("Array Methods must be provided an Array")};Q.prototype._init=function(){this._result=Array(this.length)};Q.prototype._enumerate=function(){for(var a=this.length,b=this.promise,c=this._input,d=0;void 0===b._state&&d<a;d++)this._eachEntry(c[d],d)};Q.prototype._eachEntry=function(a,b){var c=this._instanceConstructor;"object"===typeof a&&null!==a?a.constructor===c&&void 0!==a._state?(a._onerror=null,this._settledAt(a._state,
b,a._result)):this._willSettleAt(c.resolve(a),b):(this._remaining--,this._result[b]=this._makeResult(1,b,a))};Q.prototype._settledAt=function(a,b,c){var d=this.promise;void 0===d._state&&(this._remaining--,this._abortOnReject&&2===a?E(d,c):this._result[b]=this._makeResult(a,b,c));0===this._remaining&&F(d,this._result)};Q.prototype._makeResult=function(a,b,c){return c};Q.prototype._willSettleAt=function(a,b){var c=this;K(a,void 0,function(a){c._settledAt(1,b,a)},function(a){c._settledAt(2,b,a)})};
var la=0;O.all=function(a,b){return(new Q(this,a,!0,b)).promise};O.race=function(a,b){function c(a){G(f,a)}function d(a){E(f,a)}var f=new this(l,b);if(!ca(a))return E(f,new TypeError("You must pass an array to race.")),f;for(var g=a.length,h=0;void 0===f._state&&h<g;h++)K(this.resolve(a[h]),void 0,c,d);return f};O.resolve=function(a,b){if(a&&"object"===typeof a&&a.constructor===this)return a;var c=new this(l,b);G(c,a);return c};O.reject=function(a,b){var c=new this(l,b);E(c,a);return c};O.prototype=
{constructor:O,then:function(a,b){var c=this._state;if(1===c&&!a||2===c&&!b)return this;var d=new this.constructor(l),f=this._result;if(c){var g=arguments[c-1];Z(function(){L(c,d,g,f)})}else K(this,d,a,b);return d},"catch":function(a){return this.then(null,a)}};var ta={Promise:O,polyfill:function(){var a;a="undefined"!==typeof g?g:"undefined"!==typeof window&&window.document?window:self;"Promise"in a&&"resolve"in a.Promise&&"reject"in a.Promise&&"all"in a.Promise&&"race"in a.Promise&&function(){var c;
new a.Promise(function(a){c=a});return b(c)}()||(a.Promise=O)}};c(49).amd?!(n=function(){return ta}.call(k,c,k,a),void 0!==n&&(a.exports=n)):"undefined"!==typeof a&&a.exports?a.exports=ta:"undefined"!==typeof this&&(this.ES6Promise=ta)}).call(this)}).call(k,c(14),function(){return this}(),c(22)(r))},function(r,k){r.exports=function(){throw Error("define cannot be used indirect");}}])});
