const mulTable=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shgTable=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function processImage(t,e,a,n){if("string"==typeof t&&(t=document.getElementById(t)),!(t&&"naturalWidth"in t))return;const r=t.naturalWidth,s=t.naturalHeight;if("string"==typeof e&&(e=document.getElementById(e)),!(e&&"getContext"in e))return;e.style.width=r+"px",e.style.height=s+"px",e.width=r,e.height=s;const o=e.getContext("2d");o.clearRect(0,0,r,s),o.drawImage(t,0,0),isNaN(a)||a<1||(n?processCanvasRGBA(e,0,0,r,s,a):processCanvasRGB(e,0,0,r,s,a))}function getImageDataFromCanvas(t,e,a,n,r){if("string"==typeof t&&(t=document.getElementById(t)),!(t&&"getContext"in t))return;const s=t.getContext("2d");try{return s.getImageData(e,a,n,r)}catch(t){throw new Error("unable to access image data: "+t)}}function processCanvasRGBA(t,e,a,n,r,s){if(isNaN(s)||s<1)return;s|=0;let o=getImageDataFromCanvas(t,e,a,n,r);o=processImageDataRGBA(o,e,a,n,r,s),t.getContext("2d").putImageData(o,e,a)}function processImageDataRGBA(t,e,a,n,r,s){const o=t.data;let g,c,l,u,i,f,m,x,b,B,p,h,d,I,R,G,C,D,v,w,y,A,k,N;const S=s+s+1,T=n-1,E=r-1,F=s+1,W=F*(F+1)/2,H=new BlurStack;let j,q=H;for(l=1;l<S;l++)q=q.next=new BlurStack,l===F&&(j=q);q.next=H;let z=null,J=null;m=f=0;const K=mulTable[s],L=shgTable[s];for(c=0;c<r;c++){for(G=C=D=v=x=b=B=p=0,h=F*(w=o[f]),d=F*(y=o[f+1]),I=F*(A=o[f+2]),R=F*(k=o[f+3]),x+=W*w,b+=W*y,B+=W*A,p+=W*k,q=H,l=0;l<F;l++)q.r=w,q.g=y,q.b=A,q.a=k,q=q.next;for(l=1;l<F;l++)u=f+((T<l?T:l)<<2),x+=(q.r=w=o[u])*(N=F-l),b+=(q.g=y=o[u+1])*N,B+=(q.b=A=o[u+2])*N,p+=(q.a=k=o[u+3])*N,G+=w,C+=y,D+=A,v+=k,q=q.next;for(z=H,J=j,g=0;g<n;g++)o[f+3]=k=p*K>>L,0!==k?(k=255/k,o[f]=(x*K>>L)*k,o[f+1]=(b*K>>L)*k,o[f+2]=(B*K>>L)*k):o[f]=o[f+1]=o[f+2]=0,x-=h,b-=d,B-=I,p-=R,h-=z.r,d-=z.g,I-=z.b,R-=z.a,u=m+((u=g+s+1)<T?u:T)<<2,x+=G+=z.r=o[u],b+=C+=z.g=o[u+1],B+=D+=z.b=o[u+2],p+=v+=z.a=o[u+3],z=z.next,h+=w=J.r,d+=y=J.g,I+=A=J.b,R+=k=J.a,G-=w,C-=y,D-=A,v-=k,J=J.next,f+=4;m+=n}for(g=0;g<n;g++){for(C=D=v=G=b=B=p=x=0,h=F*(w=o[f=g<<2]),d=F*(y=o[f+1]),I=F*(A=o[f+2]),R=F*(k=o[f+3]),x+=W*w,b+=W*y,B+=W*A,p+=W*k,q=H,l=0;l<F;l++)q.r=w,q.g=y,q.b=A,q.a=k,q=q.next;for(i=n,l=1;l<=s;l++)f=i+g<<2,x+=(q.r=w=o[f])*(N=F-l),b+=(q.g=y=o[f+1])*N,B+=(q.b=A=o[f+2])*N,p+=(q.a=k=o[f+3])*N,G+=w,C+=y,D+=A,v+=k,q=q.next,l<E&&(i+=n);for(f=g,z=H,J=j,c=0;c<r;c++)o[(u=f<<2)+3]=k=p*K>>L,k>0?(k=255/k,o[u]=(x*K>>L)*k,o[u+1]=(b*K>>L)*k,o[u+2]=(B*K>>L)*k):o[u]=o[u+1]=o[u+2]=0,x-=h,b-=d,B-=I,p-=R,h-=z.r,d-=z.g,I-=z.b,R-=z.a,u=g+((u=c+F)<E?u:E)*n<<2,x+=G+=z.r=o[u],b+=C+=z.g=o[u+1],B+=D+=z.b=o[u+2],p+=v+=z.a=o[u+3],z=z.next,h+=w=J.r,d+=y=J.g,I+=A=J.b,R+=k=J.a,G-=w,C-=y,D-=A,v-=k,J=J.next,f+=n}return t}function processCanvasRGB(t,e,a,n,r,s){if(isNaN(s)||s<1)return;s|=0;let o=getImageDataFromCanvas(t,e,a,n,r);o=processImageDataRGB(o,e,a,n,r,s),t.getContext("2d").putImageData(o,e,a)}function processImageDataRGB(t,e,a,n,r,s){const o=t.data;let g,c,l,u,i,f,m,x,b,B,p,h,d,I,R,G,C,D,v,w;const y=s+s+1,A=n-1,k=r-1,N=s+1,S=N*(N+1)/2,T=new BlurStack;let E,F=T;for(l=1;l<y;l++)F=F.next=new BlurStack,l===N&&(E=F);F.next=T;let W=null,H=null;m=f=0;const j=mulTable[s],q=shgTable[s];for(c=0;c<r;c++){for(I=R=G=x=b=B=0,p=N*(C=o[f]),h=N*(D=o[f+1]),d=N*(v=o[f+2]),x+=S*C,b+=S*D,B+=S*v,F=T,l=0;l<N;l++)F.r=C,F.g=D,F.b=v,F=F.next;for(l=1;l<N;l++)u=f+((A<l?A:l)<<2),x+=(F.r=C=o[u])*(w=N-l),b+=(F.g=D=o[u+1])*w,B+=(F.b=v=o[u+2])*w,I+=C,R+=D,G+=v,F=F.next;for(W=T,H=E,g=0;g<n;g++)o[f]=x*j>>q,o[f+1]=b*j>>q,o[f+2]=B*j>>q,x-=p,b-=h,B-=d,p-=W.r,h-=W.g,d-=W.b,u=m+((u=g+s+1)<A?u:A)<<2,x+=I+=W.r=o[u],b+=R+=W.g=o[u+1],B+=G+=W.b=o[u+2],W=W.next,p+=C=H.r,h+=D=H.g,d+=v=H.b,I-=C,R-=D,G-=v,H=H.next,f+=4;m+=n}for(g=0;g<n;g++){for(R=G=I=b=B=x=0,p=N*(C=o[f=g<<2]),h=N*(D=o[f+1]),d=N*(v=o[f+2]),x+=S*C,b+=S*D,B+=S*v,F=T,l=0;l<N;l++)F.r=C,F.g=D,F.b=v,F=F.next;for(i=n,l=1;l<=s;l++)f=i+g<<2,x+=(F.r=C=o[f])*(w=N-l),b+=(F.g=D=o[f+1])*w,B+=(F.b=v=o[f+2])*w,I+=C,R+=D,G+=v,F=F.next,l<k&&(i+=n);for(f=g,W=T,H=E,c=0;c<r;c++)o[u=f<<2]=x*j>>q,o[u+1]=b*j>>q,o[u+2]=B*j>>q,x-=p,b-=h,B-=d,p-=W.r,h-=W.g,d-=W.b,u=g+((u=c+N)<k?u:k)*n<<2,x+=I+=W.r=o[u],b+=R+=W.g=o[u+1],B+=G+=W.b=o[u+2],W=W.next,p+=C=H.r,h+=D=H.g,d+=v=H.b,I-=C,R-=D,G-=v,H=H.next,f+=n}return t}class BlurStack{constructor(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}}export{BlurStack,processImage as image,processCanvasRGBA as canvasRGBA,processCanvasRGB as canvasRGB,processImageDataRGBA as imageDataRGBA,processImageDataRGB as imageDataRGB};
//# sourceMappingURL=stackblur-es.min.js.map
