(function(f,v){"object"===typeof exports&&"undefined"!==typeof module?v(exports):"function"===typeof define&&define.amd?define(["exports"],v):v(f.redom={})})(this,function(f){function v(a,c,b){for(var d=Array(c.length),e=0;e<c.length;e++)d[e]=c[e]&&g(c[e]);for(e=0;e<c.length;e++){var h=c[e];if(h){var m=d[e];if(m===b)b=b.nextSibling;else if(m&&m.nodeType){m=b&&b.nextSibling;var f=null!=h.__redom_index&&m===d[e+1];k(a,h,b,f);f&&(b=m)}else null!=h.length&&(b=v(a,h,b))}}return b}var y=function(a,c){for(var b,
d=null,e=b=null,h=0,f=0,g=0;g<=a.length;g++){var l=a.charCodeAt(g),r=35===l,p=46===l;l=!l;if(r||p||l)0===h?d=0===g?"div":a.substring(f,g):1===h?b=a.substring(f,g):e=e?e+(" "+a.substring(f,g)):a.substring(f,g),r?h=1:p&&(h=2),f=g+1}a=d;a=c?document.createElementNS(c,a):document.createElement(a);b&&(a.id=b);e&&(c?a.setAttribute("class",e):a.className=e);return a},n=function(a,c){a=g(a);var b=g(c);c===b&&b.__redom_view&&(c=b.__redom_view);b.parentNode&&(L(c,b,a),a.removeChild(b));return c},L=function(a,
c,b){a=c.__redom_lifecycle;if(M(a))c.__redom_mounted=!1;else for(c.__redom_mounted&&z(c,"onunmount");b;){c=b.__redom_lifecycle||{};for(var d in a)c[d]&&(c[d]-=a[d]);M(c)&&(b.__redom_lifecycle=null);b=b.parentNode}},M=function(a){if(null==a)return!0;for(var c in a)if(a[c])return!1;return!0},N=["onmount","onremount","onunmount"],Q="undefined"!==typeof window&&"ShadowRoot"in window,k=function(a,c,b,d){var e=g(a);a=g(c);c===a&&a.__redom_view&&(c=a.__redom_view);c!==a&&(a.__redom_view=c);var h=a.parentNode;
a.__redom_mounted&&h!==e&&L(c,a,h);null!=b?d?e.replaceChild(a,g(b)):e.insertBefore(a,g(b)):e.appendChild(a);d=c;b=a.__redom_lifecycle||(a.__redom_lifecycle={});h=e===h;for(var f=!1,k=0;k<N.length;k+=1){var l=N[k];h||d!==a&&l in d&&(b[l]=(b[l]||0)+1);b[l]&&(f=!0)}if(f){d=!1;if(h||e&&e.__redom_mounted)z(a,h?"onremount":"onmount"),d=!0;for(;e;){a=e.parentNode;f=e.__redom_lifecycle||(e.__redom_lifecycle={});for(var r in b)f[r]=(f[r]||0)+b[r];if(d)break;else{if(e===document||Q&&e instanceof window.ShadowRoot||
a&&a.__redom_mounted)z(e,h?"onremount":"onmount"),d=!0;e=a}}}else a.__redom_mounted=!0;return c},z=function(a,c){"onmount"===c||"onremount"===c?a.__redom_mounted=!0:"onunmount"===c&&(a.__redom_mounted=!1);var b=a.__redom_lifecycle;if(b){var d=a.__redom_view,e=0;d&&d[c]&&d[c]();for(var f in b)f&&e++;if(e)for(a=a.firstChild;a;)b=a.nextSibling,z(a,c),a=b}},E=function(a,c,b){a=g(a);if(void 0!==b)a.style[c]=b;else if(A(c))a.setAttribute("style",c);else for(var d in c)E(a,d,c[d])},F=function(a,c,b){a=g(a);
var d=a instanceof SVGElement;if(void 0!==b)if("style"===c)E(a,b);else if(d&&w(b))a[c]=b;else if("dataset"===c)for(var e in b)a.dataset[e]=b[e];else if(!d&&(c in a||w(b)))a[c]=b;else if(d&&"xlink"===c)for(var f in b)a.setAttributeNS("http://www.w3.org/1999/xlink",f,b[f]);else a.setAttribute(c,b);else for(var m in c)F(a,m,c[m])},G=function(a){return document.createTextNode(null!=a?a:"")},H=function(a,c){for(var b=0;b<c.length;b+=1){var d=c[b];if(0===d||d){var e=typeof d;if("function"===e)d(a);else if("string"===
e||"number"===e)a.appendChild(G(d));else{var f=g(d);f&&f.nodeType?k(a,d):d.length?H(a,d):"object"===e&&F(a,d)}}}},O=function(a){return A(a)?q(a):g(a)},g=function(a){return a.nodeType&&a||!a.el&&a||g(a.el)},A=function(a){return"string"===typeof a},w=function(a){return"function"===typeof a},B={},q=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];if(A(a))b=(B[a]||(B[a]=y(a))).cloneNode(!1);else if(a&&a.nodeType)b=a.cloneNode(!1);else if(w(a))b=new (Function.prototype.bind.apply(a,
[null].concat(c)));else throw Error("At least one argument required");H(g(b),c);return b};q.extend=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];b=B[a]||(B[a]=y(a));return q.bind.apply(q,[this,b].concat(c))};var I=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];b=g(a);for(c=v(a,c,b.firstChild);c;)b=c.nextSibling,n(a,c),c=b},R=function(a){return function(c){return c[a]}},C=function(a,c,b){this.View=a;this.initData=b;this.oldLookup={};this.lookup=
{};this.oldViews=[];this.views=[];null!=c&&(this.key=w(c)?c:R(c))};C.prototype.update=function(a,c){for(var b=this.View,d=this.key,e=this.initData,f=null!=d,m=this.lookup,k={},l=Array(a.length),r=this.views,p=0;p<a.length;p++){var n=a[p];if(f){var q=d(n);var t=m[q]||new b(e,n,p,a);k[q]=t;t.__redom_id=q}else t=r[p]||new b(e,n,p,a);t.update&&t.update(n,p,a,c);g(t.el).__redom_view=t;l[p]=t}this.oldViews=r;this.views=l;this.oldLookup=m;this.lookup=k};var P=function(a,c,b,d){return new u(a,c,b,d)},u=function(a,
c,b,d){this.__redom_list=!0;this.View=c;this.initData=d;this.views=[];this.pool=new C(c,b,d);this.el=O(a);this.keySet=null!=b};u.prototype.update=function(a,c){void 0===a&&(a=[]);var b=this.keySet,d=this.views;this.pool.update(a,c);c=this.pool;a=c.views;c=c.lookup;if(b)for(var e=0;e<d.length;e++){var f=d[e];null==c[f.__redom_id]&&(f.__redom_index=null,n(this,f))}for(d=0;d<a.length;d++)a[d].__redom_index=d;I(this,a);b&&(this.lookup=c);this.views=a};u.extend=function(a,c,b,d){return u.bind(u,a,c,b,
d)};P.extend=u.extend;var J=function(a,c){this.el=G("");this.visible=!1;this.view=null;this._placeholder=this.el;a instanceof Node?this._el=a:this._View=a;this._initData=c};J.prototype.update=function(a,c){var b=this._placeholder,d=this.el.parentNode;if(a){if(!this.visible){if(this._el){k(d,this._el,b);n(d,b);this.el=this._el;this.visible=a;return}var e=new this._View(this._initData);this.el=g(e);this.view=e;k(d,e,b);n(d,b)}this.view&&this.view.update&&this.view.update(c)}else if(this.visible){if(this._el){k(d,
b,this._el);n(d,this._el);this.el=b;this.visible=a;return}k(d,b,this.view);n(d,this.view);this.el=b;this.view=null}this.visible=a};var K=function(a,c,b){this.el=O(a);this.Views=c;this.initData=b};K.prototype.update=function(a,c){if(a!==this.route){var b=this.Views[a];this.route=a;this.view=b&&new b(this.initData,c);I(this.el,[this.view])}this.view&&this.view.update&&this.view.update(c,a)};var D={},x=function(a){for(var c=[],b=arguments.length-1;0<b--;)c[b]=arguments[b+1];if(A(a))b=(D[a]||(D[a]=y(a,
"http://www.w3.org/2000/svg"))).cloneNode(!1);else if(a&&a.nodeType)b=a.cloneNode(!1);else if(w(a))b=new (Function.prototype.bind.apply(a,[null].concat(c)));else throw Error("At least one argument required");H(g(b),c);return b};x.extend=function(a){a=D[a]||(D[a]=y(a,"http://www.w3.org/2000/svg"));return x.bind(this,a)};x.ns="http://www.w3.org/2000/svg";f.el=q;f.h=q;f.html=q;f.list=P;f.List=u;f.listPool=function(a,c,b){return new C(a,c,b)};f.ListPool=C;f.mount=k;f.unmount=n;f.place=function(a,c){return new J(a,
c)};f.Place=J;f.router=function(a,c,b){return new K(a,c,b)};f.Router=K;f.setAttr=F;f.setStyle=E;f.setChildren=I;f.s=x;f.svg=x;f.text=G;Object.defineProperty(f,"__esModule",{value:!0})});
