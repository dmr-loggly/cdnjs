{"version":3,"sources":["lazyload.js"],"names":["global","factory","exports","_typeof","module","define","amd","LazyLoad","this","event","element","eventString","detail","isBelowViewport","container","threshold","document","createEvent","initCustomEvent","isAtLeftOfViewport","getDefaultSettings","elements_selector","window","throttle","data_src","data_srcset","data_sizes","class_loading","class_loaded","class_error","class_initial","skip_invisible","callback_load","callback_error","callback_enter","callback","argument","to_webp","getBoundingClientRect","top","pageYOffset","ownerDocument","documentElement","clientTop","fold","getTopOffset","offsetHeight","getLeftOffset","isAtRightOfViewport","left","documentWidth","isAboveViewport","pageXOffset","createInstance","options","instance","offsetWidth","classObj","CustomEvent","optionsItem","dispatchEvent","replaceExtToWebp","attribute","condition","getWasProcessed","detectWebp","value","webpString","canvas","setData","processedDataName","getData","runningOnBrowser","isBot","setAttributeIfValue","test","navigator","userAgent","supportsClassList","createElement","supportsWebp","getContext","attrName","setSourcesInChildren","setSourcesImg","parentTag","dataAttrName","toWebpFlag","parent","srcsetDataName","childTag","tagName","sizesDataValue","srcDataName","settings","addClass","add","className","srcDataValue","style","backgroundImage","setValue","IMG","parentNode","setSourcesBgImage","srcsetDataValue","IFRAME","setSourcesIframe","setSourcesFunction","setSourcesFunctions","setSources","_boundHandleScroll","_isFirstLoop","_reveal","classList","remove","_settings","replace","RegExp","errorCallback","callCallback","instanceSettings","_queryOriginNode","_previousLoopTime","_loopTimeout","removeClass","removeEventListener","force","addEventListener","_loopThroughElements","elementsLength","elements","loadCallback","i","processedIndexes","firstLoop","forceDownload","push","setWasProcessed","indexOf","splice","callback_processed","_stopScrollHandler","_elements","length","_purgeElements","offsetParent","isInsideViewport","elementsToPurge","_startScrollHandler","_isHandlingScroll","pop","clearTimeout","setTimeout","update","destroy","handleScroll","load","now","remainingTime","Date","bind","loadAll","Array","prototype","slice","call","querySelectorAll","processedDataValue","autoInitialize","lazyLoadOptions"],"mappings":"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","file":"lazyload.min.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.LazyLoad = factory());\n}(this, (function () { 'use strict';\n\nvar getDefaultSettings = () => ({\r\n\telements_selector: \"img\",\r\n\tcontainer: window,\r\n\tthreshold: 300,\r\n\tthrottle: 150,\r\n\tdata_src: \"src\",\r\n\tdata_srcset: \"srcset\",\r\n\tdata_sizes: \"sizes\",\r\n\tclass_loading: \"loading\",\r\n\tclass_loaded: \"loaded\",\r\n\tclass_error: \"error\",\r\n\tclass_initial: \"initial\",\r\n\tskip_invisible: true,\r\n\tcallback_load: null,\r\n\tcallback_error: null,\r\n\tcallback_set: null,\r\n\tcallback_processed: null,\r\n\tcallback_enter: null,\r\n\tto_webp: false\r\n});\n\nconst callCallback = function(callback, argument) {\r\n\tif (callback) {\r\n\t\tcallback(argument);\r\n\t}\r\n};\n\nconst getTopOffset = function(element) {\r\n\treturn (\r\n\t\telement.getBoundingClientRect().top +\r\n\t\twindow.pageYOffset -\r\n\t\telement.ownerDocument.documentElement.clientTop\r\n\t);\r\n};\r\n\r\nconst isBelowViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window\r\n\t\t\t? window.innerHeight + window.pageYOffset\r\n\t\t\t: getTopOffset(container) + container.offsetHeight;\r\n\treturn fold <= getTopOffset(element) - threshold;\r\n};\r\n\r\nconst getLeftOffset = function(element) {\r\n\treturn (\r\n\t\telement.getBoundingClientRect().left +\r\n\t\twindow.pageXOffset -\r\n\t\telement.ownerDocument.documentElement.clientLeft\r\n\t);\r\n};\r\n\r\nconst isAtRightOfViewport = function(element, container, threshold) {\r\n\tconst documentWidth = window.innerWidth;\r\n\tconst fold =\r\n\t\tcontainer === window\r\n\t\t\t? documentWidth + window.pageXOffset\r\n\t\t\t: getLeftOffset(container) + documentWidth;\r\n\treturn fold <= getLeftOffset(element) - threshold;\r\n};\r\n\r\nconst isAboveViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window ? window.pageYOffset : getTopOffset(container);\r\n\treturn fold >= getTopOffset(element) + threshold + element.offsetHeight;\r\n};\r\n\r\nconst isAtLeftOfViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window ? window.pageXOffset : getLeftOffset(container);\r\n\treturn fold >= getLeftOffset(element) + threshold + element.offsetWidth;\r\n};\r\n\r\nfunction isInsideViewport(element, container, threshold) {\r\n\treturn (\r\n\t\t!isBelowViewport(element, container, threshold) &&\r\n\t\t!isAboveViewport(element, container, threshold) &&\r\n\t\t!isAtRightOfViewport(element, container, threshold) &&\r\n\t\t!isAtLeftOfViewport(element, container, threshold)\r\n\t);\r\n}\n\n/* Creates instance and notifies it through the window element */\r\nconst createInstance = function(classObj, options) {\r\n\tvar event;\r\n\tlet eventString = \"LazyLoad::Initialized\";\r\n\tlet instance = new classObj(options);\r\n\ttry {\r\n\t\t// Works in modern browsers\r\n\t\tevent = new CustomEvent(eventString, { detail: { instance } });\r\n\t} catch (err) {\r\n\t\t// Works in Internet Explorer (all versions)\r\n\t\tevent = document.createEvent(\"CustomEvent\");\r\n\t\tevent.initCustomEvent(eventString, false, false, { instance });\r\n\t}\r\n\twindow.dispatchEvent(event);\r\n};\r\n\r\n/* Auto initialization of one or more instances of lazyload, depending on the \r\n    options passed in (plain object or an array) */\r\nfunction autoInitialize(classObj, options) {\r\n\tif (!options) {\r\n\t\treturn;\r\n\t}\r\n\tif (!options.length) {\r\n\t\t// Plain object\r\n\t\tcreateInstance(classObj, options);\r\n\t} else {\r\n\t\t// Array of objects\r\n\t\tfor (let i = 0, optionsItem; (optionsItem = options[i]); i += 1) {\r\n\t\t\tcreateInstance(classObj, optionsItem);\r\n\t\t}\r\n\t}\r\n}\n\nconst dataPrefix = \"data-\";\r\nconst processedDataName = \"was-processed\";\r\nconst processedDataValue = \"true\";\r\n\r\nconst getData = (element, attribute) => {\r\n\treturn element.getAttribute(dataPrefix + attribute);\r\n};\r\n\r\nconst setData = (element, attribute, value) => {\r\n\treturn element.setAttribute(dataPrefix + attribute, value);\r\n};\r\n\r\nconst setWasProcessed = element =>\r\n\tsetData(element, processedDataName, processedDataValue);\r\n\r\nconst getWasProcessed = element =>\r\n\tgetData(element, processedDataName) === processedDataValue;\n\nconst replaceExtToWebp = (value, condition) =>\r\n\tcondition ? value.replace(/\\.(jpe?g|png)/gi, \".webp\") : value;\r\n\r\nconst detectWebp = () => {\r\n\tvar webpString = \"image/webp\";\r\n\tvar canvas = document.createElement(\"canvas\");\r\n\r\n\tif (canvas.getContext && canvas.getContext(\"2d\")) {\r\n\t\treturn canvas.toDataURL(webpString).indexOf(`data:${webpString}`) === 0;\r\n\t}\r\n\r\n\treturn false;\r\n};\n\nconst runningOnBrowser = typeof window !== \"undefined\";\r\n\r\nconst isBot =\r\n\t(runningOnBrowser && !(\"onscroll\" in window)) ||\r\n\t/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent);\r\nconst supportsClassList =\r\n\trunningOnBrowser && \"classList\" in document.createElement(\"p\");\r\n\r\nconst supportsWebp = runningOnBrowser && detectWebp();\n\nconst setSourcesInChildren = function(\r\n\tparentTag,\r\n\tattrName,\r\n\tdataAttrName,\r\n\ttoWebpFlag\r\n) {\r\n\tfor (let i = 0, childTag; (childTag = parentTag.children[i]); i += 1) {\r\n\t\tif (childTag.tagName === \"SOURCE\") {\r\n\t\t\tlet attrValue = getData(childTag, dataAttrName);\r\n\t\t\tsetAttributeIfValue(childTag, attrName, attrValue, toWebpFlag);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst setAttributeIfValue = function(\r\n\telement,\r\n\tattrName,\r\n\tvalue,\r\n\ttoWebpFlag\r\n) {\r\n\tif (!value) {\r\n\t\treturn;\r\n\t}\r\n\telement.setAttribute(attrName, replaceExtToWebp(value, toWebpFlag));\r\n};\r\n\r\nconst setSourcesImg = (element, settings) => {\r\n\tconst toWebpFlag = supportsWebp && settings.to_webp;\r\n\tconst srcsetDataName = settings.data_srcset;\r\n\tconst parent = element.parentNode;\r\n\r\n\tif (parent && parent.tagName === \"PICTURE\") {\r\n\t\tsetSourcesInChildren(parent, \"srcset\", srcsetDataName, toWebpFlag);\r\n\t}\r\n\tconst sizesDataValue = getData(element, settings.data_sizes);\r\n\tsetAttributeIfValue(element, \"sizes\", sizesDataValue);\r\n\tconst srcsetDataValue = getData(element, srcsetDataName);\r\n\tsetAttributeIfValue(element, \"srcset\", srcsetDataValue, toWebpFlag);\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue, toWebpFlag);\r\n};\r\n\r\nconst setSourcesIframe = (element, settings) => {\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue);\r\n};\r\n\r\nconst setSourcesVideo = (element, settings) => {\r\n\tconst srcDataName = settings.data_src;\r\n\tconst srcDataValue = getData(element, srcDataName);\r\n\r\n\tsetSourcesInChildren(element, \"src\", srcDataName);\r\n\tsetAttributeIfValue(element, \"src\", srcDataValue);\r\n\telement.load();\r\n};\r\n\r\nconst setSourcesBgImage = (element, settings) => {\r\n\tconst toWebpFlag = supportsWebp && settings.to_webp;\r\n\tconst srcDataValue = getData(element, settings.data_src);\r\n\r\n\tif (srcDataValue) {\r\n\t\tlet setValue = replaceExtToWebp(srcDataValue, toWebpFlag);\r\n\t\telement.style.backgroundImage = `url(\"${setValue}\")`;\r\n\t}\r\n};\r\n\r\nconst setSourcesFunctions = {\r\n\tIMG: setSourcesImg,\r\n\tIFRAME: setSourcesIframe,\r\n\tVIDEO: setSourcesVideo\r\n};\r\n\r\nconst setSources = (element, settings) => {\r\n\tconst tagName = element.tagName;\r\n\tconst setSourcesFunction = setSourcesFunctions[tagName];\r\n\tif (setSourcesFunction) {\r\n\t\tsetSourcesFunction(element, settings);\r\n\t\treturn;\r\n\t}\r\n\tsetSourcesBgImage(element, settings);\r\n};\n\nconst addClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.add(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className += (element.className ? \" \" : \"\") + className;\r\n};\r\n\r\nconst removeClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.remove(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className = element.className.\r\n\t\treplace(new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\"), \" \").\r\n\t\treplace(/^\\s+/, \"\").\r\n\t\treplace(/\\s+$/, \"\");\r\n};\n\n/*\r\n * Constructor\r\n */\r\n\r\nconst LazyLoad = function(instanceSettings) {\r\n\tthis._settings = Object.assign({}, getDefaultSettings(), instanceSettings);\r\n\tthis._queryOriginNode =\r\n\t\tthis._settings.container === window\r\n\t\t\t? document\r\n\t\t\t: this._settings.container;\r\n\r\n\tthis._previousLoopTime = 0;\r\n\tthis._loopTimeout = null;\r\n\tthis._boundHandleScroll = this.handleScroll.bind(this);\r\n\r\n\tthis._isFirstLoop = true;\r\n\twindow.addEventListener(\"resize\", this._boundHandleScroll);\r\n\tthis.update();\r\n};\r\n\r\nLazyLoad.prototype = {\r\n\t_reveal: function(element, force) {\r\n\t\tif (!force && getWasProcessed(element)) {\r\n\t\t\treturn; // element has already been processed and force wasn't true\r\n\t\t}\r\n\r\n\t\tconst settings = this._settings;\r\n\r\n\t\tconst errorCallback = function() {\r\n\t\t\t/* As this method is asynchronous, it must be protected against external destroy() calls */\r\n\t\t\tif (!settings) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telement.removeEventListener(\"load\", loadCallback);\r\n\t\t\telement.removeEventListener(\"error\", errorCallback);\r\n\t\t\tremoveClass(element, settings.class_loading);\r\n\t\t\taddClass(element, settings.class_error);\r\n\t\t\tcallCallback(settings.callback_error, element);\r\n\t\t};\r\n\r\n\t\tconst loadCallback = function() {\r\n\t\t\t/* As this method is asynchronous, it must be protected against external destroy() calls */\r\n\t\t\tif (!settings) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tremoveClass(element, settings.class_loading);\r\n\t\t\taddClass(element, settings.class_loaded);\r\n\t\t\telement.removeEventListener(\"load\", loadCallback);\r\n\t\t\telement.removeEventListener(\"error\", errorCallback);\r\n\t\t\tcallCallback(settings.callback_load, element);\r\n\t\t};\r\n\r\n\t\tcallCallback(settings.callback_enter, element);\r\n\t\tif ([\"IMG\", \"IFRAME\", \"VIDEO\"].indexOf(element.tagName) > -1) {\r\n\t\t\telement.addEventListener(\"load\", loadCallback);\r\n\t\t\telement.addEventListener(\"error\", errorCallback);\r\n\t\t\taddClass(element, settings.class_loading);\r\n\t\t}\r\n\t\tsetSources(element, settings);\r\n\t\tcallCallback(settings.callback_set, element);\r\n\t},\r\n\r\n\t_loopThroughElements: function(forceDownload) {\r\n\t\tconst settings = this._settings,\r\n\t\t\telements = this._elements,\r\n\t\t\telementsLength = !elements ? 0 : elements.length;\r\n\t\tlet i,\r\n\t\t\tprocessedIndexes = [],\r\n\t\t\tfirstLoop = this._isFirstLoop;\r\n\r\n\t\tfor (i = 0; i < elementsLength; i++) {\r\n\t\t\tlet element = elements[i];\r\n\t\t\t/* If must skip_invisible and element is invisible, skip it */\r\n\t\t\tif (settings.skip_invisible && element.offsetParent === null) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tisBot ||\r\n\t\t\t\tforceDownload ||\r\n\t\t\t\tisInsideViewport(\r\n\t\t\t\t\telement,\r\n\t\t\t\t\tsettings.container,\r\n\t\t\t\t\tsettings.threshold\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\tif (firstLoop) {\r\n\t\t\t\t\taddClass(element, settings.class_initial);\r\n\t\t\t\t}\r\n\t\t\t\t/* Start loading the image */\r\n\t\t\t\tthis.load(element);\r\n\t\t\t\t/* Marking the element as processed. */\r\n\t\t\t\tprocessedIndexes.push(i);\r\n\t\t\t\tsetWasProcessed(element);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* Removing processed elements from this._elements. */\r\n\t\twhile (processedIndexes.length) {\r\n\t\t\telements.splice(processedIndexes.pop(), 1);\r\n\t\t\tcallCallback(settings.callback_processed, elements.length);\r\n\t\t}\r\n\t\t/* Stop listening to scroll event when 0 elements remains */\r\n\t\tif (elementsLength === 0) {\r\n\t\t\tthis._stopScrollHandler();\r\n\t\t}\r\n\t\t/* Sets isFirstLoop to false */\r\n\t\tif (firstLoop) {\r\n\t\t\tthis._isFirstLoop = false;\r\n\t\t}\r\n\t},\r\n\r\n\t_purgeElements: function() {\r\n\t\tconst elements = this._elements,\r\n\t\t\telementsLength = elements.length;\r\n\t\tlet i,\r\n\t\t\telementsToPurge = [];\r\n\r\n\t\tfor (i = 0; i < elementsLength; i++) {\r\n\t\t\tlet element = elements[i];\r\n\t\t\t/* If the element has already been processed, skip it */\r\n\t\t\tif (getWasProcessed(element)) {\r\n\t\t\t\telementsToPurge.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* Removing elements to purge from this._elements. */\r\n\t\twhile (elementsToPurge.length > 0) {\r\n\t\t\telements.splice(elementsToPurge.pop(), 1);\r\n\t\t}\r\n\t},\r\n\r\n\t_startScrollHandler: function() {\r\n\t\tif (!this._isHandlingScroll) {\r\n\t\t\tthis._isHandlingScroll = true;\r\n\t\t\tthis._settings.container.addEventListener(\r\n\t\t\t\t\"scroll\",\r\n\t\t\t\tthis._boundHandleScroll\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\r\n\t_stopScrollHandler: function() {\r\n\t\tif (this._isHandlingScroll) {\r\n\t\t\tthis._isHandlingScroll = false;\r\n\t\t\tthis._settings.container.removeEventListener(\r\n\t\t\t\t\"scroll\",\r\n\t\t\t\tthis._boundHandleScroll\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\r\n\thandleScroll: function() {\r\n\t\tconst throttle = this._settings.throttle;\r\n\r\n\t\tif (throttle !== 0) {\r\n\t\t\tlet now = Date.now();\r\n\t\t\tlet remainingTime = throttle - (now - this._previousLoopTime);\r\n\t\t\tif (remainingTime <= 0 || remainingTime > throttle) {\r\n\t\t\t\tif (this._loopTimeout) {\r\n\t\t\t\t\tclearTimeout(this._loopTimeout);\r\n\t\t\t\t\tthis._loopTimeout = null;\r\n\t\t\t\t}\r\n\t\t\t\tthis._previousLoopTime = now;\r\n\t\t\t\tthis._loopThroughElements();\r\n\t\t\t} else if (!this._loopTimeout) {\r\n\t\t\t\tthis._loopTimeout = setTimeout(\r\n\t\t\t\t\tfunction() {\r\n\t\t\t\t\t\tthis._previousLoopTime = Date.now();\r\n\t\t\t\t\t\tthis._loopTimeout = null;\r\n\t\t\t\t\t\tthis._loopThroughElements();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\tremainingTime\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._loopThroughElements();\r\n\t\t}\r\n\t},\r\n\r\n\tloadAll: function() {\r\n\t\tthis._loopThroughElements(true);\r\n\t},\r\n\r\n\tupdate: function() {\r\n\t\t// Converts to array the nodeset obtained querying the DOM from _queryOriginNode with elements_selector\r\n\t\tthis._elements = Array.prototype.slice.call(\r\n\t\t\tthis._queryOriginNode.querySelectorAll(\r\n\t\t\t\tthis._settings.elements_selector\r\n\t\t\t)\r\n\t\t);\r\n\t\tthis._purgeElements();\r\n\t\tthis._loopThroughElements();\r\n\t\tthis._startScrollHandler();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\twindow.removeEventListener(\"resize\", this._boundHandleScroll);\r\n\t\tif (this._loopTimeout) {\r\n\t\t\tclearTimeout(this._loopTimeout);\r\n\t\t\tthis._loopTimeout = null;\r\n\t\t}\r\n\t\tthis._stopScrollHandler();\r\n\t\tthis._elements = null;\r\n\t\tthis._queryOriginNode = null;\r\n\t\tthis._settings = null;\r\n\t},\r\n\r\n\tload: function(element, force) {\r\n\t\tthis._reveal(element, force);\r\n\t}\r\n};\r\n\r\n/* Automatic instances creation if required (useful for async script loading) */\r\nif (runningOnBrowser) {\r\n\tautoInitialize(LazyLoad, window.lazyLoadOptions);\r\n}\n\nreturn LazyLoad;\n\n})));\n"]}