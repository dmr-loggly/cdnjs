{"version":3,"sources":["lazyload.js"],"names":["LazyLoad","isInsideViewport","element","container","threshold","isBelowViewport","isAboveViewport","isAtRightOfViewport","isAtLeftOfViewport","setSources","settings","sizesDataName","data_sizes","srcsetDataName","data_srcset","srcDataName","data_src","srcDataValue","getData","mustChangeToWebP","supportsWebP","to_webp","tagName","parent","parentNode","setSourcesInChildren","sizesDataValue","setAttributeIfNotNullOrEmpty","srcsetDataValue","setValue","replaceExtToWebp","style","backgroundImage","getDefaultSettings","elements_selector","window","throttle","class_loading","class_loaded","class_error","class_initial","skip_invisible","callback_load","callback_error","callback_set","callback_processed","callback_enter","callCallback","callback","argument","getTopOffset","getBoundingClientRect","top","pageYOffset","ownerDocument","documentElement","clientTop","innerHeight","offsetHeight","getLeftOffset","left","pageXOffset","clientLeft","documentWidth","innerWidth","offsetWidth","createInstance","classObj","options","event","instance","CustomEvent","detail","err","document","createEvent","initCustomEvent","dispatchEvent","attribute","getAttribute","setData","value","setAttribute","setWasProcessed","getWasProcessed","runningOnBrowser","isBot","test","navigator","userAgent","supportsClassList","createElement","elem","getContext","toDataURL","indexOf","detectWebP","parentTag","attrName","dataAttrName","toWebP","childTag","i","children","attrValue","condition","replace","addClass","className","classList","add","removeClass","remove","RegExp","instanceSettings","this","_settings","_extends","_queryOriginNode","_previousLoopTime","_loopTimeout","_boundHandleScroll","handleScroll","bind","_isFirstLoop","addEventListener","update","prototype","_reveal","force","errorCallback","removeEventListener","loadCallback","_loopThroughElements","forceDownload","elements","_elements","elementsLength","length","processedIndexes","firstLoop","offsetParent","load","push","splice","pop","_stopScrollHandler","_purgeElements","elementsToPurge","_startScrollHandler","_isHandlingScroll","now","Date","remainingTime","clearTimeout","setTimeout","loadAll","Array","slice","call","querySelectorAll","destroy","autoInitOptions","lazyLoadOptions","optsLength","autoInitialize"],"mappings":"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","file":"lazyload.iife.min.js","sourcesContent":["var LazyLoad = (function () {\n'use strict';\n\nvar getDefaultSettings = () => ({\r\n\telements_selector: \"img\",\r\n\tcontainer: window,\r\n\tthreshold: 300,\r\n\tthrottle: 150,\r\n\tdata_src: \"src\",\r\n\tdata_srcset: \"srcset\",\r\n\tdata_sizes: \"sizes\",\r\n\tclass_loading: \"loading\",\r\n\tclass_loaded: \"loaded\",\r\n\tclass_error: \"error\",\r\n\tclass_initial: \"initial\",\r\n\tskip_invisible: true,\r\n\tcallback_load: null,\r\n\tcallback_error: null,\r\n\tcallback_set: null,\r\n\tcallback_processed: null,\r\n\tcallback_enter: null,\r\n\tto_webp: false\r\n});\n\nconst callCallback = function(callback, argument) {\r\n\tif (callback) {\r\n\t\tcallback(argument);\r\n\t}\r\n};\n\nconst getTopOffset = function(element) {\r\n\treturn (\r\n\t\telement.getBoundingClientRect().top +\r\n\t\twindow.pageYOffset -\r\n\t\telement.ownerDocument.documentElement.clientTop\r\n\t);\r\n};\r\n\r\nconst isBelowViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window\r\n\t\t\t? window.innerHeight + window.pageYOffset\r\n\t\t\t: getTopOffset(container) + container.offsetHeight;\r\n\treturn fold <= getTopOffset(element) - threshold;\r\n};\r\n\r\nconst getLeftOffset = function(element) {\r\n\treturn (\r\n\t\telement.getBoundingClientRect().left +\r\n\t\twindow.pageXOffset -\r\n\t\telement.ownerDocument.documentElement.clientLeft\r\n\t);\r\n};\r\n\r\nconst isAtRightOfViewport = function(element, container, threshold) {\r\n\tconst documentWidth = window.innerWidth;\r\n\tconst fold =\r\n\t\tcontainer === window\r\n\t\t\t? documentWidth + window.pageXOffset\r\n\t\t\t: getLeftOffset(container) + documentWidth;\r\n\treturn fold <= getLeftOffset(element) - threshold;\r\n};\r\n\r\nconst isAboveViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window ? window.pageYOffset : getTopOffset(container);\r\n\treturn fold >= getTopOffset(element) + threshold + element.offsetHeight;\r\n};\r\n\r\nconst isAtLeftOfViewport = function(element, container, threshold) {\r\n\tconst fold =\r\n\t\tcontainer === window ? window.pageXOffset : getLeftOffset(container);\r\n\treturn fold >= getLeftOffset(element) + threshold + element.offsetWidth;\r\n};\r\n\r\nfunction isInsideViewport(element, container, threshold) {\r\n\treturn (\r\n\t\t!isBelowViewport(element, container, threshold) &&\r\n\t\t!isAboveViewport(element, container, threshold) &&\r\n\t\t!isAtRightOfViewport(element, container, threshold) &&\r\n\t\t!isAtLeftOfViewport(element, container, threshold)\r\n\t);\r\n}\n\n/* Creates instance and notifies it through the window element */\r\nconst createInstance = function (classObj, options) { \r\n    var event;\r\n    let eventString = \"LazyLoad::Initialized\";\r\n    let instance = new classObj(options);\r\n    try {\r\n        // Works in modern browsers\r\n        event = new CustomEvent(eventString, { detail: { instance } });\r\n    } \r\n    catch(err) {\r\n        // Works in Internet Explorer (all versions)\r\n        event = document.createEvent(\"CustomEvent\");\r\n        event.initCustomEvent(eventString, false, false, { instance });\r\n    }\r\n    window.dispatchEvent(event);\r\n};\r\n\r\n/* Auto initialization of one or more instances of lazyload, depending on the \r\n    options passed in (plain object or an array) */\r\nfunction autoInitialize (classObj, options) { \r\n    let optsLength = options.length;\r\n    if (!optsLength) {\r\n        // Plain object\r\n        createInstance(classObj, options);\r\n    }\r\n    else {\r\n        // Array of objects\r\n        for (let i = 0; i < optsLength; i++) {\r\n            createInstance(classObj, options[i]);\r\n        }\r\n    }\r\n}\n\nconst dataPrefix = \"data-\";\r\nconst processedDataName = \"was-processed\";\r\nconst processedDataValue = \"true\";\r\n\r\nconst getData = (element, attribute) => {\r\n\treturn element.getAttribute(dataPrefix + attribute);\r\n};\r\n\r\nconst setData = (element, attribute, value) => {\r\n\treturn element.setAttribute(dataPrefix + attribute, value);\r\n};\r\n\r\nconst setWasProcessed = element =>\r\n\tsetData(element, processedDataName, processedDataValue);\r\n\r\nconst getWasProcessed = element =>\r\n\tgetData(element, processedDataName) === processedDataValue;\n\nconst runningOnBrowser = typeof window !== \"undefined\";\r\n\r\nconst isBot =\r\n\t(runningOnBrowser && !(\"onscroll\" in window)) ||\r\n\t/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent);\r\nconst supportsClassList =\r\n\trunningOnBrowser && \"classList\" in document.createElement(\"p\");\r\n\r\nconst detectWebP = () => {\r\n\tif (!runningOnBrowser) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tvar webPString = \"image/webp\";\r\n\tvar elem = document.createElement(\"canvas\");\r\n\r\n\tif (elem.getContext && elem.getContext(\"2d\")) {\r\n\t\treturn elem.toDataURL(webPString).indexOf(\"data:\" + webPString) === 0;\r\n\t}\r\n\r\n\treturn false;\r\n};\r\n\r\nconst supportsWebP = detectWebP();\n\nconst setSourcesInChildren = function(\r\n\tparentTag,\r\n\tattrName,\r\n\tdataAttrName,\r\n\ttoWebP\r\n) {\r\n\tfor (let i = 0, childTag; (childTag = parentTag.children[i]); i += 1) {\r\n\t\tif (childTag.tagName === \"SOURCE\") {\r\n\t\t\tlet attrValue = getData(childTag, dataAttrName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(childTag, attrName, attrValue, toWebP);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst replaceExtToWebp = (value, condition) =>\r\n\tcondition ? value.replace(/\\.(jpe?g|png)/gi, \".webp\") : value;\r\n\r\nconst setAttributeIfNotNullOrEmpty = function(\r\n\telement,\r\n\tattrName,\r\n\tvalue,\r\n\ttoWebP\r\n) {\r\n\tif (!value) {\r\n\t\treturn;\r\n\t}\r\n\telement.setAttribute(attrName, replaceExtToWebp(value, toWebP));\r\n};\r\n\r\nfunction setSources(element, settings) {\r\n\tconst {\r\n\t\tdata_sizes: sizesDataName,\r\n\t\tdata_srcset: srcsetDataName,\r\n\t\tdata_src: srcDataName\r\n\t} = settings;\r\n\tconst srcDataValue = getData(element, srcDataName);\r\n\tconst mustChangeToWebP = supportsWebP && settings.to_webp;\r\n\tswitch (element.tagName) {\r\n\t\tcase \"IMG\": {\r\n\t\t\tconst parent = element.parentNode;\r\n\t\t\tif (parent && parent.tagName === \"PICTURE\") {\r\n\t\t\t\tsetSourcesInChildren(\r\n\t\t\t\t\tparent,\r\n\t\t\t\t\t\"srcset\",\r\n\t\t\t\t\tsrcsetDataName,\r\n\t\t\t\t\tmustChangeToWebP\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tconst sizesDataValue = getData(element, sizesDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"sizes\", sizesDataValue);\r\n\t\t\tconst srcsetDataValue = getData(element, srcsetDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(\r\n\t\t\t\telement,\r\n\t\t\t\t\"srcset\",\r\n\t\t\t\tsrcsetDataValue,\r\n\t\t\t\tmustChangeToWebP\r\n\t\t\t);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(\r\n\t\t\t\telement,\r\n\t\t\t\t\"src\",\r\n\t\t\t\tsrcDataValue,\r\n\t\t\t\tmustChangeToWebP\r\n\t\t\t);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"IFRAME\":\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"src\", srcDataValue);\r\n\t\t\tbreak;\r\n\t\tcase \"VIDEO\":\r\n\t\t\tsetSourcesInChildren(element, \"src\", srcDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"src\", srcDataValue);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tif (srcDataValue) {\r\n\t\t\t\tlet setValue = replaceExtToWebp(srcDataValue, mustChangeToWebP);\r\n\t\t\t\telement.style.backgroundImage = `url(\"${setValue}\")`;\r\n\t\t\t}\r\n\t}\r\n}\n\nconst addClass = (element, className) => {\r\n    if (supportsClassList) {\r\n        element.classList.add(className);\r\n        return;\r\n    }\r\n    element.className += (element.className ? \" \" : \"\") + className;\r\n};\r\n\r\nconst removeClass = (element, className) => {\r\n    if (supportsClassList) {\r\n        element.classList.remove(className);\r\n        return;\r\n    }\r\n    element.className = element.className.replace(new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\"), \" \").replace(/^\\s+/, \"\").replace(/\\s+$/, \"\");\r\n};\n\n/*\r\n * Constructor\r\n */\r\n\r\nconst LazyLoad = function(instanceSettings) {\r\n\tthis._settings = Object.assign({}, getDefaultSettings(), instanceSettings);\r\n\tthis._queryOriginNode =\r\n\t\tthis._settings.container === window\r\n\t\t\t? document\r\n\t\t\t: this._settings.container;\r\n\r\n\tthis._previousLoopTime = 0;\r\n\tthis._loopTimeout = null;\r\n\tthis._boundHandleScroll = this.handleScroll.bind(this);\r\n\r\n\tthis._isFirstLoop = true;\r\n\twindow.addEventListener(\"resize\", this._boundHandleScroll);\r\n\tthis.update();\r\n};\r\n\r\nLazyLoad.prototype = {\r\n\t_reveal: function(element, force) {\r\n\t\tif (!force && getWasProcessed(element)) {\r\n\t\t\treturn; // element has already been processed and force wasn't true\r\n\t\t}\r\n\r\n\t\tconst settings = this._settings;\r\n\r\n\t\tconst errorCallback = function() {\r\n\t\t\t/* As this method is asynchronous, it must be protected against external destroy() calls */\r\n\t\t\tif (!settings) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telement.removeEventListener(\"load\", loadCallback);\r\n\t\t\telement.removeEventListener(\"error\", errorCallback);\r\n\t\t\tremoveClass(element, settings.class_loading);\r\n\t\t\taddClass(element, settings.class_error);\r\n\t\t\tcallCallback(settings.callback_error, element);\r\n\t\t};\r\n\r\n\t\tconst loadCallback = function() {\r\n\t\t\t/* As this method is asynchronous, it must be protected against external destroy() calls */\r\n\t\t\tif (!settings) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tremoveClass(element, settings.class_loading);\r\n\t\t\taddClass(element, settings.class_loaded);\r\n\t\t\telement.removeEventListener(\"load\", loadCallback);\r\n\t\t\telement.removeEventListener(\"error\", errorCallback);\r\n\t\t\tcallCallback(settings.callback_load, element);\r\n\t\t};\r\n\r\n\t\tcallCallback(settings.callback_enter, element);\r\n\t\tif ([\"IMG\", \"IFRAME\", \"VIDEO\"].indexOf(element.tagName) > -1) {\r\n\t\t\telement.addEventListener(\"load\", loadCallback);\r\n\t\t\telement.addEventListener(\"error\", errorCallback);\r\n\t\t\taddClass(element, settings.class_loading);\r\n\t\t}\r\n\t\tsetSources(element, settings);\r\n\t\tcallCallback(settings.callback_set, element);\r\n\t},\r\n\r\n\t_loopThroughElements: function(forceDownload) {\r\n\t\tconst settings = this._settings,\r\n\t\t\telements = this._elements,\r\n\t\t\telementsLength = !elements ? 0 : elements.length;\r\n\t\tlet i,\r\n\t\t\tprocessedIndexes = [],\r\n\t\t\tfirstLoop = this._isFirstLoop;\r\n\r\n\t\tfor (i = 0; i < elementsLength; i++) {\r\n\t\t\tlet element = elements[i];\r\n\t\t\t/* If must skip_invisible and element is invisible, skip it */\r\n\t\t\tif (settings.skip_invisible && element.offsetParent === null) {\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tif (\r\n\t\t\t\tisBot ||\r\n\t\t\t\tforceDownload ||\r\n\t\t\t\tisInsideViewport(\r\n\t\t\t\t\telement,\r\n\t\t\t\t\tsettings.container,\r\n\t\t\t\t\tsettings.threshold\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\tif (firstLoop) {\r\n\t\t\t\t\taddClass(element, settings.class_initial);\r\n\t\t\t\t}\r\n\t\t\t\t/* Start loading the image */\r\n\t\t\t\tthis.load(element);\r\n\t\t\t\t/* Marking the element as processed. */\r\n\t\t\t\tprocessedIndexes.push(i);\r\n\t\t\t\tsetWasProcessed(element);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* Removing processed elements from this._elements. */\r\n\t\twhile (processedIndexes.length) {\r\n\t\t\telements.splice(processedIndexes.pop(), 1);\r\n\t\t\tcallCallback(settings.callback_processed, elements.length);\r\n\t\t}\r\n\t\t/* Stop listening to scroll event when 0 elements remains */\r\n\t\tif (elementsLength === 0) {\r\n\t\t\tthis._stopScrollHandler();\r\n\t\t}\r\n\t\t/* Sets isFirstLoop to false */\r\n\t\tif (firstLoop) {\r\n\t\t\tthis._isFirstLoop = false;\r\n\t\t}\r\n\t},\r\n\r\n\t_purgeElements: function() {\r\n\t\tconst elements = this._elements,\r\n\t\t\telementsLength = elements.length;\r\n\t\tlet i,\r\n\t\t\telementsToPurge = [];\r\n\r\n\t\tfor (i = 0; i < elementsLength; i++) {\r\n\t\t\tlet element = elements[i];\r\n\t\t\t/* If the element has already been processed, skip it */\r\n\t\t\tif (getWasProcessed(element)) {\r\n\t\t\t\telementsToPurge.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/* Removing elements to purge from this._elements. */\r\n\t\twhile (elementsToPurge.length > 0) {\r\n\t\t\telements.splice(elementsToPurge.pop(), 1);\r\n\t\t}\r\n\t},\r\n\r\n\t_startScrollHandler: function() {\r\n\t\tif (!this._isHandlingScroll) {\r\n\t\t\tthis._isHandlingScroll = true;\r\n\t\t\tthis._settings.container.addEventListener(\r\n\t\t\t\t\"scroll\",\r\n\t\t\t\tthis._boundHandleScroll\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\r\n\t_stopScrollHandler: function() {\r\n\t\tif (this._isHandlingScroll) {\r\n\t\t\tthis._isHandlingScroll = false;\r\n\t\t\tthis._settings.container.removeEventListener(\r\n\t\t\t\t\"scroll\",\r\n\t\t\t\tthis._boundHandleScroll\r\n\t\t\t);\r\n\t\t}\r\n\t},\r\n\r\n\thandleScroll: function() {\r\n\t\tconst throttle = this._settings.throttle;\r\n\r\n\t\tif (throttle !== 0) {\r\n\t\t\tlet now = Date.now();\r\n\t\t\tlet remainingTime = throttle - (now - this._previousLoopTime);\r\n\t\t\tif (remainingTime <= 0 || remainingTime > throttle) {\r\n\t\t\t\tif (this._loopTimeout) {\r\n\t\t\t\t\tclearTimeout(this._loopTimeout);\r\n\t\t\t\t\tthis._loopTimeout = null;\r\n\t\t\t\t}\r\n\t\t\t\tthis._previousLoopTime = now;\r\n\t\t\t\tthis._loopThroughElements();\r\n\t\t\t} else if (!this._loopTimeout) {\r\n\t\t\t\tthis._loopTimeout = setTimeout(\r\n\t\t\t\t\tfunction() {\r\n\t\t\t\t\t\tthis._previousLoopTime = Date.now();\r\n\t\t\t\t\t\tthis._loopTimeout = null;\r\n\t\t\t\t\t\tthis._loopThroughElements();\r\n\t\t\t\t\t}.bind(this),\r\n\t\t\t\t\tremainingTime\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis._loopThroughElements();\r\n\t\t}\r\n\t},\r\n\r\n\tloadAll: function() {\r\n\t\tthis._loopThroughElements(true);\r\n\t},\r\n\r\n\tupdate: function() {\r\n\t\t// Converts to array the nodeset obtained querying the DOM from _queryOriginNode with elements_selector\r\n\t\tthis._elements = Array.prototype.slice.call(\r\n\t\t\tthis._queryOriginNode.querySelectorAll(\r\n\t\t\t\tthis._settings.elements_selector\r\n\t\t\t)\r\n\t\t);\r\n\t\tthis._purgeElements();\r\n\t\tthis._loopThroughElements();\r\n\t\tthis._startScrollHandler();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\twindow.removeEventListener(\"resize\", this._boundHandleScroll);\r\n\t\tif (this._loopTimeout) {\r\n\t\t\tclearTimeout(this._loopTimeout);\r\n\t\t\tthis._loopTimeout = null;\r\n\t\t}\r\n\t\tthis._stopScrollHandler();\r\n\t\tthis._elements = null;\r\n\t\tthis._queryOriginNode = null;\r\n\t\tthis._settings = null;\r\n\t},\r\n\r\n\tload: function(element, force) {\r\n\t\tthis._reveal(element, force);\r\n\t}\r\n};\r\n\r\n/* Automatic instances creation if required (useful for async script loading!) */\r\nlet autoInitOptions = window.lazyLoadOptions;\r\nif (runningOnBrowser && autoInitOptions) {\r\n\tautoInitialize(LazyLoad, autoInitOptions);\r\n}\n\nreturn LazyLoad;\n\n}());\n"]}