{"version":3,"sources":["lazyload.js"],"names":["global","factory","exports","_typeof","module","define","amd","LazyLoad","this","purgeElements","elements","getWasProcessed","element","addClass","settings","class_loading","force","callCallback","indexOf","tagName","addOneShotListeners","setSources","isIntersecting","setWasProcessed","callback_set","getInstanceSettings","customSettings","defaultSettings","elements_selector","container","document","threshold","data_src","data_srcset","data_sizes","class_loaded","class_error","callback_load","callback_enter","processedDataName","attribute","processedDataValue","setData","getAttribute","dataPrefix","setAttribute","value","getData","createInstance","classObj","options","event","instance","CustomEvent","detail","eventString","window","dispatchEvent","setSourcesInChildren","parentTag","dataAttrName","childTag","i","children","attributeValue","attrName","setAttributeIfNotNullOrEmpty","sizesDataName","srcDataName","srcDataValue","parent","parentNode","srcsetDataName","srcsetDataValue","style","backgroundImage","runningOnBrowser","isBot","test","navigator","userAgent","supportsIntersectionObserver","supportsClassList","createElement","className","classList","add","remove","replace","RegExp","callback","argument","loadString","removeListeners","loadHandler","errorHandler","removeEventListener","onLoad","onError","onEvent","addEventListener","success","target","removeClass","revealElement","callback_error","rootMargin","intersectionRatio","getObserverSettings","root","_settings","_setObserver","_this","_observer","IntersectionObserver","entries","unobserve","load","loadAll","_this2","_elements","forEach","update","nodeSet","querySelectorAll","Array","prototype","slice","call","_this3","observe","destroy","_this4","autoInitialize","length","optionsItem","lazyLoadOptions"],"mappings":"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","file":"lazyload.min.js","sourcesContent":["(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n\ttypeof define === 'function' && define.amd ? define(factory) :\n\t(global.LazyLoad = factory());\n}(this, (function () { 'use strict';\n\nvar getInstanceSettings = (customSettings) => {\r\n    const defaultSettings = {\r\n        elements_selector: \"img\",\r\n        container: document,\r\n        threshold: 300,\r\n        data_src: \"src\",\r\n        data_srcset: \"srcset\",\r\n        data_sizes: \"sizes\",\r\n        class_loading: \"loading\",\r\n        class_loaded: \"loaded\",\r\n        class_error: \"error\",\r\n        callback_load: null,\r\n        callback_error: null,\r\n        callback_set: null,\r\n        callback_enter: null\r\n    };\r\n\r\n    return Object.assign({}, defaultSettings, customSettings);\r\n};\n\nconst dataPrefix = \"data-\";\r\nconst processedDataName = \"was-processed\";\r\nconst processedDataValue = \"true\";\r\n\r\nconst getData = (element, attribute) => {\r\n\treturn element.getAttribute(dataPrefix + attribute);\r\n};\r\n\r\nconst setData = (element, attribute, value) => {\r\n\treturn element.setAttribute(dataPrefix + attribute, value);\r\n};\r\n\r\nconst setWasProcessed = element =>\r\n\tsetData(element, processedDataName, processedDataValue);\r\n\r\nconst getWasProcessed = element =>\r\n\tgetData(element, processedDataName) === processedDataValue;\n\nfunction purgeElements(elements) {\r\n\treturn elements.filter(element => !getWasProcessed(element));\r\n}\n\n/* Creates instance and notifies it through the window element */\r\nconst createInstance = function(classObj, options) {\r\n\tvar event;\r\n\tlet eventString = \"LazyLoad::Initialized\";\r\n\tlet instance = new classObj(options);\r\n\ttry {\r\n\t\t// Works in modern browsers\r\n\t\tevent = new CustomEvent(eventString, { detail: { instance } });\r\n\t} catch (err) {\r\n\t\t// Works in Internet Explorer (all versions)\r\n\t\tevent = document.createEvent(\"CustomEvent\");\r\n\t\tevent.initCustomEvent(eventString, false, false, { instance });\r\n\t}\r\n\twindow.dispatchEvent(event);\r\n};\r\n\r\n/* Auto initialization of one or more instances of lazyload, depending on the \r\n    options passed in (plain object or an array) */\r\nfunction autoInitialize(classObj, options) {\r\n\tif (!options) {\r\n\t\treturn;\r\n\t}\r\n\tif (!options.length) {\r\n\t\t// Plain object\r\n\t\tcreateInstance(classObj, options);\r\n\t} else {\r\n\t\t// Array of objects\r\n\t\tfor (let i = 0, optionsItem; (optionsItem = options[i]); i += 1) {\r\n\t\t\tcreateInstance(classObj, optionsItem);\r\n\t\t}\r\n\t}\r\n}\n\nconst setSourcesInChildren = function(\r\n\tparentTag,\r\n\tattrName,\r\n\tdataAttrName\r\n) {\r\n\tfor (let i = 0, childTag; (childTag = parentTag.children[i]); i += 1) {\r\n\t\tif (childTag.tagName === \"SOURCE\") {\r\n\t\t\tlet attributeValue = getData(childTag, dataAttrName);\r\n\t\t\tif (attributeValue) {\r\n\t\t\t\tchildTag.setAttribute(attrName, attributeValue);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nconst setAttributeIfNotNullOrEmpty = function(element, attrName, value) {\r\n\tif (!value) {\r\n\t\treturn;\r\n\t}\r\n\telement.setAttribute(attrName, value);\r\n};\r\n\r\nconst setSources = function(element, settings) {\r\n\tconst {\r\n\t\tdata_sizes: sizesDataName,\r\n\t\tdata_srcset: srcsetDataName,\r\n\t\tdata_src: srcDataName\r\n\t} = settings;\r\n\tconst srcDataValue = getData(element, srcDataName);\r\n\tswitch (element.tagName) {\r\n\t\tcase \"IMG\": {\r\n\t\t\tconst parent = element.parentNode;\r\n\t\t\tif (parent && parent.tagName === \"PICTURE\") {\r\n\t\t\t\tsetSourcesInChildren(parent, \"srcset\", srcsetDataName);\r\n\t\t\t}\r\n\t\t\tconst sizesDataValue = getData(element, sizesDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"sizes\", sizesDataValue);\r\n\t\t\tconst srcsetDataValue = getData(element, srcsetDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"srcset\", srcsetDataValue);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"src\", srcDataValue);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tcase \"IFRAME\":\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"src\", srcDataValue);\r\n\t\t\tbreak;\r\n\t\tcase \"VIDEO\":\r\n\t\t\tsetSourcesInChildren(element, \"src\", srcDataName);\r\n\t\t\tsetAttributeIfNotNullOrEmpty(element, \"src\", srcDataValue);\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tif (srcDataValue) {\r\n\t\t\t\telement.style.backgroundImage = `url(\"${srcDataValue}\")`;\r\n\t\t\t}\r\n\t}\r\n};\n\nconst runningOnBrowser = typeof window !== \"undefined\";\r\n\r\nconst isBot =\r\n\t(runningOnBrowser && !(\"onscroll\" in window)) ||\r\n\t/(gle|ing|ro)bot|crawl|spider/i.test(navigator.userAgent);\r\n\r\nconst supportsIntersectionObserver =\r\n\trunningOnBrowser && \"IntersectionObserver\" in window;\r\n\r\nconst supportsClassList =\r\n\trunningOnBrowser && \"classList\" in document.createElement(\"p\");\n\nconst addClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.add(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className += (element.className ? \" \" : \"\") + className;\r\n};\r\n\r\nconst removeClass = (element, className) => {\r\n\tif (supportsClassList) {\r\n\t\telement.classList.remove(className);\r\n\t\treturn;\r\n\t}\r\n\telement.className = element.className.\r\n\t\treplace(new RegExp(\"(^|\\\\s+)\" + className + \"(\\\\s+|$)\"), \" \").\r\n\t\treplace(/^\\s+/, \"\").\r\n\t\treplace(/\\s+$/, \"\");\r\n};\n\nconst callCallback = function(callback, argument) {\r\n\tif (callback) {\r\n\t\tcallback(argument);\r\n\t}\r\n};\r\n\r\nconst loadString = \"load\";\r\nconst errorString = \"error\";\r\n\r\nconst removeListeners = function(element, loadHandler, errorHandler) {\r\n\telement.removeEventListener(loadString, loadHandler);\r\n\telement.removeEventListener(errorString, errorHandler);\r\n};\r\n\r\nconst addOneShotListeners = function(element, settings) {\r\n\tconst onLoad = event => {\r\n\t\tonEvent(event, true, settings);\r\n\t\tremoveListeners(element, onLoad, onError);\r\n\t};\r\n\tconst onError = event => {\r\n\t\tonEvent(event, false, settings);\r\n\t\tremoveListeners(element, onLoad, onError);\r\n\t};\r\n\telement.addEventListener(loadString, onLoad);\r\n\telement.addEventListener(errorString, onError);\r\n};\r\n\r\nconst onEvent = function(event, success, settings) {\r\n\tconst element = event.target;\r\n\tremoveClass(element, settings.class_loading);\r\n\taddClass(element, success ? settings.class_loaded : settings.class_error); // Setting loaded or error class\r\n\tcallCallback(\r\n\t\tsuccess ? settings.callback_load : settings.callback_error,\r\n\t\telement\r\n\t);\r\n};\r\n\r\nfunction revealElement(element, settings, force) {\r\n\tif (!force && getWasProcessed(element)) {\r\n\t\treturn; // element has already been processed and force wasn't true\r\n\t}\r\n\tcallCallback(settings.callback_enter, element);\r\n\tif ([\"IMG\", \"IFRAME\", \"VIDEO\"].indexOf(element.tagName) > -1) {\r\n\t\taddOneShotListeners(element, settings);\r\n\t\taddClass(element, settings.class_loading);\r\n\t}\r\n\tsetSources(element, settings);\r\n\tsetWasProcessed(element);\r\n\tcallCallback(settings.callback_set, element);\r\n}\n\n/* entry.isIntersecting needs fallback because is null on some versions of MS Edge, and\r\n   entry.intersectionRatio is not enough alone because it could be 0 on some intersecting elements */\r\nconst isIntersecting = element =>\r\n\telement.isIntersecting || element.intersectionRatio > 0;\r\n\r\nconst getObserverSettings = settings => ({\r\n\troot: settings.container === document ? null : settings.container,\r\n\trootMargin: settings.threshold + \"px\"\r\n});\n\nconst LazyLoad = function(customSettings, elements) {\r\n\tthis._settings = getInstanceSettings(customSettings);\r\n\tthis._setObserver();\r\n\tthis.update(elements);\r\n};\r\n\r\nLazyLoad.prototype = {\r\n\t_setObserver: function() {\r\n\t\tif (!supportsIntersectionObserver) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst revealIntersectingElements = entries => {\r\n\t\t\tentries.forEach(entry => {\r\n\t\t\t\tif (isIntersecting(entry)) {\r\n\t\t\t\t\tlet element = entry.target;\r\n\t\t\t\t\tthis.load(element);\r\n\t\t\t\t\tthis._observer.unobserve(element);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis._elements = purgeElements(this._elements);\r\n\t\t};\r\n\t\tthis._observer = new IntersectionObserver(\r\n\t\t\trevealIntersectingElements,\r\n\t\t\tgetObserverSettings(this._settings)\r\n\t\t);\r\n\t},\r\n\r\n\tloadAll: function() {\r\n\t\tthis._elements.forEach(element => {\r\n\t\t\tthis.load(element);\r\n\t\t});\r\n\t\tthis._elements = purgeElements(this._elements);\r\n\t},\r\n\r\n\tupdate: function(elements) {\r\n\t\tconst settings = this._settings;\r\n\t\tconst nodeSet =\r\n\t\t\telements ||\r\n\t\t\tsettings.container.querySelectorAll(settings.elements_selector);\r\n\r\n\t\tthis._elements = purgeElements(Array.prototype.slice.call(nodeSet)); // nodeset to array for IE compatibility\r\n\r\n\t\tif (isBot || !this._observer) {\r\n\t\t\tthis.loadAll();\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._elements.forEach(element => {\r\n\t\t\tthis._observer.observe(element);\r\n\t\t});\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tif (this._observer) {\r\n\t\t\tpurgeElements(this._elements).forEach(element => {\r\n\t\t\t\tthis._observer.unobserve(element);\r\n\t\t\t});\r\n\t\t\tthis._observer = null;\r\n\t\t}\r\n\t\tthis._elements = null;\r\n\t\tthis._settings = null;\r\n\t},\r\n\r\n\tload: function(element, force) {\r\n\t\trevealElement(element, this._settings, force);\r\n\t}\r\n};\r\n\r\n/* Automatic instances creation if required (useful for async script loading) */\r\nif (runningOnBrowser) {\r\n\tautoInitialize(LazyLoad, window.lazyLoadOptions);\r\n}\n\nreturn LazyLoad;\n\n})));\n"]}