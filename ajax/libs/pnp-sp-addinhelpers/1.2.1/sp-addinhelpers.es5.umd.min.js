/**
@license
 * @pnp/sp-addinhelpers v1.2.1 - pnp - provides functionality for working within SharePoint add-ins
 * MIT (https://github.com/pnp/pnpjs/blob/master/LICENSE)
 * Copyright (c) 2018 Microsoft
 * docs: https://pnp.github.io/pnpjs/
 * source: https:github.com/pnp/pnpjs
 * bugs: https://github.com/pnp/pnpjs/issues
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@pnp/common"),require("tslib"),require("@pnp/sp")):"function"==typeof define&&define.amd?define(["exports","@pnp/common","tslib","@pnp/sp"],t):t((e.pnp=e.pnp||{},e.pnp["sp-addinhelpers"]={}),e.pnp.common,e.tslib_1,e.pnp.sp)}(this,function(e,p,n,r){"use strict";var t=function(){function e(){this.convertToResponse=function(e){var t=new Headers;if(void 0!==e.headers)for(var n in e.headers)e.headers[n]&&t.append(n,e.headers[n]);var r=204===e.statusCode?null:e.body;return new Response(r,{headers:t,status:e.statusCode,statusText:e.statusText})}}return e.prototype.fetch=function(r,o){var s=this;if(void 0===SP||void 0===SP.RequestExecutor)throw new Error("SP.RequestExecutor is undefined. Load the SP.RequestExecutor.js library (/_layouts/15/SP.RequestExecutor.js) before loading the PnP JS Core library.");var e,t,n=r.substring(0,r.indexOf("/_api")),i=new SP.RequestExecutor(n),u={};if(o.headers&&o.headers instanceof Headers)for(t=(e=o.headers.entries()).next();!t.done;)u[t.value[0]]=t.value[1],t=e.next();else u=o.headers;return new Promise(function(t,n){var e={error:function(e){n(s.convertToResponse(e))},headers:u,method:o.method,success:function(e){t(s.convertToResponse(e))},url:r};e=o.body?p.extend(e,{body:o.body}):p.extend(e,{binaryStringRequestBody:!0}),i.executeAsync(e)})},e}(),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.__extends(t,e),t.prototype.crossDomainSite=function(e,t){return this._cdImpl(r.Site,e,t,"site")},t.prototype.crossDomainWeb=function(e,t){return this._cdImpl(r.Web,e,t,"web")},t.prototype._cdImpl=function(e,t,n,r){if(!p.isUrlAbsolute(t))throw new Error("The addInWebUrl parameter must be an absolute url.");if(!p.isUrlAbsolute(n))throw new Error("The hostWebUrl parameter must be an absolute url.");var o=new e(p.combine(t,"_api/SP.AppContextSite(@target)"),r);return o.query.set("@target","'"+encodeURIComponent(n)+"'"),o.configure(this._options)},t}(r.SPRest),s=new o;e.SPRequestExecutorClient=t,e.SPRestAddIn=o,e.sp=s,Object.defineProperty(e,"__esModule",{value:!0})});