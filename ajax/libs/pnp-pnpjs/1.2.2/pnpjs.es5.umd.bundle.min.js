!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.pnp=t():e.pnp=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t,r){"use strict";var n=r(4),s=r(1),i=r(6);class o extends n.a{constructor(e,t,r){super(null),this.clientId=e,this.tenant=t,this.redirectUri=r,this._displayCallback=null,this._loginPromise=null}static fromSPFxContext(e,t="c58637bb-e2e1-4312-8a00-04b5ffcd3403"){return new o(t,e.pageContext.aadInfo.tenantId.toString(),Object(s.a)(window.location.origin,"/_forms/spfxsinglesignon.aspx"))}fetch(e,t){if(!Object(s.l)(e))throw Error("You must supply absolute urls to AdalClient.fetch.");return this.getToken(this.getResource(e)).then(r=>(this.token=r,super.fetch(e,t)))}getToken(e){return new Promise((t,r)=>{this.ensureAuthContext().then(e=>this.login()).then(n=>{o._authContext.acquireToken(e,(e,n)=>{if(e)return r(Error(e));t(n)})}).catch(r)})}ensureAuthContext(){return new Promise(e=>{null===o._authContext&&(o._authContext=i.inject({clientId:this.clientId,displayCall:e=>{this._displayCallback&&this._displayCallback(e)},navigateToLoginRequestUrl:!1,redirectUri:this.redirectUri,tenant:this.tenant})),e()})}login(){return this._loginPromise?this._loginPromise:(this._loginPromise=new Promise((e,t)=>{if(o._authContext.getCachedUser())return e();this._displayCallback=(r=>{const n=window.open(r,"login","width=483, height=600");if(!n)return t(Error("Could not open pop-up window for auth. Likely pop-ups are blocked by the browser."));n&&n.focus&&n.focus();const s=window.setInterval(()=>{n&&!n.closed&&void 0!==n.closed||window.clearInterval(s);try{-1!==n.document.URL.indexOf(this.redirectUri)&&(window.clearInterval(s),o._authContext.handleWindowCallback(n.location.hash),n.close(),e())}catch(e){t(e)}},30)}),this.ensureAuthContext().then(e=>{o._authContext._loginInProgress=!1,o._authContext.login(),this._displayCallback=null})}),this._loginPromise)}getResource(e){const t=document.createElement("a");return t.href=e,`${t.protocol}//${t.hostname}`}}o._authContext=null;const a=Object(s.k)(Object.entries)?Object.entries:e=>Object.keys(e).map(t=>[t,e[t]]);function c(e){return void 0!==e&&null!==e?new Map(a(e)):new Map}function l(e,...t){for(let r=0;r<t.length;r++)t[r].forEach((t,r)=>{e.set(r,t)});return e}const u=["defaultCachingStore","defaultCachingTimeoutSeconds","globalCacheDisable","enableCacheExpiration","cacheExpirationIntervalMilliseconds","spfxContext"];class h{constructor(e=new Map){this._v=e,this._v.set(u[0],"session"),this._v.set(u[1],60),this._v.set(u[2],!1),this._v.set(u[3],!1),this._v.set(u[4],750),this._v.set(u[5],null)}extend(e){this._v=l(this._v,c(e))}get(e){return this._v.get(e)}get defaultCachingStore(){return this.get(u[0])}get defaultCachingTimeoutSeconds(){return this.get(u[1])}get globalCacheDisable(){return this.get(u[2])}get enableCacheExpiration(){return this.get(u[3])}get cacheExpirationIntervalMilliseconds(){return this.get(u[4])}get spfxContext(){return this.get(u[5])}}let d=new h;class p{constructor(e,t=-1){this.store=e,this.defaultTimeoutMinutes=t,this.enabled=this.test(),d.enableCacheExpiration&&this.cacheExpirationHandler()}get(e){if(!this.enabled)return null;const t=this.store.getItem(e);if(!Object(s.n)(t))return null;const r=JSON.parse(t);return new Date(r.expiration)<=new Date?(this.delete(e),null):r.value}put(e,t,r){this.enabled&&this.store.setItem(e,this.createPersistable(t,r))}delete(e){this.enabled&&this.store.removeItem(e)}getOrPut(e,t,r){return this.enabled?new Promise(n=>{const s=this.get(e);null==s?t().then(t=>{this.put(e,t,r),n(t)}):n(s)}):t()}deleteExpired(){return new Promise((e,t)=>{this.enabled||e();try{for(let e=0;e<this.store.length;e++){const t=this.store.key(e);null!==t&&/["|']?pnp["|']? ?: ?1/i.test(this.store.getItem(t))&&this.get(t)}e()}catch(e){t(e)}})}test(){try{return this.store.setItem("t","t"),this.store.removeItem("t"),!0}catch(e){return!1}}createPersistable(e,t){if(void 0===t){let e=d.defaultCachingTimeoutSeconds;this.defaultTimeoutMinutes>0&&(e=60*this.defaultTimeoutMinutes),t=Object(s.b)(new Date,"second",e)}return Object(s.m)({pnp:1,expiration:t,value:e})}cacheExpirationHandler(){this.deleteExpired().then(e=>{setTimeout(Object(s.e)(this,this.cacheExpirationHandler),d.cacheExpirationIntervalMilliseconds)}).catch(e=>{console.error(e)})}}class g{constructor(e=new Map){this._store=e}get length(){return this._store.size}clear(){this._store.clear()}getItem(e){return this._store.get(e)}key(e){return Array.from(this._store)[e][0]}removeItem(e){this._store.delete(e)}setItem(e,t){this._store.set(e,t)}}class m{constructor(e=null,t=null){this._local=e,this._session=t}get local(){return null===this._local&&(this._local=this.getStore("local")),this._local}get session(){return null===this._session&&(this._session=this.getStore("session")),this._session}getStore(e){return new p("local"===e?"undefined"==typeof localStorage?new g:localStorage:"undefined"==typeof sessionStorage?new g:sessionStorage)}}r.d(t,"a",function(){return o}),r.d(t,"y",function(){return c}),r.d(t,"v",function(){return l}),r.d(t,"g",function(){return h}),r.d(t,"f",function(){return d}),r.d(t,"u",function(){return n.c}),r.d(t,"w",function(){return n.d}),r.d(t,"c",function(){return n.b}),r.d(t,"b",function(){return n.a}),r.d(t,"e",function(){return p}),r.d(t,"d",function(){return m}),r.d(t,"l",function(){return s.e}),r.d(t,"i",function(){return s.b}),r.d(t,"h",function(){return s.a}),r.d(t,"o",function(){return s.h}),r.d(t,"m",function(){return s.f}),r.d(t,"r",function(){return s.k}),r.d(t,"x",function(){return s.n}),r.d(t,"q",function(){return s.j}),r.d(t,"j",function(){return s.c}),r.d(t,"s",function(){return s.l}),r.d(t,"A",function(){return s.p}),r.d(t,"k",function(){return s.d}),r.d(t,"z",function(){return s.o}),r.d(t,"t",function(){return s.m}),r.d(t,"p",function(){return s.i}),r.d(t,"n",function(){return s.g})},function(e,t,r){"use strict";function n(e,t,...r){return function(){t.apply(e,r)}}function s(e,t,r){let n=new Date(e);switch(t.toLowerCase()){case"year":n.setFullYear(n.getFullYear()+r);break;case"quarter":n.setMonth(n.getMonth()+3*r);break;case"month":n.setMonth(n.getMonth()+r);break;case"week":n.setDate(n.getDate()+7*r);break;case"day":n.setDate(n.getDate()+r);break;case"hour":n.setTime(n.getTime()+36e5*r);break;case"minute":n.setTime(n.getTime()+6e4*r);break;case"second":n.setTime(n.getTime()+1e3*r);break;default:n=void 0}return n}function i(...e){return e.filter(e=>!p(e)).map(e=>e.replace(/^[\\|\/]/,"").replace(/[\\|\/]$/,"")).join("/").replace(/\\/g,"/")}function o(e){const t=new Array(e),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let n=0;n<e;n++)t[n]=r.charAt(Math.floor(Math.random()*r.length));return t.join("")}function a(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)})}function c(e){return"function"==typeof e}function l(e){return void 0!==e&&null!==e}function u(e){return Array.isArray?Array.isArray(e):e&&"number"==typeof e.length&&e.constructor===Array}function h(e,t,r=!1,n=(()=>!0)){if(!l(t))return e;const s=r?(e,t)=>!(t in e):()=>!0;return Object.getOwnPropertyNames(t).filter(t=>s(e,t)&&n(t)).reduce((e,r)=>(e[r]=t[r],e),e)}function d(e){return/^https?:\/\/|^\/\//i.test(e)}function p(e){return void 0===e||null===e||e.length<1}function g(e,t){e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");const r=new RegExp(`${t}\\s*?=\\s*?("|')([^\\1]*?)\\1`,"i").exec(e);return null!==r&&r.length>0?r[2]:null}function m(e){if(p(e))return e;const t=/([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})/i.exec(e);return null===t?e:t[1]}function f(e){return JSON.stringify(e)}function b(e,t){return Object.hasOwnProperty.call(e,t)}function y(e){let t=0;if(0===e.length)return t;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t|=0}return t}r.d(t,"e",function(){return n}),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return i}),r.d(t,"h",function(){return o}),r.d(t,"f",function(){return a}),r.d(t,"k",function(){return c}),r.d(t,"n",function(){return l}),r.d(t,"j",function(){return u}),r.d(t,"c",function(){return h}),r.d(t,"l",function(){return d}),r.d(t,"p",function(){return p}),r.d(t,"d",function(){return g}),r.d(t,"o",function(){return m}),r.d(t,"m",function(){return f}),r.d(t,"i",function(){return b}),r.d(t,"g",function(){return y})},function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"a",function(){return i});var n=r(0);function s(e){n.f.extend(e)}let i=new class{get headers(){const e=n.f.get("sp");return void 0!==e&&void 0!==e.headers?e.headers:{}}get baseUrl(){const e=n.f.get("sp");return void 0!==e&&void 0!==e.baseUrl?e.baseUrl:void 0!==n.f.spfxContext&&null!==n.f.spfxContext?n.f.spfxContext.pageContext.web.absoluteUrl:null}get fetchClientFactory(){const e=n.f.get("sp");return void 0!==e&&void 0!==e.fetchClientFactory?e.fetchClientFactory:()=>new n.c}}},function(e,t,r){"use strict";(function(e){r.d(t,"a",function(){return i});var n=r(0),s=r(2);function i(t){return new Promise(r=>{if(Object(n.s)(t))return r(t);if(null!==s.a.baseUrl)return r(Object(n.h)(s.a.baseUrl,t));if(void 0!==e._spPageContextInfo){if(Object(n.p)(e._spPageContextInfo,"webAbsoluteUrl"))return r(Object(n.h)(e._spPageContextInfo.webAbsoluteUrl,t));if(Object(n.p)(e._spPageContextInfo,"webServerRelativeUrl"))return r(Object(n.h)(e._spPageContextInfo.webServerRelativeUrl,t))}if(void 0!==e.location){const s=e.location.toString().toLowerCase();["/_layouts/","/siteassets/"].forEach(e=>{const i=s.indexOf(e);if(i>0)return r(Object(n.h)(s.substr(0,i),t))})}return r(t)})}}).call(this,r(5))},function(e,t,r){"use strict";(function(e){r.d(t,"c",function(){return s}),r.d(t,"d",function(){return i}),r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a});var n=r(1);function s(e,t){if(void 0!==t&&null!==t){new Request("",{headers:t}).headers.forEach((t,r)=>{e.append(r,t)})}}function i(e,t){if(Object(n.n)(t)){const r=Object(n.c)(e.headers||{},t.headers);(e=Object(n.c)(e,t)).headers=r}}class o{fetch(t,r){return e.fetch(t,r)}}class a extends o{constructor(e){super(),this._token=e}get token(){return this._token||""}set token(e){this._token=e}fetch(e,t={}){const r=new Headers;return s(r,t.headers),r.set("Authorization",`Bearer ${this._token}`),t.headers=r,super.fetch(e,t)}}}).call(this,r(5))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t){
/*! adal-angular v1.0.17 2018-02-27 */
var r=function(){"use strict";return r=function(e){if(this.REQUEST_TYPE={LOGIN:"LOGIN",RENEW_TOKEN:"RENEW_TOKEN",UNKNOWN:"UNKNOWN"},this.RESPONSE_TYPE={ID_TOKEN_TOKEN:"id_token token",TOKEN:"token"},this.CONSTANTS={ACCESS_TOKEN:"access_token",EXPIRES_IN:"expires_in",ID_TOKEN:"id_token",ERROR_DESCRIPTION:"error_description",SESSION_STATE:"session_state",ERROR:"error",STORAGE:{TOKEN_KEYS:"adal.token.keys",ACCESS_TOKEN_KEY:"adal.access.token.key",EXPIRATION_KEY:"adal.expiration.key",STATE_LOGIN:"adal.state.login",STATE_RENEW:"adal.state.renew",NONCE_IDTOKEN:"adal.nonce.idtoken",SESSION_STATE:"adal.session.state",USERNAME:"adal.username",IDTOKEN:"adal.idtoken",ERROR:"adal.error",ERROR_DESCRIPTION:"adal.error.description",LOGIN_REQUEST:"adal.login.request",LOGIN_ERROR:"adal.login.error",RENEW_STATUS:"adal.token.renew.status",ANGULAR_LOGIN_REQUEST:"adal.angular.login.request"},RESOURCE_DELIMETER:"|",CACHE_DELIMETER:"||",LOADFRAME_TIMEOUT:6e3,TOKEN_RENEW_STATUS_CANCELED:"Canceled",TOKEN_RENEW_STATUS_COMPLETED:"Completed",TOKEN_RENEW_STATUS_IN_PROGRESS:"In Progress",LOGGING_LEVEL:{ERROR:0,WARN:1,INFO:2,VERBOSE:3},LEVEL_STRING_MAP:{0:"ERROR:",1:"WARNING:",2:"INFO:",3:"VERBOSE:"},POPUP_WIDTH:483,POPUP_HEIGHT:600},r.prototype._singletonInstance)return r.prototype._singletonInstance;if(r.prototype._singletonInstance=this,this.instance="https://login.microsoftonline.com/",this.config={},this.callback=null,this.popUp=!1,this.isAngular=!1,this._user=null,this._activeRenewals={},this._loginInProgress=!1,this._acquireTokenInProgress=!1,this._renewStates=[],this._callBackMappedToRenewStates={},this._callBacksMappedToRenewStates={},this._openedWindows=[],this._requestType=this.REQUEST_TYPE.LOGIN,window._adalInstance=this,e.displayCall&&"function"!=typeof e.displayCall)throw new Error("displayCall is not a function");if(!e.clientId)throw new Error("clientId is required");this.config=this._cloneConfig(e),void 0===this.config.navigateToLoginRequestUrl&&(this.config.navigateToLoginRequestUrl=!0),this.config.popUp&&(this.popUp=!0),this.config.callback&&"function"==typeof this.config.callback&&(this.callback=this.config.callback),this.config.instance&&(this.instance=this.config.instance),this.config.loginResource||(this.config.loginResource=this.config.clientId),this.config.redirectUri||(this.config.redirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.postLogoutRedirectUri||(this.config.postLogoutRedirectUri=window.location.href.split("?")[0].split("#")[0]),this.config.anonymousEndpoints||(this.config.anonymousEndpoints=[]),this.config.isAngular&&(this.isAngular=this.config.isAngular),this.config.loadFrameTimeout&&(this.CONSTANTS.LOADFRAME_TIMEOUT=this.config.loadFrameTimeout)},"undefined"!=typeof window&&(window.Logging={piiLoggingEnabled:!1,level:0,log:function(e){}}),r.prototype.login=function(){if(this._loginInProgress)this.info("Login in progress");else{this._loginInProgress=!0;var e=this._guid();this.config.state=e,this._idTokenNonce=this._guid();var t=this._getItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST);t&&""!==t?this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""):t=window.location.href,this.verbose("Expected state: "+e+" startPage:"+t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,t),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,e,!0),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var r=this._getNavigateUrl("id_token",null)+"&nonce="+encodeURIComponent(this._idTokenNonce);this.config.displayCall?this.config.displayCall(r):this.popUp?(this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._renewStates.push(e),this.registerCallback(e,this.config.clientId,this.callback),this._loginPopup(r)):this.promptUser(r)}},r.prototype._openPopup=function(e,t,r,n){try{var s=window.screenLeft?window.screenLeft:window.screenX,i=window.screenTop?window.screenTop:window.screenY,o=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=o/2-r/2+s,l=a/2-n/2+i,u=window.open(e,t,"width="+r+", height="+n+", top="+l+", left="+c);return u.focus&&u.focus(),u}catch(e){return this.warn("Error opening popup, "+e.message),this._loginInProgress=!1,this._acquireTokenInProgress=!1,null}},r.prototype._handlePopupError=function(e,t,r,n,s){this.warn(n),this._saveItem(this.CONSTANTS.STORAGE.ERROR,r),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,n),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,s),t&&this._activeRenewals[t]&&(this._activeRenewals[t]=null),this._loginInProgress=!1,this._acquireTokenInProgress=!1,e&&e(n,null,r)},r.prototype._loginPopup=function(e,t,r){var n=this._openPopup(e,"login",this.CONSTANTS.POPUP_WIDTH,this.CONSTANTS.POPUP_HEIGHT),s=r||this.callback;if(null!=n){if(this._openedWindows.push(n),-1!=this.config.redirectUri.indexOf("#"))var i=this.config.redirectUri.split("#")[0];else i=this.config.redirectUri;var o=this,a=window.setInterval(function(){if(!n||n.closed||void 0===n.closed){var e="Popup Window closed",r="Popup Window closed by UI action/ Popup Window handle destroyed due to cross zone navigation in IE/Edge";return o.isAngular&&o._broadcast("adal:popUpClosed",r+o.CONSTANTS.RESOURCE_DELIMETER+e),o._handlePopupError(s,t,e,r,r),void window.clearInterval(a)}try{var c=n.location;if(-1!=encodeURI(c.href).indexOf(encodeURI(i)))return o.isAngular?o._broadcast("adal:popUpHashChanged",c.hash):o.handleWindowCallback(c.hash),window.clearInterval(a),o._loginInProgress=!1,o._acquireTokenInProgress=!1,o.info("Closing popup window"),o._openedWindows=[],void n.close()}catch(e){}},1)}else{var c="Popup Window is null. This can happen if you are using IE";this._handlePopupError(s,t,"Error opening popup",c,c)}},r.prototype._broadcast=function(e,t){!function(){function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var r=document.createEvent("CustomEvent");return r.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),r}if("function"==typeof window.CustomEvent)return!1;e.prototype=window.Event.prototype,window.CustomEvent=e}();var r=new CustomEvent(e,{detail:t});window.dispatchEvent(r)},r.prototype.loginInProgress=function(){return this._loginInProgress},r.prototype._hasResource=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);return t&&!this._isEmpty(t)&&t.indexOf(e+this.CONSTANTS.RESOURCE_DELIMETER)>-1},r.prototype.getCachedToken=function(e){if(!this._hasResource(e))return null;var t=this._getItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e),r=this._getItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e),n=this.config.expireOffsetSeconds||300;return r&&r>this._now()+n?t:(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0),null)},r.prototype.getCachedUser=function(){if(this._user)return this._user;var e=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);return this._user=this._createUser(e),this._user},r.prototype.registerCallback=function(e,t,r){this._activeRenewals[t]=e,this._callBacksMappedToRenewStates[e]||(this._callBacksMappedToRenewStates[e]=[]);var n=this;this._callBacksMappedToRenewStates[e].push(r),this._callBackMappedToRenewStates[e]||(this._callBackMappedToRenewStates[e]=function(r,s,i,o){n._activeRenewals[t]=null;for(var a=0;a<n._callBacksMappedToRenewStates[e].length;++a)try{n._callBacksMappedToRenewStates[e][a](r,s,i,o)}catch(i){n.warn(i)}n._callBacksMappedToRenewStates[e]=null,n._callBackMappedToRenewStates[e]=null})},r.prototype._renewToken=function(e,t,r){this.info("renewToken is called for resource:"+e);var n=this._addAdalFrame("adalRenewFrame"+e),s=this._guid()+"|"+e;this.config.state=s,this._renewStates.push(s),this.verbose("Renew token Expected state: "+s),r=r||"token";var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl(r,e),"prompt");r===this.RESPONSE_TYPE.ID_TOKEN_TOKEN&&(this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),i+="&nonce="+encodeURIComponent(this._idTokenNonce)),i+="&prompt=none",i=this._addHintParameters(i),this.registerCallback(s,e,t),this.verbosePii("Navigate to:"+i),n.src="about:blank",this._loadFrameTimeout(i,"adalRenewFrame"+e,e)},r.prototype._renewIdToken=function(e,t){this.info("renewIdToken is called");var r=this._addAdalFrame("adalIdTokenFrame"),n=this._guid()+"|"+this.config.clientId;this._idTokenNonce=this._guid(),this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,this._idTokenNonce,!0),this.config.state=n,this._renewStates.push(n),this.verbose("Renew Idtoken Expected state: "+n);var s=null===t||void 0===t?null:this.config.clientId,i=(t=t||"id_token",this._urlRemoveQueryStringParameter(this._getNavigateUrl(t,s),"prompt"));i+="&prompt=none",i=this._addHintParameters(i),i+="&nonce="+encodeURIComponent(this._idTokenNonce),this.registerCallback(n,this.config.clientId,e),this.verbosePii("Navigate to:"+i),r.src="about:blank",this._loadFrameTimeout(i,"adalIdTokenFrame",this.config.clientId)},r.prototype._urlContainsQueryStringParameter=function(e,t){return new RegExp("[\\?&]"+e+"=").test(t)},r.prototype._urlRemoveQueryStringParameter=function(e,t){var r=new RegExp("(\\&"+t+"=)[^&]+");return e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+&"),e=e.replace(r,""),r=new RegExp("("+t+"=)[^&]+"),e.replace(r,"")},r.prototype._loadFrameTimeout=function(e,t,r){this.verbose("Set loading state to pending for: "+r),this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+r,this.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS),this._loadFrame(e,t);var n=this;setTimeout(function(){if(n._getItem(n.CONSTANTS.STORAGE.RENEW_STATUS+r)===n.CONSTANTS.TOKEN_RENEW_STATUS_IN_PROGRESS){n.verbose("Loading frame has timed out after: "+n.CONSTANTS.LOADFRAME_TIMEOUT/1e3+" seconds for resource "+r);var e=n._activeRenewals[r];e&&n._callBackMappedToRenewStates[e]&&n._callBackMappedToRenewStates[e]("Token renewal operation failed due to timeout",null,"Token Renewal Failed"),n._saveItem(n.CONSTANTS.STORAGE.RENEW_STATUS+r,n.CONSTANTS.TOKEN_RENEW_STATUS_CANCELED)}},n.CONSTANTS.LOADFRAME_TIMEOUT)},r.prototype._loadFrame=function(e,t){var r=this;r.info("LoadFrame: "+t);var n=t;setTimeout(function(){var t=r._addAdalFrame(n);""!==t.src&&"about:blank"!==t.src||(t.src=e,r._loadFrame(e,n))},500)},r.prototype.acquireToken=function(e,t){if(this._isEmpty(e))return this.warn("resource is required"),void t("resource is required",null,"resource is required");var r=this.getCachedToken(e);return r?(this.info("Token is already in cache for resource:"+e),void t(null,r,null)):this._user||this.config.extraQueryParameter&&-1!==this.config.extraQueryParameter.indexOf("login_hint")?void(this._activeRenewals[e]?this.registerCallback(this._activeRenewals[e],e,t):(this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,e===this.config.clientId?this._user?(this.verbose("renewing idtoken"),this._renewIdToken(t)):(this.verbose("renewing idtoken and access_token"),this._renewIdToken(t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)):this._user?(this.verbose("renewing access_token"),this._renewToken(e,t)):(this.verbose("renewing idtoken and access_token"),this._renewToken(e,t,this.RESPONSE_TYPE.ID_TOKEN_TOKEN)))):(this.warn("User login is required"),void t("User login is required",null,"login required"))},r.prototype.acquireTokenPopup=function(e,t,r,n){if(this._isEmpty(e))return this.warn("resource is required"),void n("resource is required",null,"resource is required");if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var s=this._guid()+"|"+e;this.config.state=s,this._renewStates.push(s),this._requestType=this.REQUEST_TYPE.RENEW_TOKEN,this.verbose("Renew token Expected state: "+s);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),r&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(r);else if(r&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this.registerCallback(s,e,n),this._loginPopup(i,e,n)},r.prototype.acquireTokenRedirect=function(e,t,r){if(this._isEmpty(e))return this.warn("resource is required"),void n("resource is required",null,"resource is required");var n=this.callback;if(!this._user)return this.warn("User login is required"),void n("User login is required",null,"login required");if(this._acquireTokenInProgress)return this.warn("Acquire token interactive is already in progress"),void n("Acquire token interactive is already in progress",null,"Acquire token interactive is already in progress");var s=this._guid()+"|"+e;this.config.state=s,this.verbose("Renew token Expected state: "+s);var i=this._urlRemoveQueryStringParameter(this._getNavigateUrl("token",e),"prompt");if(i+="&prompt=select_account",t&&(i+=t),r&&-1===i.indexOf("&claims"))i+="&claims="+encodeURIComponent(r);else if(r&&-1!==i.indexOf("&claims"))throw new Error("Claims cannot be passed as an extraQueryParameter");i=this._addHintParameters(i),this._acquireTokenInProgress=!0,this.info("acquireToken interactive is called for the resource "+e),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,window.location.href),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,s,!0),this.promptUser(i)},r.prototype.promptUser=function(e){e?(this.infoPii("Navigate to:"+e),window.location.replace(e)):this.info("Navigate url is empty")},r.prototype.clearCache=function(){this._saveItem(this.CONSTANTS.STORAGE.LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.ANGULAR_LOGIN_REQUEST,""),this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_LOGIN,""),this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._renewStates=[],this._saveItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"");var e=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS);if(!this._isEmpty(e)){e=e.split(this.CONSTANTS.RESOURCE_DELIMETER);for(var t=0;t<e.length&&""!==e[t];t++)this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e[t],""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e[t],0)}this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,"")},r.prototype.clearCacheForResource=function(e){this._saveItem(this.CONSTANTS.STORAGE.STATE_RENEW,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,""),this._hasResource(e)&&(this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+e,""),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+e,0))},r.prototype.logOut=function(){var e;if(this.clearCache(),this._user=null,this.config.logOutUri)e=this.config.logOutUri;else{var t="common",r="";this.config.tenant&&(t=this.config.tenant),this.config.postLogoutRedirectUri&&(r="post_logout_redirect_uri="+encodeURIComponent(this.config.postLogoutRedirectUri)),e=this.instance+t+"/oauth2/logout?"+r}this.infoPii("Logout navigate to: "+e),this.promptUser(e)},r.prototype._isEmpty=function(e){return void 0===e||!e||0===e.length},r.prototype.getUser=function(e){if("function"!=typeof e)throw new Error("callback is not a function");if(this._user)e(null,this._user);else{var t=this._getItem(this.CONSTANTS.STORAGE.IDTOKEN);this._isEmpty(t)?(this.warn("User information is not available"),e("User information is not available",null)):(this.info("User exists in cache: "),this._user=this._createUser(t),e(null,this._user))}},r.prototype._addHintParameters=function(e){if(this._user&&this._user.profile)if(this._user.profile.sid&&-1!==e.indexOf("&prompt=none"))this._urlContainsQueryStringParameter("sid",e)||(e+="&sid="+encodeURIComponent(this._user.profile.sid));else if(this._user.profile.upn&&(this._urlContainsQueryStringParameter("login_hint",e)||(e+="&login_hint="+encodeURIComponent(this._user.profile.upn)),!this._urlContainsQueryStringParameter("domain_hint",e)&&this._user.profile.upn.indexOf("@")>-1)){var t=this._user.profile.upn.split("@");e+="&domain_hint="+encodeURIComponent(t[t.length-1])}return e},r.prototype._createUser=function(e){var t=null,r=this._extractIdToken(e);return r&&r.hasOwnProperty("aud")&&(r.aud.toLowerCase()===this.config.clientId.toLowerCase()?(t={userName:"",profile:r},r.hasOwnProperty("upn")?t.userName=r.upn:r.hasOwnProperty("email")&&(t.userName=r.email)):this.warn("IdToken has invalid aud field")),t},r.prototype._getHash=function(e){return e.indexOf("#/")>-1?e=e.substring(e.indexOf("#/")+2):e.indexOf("#")>-1&&(e=e.substring(1)),e},r.prototype.isCallback=function(e){e=this._getHash(e);var t=this._deserialize(e);return t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN)},r.prototype.getLoginError=function(){return this._getItem(this.CONSTANTS.STORAGE.LOGIN_ERROR)},r.prototype.getRequestInfo=function(e){e=this._getHash(e);var t=this._deserialize(e),r={valid:!1,parameters:{},stateMatch:!1,stateResponse:"",requestType:this.REQUEST_TYPE.UNKNOWN};if(t&&(r.parameters=t,t.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION)||t.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)||t.hasOwnProperty(this.CONSTANTS.ID_TOKEN))){r.valid=!0;var n;if(!t.hasOwnProperty("state"))return this.warn("No state returned"),r;if(this.verbose("State: "+t.state),n=t.state,r.stateResponse=n,this._matchState(r))return r;if(!r.stateMatch&&window.parent){r.requestType=this._requestType;for(var s=this._renewStates,i=0;i<s.length;i++)if(s[i]===r.stateResponse){r.stateMatch=!0;break}}}return r},r.prototype._matchNonce=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.profile.nonce)return!0}return!1},r.prototype._matchState=function(e){var t=this._getItem(this.CONSTANTS.STORAGE.STATE_LOGIN);if(t){t=t.split(this.CONSTANTS.CACHE_DELIMETER);for(var r=0;r<t.length;r++)if(t[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.LOGIN,e.stateMatch=!0,!0}var n=this._getItem(this.CONSTANTS.STORAGE.STATE_RENEW);if(n){n=n.split(this.CONSTANTS.CACHE_DELIMETER);for(r=0;r<n.length;r++)if(n[r]===e.stateResponse)return e.requestType=this.REQUEST_TYPE.RENEW_TOKEN,e.stateMatch=!0,!0}return!1},r.prototype._getResourceFromState=function(e){if(e){var t=e.indexOf("|");if(t>-1&&t+1<e.length)return e.substring(t+1)}return""},r.prototype.saveTokenFromHash=function(e){this.info("State status:"+e.stateMatch+"; Request type:"+e.requestType),this._saveItem(this.CONSTANTS.STORAGE.ERROR,""),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"");var t=this._getResourceFromState(e.stateResponse);if(e.parameters.hasOwnProperty(this.CONSTANTS.ERROR_DESCRIPTION))this.infoPii("Error :"+e.parameters.error+"; Error description:"+e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),this._saveItem(this.CONSTANTS.STORAGE.ERROR,e.parameters.error),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,e.parameters[this.CONSTANTS.ERROR_DESCRIPTION]),e.requestType===this.REQUEST_TYPE.LOGIN&&(this._loginInProgress=!1,this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,e.parameters.error_description));else if(e.stateMatch){var r;this.info("State is right"),e.parameters.hasOwnProperty(this.CONSTANTS.SESSION_STATE)&&this._saveItem(this.CONSTANTS.STORAGE.SESSION_STATE,e.parameters[this.CONSTANTS.SESSION_STATE]),e.parameters.hasOwnProperty(this.CONSTANTS.ACCESS_TOKEN)&&(this.info("Fragment has access token"),this._hasResource(t)||(r=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,r+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ACCESS_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._expiresIn(e.parameters[this.CONSTANTS.EXPIRES_IN]))),e.parameters.hasOwnProperty(this.CONSTANTS.ID_TOKEN)&&(this.info("Fragment has id token"),this._loginInProgress=!1,this._user=this._createUser(e.parameters[this.CONSTANTS.ID_TOKEN]),this._user&&this._user.profile?this._matchNonce(this._user)?(this._saveItem(this.CONSTANTS.STORAGE.IDTOKEN,e.parameters[this.CONSTANTS.ID_TOKEN]),t=this.config.loginResource?this.config.loginResource:this.config.clientId,this._hasResource(t)||(r=this._getItem(this.CONSTANTS.STORAGE.TOKEN_KEYS)||"",this._saveItem(this.CONSTANTS.STORAGE.TOKEN_KEYS,r+t+this.CONSTANTS.RESOURCE_DELIMETER)),this._saveItem(this.CONSTANTS.STORAGE.ACCESS_TOKEN_KEY+t,e.parameters[this.CONSTANTS.ID_TOKEN]),this._saveItem(this.CONSTANTS.STORAGE.EXPIRATION_KEY+t,this._user.profile.exp)):(this._saveItem(this.CONSTANTS.STORAGE.LOGIN_ERROR,"Nonce received: "+this._user.profile.nonce+" is not same as requested: "+this._getItem(this.CONSTANTS.STORAGE.NONCE_IDTOKEN)),this._user=null):(e.parameters.error="invalid id_token",e.parameters.error_description="Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN],this._saveItem(this.CONSTANTS.STORAGE.ERROR,"invalid id_token"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid id_token. id_token: "+e.parameters[this.CONSTANTS.ID_TOKEN])))}else e.parameters.error="Invalid_state",e.parameters.error_description="Invalid_state. state: "+e.stateResponse,this._saveItem(this.CONSTANTS.STORAGE.ERROR,"Invalid_state"),this._saveItem(this.CONSTANTS.STORAGE.ERROR_DESCRIPTION,"Invalid_state. state: "+e.stateResponse);this._saveItem(this.CONSTANTS.STORAGE.RENEW_STATUS+t,this.CONSTANTS.TOKEN_RENEW_STATUS_COMPLETED)},r.prototype.getResourceForEndpoint=function(e){if(this.config&&this.config.anonymousEndpoints)for(var t=0;t<this.config.anonymousEndpoints.length;t++)if(e.indexOf(this.config.anonymousEndpoints[t])>-1)return null;if(this.config&&this.config.endpoints)for(var r in this.config.endpoints)if(e.indexOf(r)>-1)return this.config.endpoints[r];return e.indexOf("http://")>-1||e.indexOf("https://")>-1?this._getHostFromUri(e)===this._getHostFromUri(this.config.redirectUri)?this.config.loginResource:null:this.config.loginResource},r.prototype._getHostFromUri=function(e){var t=String(e).replace(/^(https?:)\/\//,"");return t.split("/")[0]},r.prototype.handleWindowCallback=function(e){if(null==e&&(e=window.location.hash),this.isCallback(e)){var t=null,r=!1;this._openedWindows.length>0&&this._openedWindows[this._openedWindows.length-1].opener&&this._openedWindows[this._openedWindows.length-1].opener._adalInstance?(t=this._openedWindows[this._openedWindows.length-1].opener._adalInstance,r=!0):window.parent&&window.parent._adalInstance&&(t=window.parent._adalInstance);var n,s,i=t.getRequestInfo(e),o=null;s=r||window.parent!==window?t._callBackMappedToRenewStates[i.stateResponse]:t.callback,t.info("Returned from redirect url"),t.saveTokenFromHash(i),i.requestType===this.REQUEST_TYPE.RENEW_TOKEN&&window.parent?(window.parent!==window?t.verbose("Window is in iframe, acquiring token silently"):t.verbose("acquiring token interactive in progress"),n=i.parameters[t.CONSTANTS.ACCESS_TOKEN]||i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ACCESS_TOKEN):i.requestType===this.REQUEST_TYPE.LOGIN&&(n=i.parameters[t.CONSTANTS.ID_TOKEN],o=t.CONSTANTS.ID_TOKEN);var a=i.parameters[t.CONSTANTS.ERROR_DESCRIPTION],c=i.parameters[t.CONSTANTS.ERROR];try{s&&s(a,n,c,o)}catch(e){t.error("Error occurred in user defined callback function: "+e)}window.parent!==window||r||(t.config.navigateToLoginRequestUrl?window.location.href=t._getItem(t.CONSTANTS.STORAGE.LOGIN_REQUEST):window.location.hash="")}},r.prototype._getNavigateUrl=function(e,t){var r="common";this.config.tenant&&(r=this.config.tenant);var n=this.instance+r+"/oauth2/authorize"+this._serialize(e,this.config,t)+this._addLibMetadata();return this.info("Navigate url:"+n),n},r.prototype._extractIdToken=function(e){var t=this._decodeJwt(e);if(!t)return null;try{var r=t.JWSPayload,n=this._base64DecodeStringUrlSafe(r);return n?JSON.parse(n):(this.info("The returned id_token could not be base64 url safe decoded."),null)}catch(e){this.error("The returned id_token could not be decoded",e)}return null},r.prototype._base64DecodeStringUrlSafe=function(e){return e=e.replace(/-/g,"+").replace(/_/g,"/"),window.atob?decodeURIComponent(escape(window.atob(e))):decodeURIComponent(escape(this._decode(e)))},r.prototype._decode=function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",r=(e=String(e).replace(/=+$/,"")).length;if(r%4==1)throw new Error("The token to be decoded is not correctly encoded.");for(var n,s,i,o,a,c,l,u,h="",d=0;d<r;d+=4){if(n=t.indexOf(e.charAt(d)),s=t.indexOf(e.charAt(d+1)),i=t.indexOf(e.charAt(d+2)),o=t.indexOf(e.charAt(d+3)),d+2===r-1){c=(a=n<<18|s<<12|i<<6)>>16&255,l=a>>8&255,h+=String.fromCharCode(c,l);break}if(d+1===r-1){c=(a=n<<18|s<<12)>>16&255,h+=String.fromCharCode(c);break}c=(a=n<<18|s<<12|i<<6|o)>>16&255,l=a>>8&255,u=255&a,h+=String.fromCharCode(c,l,u)}return h},r.prototype._decodeJwt=function(e){if(this._isEmpty(e))return null;var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);return!t||t.length<4?(this.warn("The returned id_token is not parseable."),null):{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},r.prototype._convertUrlSafeToRegularBase64EncodedString=function(e){return e.replace("-","+").replace("_","/")},r.prototype._serialize=function(e,t,r){var n=[];if(null!==t){n.push("?response_type="+e),n.push("client_id="+encodeURIComponent(t.clientId)),r&&n.push("resource="+encodeURIComponent(r)),n.push("redirect_uri="+encodeURIComponent(t.redirectUri)),n.push("state="+encodeURIComponent(t.state)),t.hasOwnProperty("slice")&&n.push("slice="+encodeURIComponent(t.slice)),t.hasOwnProperty("extraQueryParameter")&&n.push(t.extraQueryParameter);var s=t.correlationId?t.correlationId:this._guid();n.push("client-request-id="+encodeURIComponent(s))}return n.join("&")},r.prototype._deserialize=function(e){var t,r=/\+/g,n=/([^&=]+)=([^&]*)/g,s=function(e){return decodeURIComponent(e.replace(r," "))},i={};for(t=n.exec(e);t;)i[s(t[1])]=s(t[2]),t=n.exec(e);return i},r.prototype._decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},r.prototype._guid=function(){var e=window.crypto||window.msCrypto;if(e&&e.getRandomValues){var t=new Uint8Array(16);return e.getRandomValues(t),t[6]|=64,t[6]&=79,t[8]|=128,t[8]&=191,this._decimalToHex(t[0])+this._decimalToHex(t[1])+this._decimalToHex(t[2])+this._decimalToHex(t[3])+"-"+this._decimalToHex(t[4])+this._decimalToHex(t[5])+"-"+this._decimalToHex(t[6])+this._decimalToHex(t[7])+"-"+this._decimalToHex(t[8])+this._decimalToHex(t[9])+"-"+this._decimalToHex(t[10])+this._decimalToHex(t[11])+this._decimalToHex(t[12])+this._decimalToHex(t[13])+this._decimalToHex(t[14])+this._decimalToHex(t[15])}for(var r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",n="0123456789abcdef",s=0,i="",o=0;o<36;o++)"-"!==r[o]&&"4"!==r[o]&&(s=16*Math.random()|0),"x"===r[o]?i+=n[s]:"y"===r[o]?(s&=3,i+=n[s|=8]):i+=r[o];return i},r.prototype._expiresIn=function(e){return e||(e=3599),this._now()+parseInt(e,10)},r.prototype._now=function(){return Math.round((new Date).getTime()/1e3)},r.prototype._addAdalFrame=function(e){if(void 0!==e){this.info("Add adal frame to document:"+e);var t=document.getElementById(e);if(!t){if(document.createElement&&document.documentElement&&(window.opera||-1===window.navigator.userAgent.indexOf("MSIE 5.0"))){var r=document.createElement("iframe");r.setAttribute("id",e),r.setAttribute("aria-hidden","true"),r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height=r.borderWidth="0px",t=document.getElementsByTagName("body")[0].appendChild(r)}else document.body&&document.body.insertAdjacentHTML&&document.body.insertAdjacentHTML("beforeEnd",'<iframe name="'+e+'" id="'+e+'" style="display:none"></iframe>');window.frames&&window.frames[e]&&(t=window.frames[e])}return t}},r.prototype._saveItem=function(e,t,r){if(this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation){if(!this._supportsLocalStorage())return this.info("Local storage is not supported"),!1;if(r){var n=this._getItem(e)||"";localStorage.setItem(e,n+t+this.CONSTANTS.CACHE_DELIMETER)}else localStorage.setItem(e,t);return!0}return this._supportsSessionStorage()?(sessionStorage.setItem(e,t),!0):(this.info("Session storage is not supported"),!1)},r.prototype._getItem=function(e){return this.config&&this.config.cacheLocation&&"localStorage"===this.config.cacheLocation?this._supportsLocalStorage()?localStorage.getItem(e):(this.info("Local storage is not supported"),null):this._supportsSessionStorage()?sessionStorage.getItem(e):(this.info("Session storage is not supported"),null)},r.prototype._supportsLocalStorage=function(){try{return!!window.localStorage&&(window.localStorage.setItem("storageTest","A"),"A"==window.localStorage.getItem("storageTest")&&(window.localStorage.removeItem("storageTest"),!window.localStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._supportsSessionStorage=function(){try{return!!window.sessionStorage&&(window.sessionStorage.setItem("storageTest","A"),"A"==window.sessionStorage.getItem("storageTest")&&(window.sessionStorage.removeItem("storageTest"),!window.sessionStorage.getItem("storageTest")))}catch(e){return!1}},r.prototype._cloneConfig=function(e){if(null===e||"object"!=typeof e)return e;var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},r.prototype._addLibMetadata=function(){return"&x-client-SKU=Js&x-client-Ver="+this._libVersion()},r.prototype.log=function(e,t,r,n){if(e<=Logging.level){if(!Logging.piiLoggingEnabled&&n)return;var s=(new Date).toUTCString(),i="";i=this.config.correlationId?s+":"+this.config.correlationId+"-"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t:s+":"+this._libVersion()+"-"+this.CONSTANTS.LEVEL_STRING_MAP[e]+" "+t,r&&(i+="\nstack:\n"+r.stack),Logging.log(i)}},r.prototype.error=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t)},r.prototype.warn=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null)},r.prototype.info=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null)},r.prototype.verbose=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null)},r.prototype.errorPii=function(e,t){this.log(this.CONSTANTS.LOGGING_LEVEL.ERROR,e,t,!0)},r.prototype.warnPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.WARN,e,null,!0)},r.prototype.infoPii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.INFO,e,null,!0)},r.prototype.verbosePii=function(e){this.log(this.CONSTANTS.LOGGING_LEVEL.VERBOSE,e,null,!0)},r.prototype._libVersion=function(){return"1.0.17"},void 0!==e&&e.exports&&(e.exports=r,e.exports.inject=function(e){return new r(e)}),r}()},function(e,t,r){"use strict";r.r(t);class n{static get activeLogLevel(){return n.instance.activeLogLevel}static set activeLogLevel(e){n.instance.activeLogLevel=e}static get instance(){return void 0!==n._instance&&null!==n._instance||(n._instance=new s),n._instance}static subscribe(...e){e.map(e=>n.instance.subscribe(e))}static clearSubscribers(){return n.instance.clearSubscribers()}static get count(){return n.instance.count}static write(e,t=1){n.instance.log({level:t,message:e})}static writeJSON(e,t=1){this.write(JSON.stringify(e),t)}static log(e){n.instance.log(e)}static error(e){n.instance.log({data:e,level:3,message:e.message})}}class s{constructor(e=2,t=[]){this.activeLogLevel=e,this.subscribers=t}subscribe(e){this.subscribers.push(e)}clearSubscribers(){const e=this.subscribers.slice(0);return this.subscribers.length=0,e}get count(){return this.subscribers.length}write(e,t=1){this.log({level:t,message:e})}log(e){void 0!==e&&this.activeLogLevel<=e.level&&this.subscribers.map(t=>t.log(e))}}var i;!function(e){e[e.Verbose=0]="Verbose",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Off=99]="Off"}(i||(i={}));class o{log(e){const t=this.format(e);switch(e.level){case 0:case 1:console.log(t);break;case 2:console.warn(t);break;case 3:console.error(t)}}format(e){const t=[];return t.push("Message: "+e.message),void 0!==e.data&&t.push(" Data: "+JSON.stringify(e.data)),t.join("")}}class a{constructor(e){this.method=e}log(e){this.method(e)}}var c=r(0);class l{constructor(e=new Map){this._settings=e}add(e,t){this._settings.set(e,t)}addJSON(e,t){this._settings.set(e,Object(c.t)(t))}apply(e){return new Promise((t,r)=>{try{this._settings=Object(c.v)(this._settings,Object(c.y)(e)),t()}catch(e){r(e)}})}load(e){return new Promise((t,r)=>{e.getConfiguration().then(e=>{this._settings=Object(c.v)(this._settings,Object(c.y)(e)),t()}).catch(r)})}get(e){return this._settings.get(e)||null}getJSON(e){const t=this.get(e);return void 0===t||null===t?t:JSON.parse(t)}}class u{constructor(e,t,r){this.wrappedProvider=e,this.cacheKey=t,this.wrappedProvider=e,this.store=r||this.selectPnPCache()}getWrappedProvider(){return this.wrappedProvider}getConfiguration(){return this.store&&this.store.enabled?this.store.getOrPut(this.cacheKey,()=>this.wrappedProvider.getConfiguration().then(e=>(this.store.put(this.cacheKey,e),e))):this.wrappedProvider.getConfiguration()}selectPnPCache(){const e=new c.d;if(e.local&&e.local.enabled)return e.local;if(e.session&&e.session.enabled)return e.session;throw Error("Cannot create a caching configuration provider since cache is not available.")}}class h{constructor(e,t="config",r="Title",n="Value"){this.web=e,this.listTitle=t,this.keyFieldName=r,this.valueFieldName=n}getConfiguration(){return this.web.lists.getByTitle(this.listTitle).items.select(this.keyFieldName,this.valueFieldName).get().then(e=>e.reduce((e,t)=>(e[t[this.keyFieldName]]=t[this.valueFieldName],e),{}))}asCaching(e=`pnp_configcache_splist_${this.web.toUrl()}+${this.listTitle}`){return new u(this,e)}}class d{constructor(e){this.key=e,this.expiration=Object(c.i)(new Date,"second",c.f.defaultCachingTimeoutSeconds),this.storeName=c.f.defaultCachingStore}get store(){return"local"===this.storeName?d.storage.local:d.storage.session}}d.storage=new c.d;class p{constructor(e,t){this.parser=e,this.cacheOptions=t}parse(e){return this.parser.parse(e).then(e=>this.cacheData(e))}cacheData(e){return null!==this.cacheOptions.store&&this.cacheOptions.store.put(this.cacheOptions.key,e,this.cacheOptions.expiration),e}}class g extends Error{constructor(e,t,r=t.status,n=t.statusText){super(e),this.response=t,this.status=r,this.statusText=n,this.isHttpRequestError=!0}}class m{parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&this.parseImpl(e,t,r)})}parseImpl(e,t,r){e.headers.has("Content-Length")&&0===parseFloat(e.headers.get("Content-Length"))||204===e.status?t({}):e.text().then(e=>e.replace(/\s/gi,"").length>0?JSON.parse(e):{}).then(e=>t(this.parseODataJSON(e))).catch(e=>r(e))}handleError(e,t){return e.ok||t(new g(`Error making HttpClient request in queryable: [${e.status}] ${e.statusText}`,e.clone())),e.ok}parseODataJSON(e){let t=e;return Object(c.p)(e,"d")?t=Object(c.p)(e.d,"results")?e.d.results:e.d:Object(c.p)(e,"value")&&(t=e.value),t}}class f extends m{}class b extends m{parseImpl(e,t){e.text().then(t)}}class y extends m{parseImpl(e,t){e.blob().then(t)}}class T extends m{parseImpl(e,t){e.json().then(t)}}class S extends m{parseImpl(e,t){Object(c.r)(e.arrayBuffer)?e.arrayBuffer().then(t):e.buffer().then(t)}}class w extends m{constructor(e){super(),this.parser=e}parseImpl(e,t){this.parser(e).then(t)}}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function C(e,t,r,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(i<3?s(o):i>3?s(t,r,o):s(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function O(e,t){return new Promise(r=>{e.result=t,e.hasResult=!0,r(e)})}function _(e){return e.pipeline.length>0?e.pipeline.shift()(e):Promise.resolve(e)}function I(e){e.pipeline.length<1&&n.write(`[${e.requestId}] (${(new Date).getTime()}) Request pipeline contains no methods!`,2);const t=_(e).then(e=>(function(e){return n.log({data:0===n.activeLogLevel?e.result:{},level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Returning result from pipeline. Set logging to verbose to see data.`}),Promise.resolve(e.result)})(e)).catch(e=>{throw n.error(e),e});return e.isBatched&&e.batch.addResolveBatchDependency(t),t}function v(e=!1){return(t,r,s)=>{const i=s.value;s.value=function(...s){return!e&&s.length>0&&Object(c.p)(s[0],"hasResult")&&s[0].hasResult?(n.write(`[${s[0].requestId}] (${(new Date).getTime()}) Skipping request pipeline method ${r}, existing result in pipeline.`,0),Promise.resolve(s[0])):(n.write(`[${s[0].requestId}] (${(new Date).getTime()}) Calling request pipeline method ${r}.`,0),i.apply(t,s).then(e=>_(e)))}}}class E{static logStart(e){return new Promise(t=>{n.log({data:1===n.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Beginning ${e.verb} request (${e.requestAbsoluteUrl})`}),t(e)})}static caching(e){return new Promise(t=>{if(e.isCached){n.write(`[${e.requestId}] (${(new Date).getTime()}) Caching is enabled for request, checking cache...`,1);let r=new d(e.requestAbsoluteUrl.toLowerCase());if(void 0!==e.cachingOptions&&(r=Object(c.j)(r,e.cachingOptions)),null!==r.store){let s=r.store.get(r.key);if(null!==s)return n.log({data:1===n.activeLogLevel?{}:s,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Value returned from cache.`}),Object(c.r)(e.batchDependency)&&e.batchDependency(),Object(c.p)(e.parser,"hydrate")&&(s=e.parser.hydrate(s)),O(e,s).then(e=>t(e))}n.write(`[${e.requestId}] (${(new Date).getTime()}) Value not found in cache.`,1),e.parser=new p(e.parser,r)}return t(e)})}static send(e){return new Promise((t,r)=>{if(e.isBatched){const r=e.batch.add(e.requestAbsoluteUrl,e.verb,e.options,e.parser,e.requestId);Object(c.r)(e.batchDependency)&&e.batchDependency(),n.write(`[${e.requestId}] (${(new Date).getTime()}) Batching request in batch ${e.batch.batchId}.`,1),t(O(e,r))}else{n.write(`[${e.requestId}] (${(new Date).getTime()}) Sending request.`,1);const s=e.clientFactory(),i=Object(c.j)(e.options||{},{method:e.verb});s.fetch(e.requestAbsoluteUrl,i).then(t=>e.parser.parse(t)).then(t=>O(e,t)).then(e=>t(e)).catch(e=>r(e))}})}static logEnd(e){return new Promise(t=>{e.isBatched?n.log({data:1===n.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) ${e.verb} request will complete in batch ${e.batch.batchId}.`}):n.log({data:1===n.activeLogLevel?{}:e,level:1,message:`[${e.requestId}] (${(new Date).getTime()}) Completing ${e.verb} request.`}),t(e)})}}function P(){return[E.logStart,E.caching,E.send,E.logEnd].slice(0)}C([v(!0)],E,"logStart",null),C([v()],E,"caching",null),C([v()],E,"send",null),C([v(!0)],E,"logEnd",null);class N{constructor(){this._query=new Map,this._options={},this._url="",this._parentUrl="",this._useCaching=!1,this._cachingOptions=null}toUrl(){return this._url}concat(e){return this._url+=e,this}get query(){return this._query}configure(e){return Object(c.w)(this._options,e),this}configureFrom(e){return Object(c.w)(this._options,e._options),this}usingCaching(e){return c.f.globalCacheDisable||(this._useCaching=!0,void 0!==e&&(this._cachingOptions=e)),this}getCore(e=new T,t={}){return this.toRequestContext("GET",t,e,P()).then(e=>I(e))}postCore(e={},t=new T){return this.toRequestContext("POST",e,t,P()).then(e=>I(e))}patchCore(e={},t=new T){return this.toRequestContext("PATCH",e,t,P()).then(e=>I(e))}deleteCore(e={},t=new T){return this.toRequestContext("DELETE",e,t,P()).then(e=>I(e))}putCore(e={},t=new T){return this.toRequestContext("PUT",e,t,P()).then(e=>I(e))}append(e){this._url=Object(c.h)(this._url,e)}get parentUrl(){return this._parentUrl}extend(e,t){this._parentUrl=e._url,this._url=Object(c.h)(this._parentUrl,t||""),this.configureFrom(e)}}class R extends N{constructor(){super(),this._batch=null}inBatch(e){if(null!==this.batch)throw Error("This query is already part of a batch.");return this._batch=e,this}toUrl(){return this._url}get(e=new f,t={}){return this.getCore(e,t)}getCore(e=new f,t={}){return this.toRequestContext("GET",t,e,P()).then(e=>I(e))}postCore(e={},t=new f){return this.toRequestContext("POST",e,t,P()).then(e=>I(e))}patchCore(e={},t=new f){return this.toRequestContext("PATCH",e,t,P()).then(e=>I(e))}deleteCore(e={},t=new f){return this.toRequestContext("DELETE",e,t,P()).then(e=>I(e))}putCore(e={},t=new f){return this.toRequestContext("PUT",e,t,P()).then(e=>I(e))}addBatchDependency(){return null!==this._batch?this._batch.addDependency():()=>null}get hasBatch(){return Object(c.x)(this._batch)}get batch(){return this.hasBatch?this._batch:null}}class A{constructor(e=Object(c.m)()){this._batchId=e,this._reqs=[],this._deps=[],this._rDeps=[]}get batchId(){return this._batchId}get requests(){return this._reqs}add(e,t,r,n,s){const i={id:s,method:t.toUpperCase(),options:r,parser:n,reject:null,resolve:null,url:e},o=new Promise((e,t)=>{i.resolve=e,i.reject=t});return this._reqs.push(i),o}addDependency(){let e=()=>void 0;return this._deps.push(new Promise(t=>{e=t})),e}addResolveBatchDependency(e){this._rDeps.push(e)}execute(){return Promise.all(this._deps).then(()=>Promise.all(this._deps)).then(()=>this.executeImpl()).then(()=>Promise.all(this._rDeps)).then(()=>void 0)}}let x=new class{get headers(){const e=c.f.get("graph");return void 0!==e&&null!==e&&void 0!==e.headers?e.headers:{}}get fetchClientFactory(){const e=c.f.get("graph");if(void 0!==e&&null!==e&&void 0!==e.fetchClientFactory)return e.fetchClientFactory;if(void 0!==c.f.spfxContext)return()=>c.a.fromSPFxContext(c.f.spfxContext);throw Error("There is no Graph Client available, either set one using configuraiton or provide a valid SPFx Context using setup.")}};class j{constructor(){this._impl=x.fetchClientFactory()}fetch(e,t={}){const r=new Headers;Object(c.u)(r,x.headers),Object(c.u)(r,t.headers),r.has("Content-Type")||r.append("Content-Type","application/json");const n=Object(c.j)(t,{headers:r});return this.fetchRaw(e,n)}fetchRaw(e,t={}){const r=new Headers;Object(c.u)(r,t.headers),t=Object(c.j)(t,{headers:r});const n=r=>{this._impl.fetch(e,t).then(e=>r.resolve(e)).catch(e=>{429!==e.status&&503!==e.status&&r.reject(e);const t=r.delay;r.delay*=2,r.attempts++,r.retryCount<=r.attempts&&r.reject(e),setTimeout(Object(c.l)(this,n,r),t)})};return new Promise((e,t)=>{const r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};n.call(this,r)})}get(e,t={}){const r=Object(c.j)(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=Object(c.j)(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=Object(c.j)(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=Object(c.j)(t,{method:"DELETE"});return this.fetch(e,r)}}class U{static ensure(e,t){const r=[U.Beta,U.V1];let n=new RegExp(t,"i");const s=r.filter(e=>!n.test(e)).map(e=>e.replace(".","\\."));return n=new RegExp(`/?(${s.join("|")})/`,"ig"),e.replace(n,`/${t}/`)}}U.Beta="beta",U.V1="v1.0";class k extends R{constructor(e,t){if(super(),"string"==typeof e){const r=e;this._parentUrl=r,this._url=Object(c.h)(r,t)}else this.extend(e,t)}as(e){const t=new e(this._url,null);return Object(c.j)(t,this,!0)}toUrlAndQuery(){let e=this.toUrl();if(Object(c.s)(e)||(e=Object(c.h)("https://graph.microsoft.com",e)),this.query.size>0){e+=`${e.indexOf("?")>-1?"&":"?"}${Array.from(this.query).map(e=>e[0]+"="+e[1]).join("&")}`}return e}getParent(e,t=this.parentUrl,r){return new e(t,r)}clone(e,t,r=!0){let n=new e(this,t);return n.configure(this._options),r&&(n=n.inBatch(this._batch)),n}setEndpoint(e){return this._url=U.ensure(this._url,e),this}toRequestContext(e,t={},r,n){return Promise.resolve({batch:this.batch,batchDependency:()=>void 0,cachingOptions:this._cachingOptions,clientFactory:()=>new j,isBatched:this.hasBatch,isCached:/^get$/i.test(e)&&this._useCaching,options:t,parser:r,pipeline:n,requestAbsoluteUrl:this.toUrlAndQuery(),requestId:Object(c.m)(),verb:e})}}class L extends k{filter(e){return this.query.set("$filter",e),this}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${e} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}top(e){return this.query.set("$top",e.toString()),this}skip(e){return this.query.set("$top",e.toString()),this}skipToken(e){return this.query.set("$skiptoken",e),this}get count(){return this.query.set("$count","true"),this}}class D extends L{search(e){return this.query.set("$search",e),this}}class F extends k{select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}}class $ extends L{constructor(e,t="members"){super(e,t)}add(e){return this.clone($,"$ref").postCore({body:Object(c.t)({"@odata.id":e})})}getById(e){return new B(this,e)}}class B extends F{}class q extends ${constructor(e,t="owners"){super(e,t)}}class G extends F{get events(){return new M(this)}}class M extends L{constructor(e,t="events"){super(e,t)}getById(e){return new W(this,e)}add(e){return this.postCore({body:Object(c.t)(e)}).then(e=>({data:e,event:this.getById(e.id)}))}}class W extends F{update(e){return this.patchCore({body:Object(c.t)(e)})}delete(){return this.deleteCore()}}class H extends L{constructor(e,t="attachments"){super(e,t)}getById(e){return new K(this,e)}addFile(e,t){return this.postCore({body:Object(c.t)({"@odata.type":"#microsoft.graph.fileAttachment",contentBytes:t,name:e})})}}class K extends F{}class V extends L{constructor(e,t="conversations"){super(e,t)}add(e){return this.postCore({body:Object(c.t)(e)})}getById(e){return new J(this,e)}}class Q extends L{constructor(e,t="threads"){super(e,t)}getById(e){return new X(this,e)}add(e){return this.postCore({body:Object(c.t)(e)})}}class z extends L{constructor(e,t="posts"){super(e,t)}getById(e){return new Y(this,e)}add(e){return this.postCore({body:Object(c.t)(e)})}}class J extends F{get threads(){return new Q(this)}update(e){return this.patchCore({body:Object(c.t)(e)})}delete(){return this.deleteCore()}}class X extends F{get posts(){return new z(this)}reply(e){return this.clone(X,"reply").postCore({body:Object(c.t)({post:e})})}delete(){return this.deleteCore()}}class Y extends F{get attachments(){return new H(this)}delete(){return this.deleteCore()}forward(e){return this.clone(Y,"forward").postCore({body:Object(c.t)(e)})}reply(e){return this.clone(Y,"reply").postCore({body:Object(c.t)({post:e})})}}class Z extends L{constructor(e,t){super(e,t)}add(e){return this.clone(Z,"$ref").postCore({body:Object(c.t)({"@odata.id":e})})}remove(e){const t=this.clone(Z,"$ref");return t.query.set("$id",e),t.deleteCore()}}class ee extends L{constructor(e,t="planner/plans"){super(e,t)}getById(e){return new te(this,e)}}class te extends F{}class re extends F{constructor(e,t="photo"){super(e,t)}getBlob(){return this.clone(re,"$value",!1).get(new y)}getBuffer(){return this.clone(re,"$value",!1).get(new S)}setContent(e){return this.clone(re,"$value",!1).patchCore({body:e})}}class ne{create(e,t="",r={}){const n=t&&t.length>0?{description:t}:{};return Oe.groups.add(e,e,ie.Office365,n).then(e=>e.group.createTeam(r).then(t=>({data:t,group:e.group,team:new se(e.group)})))}}class se extends F{constructor(e,t="team"){super(e,t)}update(e){return this.clone(se,"").setEndpoint(U.Beta).patchCore({body:Object(c.t)(e)}).then(e=>({data:e,team:this}))}get(e=new f,t={}){return this.clone(se,"").setEndpoint(U.Beta).getCore(e,t)}}var ie;!function(e){e[e.Office365=0]="Office365",e[e.Dynamic=1]="Dynamic",e[e.Security=2]="Security"}(ie||(ie={}));class oe extends L{constructor(e,t="groups"){super(e,t)}getById(e){return new ae(this,e)}add(e,t,r,n={}){let s=Object(c.j)({displayName:e,mailEnabled:r===ie.Office365,mailNickname:t,securityEnabled:r!==ie.Office365},n);return r!==ie.Security&&(s=Object(c.j)(s,{groupTypes:r===ie.Office365?["Unified"]:["DynamicMembership"]})),this.postCore({body:Object(c.t)(s)}).then(e=>({data:e,group:this.getById(e.id)}))}}class ae extends F{get calendar(){return new G(this,"calendar")}get events(){return new M(this)}get owners(){return new q(this)}get plans(){return new ee(this)}get members(){return new $(this)}get conversations(){return new V(this)}get acceptedSenders(){return new Z(this,"acceptedsenders")}get rejectedSenders(){return new Z(this,"rejectedsenders")}get photo(){return new re(this)}get team(){return new se(this)}addFavorite(){return this.clone(ae,"addFavorite").postCore()}createTeam(e){return this.clone(ae,"team").setEndpoint(U.Beta).putCore({body:Object(c.t)(e)})}getMemberGroups(e=!1){return this.clone(ae,"getMemberGroups").postCore({body:Object(c.t)({securityEnabledOnly:e})})}delete(){return this.deleteCore()}update(e){return this.patchCore({body:Object(c.t)(e)})}removeFavorite(){return this.clone(ae,"removeFavorite").postCore()}resetUnseenCount(){return this.clone(ae,"resetUnseenCount").postCore()}subscribeByMail(){return this.clone(ae,"subscribeByMail").postCore()}unsubscribeByMail(){return this.clone(ae,"unsubscribeByMail").postCore()}getCalendarView(e,t){const r=this.clone(ae,"calendarView");return r.query.set("startDateTime",e.toISOString()),r.query.set("endDateTime",t.toISOString()),r.get()}}class ce extends F{constructor(e,t="onenote"){super(e,t)}get notebooks(){return new le(this)}get sections(){return new he(this)}get pages(){return new pe(this)}}class le extends L{constructor(e,t="notebooks"){super(e,t)}getById(e){return new ue(this,e)}add(e){const t={displayName:e};return this.postCore({body:Object(c.t)(t)}).then(e=>({data:e,notebook:this.getById(e.id)}))}}class ue extends F{constructor(e,t){super(e,t)}get sections(){return new he(this)}}class he extends L{constructor(e,t="sections"){super(e,t)}getById(e){return new de(this,e)}add(e){const t={displayName:e};return this.postCore({body:Object(c.t)(t)}).then(e=>({data:e,section:this.getById(e.id)}))}}class de extends F{constructor(e,t){super(e,t)}}class pe extends L{constructor(e,t="pages"){super(e,t)}}class ge extends L{constructor(e,t="contacts"){super(e,t)}getById(e){return new me(this,e)}add(e,t,r,n,s={}){const i=Object(c.j)({businessPhones:n,emailAddresses:r,givenName:e,surName:t},s);return this.postCore({body:Object(c.t)(i)}).then(e=>({contact:this.getById(e.id),data:e}))}}class me extends F{delete(){return this.deleteCore()}update(e){return this.patchCore({body:Object(c.t)(e)})}}class fe extends L{constructor(e,t="contactFolders"){super(e,t)}getById(e){return new be(this,e)}add(e,t){const r={displayName:e,parentFolderId:t};return this.postCore({body:Object(c.t)(r)}).then(e=>({contactFolder:this.getById(e.id),data:e}))}}class be extends F{get contacts(){return new ge(this)}get childFolders(){return new ye(this)}delete(){return this.deleteCore()}update(e){return this.patchCore({body:Object(c.t)(e)})}}class ye extends F{constructor(e,t="childFolders"){super(e,t)}getById(e){return new be(this,e)}add(e,t){const r={displayName:e,parentFolderId:t};return this.postCore({body:Object(c.t)(r)}).then(e=>({contactFolder:this.getById(e.id),data:e}))}}class Te extends F{constructor(e,t="me"){super(e,t)}get onenote(){return new ce(this)}get contacts(){return new ge(this)}get contactFolders(){return new fe(this)}}class Se extends L{constructor(e,t="users"){super(e,t)}getById(e){return new we(this,e)}}class we extends F{get onenote(){return new ce(this)}get contacts(){return new ge(this)}get contactFolders(){return new fe(this)}}class Ce extends k{constructor(e,t){super(e,t)}get groups(){return new oe(this)}get teams(){return new ne}get me(){return new Te(this)}get users(){return new Se(this)}setup(e){!function(e){c.f.extend(e)}(e)}}let Oe=new Ce("v1.0");class _e extends A{constructor(e="https://graph.microsoft.com/beta/$batch"){super(),this.batchUrl=e}executeImpl(){n.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1);const e=new j,t={requests:this.formatRequests()},r={body:Object(c.t)(t),headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};return n.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1),e.fetch(this.batchUrl,r).then(e=>e.json()).then(this._parseResponse).then(e=>(n.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),e.responses.reduce((t,r,s)=>{const i=this.requests[s];if(Object(c.x)(i))return n.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched request ${i.method} ${i.url}.`,0),t.then(e=>i.parser.parse(r).then(i.resolve).catch(i.reject));if(e.nextLink)throw Error("Could not properly parse responses to match requests in batch.");return t},Promise.resolve())))}formatRequests(){return this.requests.map((e,t)=>{let r={id:`${++t}`,method:e.method,url:e.url},n={};return void 0!==x.headers&&null!==x.headers&&(n=Object(c.j)(n,x.headers)),void 0!==e.options&&(void 0!==e.options.headers&&null!==e.options.headers&&(n=Object(c.j)(n,e.options.headers)),void 0!==e.options.body&&null!==e.options.body&&(r=Object(c.j)(r,{body:e.options.body}))),r=Object(c.j)(r,{headers:n})})}_parseResponse(e){return new Promise(t=>{const r=new Array(this.requests.length).fill(null);for(let t=0;t<e.responses.length;++t){const n=e.responses[t],s=parseInt(n.id,10)-1;204===n.status?r[s]=new Response:r[s]=new Response(null,{headers:n.headers,status:n.status})}t({nextLink:e.nextLink,responses:r})})}}function Ie(e){if(Object(c.A)(e))return"";let t=e.indexOf("_api/");return t<0&&(t=e.indexOf("_vti_bin/")),t>-1?e.substr(0,t):e}function ve(e){const t=[],r=["odata.type","odata.editLink","__metadata","odata.metadata"];return Object(c.p)(e,r[0])&&"SP.Web"===e[r[0]]?Object(c.p)(e,r[1])?t.push(e[r[1]]):Object(c.p)(e,r[2])&&t.push(e.__metadata.uri):Object(c.p)(e,r[3])&&Object(c.p)(e,r[1])?t.push(Ie(e[r[3]]),"_api",e[r[1]]):Object(c.p)(e,r[1])?t.push("_api",e[r[1]]):Object(c.p)(e,r[2])&&t.push(e.__metadata.uri),t.length<1?(n.write("No uri information found in ODataEntity parsing, chaining will fail for this object.",2),""):Object(c.h)(...t)}class Ee extends m{constructor(e){super(),this.factory=e,this.hydrate=(e=>{const t=new this.factory(ve(e),null);return Object(c.j)(t,e)})}parse(e){return super.parse(e).then(e=>{const t=new this.factory(ve(e),null);return Object(c.j)(t,e)})}}class Pe extends m{constructor(e){super(),this.factory=e,this.hydrate=(e=>e.map(e=>{const t=new this.factory(ve(e),null);return Object(c.j)(t,e)}))}parse(e){return super.parse(e).then(e=>e.map(e=>{const t=new this.factory(ve(e),null);return Object(c.j)(t,e)}))}}function Ne(e){return new Ee(e)}function Re(e){return new Pe(e)}var Ae=r(2);class xe{}const je=new Map;class Ue{constructor(e,t=je){this._httpClient=e,this._digests=t}getDigest(e){const t=this._digests.get(e);if(void 0!==t){if(new Date<t.expiration)return Promise.resolve(t.value)}const r=Object(c.h)(e,"/_api/contextinfo");return this._httpClient.fetchRaw(r,{cache:"no-cache",credentials:"same-origin",headers:Object(c.j)({Accept:"application/json;odata=verbose","Content-Type":"application/json;odata=verbose;charset=utf-8"},Ae.a.headers,!0),method:"POST"}).then(e=>{return(new f).parse(e).then(e=>e.GetContextWebInformation)}).then(t=>{const r=new xe;r.value=t.FormDigestValue;const n=t.FormDigestTimeoutSeconds,s=new Date;return s.setTime(s.getTime()+1e3*n),r.expiration=s,this._digests.set(e,r),r.value})}clear(){this._digests.clear()}}class ke{constructor(e=Ae.a.fetchClientFactory()){this._impl=e,this._digestCache=new Ue(this)}fetch(e,t={}){let r=Object(c.j)(t,{cache:"no-cache",credentials:"same-origin"},!0);const n=new Headers;return Object(c.u)(n,Ae.a.headers),Object(c.u)(n,t.headers),n.has("Accept")||n.append("Accept","application/json"),n.has("Content-Type")||n.append("Content-Type","application/json;odata=verbose;charset=utf-8"),n.has("X-ClientService-ClientTag")||n.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.2"),n.has("User-Agent")||n.append("User-Agent","NONISV|SharePointPnP|PnPCoreJS/1.2.2"),!(r=Object(c.j)(r,{headers:n})).method||"GET"===r.method.toUpperCase()||n.has("X-RequestDigest")||n.has("Authorization")?this.fetchRaw(e,r):this._digestCache.getDigest(Ie(e)).then(t=>(n.append("X-RequestDigest",t),this.fetchRaw(e,r)))}fetchRaw(e,t={}){const r=new Headers;Object(c.u)(r,t.headers),t=Object(c.j)(t,{headers:r});const n=r=>{const s=e=>{let t;e.headers.has("Retry-After")?t=parseInt(e.headers.get("Retry-After"),10):(t=r.delay,r.delay*=2),r.attempts++,r.retryCount<=r.attempts?r.reject(Error(`Retry count exceeded (${r.retryCount}) for request. Response status: [${e.status}] ${e.statusText}`)):setTimeout(Object(c.l)(this,n,r),t)};this._impl.fetch(e,t).then(e=>{429===e.status?s(e):r.resolve(e)}).catch(e=>{503===e.status?s(e):r.reject(e)})};return new Promise((e,t)=>{const r={attempts:0,delay:100,reject:t,resolve:e,retryCount:7};n.call(this,r)})}get(e,t={}){const r=Object(c.j)(t,{method:"GET"});return this.fetch(e,r)}post(e,t={}){const r=Object(c.j)(t,{method:"POST"});return this.fetch(e,r)}patch(e,t={}){const r=Object(c.j)(t,{method:"PATCH"});return this.fetch(e,r)}delete(e,t={}){const r=Object(c.j)(t,{method:"DELETE"});return this.fetch(e,r)}}var Le,De=r(3);function Fe(e){return{__metadata:{type:e}}}class $e extends R{constructor(e,t){if(super(),this._forceCaching=!1,"string"==typeof e)if(Object(c.s)(e)||e.lastIndexOf("/")<0)this._parentUrl=e,this._url=Object(c.h)(e,t);else if(e.lastIndexOf("/")>e.lastIndexOf("(")){const r=e.lastIndexOf("/");this._parentUrl=e.slice(0,r),t=Object(c.h)(e.slice(r),t),this._url=Object(c.h)(this._parentUrl,t)}else{const r=e.lastIndexOf("(");this._parentUrl=e.slice(0,r),this._url=Object(c.h)(e,t)}else{this.extend(e,t);const r=e.query.get("@target");void 0!==r&&this.query.set("@target",r)}}as(e){const t=new e(this._url,null);return Object(c.j)(t,this,!0)}toUrlAndQuery(){const e=new Map(this.query);let t=this.toUrl().replace(/'!(@.*?)::(.*?)'/gi,(t,r,s)=>(n.write(`Rewriting aliased parameter from match ${t} to label: ${r} value: ${s}`,0),e.set(r,`'${s}'`),r));if(e.size>0){t+=`${t.indexOf("?")>-1?"&":"?"}${Array.from(e).map(e=>e[0]+"="+e[1]).join("&")}`}return t}select(...e){return e.length>0&&this.query.set("$select",e.join(",")),this}expand(...e){return e.length>0&&this.query.set("$expand",e.join(",")),this}getParent(e,t=this.parentUrl,r,n){let s=new e(t,r).configureFrom(this);const i="@target";return this.query.has(i)&&s.query.set(i,this.query.get(i)),void 0!==n&&(s=s.inBatch(n)),s}clone(e,t,r=!0){let n=new e(this,t).configureFrom(this);const s="@target";return this.query.has(s)&&n.query.set(s,this.query.get(s)),r&&this.hasBatch&&(n=n.inBatch(this.batch)),n}toRequestContext(e,t={},r,n){const s=this.hasBatch?this.addBatchDependency():()=>{};return Object(De.a)(this.toUrlAndQuery()).then(i=>{return Object(c.w)(t,this._options),{batch:this.batch,batchDependency:s,cachingOptions:this._cachingOptions,clientFactory:()=>new ke,isBatched:this.hasBatch,isCached:this._forceCaching||this._useCaching&&/^get$/i.test(e),options:t,parser:r,pipeline:n,requestAbsoluteUrl:i,requestId:Object(c.m)(),verb:e}})}}class Be extends $e{filter(e){return this.query.set("$filter",e),this}orderBy(e,t=!0){const r="$orderby",n=this.query.has(r)?this.query.get(r).split(","):[];return n.push(`${e} ${t?"asc":"desc"}`),this.query.set(r,n.join(",")),this}skip(e){return this.query.set("$skip",e.toString()),this}top(e){return this.query.set("$top",e.toString()),this}}class qe extends $e{_update(e,t){return r=>this.postCore({body:Object(c.t)(Object(c.j)(Fe(e),r)),headers:{"X-HTTP-Method":"MERGE"}}).then(e=>t(e,r))}_delete(){return this.postCore({headers:{"X-HTTP-Method":"DELETE"}})}_deleteWithETag(e="*"){return this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}}function Ge(e){return function(t){return class extends t{constructor(...t){super(t[0],t.length>1&&void 0!==t[1]?t[1]:e)}}}}let Me=Le=class extends Be{getById(e){return new We(this,`getById(${e})`)}getByEmail(e){return new We(this,`getByEmail('${e}')`)}getByLoginName(e){const t=new We(this);return t.concat(`('!@v::${encodeURIComponent(e)}')`),t}removeById(e){return this.clone(Le,`removeById(${e})`).postCore()}removeByLoginName(e){const t=this.clone(Le,"removeByLoginName(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.postCore()}add(e){return this.clone(Le,null).postCore({body:Object(c.t)(Object(c.j)(Fe("SP.User"),{LoginName:e}))}).then(()=>this.getByLoginName(e))}};Me=Le=C([Ge("siteusers")],Me);class We extends qe{constructor(){super(...arguments),this.update=this._update("SP.User",e=>({data:e,user:this})),this.delete=this._delete}get groups(){return new Qe(this,"groups")}}let He=class extends qe{};var Ke,Ve;He=C([Ge("currentuser")],He),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(Ve||(Ve={}));let Qe=Ke=class extends Be{getById(e){const t=new ze(this);return t.concat(`(${e})`),t}add(e){const t=Object(c.t)(Object(c.j)(Fe("SP.Group"),e));return this.postCore({body:t}).then(e=>({data:e,group:this.getById(e.Id)}))}getByName(e){return new ze(this,`getByName('${e}')`)}removeById(e){return this.clone(Ke,`removeById('${e}')`).postCore()}removeByLoginName(e){return this.clone(Ke,`removeByLoginName('${e}')`).postCore()}};Qe=Ke=C([Ge("sitegroups")],Qe);class ze extends qe{constructor(){super(...arguments),this.update=this._update("SP.Group",(e,t)=>{let r=this;return Object(c.p)(t,"Title")&&(r=this.getParent(ze,this.parentUrl,`getByName('${t.Title}')`)),{data:e,group:r}})}get users(){return new Me(this,"users")}}var Je;let Xe=Je=class extends Be{getById(e){const t=new class extends qe{constructor(){super(...arguments),this.delete=this._delete}get groups(){return new Qe(this,"groups")}get bindings(){return new et(this)}}(this);return t.concat(`(${e})`),t}add(e,t){return this.clone(Je,`addroleassignment(principalid=${e}, roledefid=${t})`).postCore()}remove(e,t){return this.clone(Je,`removeroleassignment(principalid=${e}, roledefid=${t})`).postCore()}};Xe=Je=C([Ge("roleassignments")],Xe);let Ye=class extends Be{getById(e){return new Ze(this,`getById(${e})`)}getByName(e){return new Ze(this,`getbyname('${e}')`)}getByType(e){return new Ze(this,`getbytype(${e})`)}add(e,t,r,n){const s=Object(c.t)({BasePermissions:Object(c.j)({__metadata:{type:"SP.BasePermissions"}},n),Description:t,Name:e,Order:r,__metadata:{type:"SP.RoleDefinition"}});return this.postCore({body:s}).then(e=>({data:e,definition:this.getById(e.Id)}))}};Ye=C([Ge("roledefinitions")],Ye);class Ze extends qe{constructor(){super(...arguments),this.delete=this._delete}update(e){const t=["BasePermissions"];void 0!==Object(c.p)(e,t[0])&&(e[t[0]]=Object(c.j)({__metadata:{type:"SP."+t[0]}},e[t[0]]));const r=Object(c.t)(Object(c.j)(Fe("SP.RoleDefinition"),e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(t=>{let r=this;if(Object(c.p)(e,"Name")){r=this.getParent(Ye,this.parentUrl,"").getByName(e.Name)}return{data:t,definition:r}})}}let et=class extends Be{};var tt,rt,nt,st,it,ot,at,ct,lt,ut,ht,dt,pt,gt,mt,ft,bt,yt,Tt,St;et=C([Ge("roledefinitionbindings")],et),function(e){e[e.Display=1]="Display",e[e.Edit=2]="Edit",e[e.New=3]="New"}(tt||(tt={})),function(e){e[e.Invalid=0]="Invalid",e[e.Integer=1]="Integer",e[e.Text=2]="Text",e[e.Note=3]="Note",e[e.DateTime=4]="DateTime",e[e.Counter=5]="Counter",e[e.Choice=6]="Choice",e[e.Lookup=7]="Lookup",e[e.Boolean=8]="Boolean",e[e.Number=9]="Number",e[e.Currency=10]="Currency",e[e.URL=11]="URL",e[e.Computed=12]="Computed",e[e.Threading=13]="Threading",e[e.Guid=14]="Guid",e[e.MultiChoice=15]="MultiChoice",e[e.GridChoice=16]="GridChoice",e[e.Calculated=17]="Calculated",e[e.File=18]="File",e[e.Attachments=19]="Attachments",e[e.User=20]="User",e[e.Recurrence=21]="Recurrence",e[e.CrossProjectLink=22]="CrossProjectLink",e[e.ModStat=23]="ModStat",e[e.Error=24]="Error",e[e.ContentTypeId=25]="ContentTypeId",e[e.PageSeparator=26]="PageSeparator",e[e.ThreadIndex=27]="ThreadIndex",e[e.WorkflowStatus=28]="WorkflowStatus",e[e.AllDayEvent=29]="AllDayEvent",e[e.WorkflowEventType=30]="WorkflowEventType"}(rt||(rt={})),function(e){e[e.DateOnly=0]="DateOnly",e[e.DateTime=1]="DateTime"}(nt||(nt={})),function(e){e[e.DefaultValue=0]="DefaultValue",e[e.AddToDefaultContentType=1]="AddToDefaultContentType",e[e.AddToNoContentType=2]="AddToNoContentType",e[e.AddToAllContentTypes=4]="AddToAllContentTypes",e[e.AddFieldInternalNameHint=8]="AddFieldInternalNameHint",e[e.AddFieldToDefaultView=16]="AddFieldToDefaultView",e[e.AddFieldCheckDisplayName=32]="AddFieldCheckDisplayName"}(st||(st={})),function(e){e[e.Gregorian=1]="Gregorian",e[e.Japan=3]="Japan",e[e.Taiwan=4]="Taiwan",e[e.Korea=5]="Korea",e[e.Hijri=6]="Hijri",e[e.Thai=7]="Thai",e[e.Hebrew=8]="Hebrew",e[e.GregorianMEFrench=9]="GregorianMEFrench",e[e.GregorianArabic=10]="GregorianArabic",e[e.GregorianXLITEnglish=11]="GregorianXLITEnglish",e[e.GregorianXLITFrench=12]="GregorianXLITFrench",e[e.KoreaJapanLunar=14]="KoreaJapanLunar",e[e.ChineseLunar=15]="ChineseLunar",e[e.SakaEra=16]="SakaEra",e[e.UmAlQura=23]="UmAlQura"}(it||(it={})),function(e){e[e.Hyperlink=0]="Hyperlink",e[e.Image=1]="Image"}(ot||(ot={})),function(e){e[e.EmptyMask=0]="EmptyMask",e[e.ViewListItems=1]="ViewListItems",e[e.AddListItems=2]="AddListItems",e[e.EditListItems=3]="EditListItems",e[e.DeleteListItems=4]="DeleteListItems",e[e.ApproveItems=5]="ApproveItems",e[e.OpenItems=6]="OpenItems",e[e.ViewVersions=7]="ViewVersions",e[e.DeleteVersions=8]="DeleteVersions",e[e.CancelCheckout=9]="CancelCheckout",e[e.ManagePersonalViews=10]="ManagePersonalViews",e[e.ManageLists=12]="ManageLists",e[e.ViewFormPages=13]="ViewFormPages",e[e.AnonymousSearchAccessList=14]="AnonymousSearchAccessList",e[e.Open=17]="Open",e[e.ViewPages=18]="ViewPages",e[e.AddAndCustomizePages=19]="AddAndCustomizePages",e[e.ApplyThemeAndBorder=20]="ApplyThemeAndBorder",e[e.ApplyStyleSheets=21]="ApplyStyleSheets",e[e.ViewUsageData=22]="ViewUsageData",e[e.CreateSSCSite=23]="CreateSSCSite",e[e.ManageSubwebs=24]="ManageSubwebs",e[e.CreateGroups=25]="CreateGroups",e[e.ManagePermissions=26]="ManagePermissions",e[e.BrowseDirectories=27]="BrowseDirectories",e[e.BrowseUserInfo=28]="BrowseUserInfo",e[e.AddDelPrivateWebParts=29]="AddDelPrivateWebParts",e[e.UpdatePersonalWebParts=30]="UpdatePersonalWebParts",e[e.ManageWeb=31]="ManageWeb",e[e.AnonymousSearchAccessWebLists=32]="AnonymousSearchAccessWebLists",e[e.UseClientIntegration=37]="UseClientIntegration",e[e.UseRemoteAPIs=38]="UseRemoteAPIs",e[e.ManageAlerts=39]="ManageAlerts",e[e.CreateAlerts=40]="CreateAlerts",e[e.EditMyUserInfo=41]="EditMyUserInfo",e[e.EnumeratePermissions=63]="EnumeratePermissions",e[e.FullMask=65]="FullMask"}(at||(at={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.DistributionList=2]="DistributionList",e[e.SecurityGroup=4]="SecurityGroup",e[e.SharePointGroup=8]="SharePointGroup",e[e.All=15]="All"}(ct||(ct={})),function(e){e[e.None=0]="None",e[e.UserInfoList=1]="UserInfoList",e[e.Windows=2]="Windows",e[e.MembershipProvider=4]="MembershipProvider",e[e.RoleProvider=8]="RoleProvider",e[e.All=15]="All"}(lt||(lt={})),function(e){e[e.None=0]="None",e[e.Guest=1]="Guest",e[e.Reader=2]="Reader",e[e.Contributor=3]="Contributor",e[e.WebDesigner=4]="WebDesigner",e[e.Administrator=5]="Administrator"}(ut||(ut={})),function(e){e[e.Invalid=-1]="Invalid",e[e.DefaultView=0]="DefaultView",e[e.NormalView=1]="NormalView",e[e.DialogView=2]="DialogView",e[e.View=3]="View",e[e.DisplayForm=4]="DisplayForm",e[e.DisplayFormDialog=5]="DisplayFormDialog",e[e.EditForm=6]="EditForm",e[e.EditFormDialog=7]="EditFormDialog",e[e.NewForm=8]="NewForm",e[e.NewFormDialog=9]="NewFormDialog",e[e.SolutionForm=10]="SolutionForm",e[e.PAGE_MAXITEMS=11]="PAGE_MAXITEMS"}(ht||(ht={})),function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Direct=1]="Direct",e[e.OrganizationView=2]="OrganizationView",e[e.OrganizationEdit=3]="OrganizationEdit",e[e.AnonymousView=4]="AnonymousView",e[e.AnonymousEdit=5]="AnonymousEdit",e[e.Flexible=6]="Flexible"}(dt||(dt={})),function(e){e[e.None=0]="None",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Owner=3]="Owner"}(pt||(pt={})),function(e){e[e.CompletedSuccessfully=0]="CompletedSuccessfully",e[e.AccessRequestsQueued=1]="AccessRequestsQueued",e[e.NoResolvedUsers=-1]="NoResolvedUsers",e[e.AccessDenied=-2]="AccessDenied",e[e.CrossSiteRequestNotSupported=-3]="CrossSiteRequestNotSupported",e[e.UnknowError=-4]="UnknowError",e[e.EmailBodyTooLong=-5]="EmailBodyTooLong",e[e.ListUniqueScopesExceeded=-6]="ListUniqueScopesExceeded",e[e.CapabilityDisabled=-7]="CapabilityDisabled",e[e.ObjectNotSupported=-8]="ObjectNotSupported",e[e.NestedGroupsNotSupported=-9]="NestedGroupsNotSupported"}(gt||(gt={})),function(e){e[e.Unknown=0]="Unknown",e[e.File=1]="File",e[e.Folder=2]="Folder",e[e.Item=3]="Item",e[e.List=4]="List",e[e.Web=5]="Web",e[e.Max=6]="Max"}(mt||(mt={})),function(e){e[e.None=0]="None",e[e.AllowList=1]="AllowList",e[e.BlockList=2]="BlockList"}(ft||(ft={})),function(e){e[e.None=0]="None",e[e.ContextInfo=1]="ContextInfo",e[e.ListData=2]="ListData",e[e.ListSchema=4]="ListSchema",e[e.MenuView=8]="MenuView",e[e.ListContentType=16]="ListContentType",e[e.FileSystemItemId=32]="FileSystemItemId",e[e.ClientFormSchema=64]="ClientFormSchema",e[e.QuickLaunch=128]="QuickLaunch",e[e.Spotlight=256]="Spotlight",e[e.Visualization=512]="Visualization",e[e.ViewMetadata=1024]="ViewMetadata",e[e.DisableAutoHyperlink=2048]="DisableAutoHyperlink",e[e.EnableMediaTAUrls=4096]="EnableMediaTAUrls",e[e.ParentInfo=8192]="ParentInfo",e[e.PageContextInfo=16384]="PageContextInfo",e[e.ClientSideComponentManifest=32768]="ClientSideComponentManifest"}(bt||(bt={})),function(e){e[e.PeopleAndGroups=1]="PeopleAndGroups",e[e.PeopleOnly=0]="PeopleOnly"}(yt||(yt={})),function(e){e[e.Dropdown=0]="Dropdown",e[e.RadioButtons=1]="RadioButtons"}(Tt||(Tt={})),function(e){e[e.DefaultZone=0]="DefaultZone",e[e.Intranet=1]="Intranet",e[e.Internet=2]="Internet",e[e.Custom=3]="Custom",e[e.Extranet=4]="Extranet"}(St||(St={}));class wt extends qe{get roleAssignments(){return new Xe(this)}get firstUniqueAncestorSecurableObject(){return new qe(this,"FirstUniqueAncestorSecurableObject")}getUserEffectivePermissions(e){const t=this.clone($e,"getUserEffectivePermissions(@user)");return t.query.set("@user",`'${encodeURIComponent(e)}'`),t.get().then(e=>Object(c.p)(e,"GetUserEffectivePermissions")?e.GetUserEffectivePermissions:e)}getCurrentUserEffectivePermissions(){return new qe("_api/web","currentuser").select("LoginName").get().then(e=>this.getUserEffectivePermissions(e.LoginName))}breakRoleInheritance(e=!1,t=!1){return this.clone(wt,`breakroleinheritance(copyroleassignments=${e}, clearsubscopes=${t})`).postCore()}resetRoleInheritance(){return this.clone(wt,"resetroleinheritance").postCore()}userHasPermissions(e,t){return this.getUserEffectivePermissions(e).then(e=>this.hasPermissions(e,t))}currentUserHasPermissions(e){return this.getCurrentUserEffectivePermissions().then(t=>this.hasPermissions(t,e))}hasPermissions(e,t){if(!t)return!0;if(t===at.FullMask)return 32767==(32767&e.High)&&65535===e.Low;let r=1;return(t-=1)>=0&&t<32?(r<<=t,0!=(e.Low&r)):t>=32&&t<64&&(r<<=t-32,0!=(e.High&r))}}class Ct extends $e{getShareLink(e,t=null){const r=null!==t?t.toISOString():null;return this.clone(Ct,"shareLink").postCore({body:Object(c.t)({request:{createLink:!0,emailData:null,settings:{expiration:r,linkKind:e}}})})}shareWith(e,t,r=!1,n=!1,s){Array.isArray(e)||(e=[e]);const i=Object(c.t)(e.map(e=>({Key:e}))),o=t===pt.Edit?ut.Contributor:ut.Reader;return new Be("_api/web","roledefinitions").select("Id").filter(`RoleTypeKind eq ${o}`).get().then(e=>{if(!Array.isArray(e)||e.length<1)throw Error(`Could not locate a role defintion with RoleTypeKind ${o}`);let t={includeAnonymousLinkInEmail:r,peoplePickerInput:i,propagateAcl:n,roleValue:`role:${e[0].Id}`,useSimplifiedRoles:!0};return void 0!==s&&(t=Object(c.j)(t,{emailBody:s.body,emailSubject:void 0!==s.subject?s.subject:"",sendEmail:!0})),this.clone(Ct,"shareObject").postCore({body:Object(c.t)(t)})})}shareObject(e,t=!1){return t?this.sendShareObjectRequest(e):(e=Object(c.j)(e,{group:null,includeAnonymousLinkInEmail:!1,propagateAcl:!1,useSimplifiedRoles:!0},!0),this.getRoleValue(e.role,e.group).then(t=>{Array.isArray(e.loginNames)||(e.loginNames=[e.loginNames]);let r={peoplePickerInput:Object(c.t)(e.loginNames.map(e=>({Key:e}))),roleValue:t,url:e.url};return void 0!==e.emailData&&null!==e.emailData&&(r=Object(c.j)(r,{emailBody:e.emailData.body,emailSubject:void 0!==e.emailData.subject?e.emailData.subject:"Shared with you.",sendEmail:!0})),this.sendShareObjectRequest(r)}))}unshareObjectWeb(e){return this.clone(Ct,"unshareObject").postCore({body:Object(c.t)({url:e})})}checkPermissions(e){return this.clone(Ct,"checkPermissions").postCore({body:Object(c.t)({recipients:e})})}getSharingInformation(e=null){return this.clone(Ct,"getSharingInformation").postCore({body:Object(c.t)({request:e})})}getObjectSharingSettings(e=!0){return this.clone(Ct,"getObjectSharingSettings").postCore({body:Object(c.t)({useSimplifiedRoles:e})})}unshareObject(){return this.clone(Ct,"unshareObject").postCore()}deleteLinkByKind(e){return this.clone(Ct,"deleteLinkByKind").postCore({body:Object(c.t)({linkKind:e})})}unshareLink(e,t="00000000-0000-0000-0000-000000000000"){return this.clone(Ct,"unshareLink").postCore({body:Object(c.t)({linkKind:e,shareId:t})})}getRoleValue(e,t){if(void 0===t||null===t){const t=e===pt.Edit?ut.Contributor:ut.Reader;return new Be("_api/web","roledefinitions").select("Id").top(1).filter(`RoleTypeKind eq ${t}`).get().then(e=>{if(e.length<1)throw Error("Could not locate associated role definition for supplied role. Edit and View are supported");return`role: ${e[0].Id}`})}switch(t){case ut.Contributor:return new qe("_api/web","associatedmembergroup").select("Id").get().then(e=>`group: ${e.Id}`);case ut.Reader:case ut.Guest:return new qe("_api/web","associatedvisitorgroup").select("Id").get().then(e=>`group: ${e.Id}`);default:throw Error("Could not determine role value for supplied value. Contributor, Reader, and Guest are supported")}}getShareObjectWeb(e){return Promise.resolve(new qe(Ie(e),"/_api/SP.Web.ShareObject"))}sendShareObjectRequest(e){return this.getShareObjectWeb(this.toUrl()).then(t=>t.expand("UsersWithAccessRequests","GroupsSharedWith").as(Ct).postCore({body:Object(c.t)(e)}))}}class Ot extends wt{shareWith(e,t=pt.View,r){const n=this.addBatchDependency();return new qe(Ie(this.toUrl()),"/_api/web/url").get().then(s=>(n(),this.shareObject(Object(c.h)(s,"/_layouts/15/aclinv.aspx?forSharing=1&mbypass=1"),e,t,r)))}shareObject(e,t,r,n,s,i=!1,o=!1,a=!0){return this.clone(Ct,null).shareObject({emailData:n,group:s,includeAnonymousLinkInEmail:o,loginNames:t,propagateAcl:i,role:r,url:e,useSimplifiedRoles:a})}shareObjectRaw(e){return this.clone(Ct,null).shareObject(e,!0)}unshareObject(e){return this.clone(Ct,null).unshareObjectWeb(e)}}class _t extends wt{getShareLink(e=dt.OrganizationView,t=null){return this.clone(Ct,null).getShareLink(e,t)}shareWith(e,t=pt.View,r=!1,n){return this.clone(Ct,null).shareWith(e,t,r,!1,n)}checkSharingPermissions(e){return this.clone(Ct,null).checkPermissions(e)}getSharingInformation(e=null){return this.clone(Ct,null).getSharingInformation(e)}getObjectSharingSettings(e=!0){return this.clone(Ct,null).getObjectSharingSettings(e)}unshare(){return this.clone(Ct,null).unshareObject()}deleteSharingLinkByKind(e){return this.clone(Ct,null).deleteLinkByKind(e)}unshareLink(e,t){return this.clone(Ct,null).unshareLink(e,t)}}class It extends qe{getShareLink(e=dt.OrganizationView,t=null){const r=this.addBatchDependency();return this.getShareable().then(n=>(r(),n.getShareLink(e,t)))}checkSharingPermissions(e){const t=this.addBatchDependency();return this.getShareable().then(r=>(t(),r.checkPermissions(e)))}getSharingInformation(e=null){const t=this.addBatchDependency();return this.getShareable().then(r=>(t(),r.getSharingInformation(e)))}getObjectSharingSettings(e=!0){const t=this.addBatchDependency();return this.getShareable().then(r=>(t(),r.getObjectSharingSettings(e)))}unshare(){const e=this.addBatchDependency();return this.getShareable().then(t=>(e(),t.unshareObject()))}deleteSharingLinkByKind(e){const t=this.addBatchDependency();return this.getShareable().then(r=>(t(),r.deleteLinkByKind(e)))}unshareLink(e,t){const r=this.addBatchDependency();return this.getShareable().then(n=>(r(),n.unshareLink(e,t)))}getShareable(){return this.clone(vt,"listItemAllFields",!1).select("odata.id").get().then(e=>{let t=new Ct(ve(e));return this.hasBatch&&(t=t.inBatch(this.batch)),t})}}class vt extends It{shareWith(e,t=pt.View,r=!1,n){const s=this.addBatchDependency();return this.getShareable().then(i=>(s(),i.shareWith(e,t,r,!1,n)))}}class Et extends It{shareWith(e,t=pt.View,r=!1,n=!1,s){const i=this.addBatchDependency();return this.getShareable().then(o=>(i(),o.shareWith(e,t,r,n,s)))}}class Pt extends $e{get webparts(){return new Nt(this,"webparts")}export(e){return this.clone(Pt,"ExportWebPart").postCore({body:Object(c.t)({webPartId:e})})}import(e){return this.clone(Pt,"ImportWebPart").postCore({body:Object(c.t)({webPartXml:e})})}}class Nt extends Be{getById(e){return new Rt(this,`getbyid('${e}')`)}getByControlId(e){return new Rt(this,`getByControlId('${e}')`)}}class Rt extends qe{get webpart(){return new At(this)}saveChanges(){return this.clone(Rt,"SaveWebPartChanges").postCore()}moveTo(e,t){return this.clone(Rt,`MoveWebPartTo(zoneID='${e}', zoneIndex=${t})`).postCore()}close(){return this.clone(Rt,"CloseWebPart").postCore()}open(){return this.clone(Rt,"OpenWebPart").postCore()}delete(){return this.clone(Rt,"DeleteWebPart").postCore()}}let At=class extends qe{};var xt;At=C([Ge("webpart")],At);let jt=xt=class extends Be{getByName(e){const t=new Ut(this);return t.concat(`('${e}')`),t}add(e){return this.clone(xt,`add('${e}')`).postCore().then(t=>({data:t,folder:this.getByName(e)}))}};jt=xt=C([Ge("folders")],jt);class Ut extends Et{constructor(){super(...arguments),this.update=this._update("SP.Folder",e=>({data:e,folder:this}))}get contentTypeOrder(){return new Be(this,"contentTypeOrder")}get files(){return new yr(this)}get folders(){return new jt(this)}get listItemAllFields(){return new qe(this,"listItemAllFields")}get parentFolder(){return new Ut(this,"parentFolder")}get properties(){return new qe(this,"properties")}get serverRelativeUrl(){return new $e(this,"serverRelativeUrl")}get uniqueContentTypeOrder(){return new Be(this,"uniqueContentTypeOrder")}delete(e="*"){return this.clone(Ut,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}recycle(){return this.clone(Ut,"recycle").postCore()}getItem(...e){const t=this.listItemAllFields;return t.select.apply(t,e).get().then(e=>Object(c.j)(new hr(ve(e)),e))}moveTo(e){return this.select("ServerRelativeUrl").get().then(({ServerRelativeUrl:t})=>{const r=new ke,n=this.toUrl().split("/_api")[0],s=n.replace("://","___").split("/")[0].replace("___","://"),i=`${n}/_api/SP.MoveCopyUtil.MoveFolder()`;return r.post(i,{body:Object(c.t)({destUrl:0===e.indexOf("http")?e:`${s}${e}`,srcUrl:`${s}${t}`})}).then(e=>e.json())})}}var kt;let Lt=kt=class extends Be{addAvailableContentType(e){const t=Object(c.t)({contentTypeId:e});return this.clone(kt,"addAvailableContentType").postCore({body:t}).then(e=>({contentType:this.getById(e.id),data:e}))}getById(e){const t=new Dt(this);return t.concat(`('${e}')`),t}add(e,t,r="",n="Custom Content Types",s={}){const i=Object(c.t)(Object.assign(Fe("SP.ContentType"),{Description:r,Group:n,Id:{StringValue:e},Name:t},s));return this.postCore({body:i}).then(e=>({contentType:this.getById(e.id),data:e}))}};Lt=kt=C([Ge("contenttypes")],Lt);class Dt extends qe{constructor(){super(...arguments),this.delete=this._delete}get fieldLinks(){return new Ft(this)}get fields(){return new Be(this,"fields")}get parent(){return new Dt(this,"parent")}get workflowAssociations(){return new Be(this,"workflowAssociations")}}let Ft=class extends Be{getById(e){const t=new $t(this);return t.concat(`(guid'${e}')`),t}};Ft=C([Ge("fieldlinks")],Ft);class $t extends qe{}var Bt;let qt=Bt=class extends Be{getByName(e){const t=new Gt(this);return t.concat(`('${e}')`),t}add(e,t){return this.clone(Bt,`add(FileName='${e}')`,!1).postCore({body:t}).then(t=>({data:t,file:this.getByName(e)}))}addMultiple(e){return e.reduce((e,t)=>e.then(()=>this.clone(Bt,`add(FileName='${t.name}')`,!1).postCore({body:t.content})),Promise.resolve())}deleteMultiple(...e){return e.reduce((e,t)=>e.then(()=>this.getByName(t).delete()),Promise.resolve())}};qt=Bt=C([Ge("AttachmentFiles")],qt);class Gt extends qe{constructor(){super(...arguments),this.delete=this._deleteWithETag}getText(){return this.getParsed(new b)}getBlob(){return this.getParsed(new y)}getBuffer(){return this.getParsed(new S)}getJSON(){return this.getParsed(new T)}setContent(e){return this.clone(Gt,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(e=>new Gt(this))}getParsed(e){return this.clone(Gt,"$value",!1).get(e)}}var Mt,Wt;let Ht=Mt=class extends Be{getById(e){const t=new Kt(this);return t.concat(`('${e}')`),t}getByTitle(e){return new Kt(this,`getByTitle('${e}')`)}add(e,t=!1,r={}){const n=Object(c.t)(Object.assign(Fe("SP.View"),{PersonalView:t,Title:e},r));return this.clone(Mt,null).postCore({body:n}).then(e=>({data:e,view:this.getById(e.Id)}))}};Ht=Mt=C([Ge("views")],Ht);class Kt extends qe{constructor(){super(...arguments),this.update=this._update("SP.View",e=>({data:e,view:this})),this.delete=this._delete}get fields(){return new Vt(this)}renderAsHtml(){return this.clone($e,"renderashtml").get()}}let Vt=Wt=class extends Be{getSchemaXml(){return this.clone($e,"schemaxml").get()}add(e){return this.clone(Wt,`addviewfield('${e}')`).postCore()}move(e,t){return this.clone(Wt,"moveviewfieldto").postCore({body:Object(c.t)({field:e,index:t})})}removeAll(){return this.clone(Wt,"removeallviewfields").postCore()}remove(e){return this.clone(Wt,`removeviewfield('${e}')`).postCore()}};var Qt;Vt=Wt=C([Ge("viewfields")],Vt);let zt=Qt=class extends Be{getById(e){const t=new Jt(this);return t.concat(`('${e}')`),t}getByTitle(e){return new Jt(this,`getByTitle('${e}')`)}getByInternalNameOrTitle(e){return new Jt(this,`getByInternalNameOrTitle('${e}')`)}createFieldAsXml(e){let t;t="string"==typeof e?{SchemaXml:e}:e;const r=Object(c.t)({parameters:Object(c.j)(Fe("SP.XmlSchemaFieldCreationInformation"),t)});return this.clone(Qt,"createfieldasxml").postCore({body:r}).then(e=>({data:e,field:this.getById(e.Id)}))}add(e,t,r){const n=Object(c.t)(Object.assign(Fe(t),{Title:e},r));return this.clone(Qt,null).postCore({body:n}).then(e=>({data:e,field:this.getById(e.Id)}))}addText(e,t=255,r){const n={FieldTypeKind:2,MaxLength:t};return this.add(e,"SP.FieldText",Object(c.j)(n,r))}addCalculated(e,t,r,n=rt.Text,s){const i={DateFormat:r,FieldTypeKind:17,Formula:t,OutputType:n};return this.add(e,"SP.FieldCalculated",Object(c.j)(i,s))}addDateTime(e,t=nt.DateOnly,r=it.Gregorian,n=0,s){const i={DateTimeCalendarType:r,DisplayFormat:t,FieldTypeKind:4,FriendlyDisplayFormat:n};return this.add(e,"SP.FieldDateTime",Object(c.j)(i,s))}addNumber(e,t,r,n){let s={FieldTypeKind:9};return void 0!==t&&(s=Object(c.j)({MinimumValue:t},s)),void 0!==r&&(s=Object(c.j)({MaximumValue:r},s)),this.add(e,"SP.FieldNumber",Object(c.j)(s,n))}addCurrency(e,t,r,n=1033,s){let i={CurrencyLocaleId:n,FieldTypeKind:10};return void 0!==t&&(i=Object(c.j)({MinimumValue:t},i)),void 0!==r&&(i=Object(c.j)({MaximumValue:r},i)),this.add(e,"SP.FieldCurrency",Object(c.j)(i,s))}addMultilineText(e,t=6,r=!0,n=!1,s=!1,i=!0,o){const a={AllowHyperlink:i,AppendOnly:s,FieldTypeKind:3,NumberOfLines:t,RestrictedMode:n,RichText:r};return this.add(e,"SP.FieldMultiLineText",Object(c.j)(a,o))}addUrl(e,t=ot.Hyperlink,r){const n={DisplayFormat:t,FieldTypeKind:11};return this.add(e,"SP.FieldUrl",Object(c.j)(n,r))}addUser(e,t,r){const n={FieldTypeKind:20,SelectionMode:t};return this.add(e,"SP.FieldUser",Object(c.j)(n,r))}addLookup(e,t,r,n){const s=Object(c.j)({FieldTypeKind:7,LookupFieldName:r,LookupListId:t,Title:e},n),i=Object(c.t)({parameters:Object(c.j)(Fe("SP.FieldCreationInformation"),s)});return this.clone(Qt,"addfield").postCore({body:i}).then(e=>({data:e,field:this.getById(e.Id)}))}addChoice(e,t,r=Tt.Dropdown,n,s){const i={Choices:{results:t},EditFormat:r,FieldTypeKind:6,FillInChoice:n};return this.add(e,"SP.FieldChoice",Object(c.j)(i,s))}addMultiChoice(e,t,r,n){const s={Choices:{results:t},FieldTypeKind:15,FillInChoice:r};return this.add(e,"SP.FieldMultiChoice",Object(c.j)(s,n))}addBoolean(e,t){return this.add(e,"SP.Field",Object(c.j)({FieldTypeKind:8},t))}};zt=Qt=C([Ge("fields")],zt);class Jt extends qe{constructor(){super(...arguments),this.delete=this._delete}update(e,t="SP.Field"){const r=Object(c.t)(Object(c.j)(Fe(t),e));return this.postCore({body:r,headers:{"X-HTTP-Method":"MERGE"}}).then(e=>({data:e,field:this}))}setShowInDisplayForm(e){return this.clone(Jt,`setshowindisplayform(${e})`).postCore()}setShowInEditForm(e){return this.clone(Jt,`setshowineditform(${e})`).postCore()}setShowInNewForm(e){return this.clone(Jt,`setshowinnewform(${e})`).postCore()}}let Xt=class extends Be{getById(e){const t=new class extends qe{}(this);return t.concat(`('${e}')`),t}};Xt=C([Ge("forms")],Xt);let Yt=class extends Be{getById(e){const t=new class extends qe{update(e){const t=Object(c.t)({expirationDateTime:e});return this.patchCore({body:t,headers:{"Content-Type":"application/json"}}).then(e=>({data:e,subscription:this}))}delete(){return super.deleteCore()}}(this);return t.concat(`('${e}')`),t}add(e,t,r){const n=Object(c.t)({clientState:r||"pnp-js-core-subscription",expirationDateTime:t,notificationUrl:e,resource:this.toUrl()});return this.postCore({body:n,headers:{"Content-Type":"application/json"}}).then(e=>({data:e,subscription:this.getById(e.id)}))}};Yt=C([Ge("subscriptions")],Yt);var Zt;let er=Zt=class extends Be{getById(e){const t=new class extends qe{constructor(){super(...arguments),this.update=this._update("SP.UserCustomAction",e=>({data:e,action:this}))}delete(){return super.deleteCore()}}(this);return t.concat(`('${e}')`),t}add(e){const t=Object(c.t)(Object(c.j)({__metadata:{type:"SP.UserCustomAction"}},e));return this.postCore({body:t}).then(e=>({action:this.getById(e.Id),data:e}))}clear(){return this.clone(Zt,"clear").postCore()}};er=Zt=C([Ge("usercustomactions")],er);var tr;let rr=tr=class extends Be{getById(e){const t=new nr(this);return t.concat(`('${e}')`),t}getByTitle(e){return new nr(this,`getByTitle('${e}')`)}add(e,t="",r=100,n=!1,s={}){const i=Object(c.j)({AllowContentTypes:n,BaseTemplate:r,ContentTypesEnabled:n,Description:t,Title:e,__metadata:{type:"SP.List"}},s);return this.postCore({body:Object(c.t)(i)}).then(e=>({data:e,list:this.getByTitle(i.Title)}))}ensure(e,t="",r=100,n=!1,s={}){if(this.hasBatch)throw Error("The ensure list method is not supported for use in a batch.");return new Promise((i,o)=>{const a=Object(c.j)(s,{Title:e,Description:t,ContentTypesEnabled:n},!0),l=this.getByTitle(a.Title);l.get().then(e=>{l.update(a).then(e=>{i({created:!1,data:e,list:this.getByTitle(a.Title)})}).catch(e=>o(e))}).catch(s=>{this.add(e,t,r,n,a).then(e=>{i({created:!0,data:e.data,list:this.getByTitle(a.Title)})}).catch(e=>o(e))})})}ensureSiteAssetsLibrary(){return this.clone(tr,"ensuresiteassetslibrary").postCore().then(e=>new nr(ve(e)))}ensureSitePagesLibrary(){return this.clone(tr,"ensuresitepageslibrary").postCore().then(e=>new nr(ve(e)))}};rr=tr=C([Ge("lists")],rr);class nr extends wt{get contentTypes(){return new Lt(this)}get items(){return new ur(this)}get views(){return new Ht(this)}get fields(){return new zt(this)}get forms(){return new Xt(this)}get defaultView(){return new Kt(this,"DefaultView")}get userCustomActions(){return new er(this)}get effectiveBasePermissions(){return new $e(this,"EffectiveBasePermissions")}get eventReceivers(){return new Be(this,"EventReceivers")}get relatedFields(){return new $e(this,"getRelatedFields")}get informationRightsManagementSettings(){return new $e(this,"InformationRightsManagementSettings")}get subscriptions(){return new Yt(this)}get rootFolder(){return new Ut(this,"rootFolder")}getView(e){return new Kt(this,`getView('${e}')`)}update(e,t="*"){const r=Object(c.t)(Object(c.j)({__metadata:{type:"SP.List"}},e));return this.postCore({body:r,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}}).then(t=>{let r=this;return Object(c.p)(e,"Title")&&(r=this.getParent(nr,this.parentUrl,`getByTitle('${e.Title}')`)),{data:t,list:r}})}delete(e="*"){return this.postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}getChanges(e){return this.clone(nr,"getchanges").postCore({body:Object(c.t)({query:Object(c.j)({__metadata:{type:"SP.ChangeQuery"}},e)})})}getItemsByCAMLQuery(e,...t){const r=this.clone(nr,"getitems");return r.expand.apply(r,t).postCore({body:Object(c.t)({query:Object(c.j)({__metadata:{type:"SP.CamlQuery"}},e)})})}getListItemChangesSinceToken(e){return this.clone(nr,"getlistitemchangessincetoken").postCore({body:Object(c.t)({query:Object(c.j)({__metadata:{type:"SP.ChangeLogItemQuery"}},e)})},{parse:e=>e.text()})}recycle(){return this.clone(nr,"recycle").postCore().then(e=>Object(c.p)(e,"Recycle")?e.Recycle:e)}renderListData(e){const t=this.clone(nr,"renderlistdata(@viewXml)");return t.query.set("@viewXml",`'${e}'`),t.postCore().then(e=>JSON.parse(Object(c.p)(e,"RenderListData")?e.RenderListData:e))}renderListDataAsStream(e,t=null){const r={overrideParameters:Object(c.j)(Fe("SP.RenderListDataOverrideParameters"),t),parameters:Object(c.j)(Fe("SP.RenderListDataParameters"),e)};return this.clone(nr,"RenderListDataAsStream",!0).postCore({body:Object(c.t)(r)})}renderListFormData(e,t,r){return this.clone(nr,`renderlistformdata(itemid=${e}, formid='${t}', mode='${r}')`).postCore().then(e=>JSON.parse(Object(c.p)(e,"RenderListFormData")?e.RenderListFormData:e))}reserveListItemId(){return this.clone(nr,"reservelistitemid").postCore().then(e=>Object(c.p)(e,"ReserveListItemId")?e.ReserveListItemId:e)}getListItemEntityTypeFullName(){return this.clone(nr,null,!1).select("ListItemEntityTypeFullName").get().then(e=>e.ListItemEntityTypeFullName)}addValidateUpdateItemUsingPath(e,t,r=!1,n){return this.clone(nr,"AddValidateUpdateItemUsingPath()").postCore({body:Object(c.t)({bNewDocumentUpdate:r,checkInComment:n,formValues:e,listItemCreateInfo:{FolderPath:{DecodedUrl:t,__metadata:{type:"SP.ResourcePath"}},__metadata:{type:"SP.ListItemCreationInformationUsingPath"}}})}).then(e=>void 0!==e.AddValidateUpdateItemUsingPath?e.AddValidateUpdateItemUsingPath.results:e)}}var sr,ir;let or=sr=class extends Be{add(e){"string"==typeof e&&(e={text:e});const t=Object(c.t)(Object(c.j)(Fe("Microsoft.SharePoint.Comments.comment"),e));return this.clone(sr,null).postCore({body:t}).then(e=>Object(c.j)(this.getById(e.id),e))}getById(e){const t=new ar(this);return t.concat(`(${e})`),t}clear(){return this.clone(sr,"DeleteAll").postCore()}};or=sr=C([Ge("comments")],or);class ar extends qe{get replies(){return new cr(this)}like(){return this.clone(ar,"Like").postCore()}unlike(){return this.clone(ar,"Unlike").postCore()}delete(){return this.clone(ar,"DeleteComment").postCore()}}let cr=ir=class extends Be{add(e){"string"==typeof e&&(e={text:e});const t=Object(c.t)(Object(c.j)(Fe("Microsoft.SharePoint.Comments.comment"),e));return this.clone(ir,null).postCore({body:t}).then(e=>Object(c.j)(new ar(ve(e)),e))}};var lr;cr=ir=C([Ge("replies")],cr);let ur=lr=class extends Be{getById(e){const t=new hr(this);return t.concat(`(${e})`),t}getItemByStringId(e){return new hr(this.parentUrl,`getItemByStringId('${e}')`)}skip(e,t=!1){return t?this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&PagedPrev=TRUE&p_ID=${e}`)):this.query.set("$skiptoken",encodeURIComponent(`Paged=TRUE&p_ID=${e}`)),this}getPaged(){return this.get(new class extends m{constructor(e){super(),this._parent=e}parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&e.json().then(e=>{const r=Object(c.p)(e,"d")&&Object(c.p)(e.d,"__next")?e.d.__next:e["odata.nextLink"];t(new gr(this._parent,r,this.parseODataJSON(e)))})})}}(this))}getAll(e=2e3,t="application/json;odata=nometadata"){n.write("Calling items.getAll should be done sparingly. Ensure this is the correct choice. If you are unsure, it is not.",2);const r=new lr(this,"").top(e).configure({headers:{Accept:t}});return this.query.forEach((e,t)=>{/^\$select|filter|top|expand$/i.test(t)&&r.query.set(t,e)}),new Promise((e,t)=>{const n=[],s=r=>{[].push.apply(n,r.results),r.hasNext?r.getNext().then(s).catch(t):e(n)};r.getPaged().then(s).catch(t)})}add(e={},t=null){const r=this.addBatchDependency();return this.ensureListItemEntityTypeName(t).then(t=>{const n=Object(c.t)(Object(c.j)(Fe(t),e)),s=this.clone(lr,"").postCore({body:n}).then(e=>({data:e,item:this.getById(e.Id)}));return r(),s})}ensureListItemEntityTypeName(e){return e?Promise.resolve(e):this.getParent(nr).getListItemEntityTypeFullName()}};ur=lr=C([Ge("items")],ur);class hr extends _t{constructor(){super(...arguments),this.delete=this._deleteWithETag}get attachmentFiles(){return new qt(this)}get contentType(){return new Dt(this,"ContentType")}get comments(){return new or(this)}get effectiveBasePermissions(){return new $e(this,"EffectiveBasePermissions")}get effectiveBasePermissionsForUI(){return new $e(this,"EffectiveBasePermissionsForUI")}get fieldValuesAsHTML(){return new qe(this,"FieldValuesAsHTML")}get fieldValuesAsText(){return new qe(this,"FieldValuesAsText")}get fieldValuesForEdit(){return new qe(this,"FieldValuesForEdit")}get folder(){return new Ut(this,"folder")}get file(){return new Tr(this,"file")}get versions(){return new dr(this)}update(e,t="*",r=null){return new Promise((n,s)=>{const i=this.addBatchDependency();return this.ensureListItemEntityTypeName(r).then(r=>{const s=Object(c.t)(Object(c.j)(Fe(r),e));return i(),this.postCore({body:s,headers:{"IF-Match":t,"X-HTTP-Method":"MERGE"}},new mr).then(e=>{n({data:e,item:this})})}).catch(e=>s(e))})}getLikedBy(){return this.clone(hr,"likedBy").postCore()}like(){return this.clone(hr,"like").postCore()}unlike(){return this.clone(hr,"unlike").postCore()}recycle(){return this.clone(hr,"recycle").postCore()}getWopiFrameUrl(e=0){const t=this.clone(hr,"getWOPIFrameUrl(@action)");return t.query.set("@action",e),t.postCore().then(e=>Object(c.p)(e,"GetWOPIFrameUrl")?e.GetWOPIFrameUrl:e)}validateUpdateListItem(e,t=!1){return this.clone(hr,"validateupdatelistitem").postCore({body:Object(c.t)({formValues:e,bNewDocumentUpdate:t})})}ensureListItemEntityTypeName(e){return e?Promise.resolve(e):this.getParent(nr,this.parentUrl.substr(0,this.parentUrl.lastIndexOf("/"))).getListItemEntityTypeFullName()}}let dr=class extends Be{getById(e){const t=new pr(this);return t.concat(`(${e})`),t}};dr=C([Ge("versions")],dr);class pr extends qe{constructor(){super(...arguments),this.delete=this._deleteWithETag}}class gr{constructor(e,t,r){this.parent=e,this.nextUrl=t,this.results=r}get hasNext(){return"string"==typeof this.nextUrl&&this.nextUrl.length>0}getNext(){if(this.hasNext){return new ur(this.nextUrl,null).configureFrom(this.parent).getPaged()}return new Promise(e=>e(null))}}class mr extends m{parse(e){return new Promise((t,r)=>{this.handleError(e,r)&&t({"odata.etag":e.headers.get("etag")})})}}var fr,br;let yr=fr=class extends Be{getByName(e){const t=new Tr(this);return t.concat(`('${e}')`),t}add(e,t,r=!0){return new fr(this,`add(overwrite=${r},url='${e}')`).postCore({body:t}).then(t=>({data:t,file:this.getByName(e)}))}addChunked(e,t,r,n=!0,s=10485760){return this.clone(fr,`add(overwrite=${n},url='${e}')`,!1).postCore().then(()=>this.getByName(e)).then(e=>e.setContentChunked(t,r,s))}addTemplateFile(e,t){return this.clone(fr,`addTemplateFile(urloffile='${e}',templatefiletype=${t})`,!1).postCore().then(t=>({data:t,file:this.getByName(e)}))}};yr=fr=C([Ge("files")],yr);class Tr extends vt{get listItemAllFields(){return new qe(this,"listItemAllFields")}get versions(){return new Sr(this)}approve(e=""){return this.clone(Tr,`approve(comment='${e}')`).postCore()}cancelUpload(e){return this.clone(Tr,`cancelUpload(uploadId=guid'${e}')`,!1).postCore()}checkin(e="",t=wr.Major){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(Tr,`checkin(comment='${e}',checkintype=${t})`).postCore()}checkout(){return this.clone(Tr,"checkout").postCore()}copyTo(e,t=!0){return this.clone(Tr,`copyTo(strnewurl='${e}',boverwrite=${t})`).postCore()}delete(e="*"){return this.clone(Tr,null).postCore({headers:{"IF-Match":e,"X-HTTP-Method":"DELETE"}})}deny(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(Tr,`deny(comment='${e}')`).postCore()}getLimitedWebPartManager(e=Cr.Shared){return new Pt(this,`getLimitedWebPartManager(scope=${e})`)}moveTo(e,t=Or.Overwrite){return this.clone(Tr,`moveTo(newurl='${e}',flags=${t})`).postCore()}publish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(Tr,`publish(comment='${e}')`).postCore()}recycle(){return this.clone(Tr,"recycle").postCore()}undoCheckout(){return this.clone(Tr,"undoCheckout").postCore()}unpublish(e=""){if(e.length>1023)throw Error("The maximum comment length is 1023 characters.");return this.clone(Tr,`unpublish(comment='${e}')`).postCore()}getText(){return this.clone(Tr,"$value",!1).get(new b,{headers:{binaryStringResponseBody:"true"}})}getBlob(){return this.clone(Tr,"$value",!1).get(new y,{headers:{binaryStringResponseBody:"true"}})}getBuffer(){return this.clone(Tr,"$value",!1).get(new S,{headers:{binaryStringResponseBody:"true"}})}getJSON(){return this.clone(Tr,"$value",!1).get(new T,{headers:{binaryStringResponseBody:"true"}})}setContent(e){return this.clone(Tr,"$value",!1).postCore({body:e,headers:{"X-HTTP-Method":"PUT"}}).then(e=>new Tr(this))}getItem(...e){const t=this.listItemAllFields;return t.select.apply(t,e).get().then(e=>Object(c.j)(new hr(ve(e)),e))}setContentChunked(e,t,r=10485760){void 0===t&&(t=(()=>null));const n=e.size,s=parseInt((e.size/r).toString(),10)+(e.size%r==0?1:0),i=Object(c.m)();t({uploadId:i,blockNumber:1,chunkSize:r,currentPointer:0,fileSize:n,stage:"starting",totalBlocks:s});let o=this.startUpload(i,e.slice(0,r));for(let a=2;a<s;a++)o=o.then(o=>(t({uploadId:i,blockNumber:a,chunkSize:r,currentPointer:o,fileSize:n,stage:"continue",totalBlocks:s}),this.continueUpload(i,o,e.slice(o,o+r))));return o.then(o=>(t({uploadId:i,blockNumber:s,chunkSize:r,currentPointer:o,fileSize:n,stage:"finishing",totalBlocks:s}),this.finishUpload(i,o,e.slice(o))))}startUpload(e,t){return this.clone(Tr,`startUpload(uploadId=guid'${e}')`,!1).postCore({body:t}).then(e=>("object"==typeof e&&(e=e.StartUpload),parseFloat(e)))}continueUpload(e,t,r){return this.clone(Tr,`continueUpload(uploadId=guid'${e}',fileOffset=${t})`,!1).postCore({body:r}).then(e=>("object"==typeof e&&(e=e.ContinueUpload),parseFloat(e)))}finishUpload(e,t,r){return this.clone(Tr,`finishUpload(uploadId=guid'${e}',fileOffset=${t})`,!1).postCore({body:r}).then(e=>({data:e,file:new Tr(ve(e))}))}}let Sr=br=class extends Be{getById(e){const t=new class extends qe{constructor(){super(...arguments),this.delete=this._deleteWithETag}}(this);return t.concat(`(${e})`),t}deleteAll(){return new br(this,"deleteAll").postCore()}deleteById(e){return this.clone(br,`deleteById(vid=${e})`).postCore()}recycleByID(e){return this.clone(br,`recycleByID(vid=${e})`).postCore()}deleteByLabel(e){return this.clone(br,`deleteByLabel(versionlabel='${e}')`).postCore()}recycleByLabel(e){return this.clone(br,`recycleByLabel(versionlabel='${e}')`).postCore()}restoreByLabel(e){return this.clone(br,`restoreByLabel(versionlabel='${e}')`).postCore()}};Sr=br=C([Ge("versions")],Sr);var wr,Cr,Or,_r,Ir;!function(e){e[e.Minor=0]="Minor",e[e.Major=1]="Major",e[e.Overwrite=2]="Overwrite"}(wr||(wr={})),function(e){e[e.User=0]="User",e[e.Shared=1]="Shared"}(Cr||(Cr={})),function(e){e[e.Overwrite=1]="Overwrite",e[e.AllowBrokenThickets=8]="AllowBrokenThickets"}(Or||(Or={})),function(e){e[e.StandardPage=0]="StandardPage",e[e.WikiPage=1]="WikiPage",e[e.FormPage=2]="FormPage",e[e.ClientSidePage=3]="ClientSidePage"}(_r||(_r={}));class vr extends Be{constructor(e,t="_api/web/tenantappcatalog/AvailableApps"){super(Ie("string"==typeof e?e:e.toUrl()),t)}getAppById(e){return new Er(this,`getById('${e}')`)}add(e,t,r=!0){return new vr(Ie(this.toUrl()),`_api/web/tenantappcatalog/add(overwrite=${r},url='${e}')`).postCore({body:t}).then(e=>({data:e,file:new Tr(ve(e))}))}}class Er extends qe{deploy(){return this.clone(Er,"Deploy").postCore()}retract(){return this.clone(Er,"Retract").postCore()}install(){return this.clone(Er,"Install").postCore()}uninstall(){return this.clone(Er,"Uninstall").postCore()}upgrade(){return this.clone(Er,"Upgrade").postCore()}remove(){return this.clone(Er,"Remove").postCore()}}class Pr extends A{constructor(e){super(),this.baseUrl=e}static ParseResponse(e){return new Promise((t,r)=>{const n=[],s=new RegExp("^HTTP/[0-9.]+ +([0-9]+) +(.*)","i"),i=e.split("\n");let o,a,c="batch";for(let e=0;e<i.length;++e){const t=i[e];switch(c){case"batch":if("--batchresponse_"===t.substr(0,"--batchresponse_".length))c="batchHeaders";else if(""!==t.trim())throw Error(`Invalid response, line ${e}`);break;case"batchHeaders":""===t.trim()&&(c="status");break;case"status":const r=s.exec(t);if(3!==r.length)throw Error(`Invalid status, line ${e}`);o=parseInt(r[1],10),a=r[2],c="statusHeaders";break;case"statusHeaders":""===t.trim()&&(c="body");break;case"body":n.push(204===o?new Response:new Response(t,{status:o,statusText:a})),c="batch"}}"status"!==c&&r(Error("Unexpected end of input")),t(n)})}executeImpl(){if(n.write(`[${this.batchId}] (${(new Date).getTime()}) Executing batch with ${this.requests.length} requests.`,1),this.requests.length<1)return n.write("Resolving empty batch.",1),Promise.resolve();const e=new ke;return Object(De.a)(this.baseUrl).then(t=>{const r=[];let s="";for(let e=0;e<this.requests.length;e++){const i=this.requests[e];"GET"===i.method?(s.length>0&&(r.push(`--changeset_${s}--\n\n`),s=""),r.push(`--batch_${this.batchId}\n`)):(s.length<1&&(s=Object(c.m)(),r.push(`--batch_${this.batchId}\n`),r.push(`Content-Type: multipart/mixed; boundary="changeset_${s}"\n\n`)),r.push(`--changeset_${s}\n`)),r.push("Content-Type: application/http\n"),r.push("Content-Transfer-Encoding: binary\n\n");const o=new Headers,a=Object(c.s)(i.url)?i.url:Object(c.h)(t,i.url);if(n.write(`[${this.batchId}] (${(new Date).getTime()}) Adding request ${i.method} ${a} to batch.`,0),"GET"!==i.method){let e=i.method;const t=i.options.headers;Object(c.p)(i,"options")&&Object(c.p)(i.options,"headers")&&void 0!==t["X-HTTP-Method"]&&(e=t["X-HTTP-Method"],delete t["X-HTTP-Method"]),r.push(`${e} ${a} HTTP/1.1\n`),o.set("Content-Type","application/json;odata=verbose;charset=utf-8")}else r.push(`${i.method} ${a} HTTP/1.1\n`);Object(c.u)(o,Ae.a.headers),i.options&&Object(c.u)(o,i.options.headers),o.has("Accept")||o.append("Accept","application/json"),o.has("Content-Type")||o.append("Content-Type","application/json;odata=verbose;charset=utf-8"),o.has("X-ClientService-ClientTag")||o.append("X-ClientService-ClientTag","PnPCoreJS:@pnp-1.2.2"),o.forEach((e,t)=>{r.push(`${t}: ${e}\n`)}),r.push("\n"),i.options.body&&r.push(`${i.options.body}\n\n`)}s.length>0&&(r.push(`--changeset_${s}--\n\n`),s=""),r.push(`--batch_${this.batchId}--\n`);const i={body:r.join(""),headers:{"Content-Type":`multipart/mixed; boundary=batch_${this.batchId}`},method:"POST"};return n.write(`[${this.batchId}] (${(new Date).getTime()}) Sending batch request.`,1),e.fetch(Object(c.h)(t,"/_api/$batch"),i).then(e=>e.text()).then(Pr.ParseResponse).then(e=>{if(e.length!==this.requests.length)throw Error("Could not properly parse responses to match requests in batch.");return n.write(`[${this.batchId}] (${(new Date).getTime()}) Resolving batched requests.`,1),e.reduce((e,t,r)=>{const s=this.requests[r];return n.write(`[${s.id}] (${(new Date).getTime()}) Resolving request in batch ${this.batchId}.`,1),e.then(e=>s.parser.parse(t).then(s.resolve).catch(s.reject))},Promise.resolve())})})}}function Nr(e){return e.length<1?1:Math.max.apply(null,e.map(e=>e.order))+1}function Rr(e,t=0){const r=this.substring(t).search(e);return r>=0?r+t:r}function Ar(e,t,r){const n=[];if(void 0===e||null===e)return n;const s=e.replace(/[\t\r\n]/g,"");let i=Rr.call(s,t);if(i<0)return n;for(;i>-1;){let e=1,o=i+1,a=-1,c=-1;for(;;){if(a=Rr.call(s,/<div[^>]*>/i,o),c=Rr.call(s,/<\/div>/i,o),a<0&&(a=s.length+1),a<c?(e++,o=a+1):c<a&&(e--,o=c+1),0===e){const e=s.substring(i,c+6).trim();n.push(r(e));break}if(e>1e3||e<0)throw Error("getBoundedDivMarkup exceeded depth parameters.")}i=Rr.call(s,t,c)}return n}function xr(e){for(let t=0;t<e.length;t++)e[t].order=t+1,Object(c.p)(e[t],"columns")?xr(e[t].columns):Object(c.p)(e[t],"controls")&&xr(e[t].controls)}!function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(Ir||(Ir={}));class jr extends Tr{constructor(e,t=[],r=!1){super(e),this.sections=t,this.commentsDisabled=r}static create(e,t,r,n="Article"){return e.rootFolder.files.select("Name").filter(`Name eq '${t}'`).get().then(s=>{if(s.length>0)throw Error(`A file with the name '${t}' already exists in the library '${e.toUrl()}'.`);return e.rootFolder.select("ServerRelativePath").get().then(s=>{const i=Object(c.h)("/",s.ServerRelativePath.DecodedUrl,t);return e.rootFolder.files.addTemplateFile(i,_r.ClientSidePage).then(e=>e.file.getItem().then(e=>e.update({BannerImageUrl:{Url:"/_layouts/15/images/sitepagethumbnail.png"},CanvasContent1:"",ClientSideApplicationId:"b6917cb1-93a0-4b97-a84d-7cf49975d4ec",ContentTypeId:"0x0101009D1CB255DA76424F860D91F20E6C4118",PageLayoutType:n,PromotedState:0,Title:r}).then(e=>new jr(e.item.file,e.item.CommentsDisabled))))})})}static fromFile(e){const t=new jr(e);return t.load().then(e=>t)}static jsonToEscapedString(e){return Object(c.t)(e).replace(/"/g,"&quot;").replace(/:/g,"&#58;").replace(/{/g,"&#123;").replace(/}/g,"&#125;").replace(/\[/g,"[").replace(/\]/g,"]").replace(/\./g,".")}static escapedStringToJson(e){return JSON.parse((e=>{return[[/&quot;/g,'"'],[/&#58;/g,":"],[/&#123;/g,"{"],[/&#125;/g,"}"],[/\\\\/g,"\\"],[/\\\?/g,"?"],[/\\\./g,"."],[/\\\[/g,"["],[/\\\]/g,"]"],[/\\\(/g,"("],[/\\\)/g,")"],[/\\\|/g,"|"],[/\\\+/g,"+"]].reduce((e,t)=>e.replace(t[0],t[1]),e)})(e))}addSection(){const e=new Ur(this,Nr(this.sections));return this.sections.push(e),e}toHtml(){xr(this.sections);const e=[];e.push("<div>");for(let t=0;t<this.sections.length;t++)e.push(this.sections[t].toHtml());return e.push("</div>"),e.join("")}fromHtml(e){return this.sections=[],Ar(e,/<div\b[^>]*data-sp-canvascontrol[^>]*?>/i,e=>{const t=/controlType&quot;&#58;(\d*?),/i.exec(e);let r=null;switch(null==t||t.length<2?0:parseInt(t[1],10)){case 0:(r=new Lr(null,0)).fromHtml(e),this.mergeColumnToTree(r);break;case 3:(r=new $r("")).fromHtml(e),this.mergePartToTree(r);break;case 4:(r=new Fr).fromHtml(e),this.mergePartToTree(r)}}),xr(this.sections),this}load(){return this.getItem("CanvasContent1","CommentsDisabled").then(e=>{this.fromHtml(e.CanvasContent1),this.commentsDisabled=e.CommentsDisabled})}save(){return this.updateProperties({CanvasContent1:this.toHtml()})}enableComments(){return this.setCommentsOn(!0).then(e=>(this.commentsDisabled=!1,e))}disableComments(){return this.setCommentsOn(!1).then(e=>(this.commentsDisabled=!0,e))}findControlById(e){return this.findControl(t=>t.id===e)}findControl(e){for(let t=0;t<this.sections.length;t++)for(let r=0;r<this.sections[t].columns.length;r++)for(let n=0;n<this.sections[t].columns[r].controls.length;n++)if(e(this.sections[t].columns[r].controls[n]))return this.sections[t].columns[r].controls[n];return null}setCommentsOn(e){return this.getItem().then(t=>{return new hr(t,`SetCommentsDisabled(${!e})`).update({})})}mergePartToTree(e){let t=null,r=null;const n=this.sections.filter(t=>t.order===e.controlData.position.zoneIndex);n.length<1?(t=new Ur(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=n[0];const s=t.columns.filter(t=>t.order===e.controlData.position.sectionIndex);s.length<1?(r=new Lr(t,e.controlData.position.sectionIndex,e.controlData.position.sectionFactor),t.columns.push(r)):r=s[0],e.column=r,r.addControl(e)}mergeColumnToTree(e){let t=null;const r=this.sections.filter(t=>t.order===e.controlData.position.zoneIndex);r.length<1?(t=new Ur(this,e.controlData.position.zoneIndex),this.sections.push(t)):t=r[0],e.section=t,t.columns.push(e)}updateProperties(e,t="*"){return this.getItem().then(r=>r.update(e,t))}}class Ur{constructor(e,t,r=[]){this.page=e,this.order=t,this.columns=r,this._memId=Object(c.m)()}get defaultColumn(){return this.columns.length<1&&this.addColumn(12),this.columns[0]}addColumn(e){const t=new Lr(this,Nr(this.columns),e);return this.columns.push(t),t}addControl(e){return this.defaultColumn.addControl(e),this}toHtml(){const e=[];for(let t=0;t<this.columns.length;t++)e.push(this.columns[t].toHtml());return e.join("")}remove(){this.page.sections=this.page.sections.filter(e=>e._memId!==this._memId),xr(this.page.sections)}}class kr{constructor(e,t,r=null,n=1,s=Object(c.m)(),i=null){this.controlType=e,this.dataVersion=t,this.column=r,this.order=n,this.id=s,this.controlData=i}get jsonData(){return jr.jsonToEscapedString(this.getControlData())}fromHtml(e){this.controlData=jr.escapedStringToJson(Object(c.k)(e,"data-sp-controldata")),this.dataVersion=Object(c.k)(e,"data-sp-canvasdataversion"),this.controlType=this.controlData.controlType,this.id=this.controlData.id}}class Lr extends kr{constructor(e,t,r=12,n=[],s="1.0"){super(0,s),this.section=e,this.order=t,this.factor=r,this.controls=n}addControl(e){return e.column=this,this.controls.push(e),this}getControl(e){return this.controls[e]}toHtml(){const e=[];if(this.controls.length<1)e.push(`<div data-sp-canvascontrol="" data-sp-canvasdataversion="${this.dataVersion}" data-sp-controldata="${this.jsonData}"></div>`);else for(let t=0;t<this.controls.length;t++)e.push(this.controls[t].toHtml(t+1));return e.join("")}fromHtml(e){super.fromHtml(e),this.controlData=jr.escapedStringToJson(Object(c.k)(e,"data-sp-controldata")),this.factor=this.controlData.position.sectionFactor,this.order=this.controlData.position.sectionIndex}getControlData(){return{displayMode:2,position:{sectionFactor:this.factor,sectionIndex:this.order,zoneIndex:this.section.order}}}remove(){this.section.columns=this.section.columns.filter(e=>e.id!==this.id),xr(this.column.controls)}}class Dr extends kr{remove(){this.column.controls=this.column.controls.filter(e=>e.id!==this.id),xr(this.column.controls)}}class Fr extends Dr{constructor(e=""){super(4,"1.0"),this.text=e}get text(){return this._text}set text(e){e.startsWith("<p>")||(e=`<p>${e}</p>`),this._text=e}getControlData(){return{controlType:this.controlType,editorType:"CKEditor",id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order}}}toHtml(e){this.order=e;const t=[];return t.push(`<div data-sp-canvascontrol="" data-sp-canvasdataversion="${this.dataVersion}" data-sp-controldata="${this.jsonData}">`),t.push('<div data-sp-rte="">'),t.push(`${this.text}`),t.push("</div>"),t.push("</div>"),t.join("")}fromHtml(e){super.fromHtml(e),this.text="",Ar(e,/<div[^>]*data-sp-rte[^>]*>/i,e=>{const t=/<div[^>]*data-sp-rte[^>]*>(.*?)<\/div>$/i.exec(e);this.text=t.length>1?t[1]:""})}}class $r extends Dr{constructor(e,t="",r={},n="",s="",i=null,o="1.0"){super(3,"1.0"),this.title=e,this.description=t,this.propertieJson=r,this.webPartId=n,this.htmlProperties=s,this.serverProcessedContent=i,this.canvasDataVersion=o}static fromComponentDef(e){const t=new $r("");return t.import(e),t}import(e){this.webPartId=e.Id.replace(/^\{|\}$/g,"").toLowerCase();const t=JSON.parse(e.Manifest);this.title=t.preconfiguredEntries[0].title.default,this.description=t.preconfiguredEntries[0].description.default,this.dataVersion="1.0",this.propertieJson=this.parseJsonProperties(t.preconfiguredEntries[0].properties)}setProperties(e){return this.propertieJson=Object(c.j)(this.propertieJson,e),this}getProperties(){return this.propertieJson}toHtml(e){this.order=e;const t={dataVersion:this.dataVersion,description:this.description,id:this.webPartId,instanceId:this.id,properties:this.propertieJson,serverProcessedContent:this.serverProcessedContent,title:this.title},r=[];return r.push(`<div data-sp-canvascontrol="" data-sp-canvasdataversion="${this.canvasDataVersion}" data-sp-controldata="${this.jsonData}">`),r.push(`<div data-sp-webpart="" data-sp-webpartdataversion="${this.dataVersion}" data-sp-webpartdata="${jr.jsonToEscapedString(t)}">`),r.push("<div data-sp-componentid>"),r.push(this.webPartId),r.push("</div>"),r.push('<div data-sp-htmlproperties="">'),r.push(this.renderHtmlProperties()),r.push("</div>"),r.push("</div>"),r.push("</div>"),r.join("")}fromHtml(e){super.fromHtml(e);const t=jr.escapedStringToJson(Object(c.k)(e,"data-sp-webpartdata"));this.title=t.title,this.description=t.description,this.webPartId=t.id,this.canvasDataVersion=Object(c.k)(e,"data-sp-canvasdataversion").replace(/\\\./,"."),this.dataVersion=Object(c.k)(e,"data-sp-webpartdataversion").replace(/\\\./,"."),this.setProperties(t.properties),void 0!==t.serverProcessedContent&&(this.serverProcessedContent=t.serverProcessedContent);const r=Ar(e,/<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,e=>e.replace(/^<div\b[^>]*data-sp-htmlproperties[^>]*?>/i,"").replace(/<\/div>$/i,""));this.htmlProperties=r.length>0?r[0]:""}getControlData(){return{controlType:this.controlType,id:this.id,position:{controlIndex:this.order,sectionFactor:this.column.factor,sectionIndex:this.column.order,zoneIndex:this.column.section.order},webPartId:this.webPartId}}renderHtmlProperties(){const e=[];if(void 0===this.serverProcessedContent||null===this.serverProcessedContent)e.push(this.htmlProperties);else if(void 0!==this.serverProcessedContent){if(void 0!==this.serverProcessedContent.searchablePlainTexts){const t=Object.keys(this.serverProcessedContent.searchablePlainTexts);for(let r=0;r<t.length;r++)e.push(`<div data-sp-prop-name="${t[r]}" data-sp-searchableplaintext="true">`),e.push(this.serverProcessedContent.searchablePlainTexts[t[r]]),e.push("</div>")}if(void 0!==this.serverProcessedContent.imageSources){const t=Object.keys(this.serverProcessedContent.imageSources);for(let r=0;r<t.length;r++)e.push(`<img data-sp-prop-name="${t[r]}" src="${this.serverProcessedContent.imageSources[t[r]]}" />`)}if(void 0!==this.serverProcessedContent.links){const t=Object.keys(this.serverProcessedContent.links);for(let r=0;r<t.length;r++)e.push(`<a data-sp-prop-name="${t[r]}" href="${this.serverProcessedContent.links[t[r]]}"></a>`)}}return e.join("")}parseJsonProperties(e){return void 0!==e.webPartData&&void 0!==e.webPartData.serverProcessedContent?this.serverProcessedContent=e.webPartData.serverProcessedContent:void 0!==e.serverProcessedContent?this.serverProcessedContent=e.serverProcessedContent:this.serverProcessedContent=null,void 0!==e.webPartData&&void 0!==e.webPartData.properties?e.webPartData.properties:void 0!==e.properties?e.properties:e}}class Br extends Be{getById(e){const t=new qr(this);return t.concat(`(${e})`),t}add(e,t,r=!0){const n=Object(c.t)(Object(c.j)(Fe("SP.NavigationNode"),{IsVisible:r,Title:e,Url:t}));return this.clone(Br,null).postCore({body:n}).then(e=>({data:e,node:this.getById(e.Id)}))}moveAfter(e,t){const r=Object(c.t)({nodeId:e,previousNodeId:t});return this.clone(Br,"MoveAfter").postCore({body:r})}}class qr extends qe{get children(){return new Br(this,"Children")}delete(){return super.deleteCore()}}let Gr=class extends $e{get quicklaunch(){return new Br(this,"quicklaunch")}get topNavigationBar(){return new Br(this,"topnavigationbar")}};Gr=C([Ge("navigation")],Gr);class Mr extends $e{constructor(e=null){super("_api/navigation",e)}getMenuState(e=null,t=10,r=null,n=null){return new Mr("MenuState").postCore({body:Object(c.t)({customProperties:n,depth:t,mapProviderName:r,menuNodeKey:e})})}getMenuNodeKey(e,t=null){return new Mr("MenuNodeKey").postCore({body:Object(c.t)({currentUrl:e,mapProviderName:t})})}}var Wr,Hr;let Kr=class extends qe{get installedLanguages(){return new Vr(this)}get globalInstalledLanguages(){return new Vr(this,"globalinstalledlanguages")}get timeZone(){return new Qr(this)}get timeZones(){return new zr(this)}};Kr=C([Ge("regionalsettings")],Kr);let Vr=class extends Be{};Vr=C([Ge("installedlanguages")],Vr);let Qr=Wr=class extends qe{utcToLocalTime(e){let t;return t="string"==typeof e?e:e.toISOString(),this.clone(Wr,`utctolocaltime('${t}')`).postCore().then(e=>Object(c.p)(e,"UTCToLocalTime")?e.UTCToLocalTime:e)}localTimeToUTC(e){let t;return t="string"==typeof e?e:Object(c.i)(e,"minute",-1*e.getTimezoneOffset()).toISOString(),this.clone(Wr,`localtimetoutc('${t}')`).postCore().then(e=>Object(c.p)(e,"LocalTimeToUTC")?e.LocalTimeToUTC:e)}};Qr=Wr=C([Ge("timezone")],Qr);let zr=Hr=class extends Be{getById(e){return this.clone(Hr,`GetById(${e})`).postCore({},Ne(Qr))}};zr=Hr=C([Ge("timezones")],zr);const Jr=new Map([["text","Querytext"],["template","QueryTemplate"],["sourceId","SourceId"],["trimDuplicatesIncludeId",""],["startRow",""],["rowLimit",""],["rankingModelId",""],["rowsPerPage",""],["selectProperties",""],["culture",""],["timeZoneId",""],["refinementFilters",""],["refiners",""],["hiddenConstraints",""],["sortList",""],["timeout",""],["hithighlightedProperties",""],["clientType",""],["personalizationData",""],["resultsURL",""],["queryTag",""],["properties",""],["queryTemplatePropertiesUrl",""],["reorderingRules",""],["hitHighlightedMultivaluePropertyLimit",""],["collapseSpecification",""],["uiLanguage",""],["desiredSnippetLength",""],["maxSnippetLength",""],["summaryLength",""]]),Xr=new Map([]);function Yr(e){return e.replace(/^(.)/,e=>e.toUpperCase())}function Zr(e="",t={}){return new Proxy({query:Object.assign({Querytext:e},t)},{get(e,t,r){const n=t.toString();if("toSearchQuery"===n)return()=>e.query;if(Jr.has(n))return(...t)=>{const s=Jr.get(n);return e.query[s.length>0?s:Yr(n)]=t.length>1?t:t[0],r};const s=Xr.has(n)?Xr.get(n):Yr(n);return e.query[s]=!0,r}})}let en=class extends qe{execute(e){const t=this.parseQuery(e),r=Object(c.t)({request:Object(c.j)(Fe("Microsoft.Office.Server.Search.REST.SearchRequest"),Object.assign({},t,{HitHighlightedProperties:this.fixArrProp(t.HitHighlightedProperties),Properties:this.fixArrProp(t.Properties),RefinementFilters:this.fixArrProp(t.RefinementFilters),ReorderingRules:this.fixArrProp(t.ReorderingRules),SelectProperties:this.fixArrProp(t.SelectProperties),SortList:this.fixArrProp(t.SortList)}))});if(this._useCaching){this._forceCaching=!0;const e=`PnPjs.SearchWithCaching(${Object(c.n)(r)})`;Object(c.x)(this._cachingOptions)?/\/_api\/search\/postquery$/i.test(this._cachingOptions.key)&&(this._cachingOptions.key=e):this._cachingOptions=new d(e)}return this.postCore({body:r}).then(e=>new tn(e,this.toUrl(),t))}fixArrProp(e){return void 0===e?{results:[]}:(e=Object(c.q)(e)?e:[e],Object(c.p)(e,"results")?e:{results:e})}parseQuery(e){let t;return t="string"==typeof e?{Querytext:e}:e.toSearchQuery?e.toSearchQuery():e}};en=C([Ge("_api/search/postquery")],en);class tn{constructor(e,t,r,n=null,s=null){this._url=t,this._query=r,this._raw=n,this._primary=s,this._raw=e.postquery?e.postquery:e}get ElapsedTime(){return this.RawSearchResults.ElapsedTime}get RowCount(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.RowCount}get TotalRows(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRows}get TotalRowsIncludingDuplicates(){return this.RawSearchResults.PrimaryQueryResult.RelevantResults.TotalRowsIncludingDuplicates}get RawSearchResults(){return this._raw}get PrimarySearchResults(){return null===this._primary&&(this._primary=this.formatSearchResults(this._raw.PrimaryQueryResult.RelevantResults.Table.Rows)),this._primary}getPage(e,t){if(this.TotalRows<this.RowCount)return Promise.resolve(null);const r=void 0!==t?t:Object(c.p)(this._query,"RowLimit")?this._query.RowLimit:10,n=Object(c.j)(this._query,{RowLimit:r,StartRow:r*(e-1)});return n.StartRow>this.TotalRows?Promise.resolve(null):new en(this._url,null).execute(n)}formatSearchResults(e){const t=new Array,r=e.results?e.results:e;for(const e of r){const r=e.Cells.results?e.Cells.results:e.Cells;t.push(r.reduce((e,t)=>(Object.defineProperty(e,t.Key,{configurable:!1,enumerable:!0,value:t.Value,writable:!1}),e),{}))}return t}}var rn,nn,sn;!function(e){e[e.Ascending=0]="Ascending",e[e.Descending=1]="Descending",e[e.FQLFormula=2]="FQLFormula"}(rn||(rn={})),function(e){e[e.ResultContainsKeyword=0]="ResultContainsKeyword",e[e.TitleContainsKeyword=1]="TitleContainsKeyword",e[e.TitleMatchesKeyword=2]="TitleMatchesKeyword",e[e.UrlStartsWith=3]="UrlStartsWith",e[e.UrlExactlyMatches=4]="UrlExactlyMatches",e[e.ContentTypeIs=5]="ContentTypeIs",e[e.FileExtensionMatches=6]="FileExtensionMatches",e[e.ResultHasTag=7]="ResultHasTag",e[e.ManualCondition=8]="ManualCondition"}(nn||(nn={})),function(e){e[e.None=0]="None",e[e.StringType=1]="StringType",e[e.Int32Type=2]="Int32Type",e[e.BooleanType=3]="BooleanType",e[e.StringArrayType=4]="StringArrayType",e[e.UnSupportedType=5]="UnSupportedType"}(sn||(sn={}));class on{}on.Documents="e7ec8cee-ded8-43c9-beb5-436b54b31e84",on.ItemsMatchingContentType="5dc9f503-801e-4ced-8a2c-5d1237132419",on.ItemsMatchingTag="e1327b9c-2b8c-4b23-99c9-3730cb29c3f7",on.ItemsRelatedToCurrentUser="48fec42e-4a92-48ce-8363-c2703a40e67d",on.ItemsWithSameKeywordAsThisItem="5c069288-1d17-454a-8ac6-9c642a065f48",on.LocalPeopleResults="b09a7990-05ea-4af9-81ef-edfab16c4e31",on.LocalReportsAndDataResults="203fba36-2763-4060-9931-911ac8c0583b",on.LocalSharePointResults="8413cd39-2156-4e00-b54d-11efd9abdb89",on.LocalVideoResults="78b793ce-7956-4669-aa3b-451fc5defebf",on.Pages="5e34578e-4d08-4edc-8bf3-002acf3cdbcc",on.Pictures="38403c8c-3975-41a8-826e-717f2d41568a",on.Popular="97c71db1-58ce-4891-8b64-585bc2326c12",on.RecentlyChangedItems="ba63bbae-fa9c-42c0-b027-9a878f16557c",on.RecommendedItems="ec675252-14fa-4fbe-84dd-8d098ed74181",on.Wiki="9479bf85-e257-4318-b5a8-81a180f5faa1";let an=class extends qe{execute(e){return this.mapQueryToQueryString(e),this.get().then(e=>{const t=Object(c.p)(e,"suggest")?t=>e.suggest[t].results:t=>e[t];return{PeopleNames:t("PeopleNames"),PersonalResults:t("PersonalResults"),Queries:t("Queries")}})}mapQueryToQueryString(e){this.query.set("querytext",`'${e.querytext}'`);const t=(e=>t=>r=>{Object(c.p)(e,t)&&this.query.set(r,e[t].toString())})(e);t("count")("inumberofquerysuggestions"),t("personalCount")("inumberofresultsuggestions"),t("preQuery")("fprequerysuggestions"),t("hitHighlighting")("fhithighlighting"),t("capitalize")("fcapitalizefirstletters"),t("culture")("culture"),t("stemming")("enablestemming"),t("includePeople")("showpeoplenamesuggestions"),t("queryRules")("enablequeryrules"),t("prefixMatch")("fprefixmatchallterms")}};var cn;an=C([Ge("_api/search/suggest")],an);let ln=cn=class extends Be{add(e,t=!1){return this.clone(cn,"add").postCore({body:Object(c.t)({featdefScope:0,featureId:e,force:t})}).then(t=>({data:t,feature:this.getById(e)}))}getById(e){const t=new un(this);return t.concat(`('${e}')`),t}remove(e,t=!1){return this.clone(cn,"remove").postCore({body:Object(c.t)({featureId:e,force:t})})}};ln=cn=C([Ge("features")],ln);class un extends qe{deactivate(e=!1){const t=this.addBatchDependency();return new un(this).select("DefinitionId").get().then(r=>{const n=this.getParent(ln,this.parentUrl,"",this.batch).remove(r.DefinitionId,e);return t(),n})}}var hn;let dn=hn=class extends $e{static FromUrl(e){if(null===e)return new hn("");const t=e.indexOf("_api/");return new hn(t>-1?e.substr(0,t):e)}getRelatedItems(e,t){const r=this.clone(hn,null);return r.concat(".GetRelatedItems"),r.postCore({body:Object(c.t)({SourceItemID:t,SourceListName:e})})}getPageOneRelatedItems(e,t){const r=this.clone(hn,null);return r.concat(".GetPageOneRelatedItems"),r.postCore({body:Object(c.t)({SourceItemID:t,SourceListName:e})})}addSingleLink(e,t,r,n,s,i,o=!1){const a=this.clone(hn,null);return a.concat(".AddSingleLink"),a.postCore({body:Object(c.t)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:s,TargetListName:n,TargetWebUrl:i,TryAddReverseLink:o})})}addSingleLinkToUrl(e,t,r,n=!1){const s=this.clone(hn,null);return s.concat(".AddSingleLinkToUrl"),s.postCore({body:Object(c.t)({SourceItemID:t,SourceListName:e,TargetItemUrl:r,TryAddReverseLink:n})})}addSingleLinkFromUrl(e,t,r,n=!1){const s=this.clone(hn,null);return s.concat(".AddSingleLinkFromUrl"),s.postCore({body:Object(c.t)({SourceItemUrl:e,TargetItemID:r,TargetListName:t,TryAddReverseLink:n})})}deleteSingleLink(e,t,r,n,s,i,o=!1){const a=this.clone(hn,null);return a.concat(".DeleteSingleLink"),a.postCore({body:Object(c.t)({SourceItemID:t,SourceListName:e,SourceWebUrl:r,TargetItemID:s,TargetListName:n,TargetWebUrl:i,TryDeleteReverseLink:o})})}};var pn,gn;dn=hn=C([Ge("_api/SP.RelatedItemManager")],dn);let mn=pn=class extends Be{add(e,t,r="",n="STS",s=1033,i=!0){const o={Description:r,Language:s,Title:e,Url:t,UseSamePermissionsAsParentSite:i,WebTemplate:n},a=Object(c.t)({parameters:Object(c.j)({__metadata:{type:"SP.WebCreationInformation"}},o)});return this.clone(pn,"add").postCore({body:a}).then(e=>({data:e,web:new bn(ve(e).replace(/_api\/web\/?/i,""))}))}};mn=pn=C([Ge("webs")],mn);let fn=class extends Be{};fn=C([Ge("webinfos")],fn);let bn=gn=class extends Ot{static fromUrl(e,t){return new gn(Ie(e),t)}get webs(){return new mn(this)}getParentWeb(){return this.select("ParentWeb/Id").expand("ParentWeb").get().then(({ParentWeb:e})=>new Tn(this.toUrlAndQuery().split("/_api")[0]).openWebById(e.Id))}getSubwebsFilteredForCurrentUser(e=-1,t=-1){return this.clone(mn,`getSubwebsFilteredForCurrentUser(nWebTemplateFilter=${e},nConfigurationFilter=${t})`)}get allProperties(){return this.clone(Be,"allproperties")}get webinfos(){return new fn(this)}get contentTypes(){return new Lt(this)}get lists(){return new rr(this)}get fields(){return new zt(this)}get features(){return new ln(this)}get availablefields(){return new zt(this,"availablefields")}get navigation(){return new Gr(this)}get siteUsers(){return new Me(this)}get siteGroups(){return new Qe(this)}get siteUserInfoList(){return new nr(this,"siteuserinfolist")}get regionalSettings(){return new Kr(this)}get currentUser(){return new He(this)}get folders(){return new jt(this)}get userCustomActions(){return new er(this)}get roleDefinitions(){return new Ye(this)}get relatedItems(){return dn.FromUrl(this.toUrl())}createBatch(){return new Pr(this.parentUrl)}get rootFolder(){return new Ut(this,"rootFolder")}get associatedOwnerGroup(){return new ze(this,"associatedownergroup")}get associatedMemberGroup(){return new ze(this,"associatedmembergroup")}get associatedVisitorGroup(){return new ze(this,"associatedvisitorgroup")}get defaultDocumentLibrary(){return new nr(this,"DefaultDocumentLibrary")}getFolderByServerRelativeUrl(e){return new Ut(this,`getFolderByServerRelativeUrl('${e}')`)}getFolderByServerRelativePath(e){return new Ut(this,`getFolderByServerRelativePath(decodedUrl='${e}')`)}getFileByServerRelativeUrl(e){return new Tr(this,`getFileByServerRelativeUrl('${e}')`)}getFileByServerRelativePath(e){return new Tr(this,`getFileByServerRelativePath(decodedUrl='${e}')`)}getList(e){return new nr(this,`getList('${e}')`)}update(e){const t=Object(c.t)(Object(c.j)({__metadata:{type:"SP.Web"}},e));return this.postCore({body:t,headers:{"X-HTTP-Method":"MERGE"}}).then(e=>({data:e,web:this}))}delete(){return super.deleteCore()}applyTheme(e,t,r,n){const s=Object(c.t)({backgroundImageUrl:r,colorPaletteUrl:e,fontSchemeUrl:t,shareGenerated:n});return this.clone(gn,"applytheme").postCore({body:s})}applyWebTemplate(e){const t=this.clone(gn,"applywebtemplate");return t.concat("(@t)"),t.query.set("@t",e),t.postCore()}ensureUser(e){const t=Object(c.t)({logonName:e});return this.clone(gn,"ensureuser").postCore({body:t}).then(e=>({data:e,user:new We(ve(e))}))}availableWebTemplates(e=1033,t=!0){return new Be(this,`getavailablewebtemplates(lcid=${e}, doincludecrosslanguage=${t})`)}getCatalog(e){return this.clone(gn,`getcatalog(${e})`).select("Id").get().then(e=>new nr(ve(e)))}getChanges(e){const t=Object(c.t)({query:Object(c.j)({__metadata:{type:"SP.ChangeQuery"}},e)});return this.clone(gn,"getchanges").postCore({body:t})}get customListTemplate(){return new Be(this,"getcustomlisttemplates")}getUserById(e){return new We(this,`getUserById(${e})`)}mapToIcon(e,t=0,r=""){return this.clone(gn,`maptoicon(filename='${e}', progid='${r}', size=${t})`).get()}getStorageEntity(e){return this.clone(gn,`getStorageEntity('${e}')`).get()}setStorageEntity(e,t,r="",n=""){return this.clone(gn,"setStorageEntity").postCore({body:Object(c.t)({comments:n,description:r,key:e,value:t})})}removeStorageEntity(e){return this.clone(gn,`removeStorageEntity('${e}')`).postCore()}getAppCatalog(e){return new vr(e||this)}getClientSideWebParts(){return this.clone(Be,"GetClientSideWebParts").get()}addClientSidePage(e,t=e.replace(/\.[^/.]+$/,""),r="Site Pages"){return jr.create(this.lists.getByTitle(r),e,t)}addClientSidePageByPath(e,t,r=e.replace(/\.[^/.]+$/,"")){return jr.create(this.getList(t),e,r)}};var yn;bn=gn=C([Ge("_api/web")],bn);let Tn=yn=class extends qe{get rootWeb(){return new bn(this,"rootweb")}get features(){return new ln(this)}get userCustomActions(){return new er(this)}getRootWeb(){return this.rootWeb.select("Url").get().then(e=>new bn(e.Url))}getContextInfo(){return new yn(this.parentUrl,"_api/contextinfo").postCore().then(e=>{if(Object(c.p)(e,"GetContextWebInformation")){const t=e.GetContextWebInformation;return t.SupportedSchemaVersions=t.SupportedSchemaVersions.results,t}return e})}getDocumentLibraries(e){const t=new $e("","_api/sp.web.getdocumentlibraries(@v)");return t.query.set("@v","'"+e+"'"),t.get().then(e=>Object(c.p)(e,"GetDocumentLibraries")?e.GetDocumentLibraries:e)}getWebUrlFromPageUrl(e){const t=new $e("","_api/sp.web.getweburlfrompageurl(@v)");return t.query.set("@v",`'${e}'`),t.get().then(e=>Object(c.p)(e,"GetWebUrlFromPageUrl")?e.GetWebUrlFromPageUrl:e)}createBatch(){return new Pr(this.parentUrl)}openWebById(e){return this.clone(yn,`openWebById('${e}')`).postCore().then(e=>({data:e,web:bn.fromUrl(e["odata.id"]||e.__metadata.uri)}))}};var Sn,wn;Tn=yn=C([Ge("_api/site")],Tn);class Cn extends qe{constructor(e,t="_api/sp.userprofiles.peoplemanager"){super(e,t),this.clientPeoplePickerQuery=new _n(e).configureFrom(this),this.profileLoader=new On(e).configureFrom(this)}get editProfileLink(){return this.clone(Cn,"EditProfileLink").get()}get isMyPeopleListPublic(){return this.clone(Cn,"IsMyPeopleListPublic").get()}amIFollowedBy(e){const t=this.clone(Cn,"amifollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}amIFollowing(e){const t=this.clone(Cn,"amifollowing(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getFollowedTags(e=20){return this.clone(Cn,`getfollowedtags(${e})`).get()}getFollowersFor(e){const t=this.clone(Cn,"getfollowersfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get myFollowers(){return new Be(this,"getmyfollowers")}get myProperties(){return new Cn(this,"getmyproperties")}getPeopleFollowedBy(e){const t=this.clone(Cn,"getpeoplefollowedby(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}getPropertiesFor(e){const t=this.clone(Cn,"getpropertiesfor(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.get()}get trendingTags(){const e=this.clone(Cn,null);return e.concat(".gettrendingtags"),e.get()}getUserProfilePropertyFor(e,t){const r=this.clone(Cn,`getuserprofilepropertyfor(accountname=@v, propertyname='${t}')`);return r.query.set("@v",`'${encodeURIComponent(e)}'`),r.get()}hideSuggestion(e){const t=this.clone(Cn,"hidesuggestion(@v)");return t.query.set("@v",`'${encodeURIComponent(e)}'`),t.postCore()}isFollowing(e,t){const r=this.clone(Cn,null);return r.concat(".isfollowing(possiblefolloweraccountname=@v, possiblefolloweeaccountname=@y)"),r.query.set("@v",`'${encodeURIComponent(e)}'`),r.query.set("@y",`'${encodeURIComponent(t)}'`),r.get()}setMyProfilePic(e){return new Promise((t,r)=>{let n=null;const s=new FileReader;s.onload=(e=>n=e.target.result),s.readAsArrayBuffer(e),new Cn(this,"setmyprofilepicture").postCore({body:String.fromCharCode.apply(null,new Uint16Array(n))}).then(e=>t()).catch(e=>r(e))})}setSingleValueProfileProperty(e,t,r){const n=Object(c.t)({accountName:e,propertyName:t,propertyValue:r});return this.clone(Cn,"SetSingleValueProfileProperty").postCore({body:n})}setMultiValuedProfileProperty(e,t,r){const n=Object(c.t)({accountName:e,propertyName:t,propertyValues:r});return this.clone(Cn,"SetMultiValuedProfileProperty").postCore({body:n})}createPersonalSiteEnqueueBulk(...e){return this.profileLoader.createPersonalSiteEnqueueBulk(e)}get ownerUserProfile(){return this.profileLoader.ownerUserProfile}get userProfile(){return this.profileLoader.userProfile}createPersonalSite(e=!1){return this.profileLoader.createPersonalSite(e)}shareAllSocialData(e){return this.profileLoader.shareAllSocialData(e)}clientPeoplePickerResolveUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerResolveUser(e)}clientPeoplePickerSearchUser(e){return this.clientPeoplePickerQuery.clientPeoplePickerSearchUser(e)}}let On=Sn=class extends $e{createPersonalSiteEnqueueBulk(e){return this.clone(Sn,"createpersonalsiteenqueuebulk",!1).postCore({body:Object(c.t)({emailIDs:e})})}get ownerUserProfile(){let e=this.getParent(Sn,this.parentUrl,"_api/sp.userprofiles.profileloader.getowneruserprofile");return this.hasBatch&&(e=e.inBatch(this.batch)),e.postCore()}get userProfile(){return this.clone(Sn,"getuserprofile").postCore()}createPersonalSite(e=!1){return this.clone(Sn,`getuserprofile/createpersonalsiteenque(${e})`).postCore()}shareAllSocialData(e){return this.clone(Sn,`getuserprofile/shareallsocialdata(${e})`).postCore()}};On=Sn=C([Ge("_api/sp.userprofiles.profileloader.getprofileloader")],On);let _n=wn=class extends $e{clientPeoplePickerResolveUser(e){const t=this.clone(wn,null);return t.concat(".clientpeoplepickerresolveuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(e=>"object"==typeof e?e.ClientPeoplePickerResolveUser:e).then(JSON.parse)}clientPeoplePickerSearchUser(e){const t=this.clone(wn,null);return t.concat(".clientpeoplepickersearchuser"),t.postCore({body:this.createClientPeoplePickerQueryParametersRequestBody(e)}).then(e=>"object"==typeof e?e.ClientPeoplePickerSearchUser:e).then(JSON.parse)}createClientPeoplePickerQueryParametersRequestBody(e){return Object(c.t)({queryParams:Object(c.j)(Fe("SP.UI.ApplicationPages.ClientPeoplePickerQueryParameters"),e)})}};var In,vn;_n=wn=C([Ge("_api/sp.ui.applicationpages.clientpeoplepickerwebserviceinterface")],_n);let En=In=class extends qe{get my(){return new Pn(this)}getFollowedSitesUri(){return this.clone(In,"FollowedSitesUri").get().then(e=>e.FollowedSitesUri||e)}getFollowedDocumentsUri(){return this.clone(In,"FollowedDocumentsUri").get().then(e=>e.FollowedDocumentsUri||e)}follow(e){return this.clone(In,"follow").postCore({body:this.createSocialActorInfoRequestBody(e)})}isFollowed(e){return this.clone(In,"isfollowed").postCore({body:this.createSocialActorInfoRequestBody(e)})}stopFollowing(e){return this.clone(In,"stopfollowing").postCore({body:this.createSocialActorInfoRequestBody(e)})}createSocialActorInfoRequestBody(e){return Object(c.t)({actor:Object.assign(Fe("SP.Social.SocialActorInfo"),{Id:null},e)})}};En=In=C([Ge("_api/social.following")],En);let Pn=vn=class extends qe{followed(e){return this.clone(vn,`followed(types=${e})`).get().then(e=>Object(c.p)(e,"Followed")?e.Followed.results:e)}followedCount(e){return this.clone(vn,`followedcount(types=${e})`).get().then(e=>e.FollowedCount||e)}followers(){return this.clone(vn,"followers").get().then(e=>Object(c.p)(e,"Followers")?e.Followers.results:e)}suggestions(){return this.clone(vn,"suggestions").get().then(e=>Object(c.p)(e,"Suggestions")?e.Suggestions.results:e)}};var Nn,Rn,An,xn;Pn=vn=C([Ge("my")],Pn),function(e){e[e.User=0]="User",e[e.Document=1]="Document",e[e.Site=2]="Site",e[e.Tag=3]="Tag"}(Nn||(Nn={})),function(e){e[e.None=0]="None",e[e.User=1]="User",e[e.Document=2]="Document",e[e.Site=4]="Site",e[e.Tag=8]="Tag",e[e.ExcludeContentWithoutFeeds=268435456]="ExcludeContentWithoutFeeds",e[e.IncludeGroupsSites=536870912]="IncludeGroupsSites",e[e.WithinLast24Hours=1073741824]="WithinLast24Hours"}(Rn||(Rn={})),function(e){e[e.Ok=0]="Ok",e[e.AlreadyFollowing=1]="AlreadyFollowing",e[e.LimitReached=2]="LimitReached",e[e.InternalError=3]="InternalError"}(An||(An={})),function(e){e[e.OK=0]="OK",e[e.InvalidRequest=1]="InvalidRequest",e[e.AccessDenied=2]="AccessDenied",e[e.ItemNotFound=3]="ItemNotFound",e[e.InvalidOperation=4]="InvalidOperation",e[e.ItemNotModified=5]="ItemNotModified",e[e.InternalError=6]="InternalError",e[e.CacheReadError=7]="CacheReadError",e[e.CacheUpdateError=8]="CacheUpdateError",e[e.PersonalSiteNotFound=9]="PersonalSiteNotFound",e[e.FailedToCreatePersonalSite=10]="FailedToCreatePersonalSite",e[e.NotAuthorizedToCreatePersonalSite=11]="NotAuthorizedToCreatePersonalSite",e[e.CannotCreatePersonalSite=12]="CannotCreatePersonalSite",e[e.LimitReached=13]="LimitReached",e[e.AttachmentError=14]="AttachmentError",e[e.PartialData=15]="PartialData",e[e.FeatureDisabled=16]="FeatureDisabled",e[e.StorageQuotaExceeded=17]="StorageQuotaExceeded",e[e.DatabaseError=18]="DatabaseError"}(xn||(xn={}));class jn extends $e{constructor(e,t){super(jn.getBaseUrl(e),`_api/SP.Utilities.Utility.${t}`)}static getBaseUrl(e){if("string"==typeof e)return e;const t=e.toUrl(),r=t.indexOf("_api/");return r<0?t:t.substr(0,r)}excute(e){return this.postCore({body:Object(c.t)(e)})}sendEmail(e){const t={properties:Object(c.j)(Fe("SP.Utilities.EmailProperties"),{Body:e.Body,From:e.From,Subject:e.Subject})};return e.To&&e.To.length>0&&(t.properties=Object(c.j)(t.properties,{To:{results:e.To}})),e.CC&&e.CC.length>0&&(t.properties=Object(c.j)(t.properties,{CC:{results:e.CC}})),e.BCC&&e.BCC.length>0&&(t.properties=Object(c.j)(t.properties,{BCC:{results:e.BCC}})),e.AdditionalHeaders&&(t.properties=Object(c.j)(t.properties,{AdditionalHeaders:e.AdditionalHeaders})),this.clone(jn,"SendEmail",!0).excute(t)}getCurrentUserEmailAddresses(){return this.clone(jn,"GetCurrentUserEmailAddresses",!0).excute({})}resolvePrincipal(e,t,r,n,s,i=!1){const o={addToUserInfoList:s,input:e,inputIsEmailOnly:n,matchUserInfoList:i,scopes:t,sources:r};return this.clone(jn,"ResolvePrincipalInCurrentContext",!0).excute(o)}searchPrincipals(e,t,r,n,s){const i={groupName:n,input:e,maxCount:s,scopes:t,sources:r};return this.clone(jn,"SearchPrincipalsUsingContextWeb",!0).excute(i)}createEmailBodyForInvitation(e){const t={pageAddress:e};return this.clone(jn,"CreateEmailBodyForInvitation",!0).excute(t)}expandGroupsToPrincipals(e,t=30){const r={inputs:e,maxCount:t};return this.clone(jn,"ExpandGroupsToPrincipals",!0).excute(r)}createWikiPage(e){return this.clone(jn,"CreateWikiPageInContextWeb",!0).excute({parameters:e}).then(e=>({data:e,file:new Tr(ve(e))}))}}class Un{constructor(e={},t=""){this._options=e,this._baseUrl=t}configure(e,t=""){return new Un(e,t)}setup(e){Object(Ae.b)(e)}searchSuggest(e){let t;return t="string"==typeof e?{querytext:e}:e,this.create(an).execute(t)}search(e){return this.create(en).execute(e)}searchWithCaching(e,t){return this.create(en).usingCaching(t).execute(e)}get site(){return this.create(Tn)}get web(){return this.create(bn)}get profiles(){return this.create(Cn)}get social(){return this.create(En)}get navigation(){return new Mr}createBatch(){return this.web.createBatch()}get utility(){return this.create(jn,"")}create(e,t){return new e(this._baseUrl,t).configure(this._options)}}new Un;const kn=new class extends Un{crossDomainSite(e,t){return this._cdImpl(Tn,e,t,"site")}crossDomainWeb(e,t){return this._cdImpl(bn,e,t,"web")}_cdImpl(e,t,r,n){if(!Object(c.s)(t))throw Error("The addInWebUrl parameter must be an absolute url.");if(!Object(c.s)(r))throw Error("The hostWebUrl parameter must be an absolute url.");const s=new e(Object(c.h)(t,"_api/SP.AppContextSite(@target)"),n);return s.query.set("@target","'"+encodeURIComponent(r)+"'"),s.configure(this._options)}};var Ln={combine:c.h,dateAdd:c.i,extend:c.j,getAttrValueFromString:c.k,getCtxCallback:c.l,getGUID:c.m,getRandomString:c.o,isArray:c.q,isFunc:c.r,isUrlAbsolute:c.s,objectDefinedNotNull:c.x,sanitizeGuid:c.z,stringIsNullOrEmpty:c.A},Dn=kn,Fn=Oe,$n=new c.d,Bn=new l,qn=n,Gn=function(e){c.f.extend(e)},Mn={config:Bn,graph:Fn,log:qn,setup:Gn,sp:Dn,storage:$n,util:Ln};r.d(t,"util",function(){return Ln}),r.d(t,"sp",function(){return Dn}),r.d(t,"graph",function(){return Fn}),r.d(t,"storage",function(){return $n}),r.d(t,"config",function(){return Bn}),r.d(t,"log",function(){return qn}),r.d(t,"setup",function(){return Gn}),r.d(t,"odataUrlFrom",function(){return ve}),r.d(t,"spODataEntity",function(){return Ne}),r.d(t,"spODataEntityArray",function(){return Re}),r.d(t,"SharePointQueryable",function(){return $e}),r.d(t,"SharePointQueryableInstance",function(){return qe}),r.d(t,"SharePointQueryableCollection",function(){return Be}),r.d(t,"SharePointQueryableSecurable",function(){return wt}),r.d(t,"FileFolderShared",function(){return It}),r.d(t,"SharePointQueryableShareable",function(){return Ct}),r.d(t,"SharePointQueryableShareableFile",function(){return vt}),r.d(t,"SharePointQueryableShareableFolder",function(){return Et}),r.d(t,"SharePointQueryableShareableItem",function(){return _t}),r.d(t,"SharePointQueryableShareableWeb",function(){return Ot}),r.d(t,"AppCatalog",function(){return vr}),r.d(t,"App",function(){return Er}),r.d(t,"SPBatch",function(){return Pr}),r.d(t,"ContentType",function(){return Dt}),r.d(t,"ContentTypes",function(){return Lt}),r.d(t,"FieldLink",function(){return $t}),r.d(t,"FieldLinks",function(){return Ft}),r.d(t,"Field",function(){return Jt}),r.d(t,"Fields",function(){return zt}),r.d(t,"CheckinType",function(){return wr}),r.d(t,"WebPartsPersonalizationScope",function(){return Cr}),r.d(t,"MoveOperations",function(){return Or}),r.d(t,"TemplateFileType",function(){return _r}),r.d(t,"File",function(){return Tr}),r.d(t,"Files",function(){return yr}),r.d(t,"Folder",function(){return Ut}),r.d(t,"Folders",function(){return jt}),r.d(t,"SPHttpClient",function(){return ke}),r.d(t,"Item",function(){return hr}),r.d(t,"Items",function(){return ur}),r.d(t,"ItemVersion",function(){return pr}),r.d(t,"ItemVersions",function(){return dr}),r.d(t,"PagedItemCollection",function(){return gr}),r.d(t,"NavigationNodes",function(){return Br}),r.d(t,"NavigationNode",function(){return qr}),r.d(t,"NavigationService",function(){return Mr}),r.d(t,"List",function(){return nr}),r.d(t,"Lists",function(){return rr}),r.d(t,"RegionalSettings",function(){return Kr}),r.d(t,"InstalledLanguages",function(){return Vr}),r.d(t,"TimeZone",function(){return Qr}),r.d(t,"TimeZones",function(){return zr}),r.d(t,"SPRest",function(){return Un}),r.d(t,"RoleDefinitionBindings",function(){return et}),r.d(t,"Search",function(){return en}),r.d(t,"SearchQueryBuilder",function(){return Zr}),r.d(t,"SearchResults",function(){return tn}),r.d(t,"SortDirection",function(){return rn}),r.d(t,"ReorderingRuleMatchType",function(){return nn}),r.d(t,"QueryPropertyValueType",function(){return sn}),r.d(t,"SearchBuiltInSourceId",function(){return on}),r.d(t,"SearchSuggest",function(){return an}),r.d(t,"Site",function(){return Tn}),r.d(t,"UserProfileQuery",function(){return Cn}),r.d(t,"toAbsoluteUrl",function(){return De.a}),r.d(t,"extractWebUrl",function(){return Ie}),r.d(t,"UtilityMethod",function(){return jn}),r.d(t,"View",function(){return Kt}),r.d(t,"Views",function(){return Ht}),r.d(t,"ViewFields",function(){return Vt}),r.d(t,"WebPartDefinitions",function(){return Nt}),r.d(t,"WebPartDefinition",function(){return Rt}),r.d(t,"WebPart",function(){return At}),r.d(t,"Web",function(){return bn}),r.d(t,"GraphRest",function(){return Ce}),r.d(t,"GroupType",function(){return ie}),r.d(t,"Group",function(){return ae}),r.d(t,"Groups",function(){return oe}),r.d(t,"GraphBatch",function(){return _e}),r.d(t,"GraphQueryable",function(){return k}),r.d(t,"GraphQueryableCollection",function(){return L}),r.d(t,"GraphQueryableInstance",function(){return F}),r.d(t,"GraphQueryableSearchableCollection",function(){return D}),r.d(t,"Logger",function(){return n}),r.d(t,"LogLevel",function(){return i}),r.d(t,"ConsoleListener",function(){return o}),r.d(t,"FunctionListener",function(){return a}),r.d(t,"PromotedState",function(){return Ir}),r.d(t,"ClientSidePage",function(){return jr}),r.d(t,"CanvasSection",function(){return Ur}),r.d(t,"CanvasControl",function(){return kr}),r.d(t,"CanvasColumn",function(){return Lr}),r.d(t,"ClientSidePart",function(){return Dr}),r.d(t,"ClientSideText",function(){return Fr}),r.d(t,"ClientSideWebpart",function(){return $r}),r.d(t,"Comments",function(){return or}),r.d(t,"Comment",function(){return ar}),r.d(t,"Replies",function(){return cr}),r.d(t,"SocialQuery",function(){return En}),r.d(t,"MySocialQuery",function(){return Pn}),r.d(t,"SocialActorType",function(){return Nn}),r.d(t,"SocialActorTypes",function(){return Rn}),r.d(t,"SocialFollowResult",function(){return An}),r.d(t,"SocialStatusCode",function(){return xn}),r.d(t,"ControlMode",function(){return tt}),r.d(t,"FieldTypes",function(){return rt}),r.d(t,"DateTimeFieldFormatType",function(){return nt}),r.d(t,"AddFieldOptions",function(){return st}),r.d(t,"CalendarType",function(){return it}),r.d(t,"UrlFieldFormatType",function(){return ot}),r.d(t,"PermissionKind",function(){return at}),r.d(t,"PrincipalType",function(){return ct}),r.d(t,"PrincipalSource",function(){return lt}),r.d(t,"RoleType",function(){return ut}),r.d(t,"PageType",function(){return ht}),r.d(t,"SharingLinkKind",function(){return dt}),r.d(t,"SharingRole",function(){return pt}),r.d(t,"SharingOperationStatusCode",function(){return gt}),r.d(t,"SPSharedObjectType",function(){return mt}),r.d(t,"SharingDomainRestrictionMode",function(){return ft}),r.d(t,"RenderListDataOptions",function(){return bt}),r.d(t,"FieldUserSelectionMode",function(){return yt}),r.d(t,"ChoiceFieldFormatType",function(){return Tt}),r.d(t,"UrlZone",function(){return St}),r.d(t,"Teams",function(){return ne}),r.d(t,"Team",function(){return se}),r.d(t,"GraphEndpoints",function(){return U}),r.d(t,"OneNote",function(){return ce}),r.d(t,"Notebooks",function(){return le}),r.d(t,"Notebook",function(){return ue}),r.d(t,"Sections",function(){return he}),r.d(t,"Section",function(){return de}),r.d(t,"Pages",function(){return pe}),r.d(t,"AdalClient",function(){return c.a}),r.d(t,"objectToMap",function(){return c.y}),r.d(t,"mergeMaps",function(){return c.v}),r.d(t,"RuntimeConfigImpl",function(){return c.g}),r.d(t,"RuntimeConfig",function(){return c.f}),r.d(t,"mergeHeaders",function(){return c.u}),r.d(t,"mergeOptions",function(){return c.w}),r.d(t,"FetchClient",function(){return c.c}),r.d(t,"BearerTokenFetchClient",function(){return c.b}),r.d(t,"PnPClientStorageWrapper",function(){return c.e}),r.d(t,"PnPClientStorage",function(){return c.d}),r.d(t,"getCtxCallback",function(){return c.l}),r.d(t,"dateAdd",function(){return c.i}),r.d(t,"combine",function(){return c.h}),r.d(t,"getRandomString",function(){return c.o}),r.d(t,"getGUID",function(){return c.m}),r.d(t,"isFunc",function(){return c.r}),r.d(t,"objectDefinedNotNull",function(){return c.x}),r.d(t,"isArray",function(){return c.q}),r.d(t,"extend",function(){return c.j}),r.d(t,"isUrlAbsolute",function(){return c.s}),r.d(t,"stringIsNullOrEmpty",function(){return c.A}),r.d(t,"getAttrValueFromString",function(){return c.k}),r.d(t,"sanitizeGuid",function(){return c.z}),r.d(t,"jsS",function(){return c.t}),r.d(t,"hOP",function(){return c.p}),r.d(t,"getHashCode",function(){return c.n}),r.d(t,"Settings",function(){return l}),r.d(t,"CachingConfigurationProvider",function(){return u}),r.d(t,"SPListConfigurationProvider",function(){return h}),r.d(t,"CachingOptions",function(){return d}),r.d(t,"CachingParserWrapper",function(){return p}),r.d(t,"HttpRequestError",function(){return g}),r.d(t,"ODataParserBase",function(){return m}),r.d(t,"ODataDefaultParser",function(){return f}),r.d(t,"TextParser",function(){return b}),r.d(t,"BlobParser",function(){return y}),r.d(t,"JSONParser",function(){return T}),r.d(t,"BufferParser",function(){return S}),r.d(t,"LambdaParser",function(){return w}),r.d(t,"setResult",function(){return O}),r.d(t,"pipe",function(){return I}),r.d(t,"requestPipelineMethod",function(){return v}),r.d(t,"PipelineMethods",function(){return E}),r.d(t,"getDefaultPipeline",function(){return P}),r.d(t,"Queryable",function(){return N}),r.d(t,"ODataQueryable",function(){return R}),r.d(t,"ODataBatch",function(){return A});t.default=Mn}])});
//# sourceMappingURL=pnpjs.es5.umd.bundle.min.js.map