{"version":3,"sources":["../../../../packages/common/src/util.ts","../../../../packages/common/src/netutil.ts","../../../../packages/common/src/adalclient.ts","../../../../packages/common/src/collections.ts","../../../../packages/common/src/libconfig.ts","../../../../packages/common/src/storage.ts"],"names":["getCtxCallback","context","method","params","_i","arguments","length","apply","dateAdd","date","interval","units","ret","Date","toLowerCase","setFullYear","getFullYear","setMonth","getMonth","setDate","getDate","setTime","getTime","undefined","combine","paths","filter","path","stringIsNullOrEmpty","map","replace","join","isFunc","cf","objectDefinedNotNull","obj","extend","target","source","noOverwrite","check","o","i","Object","getOwnPropertyNames","v","reduce","t","isUrlAbsolute","url","test","s","jsS","JSON","stringify","Request","headers","forEach","value","name","append","FetchClient","prototype","fetch","options","global","BearerTokenFetchClient","_super","_token","_this","call","this","tslib_1.__extends","defineProperty","token","Headers","mergeHeaders","set","AdalClient","clientId","tenant","redirectUri","fromSPFxContext","spfxContext","cliendId","pageContext","aadInfo","tenantId","toString","window","location","origin","Error","getToken","getResource","then","resource","Promise","resolve","reject","ensureAuthContext","_","login","_authContext","acquireToken","message","catch","adal.inject","displayCall","_displayCallback","navigateToLoginRequestUrl","_loginPromise","getCachedUser","popupWindow","open","focus","pollTimer","setInterval","closed","clearInterval","document","URL","indexOf","handleWindowCallback","hash","close","e","_loginInProgress","parser","createElement","href","protocol","hostname","objectEntries","entries","keys","k","objectToMap","Map","mergeMaps","maps","RuntimeConfigImpl","_v","config","get","key","RuntimeConfig","PnPClientStorageWrapper","store","defaultTimeoutMinutes","enabled","enableCacheExpiration","cacheExpirationHandler","getItem","persistable","parse","expiration","delete","put","expire","setItem","createPersistable","removeItem","getOrPut","getter","d","deleteExpired","defaultTimeout","defaultCachingTimeoutSeconds","pnp","setTimeout","cacheExpirationIntervalMilliseconds","console","error","MemoryStorage","_store","size","clear","index","Array","from","data","PnPClientStorage","_local","_session","getStore","localStorage","sessionStorage","chars","text","possible","charAt","Math","floor","random","c","r","array","isArray","constructor","html","attrName","match","RegExp","exec","guid","matches","p","hasOwnProperty"],"mappings":"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"}