!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).attach=e()}}(function(){return function r(a,u,i){function c(n,e){if(!u[n]){if(!a[n]){var t="function"==typeof require&&require;if(!e&&t)return t(n,!0);if(d)return d(n,!0);var o=new Error("Cannot find module '"+n+"'");throw o.code="MODULE_NOT_FOUND",o}var f=u[n]={exports:{}};a[n][0].call(f.exports,function(e){var t=a[n][1][e];return c(t||e)},f,f.exports,r,a,u,i)}return u[n].exports}for(var d="function"==typeof require&&require,e=0;e<i.length;e++)c(i[e]);return c}({1:[function(e,t,n){"use strict";function o(e,t,n,o){var f,r=e;n=void 0===n||n,r.__socket=t,r.__flushBuffer=function(){r.write(r.__attachSocketBuffer),r.__attachSocketBuffer=null},r.__pushToBuffer=function(e){r.__attachSocketBuffer?r.__attachSocketBuffer+=e:(r.__attachSocketBuffer=e,setTimeout(r.__flushBuffer,10))},r.__getMessage=function(e){var t;if("object"==typeof e.data){if(!(e.data instanceof ArrayBuffer))throw"TODO: handle Blob?";f||(f=new TextDecoder),t=f.decode(e.data)}o?r.__pushToBuffer(t||e.data):r.write(t||e.data)},r.__sendData=function(e){1===t.readyState&&t.send(e)},t.addEventListener("message",r.__getMessage),n&&r.on("data",r.__sendData),t.addEventListener("close",function(){return a(r,t)}),t.addEventListener("error",function(){return a(r,t)})}function a(e,t){var n=e;n.off("data",n.__sendData),(t=void 0===t?n.__socket:t)&&t.removeEventListener("message",n.__getMessage),delete n.__socket}Object.defineProperty(n,"__esModule",{value:!0}),n.attach=o,n.detach=a,n.apply=function(e){e.prototype.attach=function(e,t,n){o(this,e,t,n)},e.prototype.detach=function(e){a(this,e)}}},{}]},{},[1])(1)});