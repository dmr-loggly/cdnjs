"use strict";function terminadoAttach(a,e,t,n){t=void 0===t||t,a.socket=e,a._flushBuffer=function(){a.write(a._attachSocketBuffer),a._attachSocketBuffer=null},a._pushToBuffer=function(t){a._attachSocketBuffer?a._attachSocketBuffer+=t:(a._attachSocketBuffer=t,setTimeout(a._flushBuffer,10))},a._getMessage=function(t){var e=JSON.parse(t.data);"stdout"==e[0]&&(n?a._pushToBuffer(e[1]):a.write(e[1]))},a._sendData=function(t){e.send(JSON.stringify(["stdin",t]))},a._setSize=function(t){e.send(JSON.stringify(["set_size",t.rows,t.cols]))},e.addEventListener("message",a._getMessage),t&&a.on("data",a._sendData),a.on("resize",a._setSize),e.addEventListener("close",a.terminadoDetach.bind(a,e)),e.addEventListener("error",a.terminadoDetach.bind(a,e))}function terminadoDetach(t,e){t.off("data",t._sendData),(e=void 0===e?t.socket:e)&&e.removeEventListener("message",t._getMessage),delete t.socket}function apply(t){t.prototype.terminadoAttach=function(t,e,a){return terminadoAttach(this,t,e,a)},t.prototype.terminadoDetach=function(t){return terminadoDetach(this,t)}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.terminadoAttach=terminadoAttach,exports.terminadoDetach=terminadoDetach,exports.apply=apply;