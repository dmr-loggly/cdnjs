!function(c){var u,f,h=c(window),o={},v=[],g=[],b=null,s="_open",m="_close",y=[],w=null,_=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),k={_init:function(t){var e=c(t),o=e.data("popupoptions");g[t.id]=!1,v[t.id]=0,e.data("popup-initialized")||(e.attr("data-popup-initialized","true"),k._initonce(t)),o.autoopen&&setTimeout(function(){k.show(t,0)},0)},_initonce:function(o){var t,e,i=c(o),n=c("body"),a=i.data("popupoptions");(b=parseInt(n.css("margin-right"),10),w=void 0!==document.body.style.webkitTransition||void 0!==document.body.style.MozTransition||void 0!==document.body.style.msTransition||void 0!==document.body.style.OTransition||void 0!==document.body.style.transition,"tooltip"==a.type&&(a.background=!1,a.scrolllock=!1),a.backgroundactive&&(a.background=!1,a.blur=!1,a.scrolllock=!1),a.scrolllock)&&(void 0===u&&(e=(t=c('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body")).children(),u=e.innerWidth()-e.height(99).innerWidth(),t.remove()));i.attr("id")||i.attr("id","j-popup-"+parseInt(1e8*Math.random(),10)),i.addClass("popup_content"),i.css({opacity:0,visibility:"hidden",display:"inline-block"}),a.outline||i.css("outline","none"),a.transition&&i.css("transition",a.transition),i.attr("aria-hidden",!0),"overlay"==a.type&&i.css({textAlign:"left",position:"relative",verticalAlign:"middle"}),i.attr("role","dialog");var p=a.openelement?a.openelement:"."+o.id+s;c(p).each(function(t,e){c(e).attr("data-popup-ordinal",t),e.id||c(e).attr("id","open_"+parseInt(1e8*Math.random(),10))}),i.attr("aria-labelledby")||i.attr("aria-label")||i.attr("aria-labelledby",c(p).attr("id")),"hover"==a.action?(a.keepfocus=!1,c(p).on("mouseenter",function(t){k.show(o,c(this).data("popup-ordinal"))}),c(p).on("mouseleave",function(t){k.hide(o)})):c(document).on("click",p,function(t){t.preventDefault();var e=c(this).data("popup-ordinal");setTimeout(function(){k.show(o,e)},0)}),a.closebutton&&k.addclosebutton(o),a.detach?i.hide().detach():$wrapper.hide()},show:function(t,e){var o=c(t);if(!o.data("popup-visible")){o.data("popup-initialized")||k._init(t),o.attr("data-popup-initialized","true");var i=c("body"),n=o.data("popupoptions"),a=c("#"+t.id+"_background");if(i.prepend(t),o.wrap('<div id="'+t.id+'_wrapper" class="popup_wrapper" />'),$wrapper=c("#"+t.id+"_wrapper"),$wrapper.css({opacity:0,visibility:"hidden",position:"absolute"}),_&&$wrapper.css("cursor","pointer"),n.setzindex&&!n.autozindex&&$wrapper.css("z-index","100001"),n.transition&&$wrapper.css("transition",n.transition),"overlay"==n.type&&$wrapper.css("overflow","auto"),"overlay"==n.type&&(css={position:"fixed",width:"100%",height:"100%",top:0,left:0,textAlign:"center"},n.backgroundactive&&(css.position="relative",css.height="0",css.overflow="visible"),$wrapper.css(css),$wrapper.append('<div class="popup_align" />'),c(".popup_align").css({display:"inline-block",verticalAlign:"middle",height:"100%"})),n.background&&!c("#"+t.id+"_background").length)i.prepend('<div id="'+t.id+'_background" class="popup_background"></div>'),(a=c("#"+t.id+"_background")).css({opacity:0,visibility:"hidden",backgroundColor:n.color,position:"fixed",top:0,right:0,bottom:0,left:0}),n.setzindex&&!n.autozindex&&a.css("z-index","100000"),n.transition&&a.css("transition",n.transition);if($(t,e,n.beforeopen),g[t.id]=e,setTimeout(function(){y.push(t.id)},0),n.autozindex){for(var p=document.getElementsByTagName("*"),s=p.length,l=0,d=0;d<s;d++){var r=c(p[d]).css("z-index");"auto"!==r&&l<(r=parseInt(r,10))&&(l=r)}v[t.id]=l,n.background&&0<v[t.id]&&c("#"+t.id+"_background").css({zIndex:v[t.id]+1}),0<v[t.id]&&$wrapper.css({zIndex:v[t.id]+2})}n.detach?($wrapper.prepend(t),o.show()):$wrapper.show(),f=setTimeout(function(){$wrapper.css({visibility:"visible",opacity:1}),c("html").addClass("popup_visible").addClass("popup_visible_"+t.id),$wrapper.addClass("popup_wrapper_visible")},20),n.scrolllock&&(i.css("overflow","hidden"),i.height()>h.height()&&i.css("margin-right",b+u)),n.backgroundactive&&o.css({top:(h.height()-(o.get(0).offsetHeight+parseInt(o.css("margin-top"),10)+parseInt(o.css("margin-bottom"),10)))/2+"px"}),o.css({visibility:"visible",opacity:1}),n.background&&(a.css({visibility:"visible",opacity:n.opacity}),setTimeout(function(){a.css({opacity:n.opacity})},0)),o.data("popup-visible",!0),k.reposition(t,e),o.data("focusedelementbeforepopup",document.activeElement),n.keepfocus&&(o.attr("tabindex",-1),setTimeout(function(){"closebutton"===n.focuselement?c("#"+t.id+" ."+t.id+m+":first").focus():n.focuselement?c(n.focuselement).focus():o.focus()},n.focusdelay)),c(n.pagecontainer).attr("aria-hidden",!0),o.attr("aria-hidden",!1),$(t,e,n.onopen),w?$wrapper.one("transitionend",function(){$(t,e,n.opentransitionend)}):$(t,e,n.opentransitionend)}},hide:function(e){f&&clearTimeout(f);var o=c("body"),i=c(e),n=i.data("popupoptions"),a=c("#"+e.id+"_wrapper"),p=c("#"+e.id+"_background");i.data("popup-visible",!1),1===y.length?c("html").removeClass("popup_visible").removeClass("popup_visible_"+e.id):c("html").hasClass("popup_visible_"+e.id)&&c("html").removeClass("popup_visible_"+e.id),y.pop(),a.hasClass("popup_wrapper_visible")&&a.removeClass("popup_wrapper_visible"),n.keepfocus&&setTimeout(function(){c(i.data("focusedelementbeforepopup")).is(":visible")&&i.data("focusedelementbeforepopup").focus()},0),a.css({visibility:"hidden",opacity:0}),i.css({visibility:"hidden",opacity:0}),n.background&&p.css({visibility:"hidden",opacity:0}),c(n.pagecontainer).attr("aria-hidden",!1),i.attr("aria-hidden",!0),$(e,g[e.id],n.onclose),w&&"0s"!==i.css("transition-duration")?i.one("transitionend",function(t){i.data("popup-visible")||(n.detach?(a.hide().detach(),p.hide().detach()):a.hide()),n.scrolllock&&setTimeout(function(){o.css({overflow:"visible","margin-right":b})},10),$(e,g[e.id],n.closetransitionend)}):(n.detach?(a.hide().detach(),p.hide().detach()):a.hide(),n.scrolllock&&setTimeout(function(){o.css({overflow:"visible","margin-right":b})},10),$(e,g[e.id],n.closetransitionend))},toggle:function(t,e){c(t).data("popup-visible")?k.hide(t):setTimeout(function(){k.show(t,e)},0)},reposition:function(t,e){var o=c(t),i=o.data("popupoptions"),n=c("#"+t.id+"_wrapper");c("#"+t.id+"_background");if(e=e||0,"tooltip"==i.type){var a;n.css({position:"absolute"});var p=(a=i.tooltipanchor?c(i.tooltipanchor):i.openelement?c(i.openelement).filter('[data-popup-ordinal="'+e+'"]'):c("."+t.id+s+'[data-popup-ordinal="'+e+'"]')).offset();"right"==i.horizontal?n.css("left",p.left+a.outerWidth()+i.offsetleft):"leftedge"==i.horizontal?n.css("left",p.left+a.outerWidth()-a.outerWidth()+i.offsetleft):"left"==i.horizontal?n.css("right",h.width()-p.left-i.offsetleft):"rightedge"==i.horizontal?n.css("right",h.width()-p.left-a.outerWidth()-i.offsetleft):n.css("left",p.left+a.outerWidth()/2-o.outerWidth()/2-parseFloat(o.css("marginLeft"))+i.offsetleft),"bottom"==i.vertical?n.css("top",p.top+a.outerHeight()+i.offsettop):"bottomedge"==i.vertical?n.css("top",p.top+a.outerHeight()-o.outerHeight()+i.offsettop):"top"==i.vertical?n.css("bottom",h.height()-p.top-i.offsettop):"topedge"==i.vertical?n.css("bottom",h.height()-p.top-o.outerHeight()-i.offsettop):n.css("top",p.top+a.outerHeight()/2-o.outerHeight()/2-parseFloat(o.css("marginTop"))+i.offsettop)}else"overlay"==i.type&&(i.horizontal?n.css("text-align",i.horizontal):n.css("text-align","center"),i.vertical?o.css("vertical-align",i.vertical):o.css("vertical-align","middle"))},addclosebutton:function(t){var e;e=c(t).data("popupoptions").closebuttonmarkup?c(o.closebuttonmarkup).addClass(t.id+"_close"):'<button class="popup_close '+t.id+'_close" title="Close" aria-label="Close"><span aria-hidden="true">Ã—</span></button>',$el.data("popup-initialized")&&$el.append(e)}},$=function(t,e,o){var i=c(t).data("popupoptions"),n=i.openelement?i.openelement:"."+t.id+s,a=c(n+'[data-popup-ordinal="'+e+'"]');"function"==typeof o&&o.call(c(t),t,a)};c(document).on("keydown",function(t){if(y.length){var e=y[y.length-1],o=document.getElementById(e);c(o).data("popupoptions").escape&&27==t.keyCode&&k.hide(o)}}),c(document).on("click",function(t){if(y.length){var e=y[y.length-1],o=document.getElementById(e),i=c(o).data("popupoptions").closeelement?c(o).data("popupoptions").closeelement:"."+o.id+m;c(t.target).closest(i).length&&(t.preventDefault(),k.hide(o)),c(o).data("popupoptions").blur&&!c(t.target).closest("#"+e).length&&2!==t.which&&c(t.target).is(":visible")&&(k.hide(o),"overlay"===c(o).data("popupoptions").type&&t.preventDefault())}}),c(document).on("focusin",function(t){if(y.length){var e=y[y.length-1],o=document.getElementById(e);c(o).data("popupoptions").keepfocus&&(o.contains(t.target)||(t.stopPropagation(),o.focus()))}}),c.fn.popup=function(e){return this.each(function(){if($el=c(this),"object"==typeof e){var t=c.extend({},c.fn.popup.defaults,e);$el.data("popupoptions",t),o=$el.data("popupoptions"),k._init(this)}else"string"==typeof e?($el.data("popupoptions")||($el.data("popupoptions",c.fn.popup.defaults),o=$el.data("popupoptions")),k[e].call(this,this)):($el.data("popupoptions")||($el.data("popupoptions",c.fn.popup.defaults),o=$el.data("popupoptions")),k._init(this))})},c.fn.popup.defaults={type:"overlay",autoopen:!1,background:!0,backgroundactive:!1,color:"black",opacity:"0.5",horizontal:"center",vertical:"middle",offsettop:0,offsetleft:0,escape:!0,blur:!0,setzindex:!0,autozindex:!1,scrolllock:!1,closebutton:!1,closebuttonmarkup:null,keepfocus:!0,focuselement:null,focusdelay:50,outline:!1,pagecontainer:null,detach:!0,openelement:null,closeelement:null,transition:null,tooltipanchor:null,beforeopen:null,onclose:null,onopen:null,opentransitionend:null,closetransitionend:null}}(jQuery);